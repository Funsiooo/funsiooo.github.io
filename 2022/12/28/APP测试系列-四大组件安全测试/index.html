<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="一、前言之前的文章介绍了 APP 抓包的几种方法，解决了抓包问题，其余 APP 功能点测试与 WEB 端测试如出一辙。本文主要介绍 Android APP 测试中四大组件相关测试手段。 Android 四大组件Android 四大组件分别是 Activity、Content Provider、Broadcast Receiver 以及 Service 123456| 组件名称">
<meta property="og:type" content="article">
<meta property="og:title" content="APP测试系列-四大组件安全测试">
<meta property="og:url" content="http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="世间闲客·此闲行">
<meta property="og:description" content="一、前言之前的文章介绍了 APP 抓包的几种方法，解决了抓包问题，其余 APP 功能点测试与 WEB 端测试如出一辙。本文主要介绍 Android APP 测试中四大组件相关测试手段。 Android 四大组件Android 四大组件分别是 Activity、Content Provider、Broadcast Receiver 以及 Service 123456| 组件名称">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230164849744.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116102905092.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116195702257.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116195828270.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116200101626.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116200255960.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221117205713220.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228201311642.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221123144712299.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116204352994.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221117112228564.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116205442505.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221116210214044.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230154124250.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230150431447.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118205504976.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230151306269.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118211507281.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118211715083.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118211856113.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118212227708.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118213337410.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221118214341449.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230150630239.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230150719923.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221230203111751.jpg">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228105855609.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228110911255.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228143353936.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228143724432.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228143848311.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228204134046.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228151737611.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228151941707.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228152408647.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228154520099.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228153720244.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228153747173.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228154604350.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228154446929.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228154427706.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228160057841.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228160259984.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228160839383.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228161024128.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228161043428.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20231122111055505.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228164227532.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228164826268.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228164917550.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20231122111055505.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228163829810.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228164227532.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228164509817.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228162300918.png">
<meta property="og:image" content="http://example.com/images/app/Components/image-20221228162847713.png">
<meta property="article:published_time" content="2022-12-28T12:14:11.000Z">
<meta property="article:modified_time" content="2024-03-11T02:16:06.000Z">
<meta property="article:author" content="Funsiooo">
<meta property="article:tag" content="APP测试">
<meta property="article:tag" content="四大组件">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/app/Components/image-20221230164849744.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/logo-1.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/logo-1.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/logo-1.png">
        
      
    
    <!-- title -->
    <title>APP测试系列-四大组件安全测试</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />

<meta name="generator" content="Hexo 5.4.2"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body class="max-width mx-auto px3 ">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2023/01/22/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E4%BD%A0%E6%9C%9F%E5%BE%85%E7%9A%84%EF%BC%8C%E6%AD%A3%E5%9C%A8%E8%B7%AF%E4%B8%8A/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2022/12/11/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E7%AF%87(%E4%B8%80)-Mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E4%BB%A3%E7%90%86/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&text=APP测试系列-四大组件安全测试"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&is_video=false&description=APP测试系列-四大组件安全测试"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=APP测试系列-四大组件安全测试&body=Check out this article: http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&name=APP测试系列-四大组件安全测试&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&t=APP测试系列-四大组件安全测试"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">一、前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Android-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">Android 四大组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">二、环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#drozer-%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.</span> <span class="toc-text">drozer 安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">3.</span> <span class="toc-text">三、四大组件测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Activity"><span class="toc-number">3.1.</span> <span class="toc-text">Activity</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B6%8A%E6%9D%83%E7%BB%95%E8%BF%87"><span class="toc-number">3.1.1.</span> <span class="toc-text">越权绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%92%93%E9%B1%BC%E6%AC%BA%E8%AF%88-x2F-Activity%E5%8A%AB%E6%8C%81"><span class="toc-number">3.1.2.</span> <span class="toc-text">钓鱼欺诈&#x2F;Activity劫持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="toc-number">3.1.3.</span> <span class="toc-text">拒绝服务攻击</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Conten-Provid"><span class="toc-number">3.2.</span> <span class="toc-text">Conten Provid</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">3.2.1.</span> <span class="toc-text">信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">3.2.2.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">3.2.3.</span> <span class="toc-text">目录遍历</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Broadcast-Receiver"><span class="toc-number">3.3.</span> <span class="toc-text">Broadcast Receiver</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.3.1.</span> <span class="toc-text">拒绝服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BC%AA%E9%80%A0%EF%BC%88%E5%8F%91%E9%80%81%E6%81%B6%E6%84%8F%E5%B9%BF%E6%92%AD%EF%BC%89"><span class="toc-number">3.3.2.</span> <span class="toc-text">消息伪造（发送恶意广播）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Service"><span class="toc-number">3.4.</span> <span class="toc-text">Service</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1-1"><span class="toc-number">3.4.1.</span> <span class="toc-text">拒绝服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text">四、扩展知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#adb%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">adb使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#APP%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E"><span class="toc-number">4.2.</span> <span class="toc-text">APP模块说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">五、总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">六、参考</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        APP测试系列-四大组件安全测试
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Funsiooo</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2022-12-28T12:14:11.000Z" itemprop="datePublished">2022-12-28</time>
        
        (Updated: <time datetime="2024-03-11T02:16:06.000Z" itemprop="dateModified">2024-03-11</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97/">APP测试系列</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/APP%E6%B5%8B%E8%AF%95/" rel="tag">APP测试</a>, <a class="tag-link-link" href="/tags/%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6/" rel="tag">四大组件</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230164849744.png" data-caption="image-20221230164849744"><img src="/../images/app/Components/image-20221230164849744.png" alt="image-20221230164849744"></a></p>
<h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>之前的文章介绍了 APP 抓包的几种方法，解决了抓包问题，其余 APP 功能点测试与 WEB 端测试如出一辙。本文主要介绍 Android APP 测试中四大组件相关测试手段。<br><br/></p>
<h3 id="Android-四大组件"><a href="#Android-四大组件" class="headerlink" title="Android 四大组件"></a>Android 四大组件</h3><p>Android 四大组件分别是 Activity、Content Provider、Broadcast Receiver 以及 Service</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| 组件名称            | 具体用途                                                     |</span><br><span class="line">| -----------------  | ------------------------------------------------------------ |</span><br><span class="line">| Activity           | 展示组件，用于向用户直接展示一个界面，而且可以接受用户的输入信息从而进行交互 |</span><br><span class="line">| Broadcast Receiver | 通讯组件，用于在不同组件甚至不同应用中传递消息               |</span><br><span class="line">| Content Provider   | 数据共享组件，用于向其他组件乃至其他应用共享数据             |</span><br><span class="line">| Service            | 能在后台执行长期运行操作的组件，它没有UI界面，运行在宿主进程的主线程中，因此执行耗时的后台计算任务需要在单独的线程中去完成 |</span><br></pre></td></tr></table></figure></div>


<br/>

<hr>
<h2 id="二、环境搭建"><a href="#二、环境搭建" class="headerlink" title="二、环境搭建"></a>二、环境搭建</h2><h3 id="drozer-安装"><a href="#drozer-安装" class="headerlink" title="drozer 安装"></a>drozer 安装</h3><p>drozer 安装在 Windows 下，安装环境必须为 python 2.7，下载地址 <a target="_blank" rel="noopener" href="https://github.com/WithSecureLabs/drozer/releases/tag/2.4.4">Github</a>、<a target="_blank" rel="noopener" href="https://labs.withsecure.com/tools/drozer">官网</a></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116102905092.png" data-caption="image-20221116102905092"><img src="/../images/app/Components/image-20221116102905092.png" alt="image-20221116102905092"></a></p>
<p>1、安装 drozer 前先安装 python 2.7，安装时选择自动添加环境变量</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116195702257.png" data-caption="image-20221116195702257"><img src="/../images/app/Components/image-20221116195702257.png" alt="image-20221116195702257"></a></p>
<p>安装完成，测试是否成功安装</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116195828270.png" data-caption="image-20221116195828270"><img src="/../images/app/Components/image-20221116195828270.png" alt="image-20221116195828270"></a></p>
<p>2、安装 dorzer ，下载 <a target="_blank" rel="noopener" href="https://github.com/mwrlabs/drozer/releases/download/2.4.4/drozer-2.4.4.win32.msi">drozer</a> 后点击安装，由于系统没有识别到 Python2.7，所以我们需要指定 python2.7 路径，若系统能识别到，则选择 python2.7 即可</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116200101626.png" data-caption="image-20221116200101626"><img src="/../images/app/Components/image-20221116200101626.png" alt="image-20221116200101626"></a></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116200255960.png" data-caption="image-20221116200255960"><img src="/../images/app/Components/image-20221116200255960.png" alt="image-20221116200255960"></a></p>
<p>drozer 成功安装后，软件位于 Python 2.7 下的 Scripts 目录下</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221117205713220.png" data-caption="image-20221117205713220"><img src="/../images/app/Components/image-20221117205713220.png" alt="image-20221117205713220"></a></p>
<p>3、手机安装 <code>drozer-agent-2.3.4.apk</code>，<a target="_blank" rel="noopener" href="https://github.com/mwrlabs/drozer/releases/download/2.3.4/drozer-agent-2.3.4.apk">点击下载</a> 安装完成后，测试是否可正常使用。首先进入 dorzer-agent app 点击右下按钮，开启端口转发功能。然后使用<code>具备数据传输的 USB 线</code>，手机连接电脑，点击文件传输使电脑可连接至手机</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228201311642.png" data-caption="image-20221228201311642"><img src="/../images/app/Components/image-20221228201311642.png" alt="image-20221228201311642"></a></p>
<p>使用 adb 软件进行端口转发，使手机与电脑可进行通信，命令：<code>adb forward tcp:31415 tcp:31415</code> <a target="_blank" rel="noopener" href="https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn">点击下载adb</a></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221123144712299.png" data-caption="image-20221123144712299"><img src="/../images/app/Components/image-20221123144712299.png" alt="image-20221123144712299"></a></p>
<p>注意：当使用 adb 进行端口转发，若出现报错，<code>error: no devices/emulators found</code>，原因是我们手机没有开启开发者模式，只需打开手机开发者模式,开启  USB 调试功能，根据自身手机品牌自行进行操作，开启后再次再次执行命令 <code>adb.exe forward tcp:31415 tcp:31415</code> 即可。</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116204352994.png" data-caption="image-20221116204352994"><img src="/../images/app/Components/image-20221116204352994.png" alt="image-20221116204352994"></a></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221117112228564.png" data-caption="image-20221117112228564"><img src="/../images/app/Components/image-20221117112228564.png" alt="image-20221117112228564"></a></p>
<p>最后进入 Python27\Scripts 目录下执行命令开启 drozer 与手机连接通道 <code>drozer.bat console connect</code>，如果报错 <code>ImportError: No module named google.protobuf</code>，则需要安装依赖。</p>
<p> <a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116205442505.png" data-caption="image-20221116205442505"><img src="/../images/app/Components/image-20221116205442505.png" alt="image-20221116205442505"></a></p>
<p>cmd 命令行执行逐一安装即可</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip2 install protobuf -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install pyopenssl -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install pyyaml -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install twisted -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install service_identity -i https://pypi.tuna.tsinghua.edu.cn/simple	</span><br></pre></td></tr></table></figure></div>



<p>安装依赖后再次执行命令 <code>drozer.bat console connect</code>，drozer 成功连接手机，drozer 启动成功</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116210214044.png" data-caption="image-20221116210214044"><img src="/../images/app/Components/image-20221116210214044.png" alt="image-20221116210214044"></a></p>
<p>至此 drozer 安装及测试已全部完成。</p>
<hr>
<h2 id="三、四大组件测试"><a href="#三、四大组件测试" class="headerlink" title="三、四大组件测试"></a>三、四大组件测试</h2><h3 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h3><p>由上面我们知道 Activity 为展示组件，用于向用户直接展示一个界面，而且可以接受用户的输入信息从而进行交互。具体漏洞类型及危害如下：</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| 漏洞种类                  | 危害                                                         |</span><br><span class="line">| -------------------------| ------------------------------------------------------------ |</span><br><span class="line">| 越权绕过                   | Activity用户界面绕过会造成用户信息窃取                         |</span><br><span class="line">| 拒绝服务                   | 通过Intent给Activity传输畸形数据使得程序崩溃从而影响用户体验    |</span><br><span class="line">| 钓鱼欺骗/Activity劫持       | 组件导出导致钓鱼欺诈，Activity界面被劫持产生欺诈等安全事件      |</span><br><span class="line">| 隐式启动intent包含敏感数据   | 敏感信息泄露                                                 |</span><br></pre></td></tr></table></figure></div>
<br/>

<h4 id="越权绕过"><a href="#越权绕过" class="headerlink" title="越权绕过"></a><font color=#ffffff>越权绕过</font></h4><p>在 Android 系统中，Activity 组件默认是不导出的，如果 <code>AndroidManifest.xml</code> 中设置了 <code>exported = &quot;true&quot;</code> 这样的关键值或者是添加了<code>&lt;intent-filter&gt;</code> 这样的属性，那么此时 Activity 组件是导出的，就会引发越权绕过或者是泄露敏感信息等的安全风险。<strong>（注释:导出-组件可以被外部应用调用; AndroidManifest.xml-应用清单，每个Android APP必备的文件配置，反编译后可查看其详细配置代码）</strong></p>
<p>例子:测试样本 sieve.apk，下载地址：<a target="_blank" rel="noopener" href="https://github.com/as0ler/Android-Examples">https://github.com/as0ler/Android-Examples</a></p>
<p>1、手机安装 sieve.apk、drozer-agent.apk，sieve app 界面如下图左，按照上面文章 drozer 安装部分，配置好相关测试环境，手机端点击 drozer 右下角打开代理，利用 adb 进行端口转发，界面如下图右</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230154124250.png" data-caption="image-20221230154124250"><img src="/../images/app/Components/image-20221230154124250.png" alt="image-20221230154124250"></a></p>
<p>adb开启端口转发：<code>adb.exe forward tcp:31415 tcp:31415</code></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230150431447.png" data-caption="image-20221230150431447"><img src="/../images/app/Components/image-20221230150431447.png" alt="image-20221230150431447"></a></p>
<p>drozer 连接手机：<code>drozer.bat console connect</code></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118205504976.png" data-caption="image-20221118205504976"><img src="/../images/app/Components/image-20221118205504976.png" alt="image-20221118205504976"></a></p>
<p>2、尝试利用 drozer 越权绕过 sieve app 登录界面</p>
<p>列出手机程序中所有的 APP 包名</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.list</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230151306269.png" data-caption="image-20221230151306269"><img src="/../images/app/Components/image-20221230151306269.png" alt="image-20221230151306269"></a></p>
<p>如上图出现文字乱码，解决方案如下：</p>
<p>Everything 搜索，找到位于 Python27 目录下的 <code>package.py</code></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118211507281.png" data-caption="image-20221118211507281"><img src="/../images/app/Components/image-20221118211507281.png" alt="image-20221118211507281"></a></p>
<p>添加如下代码</p>
<div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure></div>



<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118211715083.png" data-caption="image-20221118211715083"><img src="/../images/app/Components/image-20221118211715083.png" alt="image-20221118211715083"></a></p>
<p>360、362行添加字母 u</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118211856113.png" data-caption="image-20221118211856113"><img src="/../images/app/Components/image-20221118211856113.png" alt="image-20221118211856113"></a></p>
<p>重新启动 drozer，再次执行命令 <code>run app.package.list</code> 列出所有手机已安装程序的包名</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118212227708.png" data-caption="image-20221118212227708"><img src="/../images/app/Components/image-20221118212227708.png" alt="image-20221118212227708"></a></p>
<p>由于列出的包名众多，无法正确分辨需测试的 APP 包名为哪个，我们转用 <a target="_blank" rel="noopener" href="https://codeload.github.com/bihe0832/Android-GetAPKInfo/zip/refs/tags/V2.0.2">GetAPKInfo</a> 工具来获取 sieve app 包名, <code>java -jar GetAPKInfo.jar C:\Users\Boom\Desktop\sieve.apk</code></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118213337410.png" data-caption="image-20221118213337410"><img src="/../images/app/Components/image-20221118213337410.png" alt="image-20221118213337410"></a></p>
<p>然后 drozer 直接搜索包名信息 com.mwr.example.sieve,该APP具体信息如下</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118214341449.png" data-caption="image-20221118214341449"><img src="/../images/app/Components/image-20221118214341449.png" alt="image-20221118214341449"></a></p>
<p>我们直接去查询目标应用的攻击面，通过下图可知 Activity 有3个组件是可以导出的</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.attacksurface com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230150630239.png" data-caption="image-20221230150630239"><img src="/../images/app/Components/image-20221230150630239.png" alt="image-20221230150630239"></a></p>
<p>查看具体可导出的 Activity 组件信息</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230150719923.png" data-caption="image-20221230150719923"><img src="/../images/app/Components/image-20221230150719923.png" alt="image-20221230150719923"></a></p>
<p>调用组件，实现登录绕过界面（由于测试样本不支持高版本 Android，所以这里使用 MuMu 模拟器进行测试，实现绕过），其它 Activity 导出组件绕过测试只需更换组件名即可</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start --component com.mwr.example.sieve com.mwr.example.sieve.PWList</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230203111751.jpg" data-caption="image-20221230203111751"><img src="/../images/app/Components/image-20221230203111751.jpg" alt="image-20221230203111751"></a></p>
<br/>

<h4 id="钓鱼欺诈-x2F-Activity劫持"><a href="#钓鱼欺诈-x2F-Activity劫持" class="headerlink" title="钓鱼欺诈&#x2F;Activity劫持"></a><font color=#ffffff>钓鱼欺诈&#x2F;Activity劫持</font></h4><p>例子：劫持测试 APP 下载地址:<a target="_blank" rel="noopener" href="https://github.com/yanghaoi/android_app">https://github.com/yanghaoi/android_app</a></p>
<p>1、手机安装点击劫持软件 uihijackv2.0_sign.apk , drozer 开启端口转发，adb 连接 drozer</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228105855609.png" data-caption="image-20221228105855609"><img src="/../images/app/Components/image-20221228105855609.png" alt="image-20221228105855609"></a></p>
<p>2、打开被测软件界面，这里被测软件也是使用 drozer，然后 Windows 通过 drozer 命令调用劫持软件 uihijackv2.0_sign，<font color=#c3dbe8>若 uihijackv2.0_sign 界面位于被测软件上，则存在漏洞（如下图）</font>，若被测页面无变化则不存在漏洞。</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start --component com.test.uihijack com.test.uihijack.MainActivity</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228110911255.png" data-caption="image-20221228110911255"><img src="/../images/app/Components/image-20221228110911255.png" alt="image-20221228110911255"></a></p>
<br/>

<h4 id="拒绝服务攻击"><a href="#拒绝服务攻击" class="headerlink" title="拒绝服务攻击"></a><font color=#ffffff>拒绝服务攻击</font></h4><p>例子：测试 APP 下载地址：<a target="_blank" rel="noopener" href="https://github.com/Funsiooo/Vuln_Bulid/blob/main/APP/OWASP-GoatDroid-0.9.zip">https://github.com/Funsiooo/Vuln_Bulid/blob/main/APP/OWASP-GoatDroid-0.9.zip</a></p>
<p>1、利用 drozer 直接查看暴露的组件，然后进行调用，查看是否出现程序崩溃情况。通过 <a target="_blank" rel="noopener" href="https://codeload.github.com/bihe0832/Android-GetAPKInfo/zip/refs/tags/V2.0.2">GetAPKInfo</a> 工具来获取 APP 包名为 <code>org.owasp.goatdroid.fourgoats</code></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228143353936.png" data-caption="image-20221228143353936"><img src="/../images/app/Components/image-20221228143353936.png" alt="image-20221228143353936"></a></p>
<p>2、安装 <code>OWASP GoatDroid- FourGoats Android App.apk</code> 软件，利用 drozer 查看其暴露组件</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.attacksurface org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228143724432.png" data-caption="image-20221228143724432"><img src="/../images/app/Components/image-20221228143724432.png" alt="image-20221228143724432"></a></p>
<p>查看具体暴露组件</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228143848311.png" data-caption="image-20221228143848311"><img src="/../images/app/Components/image-20221228143848311.png" alt="image-20221228143848311"></a></p>
<p>3、调用组件，查看是否导致拒绝服务，若程序出现 <code>程序崩溃</code>、<code>已停止运行</code> 等程序无法运行或自动退出行为则为攻击成功。查看例子：<a target="_blank" rel="noopener" href="http://rui0.cn/archives/30">http://rui0.cn/archives/30</a> ，调用命令例子如下：</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start --component org.owasp.goatdroid.fourgoats org.owasp.goatdroid.fourgoats.activities.Main</span><br></pre></td></tr></table></figure></div>



<br/>

<h3 id="Conten-Provid"><a href="#Conten-Provid" class="headerlink" title="Conten Provid"></a>Conten Provid</h3><p>数据共享组件，用于向其他组件乃至其他应用共享数据，由此可推算，该组件漏洞与数据相关。</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| 漏洞种类 | 危害            |</span><br><span class="line">| -------- | ---------------|</span><br><span class="line">| 信息泄露 | 查看组件数据信息 |</span><br><span class="line">| SQL注入  | 注入获取相关数据 |</span><br><span class="line">| 目录遍历 | 访问任意可读文件 |</span><br></pre></td></tr></table></figure></div>
<br/>

<h4 id="信息泄露"><a href="#信息泄露" class="headerlink" title="信息泄露"></a><font color=#ffffff>信息泄露</font></h4><p>1、依然使用 seive.apk 作为测试 app，但需要在第一次安装打开时需要设置账号密码</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228204134046.png" data-caption="image-20221228204134046"><img src="/../images/app/Components/image-20221228204134046.png" alt="image-20221228204134046"></a></p>
<p>2、利用 drozer 查看 provider 数据组件具体的攻击面</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228151737611.png" data-caption="image-20221228151737611"><img src="/../images/app/Components/image-20221228151737611.png" alt="image-20221228151737611"></a></p>
<p>3、对 <code>com.mwr.example.sieve.DBContentProvider</code> 攻击面进行测试，列出 URI</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.finduri com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228151941707.png" data-caption="image-20221228151941707"><img src="/../images/app/Components/image-20221228151941707.png" alt="image-20221228151941707"></a></p>
<p>4、利用 drozer 扫描模块对列出的 URI 进行扫描，查看可访问的 URI ，三个 URI 可访问</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.finduris -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228152408647.png" data-caption="image-20221228152408647"><img src="/../images/app/Components/image-20221228152408647.png" alt="image-20221228152408647"></a></p>
<p>5、访问URI，查看具体内容 ，由下图可知，刚才我们所填的数据全部列了出来</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --vertical</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154520099.png" data-caption="image-20221228154520099"><img src="/../images/app/Components/image-20221228154520099.png" alt="image-20221228154520099"></a></p>
<br/>

<h4 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a><font color=#ffffff>SQL注入</font></h4><p>1、进一步测试可访问的 URI 是否存在注入</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection &quot;&#x27;&quot;</span><br><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --selection &quot;&#x27;&quot;</span><br></pre></td></tr></table></figure></div>

<p>出现语法错误，存在SQL注入</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228153720244.png" data-caption="image-20221228153720244"><img src="/../images/app/Components/image-20221228153720244.png" alt="image-20221228153720244"></a></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228153747173.png" data-caption="image-20221228153747173"><img src="/../images/app/Components/image-20221228153747173.png" alt="image-20221228153747173"></a></p>
<p>2、利用 drozer 内置注入扫描模块进行扫描,扫描存在注入</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.injection -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154604350.png" data-caption="image-20221228154604350"><img src="/../images/app/Components/image-20221228154604350.png" alt="image-20221228154604350"></a></p>
<p>3、继续利用，列出所有数据表，得知数据库表有 <code>name</code>、<code>android_metadata</code>、<code>Passwords</code>、<code>Key</code></p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection &quot;* FROM SQLITE_MASTER WHERE type=&#x27;table&#x27;;--&quot;</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154446929.png" data-caption="image-20221228154446929"><img src="/../images/app/Components/image-20221228154446929.png" alt="image-20221228154446929"></a></p>
<p>4、单独查看表中数据，例查询 <code>Passwords</code> 表数据</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection &quot;* FROM Passwords;--&quot;</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154427706.png" data-caption="image-20221228154427706"><img src="/../images/app/Components/image-20221228154427706.png" alt="image-20221228154427706"></a></p>
<br/>

<h4 id="目录遍历"><a href="#目录遍历" class="headerlink" title="目录遍历"></a><font color=#ffffff>目录遍历</font></h4><p>1、利用 drozer 自带模块扫描目录遍历，存在两个漏洞 <code>content://com.mwr.example.sieve.FileBackupProvider/</code>,<code>content://com.mwr.example.sieve.FileBackupProvider</code></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228160057841.png" data-caption="image-20221228160057841"><img src="/../images/app/Components/image-20221228160057841.png" alt="image-20221228160057841"></a></p>
<p>2、对其 URI 进行文件读取</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228160259984.png" data-caption="image-20221228160259984"><img src="/../images/app/Components/image-20221228160259984.png" alt="image-20221228160259984"></a></p>
<p>3、读取更多信息</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228160839383.png" data-caption="image-20221228160839383"><img src="/../images/app/Components/image-20221228160839383.png" alt="image-20221228160839383"></a></p>
<p>4、下载文件 (C:\Users\oooo\Desktop\database.db为文件保存路径)</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db C:\\Users\\oooo\\Desktop\\database.db</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228161024128.png" data-caption="image-20221228161024128"><img src="/../images/app/Components/image-20221228161024128.png" alt="image-20221228161024128"></a></p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228161043428.png" data-caption="image-20221228161043428"><img src="/../images/app/Components/image-20221228161043428.png" alt="image-20221228161043428"></a></p>
<br/>

<h3 id="Broadcast-Receiver"><a href="#Broadcast-Receiver" class="headerlink" title="Broadcast Receiver"></a>Broadcast Receiver</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| 漏洞种类     | 危害                                                         |</span><br><span class="line">| ------------ | ------------------------------------------------------------ |</span><br><span class="line">| 敏感信息泄露 | 发送的intent没有明确指定接收者，而是简单的通过action进行匹配，恶意应用便可以注册一个广播接收者嗅探拦截到这个广播，如果这个广播存在敏感数据，就被恶意应用窃取了。 |</span><br><span class="line">| 权限绕过     | 可以通过两种方式注册广播接收器，一种是在AndroidManifest.xml文件中通过&lt;receiver&gt;标签静态注册，另一种是通过Context.registerReceiver()动态注册，指定相应的intentFilter参数，动态注册的广播默认都是导出的，如果导出的BroadcastReceiver没有做权限控制，导致BroadcastReceiver组件可以接收一个外部可控的url、或者其他命令，导致攻击者可以越权利用应用的一些特定功能，比如发送恶意广播、伪造消息、任意应用下载安装、打开钓鱼网站等 |</span><br><span class="line">| 消息伪造     | 暴露的Receiver对外接收Intent，如果构造恶意的消息放在Intent中传输，被调用的Receiver接收可能产生安全隐患 |</span><br><span class="line">| 拒绝服务     | 如果敏感的BroadcastReceiver没有设置相应的权限保护，很容易受到攻击。最常见的是拒绝服务攻击。拒绝服务攻击指的是，传递恶意畸形的intent数据给广播接收器，广播接收器无法处理异常导致crash。 拒绝服务攻击的危害视具体业务场景而定，比如一个安全防护产品的拒绝服务、锁屏应用的拒绝服务、支付进程的拒绝服务等危害就是巨大的。 |</span><br></pre></td></tr></table></figure></div>
<br/>

<h4 id="拒绝服务"><a href="#拒绝服务" class="headerlink" title="拒绝服务"></a><font color=#ffffff>拒绝服务</font></h4><p>1、查看针对 broadcast 数据组件具体的攻击面</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broadcast.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20231122111055505.png" data-caption="image-20231122111055505"><img src="/../images/app/Components/image-20231122111055505.png" alt="image-20231122111055505"></a></p>
<p>2、针对 broadcast 攻击面进行测试需要先找到相应的 action 名，由上图可知，broadcast 组件名称为 org.owasp.goatdroid.fourgoats.broadcastreceivers.SendSMSNowReceiver 这边使用 jadx 进行反编译，查看 AndroidManifest.xml 寻找 action，关键搜索 .broadcastreceivers.SendSMSNowReceiver</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broadcast.send --action org.owasp.goatdroid.fourgoats.SOCIAL_SMS</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164227532.png" data-caption="	"><img src="/../images/app/Components/image-20221228164227532.png" alt="	"></a></p>
<p>未执行前</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164826268.png" data-caption="image-20221228164826268"><img src="/../images/app/Components/image-20221228164826268.png" alt="image-20221228164826268"></a></p>
<p>执行后，程序退出，导致拒绝服务</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164917550.png" data-caption="image-20221228164917550"><img src="/../images/app/Components/image-20221228164917550.png" alt="image-20221228164917550"></a></p>
<br/>

<h4 id="消息伪造（发送恶意广播）"><a href="#消息伪造（发送恶意广播）" class="headerlink" title="消息伪造（发送恶意广播）"></a><font color=#ffffff>消息伪造（发送恶意广播）</font></h4><p>1、查看针对 broadcast 数据组件具体的攻击面</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broacast.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20231122111055505.png" data-caption="image-20231122111055505"><img src="/../images/app/Components/image-20231122111055505.png" alt="image-20231122111055505"></a></p>
<p>2、利用 jadx 反编译 apk，查看 broadcast receivers 模块具体代码，审计 .broadcastreceivers.SendSMSNowReceiver 代码可知发送广播需要两个参数命令</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228163829810.png" data-caption="image-20221228163829810"><img src="/../images/app/Components/image-20221228163829810.png" alt="image-20221228163829810"></a></p>
<p>action 名称为 org.owasp.goatdroid.fourgoats.SOCIAL_SMS</p>
<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164227532.png" data-caption="image-20221228164227532"><img src="/../images/app/Components/image-20221228164227532.png" alt="image-20221228164227532"></a></p>
<p>具体执行代码为</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broadcast.send --action org.owasp.goatdroid.fourgoats.SOCIAL_SMS --extra string phoneNumber 13800000000 --extra string message test</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164509817.png" data-caption="image-20221228164509817"><img src="/../images/app/Components/image-20221228164509817.png" alt="image-20221228164509817"></a></p>
<br/>

<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>参考文章：Service(服务)是一个一种可以在后台执行长时间运行操作而没有用户界面的应用组件。服务可由其他应用组件启动（如Activity），服务一旦被启动将在后台一直运行，即使启动服务的组件（Activity）已销毁也不受影响。 此外，组件可以绑定到服务，以与之进行交互，甚至是执行进程间通信 (IPC)。</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| 漏洞种类    | 危害                                                         |</span><br><span class="line">| ----------- | ------------------------------------------------------------ |</span><br><span class="line">| 权限提升    | 当一个service配置了intent``-``filter默认是被导出的，如果没对调用Service进行权限，限制或者是没有对调用者的身份进行有效验证，那么恶意构造的APP都可以对此Service传入恰当的参数进行调用，导致恶意行为发生比如调用具有system权限的删除卸载服务删除卸载其他应用。 |</span><br><span class="line">| service劫持 | 隐式启动services,当存在同名services,先安装应用的services优先级高 |</span><br><span class="line">| 消息伪造    | 暴露的Service对外接收Intent，如果构造恶意的消息放在Intent中传输，被调用的Service接收可能产生安全隐患 |</span><br><span class="line">| 拒绝服务    | Service的拒绝服务主要来源于Service启动时对接收的Intent等没有做异常情况下的处理，导致程序崩溃 |</span><br></pre></td></tr></table></figure></div>
<br/>

<h4 id="拒绝服务-1"><a href="#拒绝服务-1" class="headerlink" title="拒绝服务"></a><font color=#ffffff>拒绝服务</font></h4><p>1、查看针对 service 组件具体的攻击面</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.service.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228162300918.png" data-caption="image-20221228162300918"><img src="/../images/app/Components/image-20221228162300918.png" alt="image-20221228162300918"></a></p>
<p>打开 FourGoats app 停留在首页界面，由于存漏洞，直接调用导致拒绝服务，APP程序自动退出，返回桌面</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.service.start --action org.owasp.goatdroid.fourgoats.services.LocationService</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228162847713.png" data-caption="image-20221228162847713"><img src="/../images/app/Components/image-20221228162847713.png" alt="image-20221228162847713"></a></p>
<p>更多具体例子请参考文章：<a target="_blank" rel="noopener" href="https://bbs.pediy.com/thread-269255.htm">https://bbs.pediy.com/thread-269255.htm</a></p>
<hr>
<h2 id="四、扩展知识点"><a href="#四、扩展知识点" class="headerlink" title="四、扩展知识点"></a>四、扩展知识点</h2><h3 id="adb使用"><a href="#adb使用" class="headerlink" title="adb使用"></a>adb使用</h3><p>adb查看连接设备的android日志</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//格式1：打印默认日志数据</span><br><span class="line">adb logcat </span><br><span class="line"></span><br><span class="line">//格式2：需要打印日志详细时间的简单数据</span><br><span class="line">adb logcat -v time</span><br><span class="line"></span><br><span class="line">//格式3：需要打印级别为Error的信息</span><br><span class="line">adb logcat *:E</span><br><span class="line"></span><br><span class="line">//格式4：需要打印时间和级别是Error的信息</span><br><span class="line">adb logcat -v time *:E</span><br><span class="line"></span><br><span class="line">//格式5：将日志保存到电脑固定的位置，比如D:\log.txt</span><br><span class="line">adb logcat -v time &gt;D:\log.txt</span><br><span class="line"></span><br><span class="line">//格式5：日志监听</span><br><span class="line">adb logcat |grep packagename(app包名)</span><br></pre></td></tr></table></figure></div>

<br/>

<h3 id="APP模块说明"><a href="#APP模块说明" class="headerlink" title="APP模块说明"></a>APP模块说明</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">| 模块名                    | 作用                                                        |</span><br><span class="line">| ------------------------- | ----------------------------------------------------------- |</span><br><span class="line">| app.activity.forintent    | 通过intent查找它的activity                                  |</span><br><span class="line">| app.activity.info         | 获取activities信息                                          |</span><br><span class="line">| app.activity.start        | 开启 Activity                                               |</span><br><span class="line">| app.broadcast.info        | 获取broadcast receivers信息                                 |</span><br><span class="line">| app.broadcast.send        | 发送广播                                                    |</span><br><span class="line">| app.broadcast.sniff       | 嗅探广播中intent的数据                                      |</span><br><span class="line">| app.package.attacksurface | 确定安装包的可攻击面                                        |</span><br><span class="line">| app.package.backup        | 列出可备份的包                                              |</span><br><span class="line">| app.package.debuggable    | 列出可debug的包                                             |</span><br><span class="line">| app.package.info          | 获取已安装包的信息                                          |</span><br><span class="line">| app.package.launchintent  | 获取程序启动的activity信息                                  |</span><br><span class="line">| app.package.list          | 手机已安装的程序包                                          |</span><br><span class="line">| app.package.manifest      | 获取程序manifest文件信息                                    |</span><br><span class="line">| app.package.native        | 列出Native libraries 信息                                   |</span><br><span class="line">| app.package.shareduid     | 查找拥有共同uid的包和他们所有的权限                         |</span><br><span class="line">| app.provider.columns      | 展示content provider URI的各列                              |</span><br><span class="line">| app.provider.delete       | 删除content provider URI的内容                              |</span><br><span class="line">| app.provider.download     | 使用openInputStream读取指定uri的内容，并下载在电脑中        |</span><br><span class="line">| app.provider.info         | 获取 content providers信息                                  |</span><br><span class="line">| app.provider.insert       | 插入数据到content provider                                  |</span><br><span class="line">| app.provider.query        | 查询content provider 内容                                   |</span><br><span class="line">| app.provider.read         | 使用openInputStream读取指定uri的内容                        |</span><br><span class="line">| app.provider.update       | 更新content provider的内容                                  |</span><br><span class="line">| app.service.info          | 获取services的信息                                          |</span><br><span class="line">| app.service.send          | 使用 Message攻击暴露的service，其service实现了handleMessage |</span><br><span class="line">| app.service.start         | 开启服务                                                    |</span><br><span class="line">| app.service.stop          | 停止服务                                                    |</span><br></pre></td></tr></table></figure></div>

<br/>

<h2 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h2><p>文章编写断断续续，内容多为参考网上师傅们的文章，属于前人栽树，后人乘凉了，知识点也是好几年前的知识，一系列学习下来，扩展了 APP 测试攻击的思路，总体上测试基于 drozer 工具下进行测试，根据每个组件的特性进行单点突破，收获还是有的。</p>
<h2 id="六、参考"><a href="#六、参考" class="headerlink" title="六、参考"></a>六、参考</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">https://blog.yorek.xyz/android/paid/zsxq/week17-android-components/</span><br><span class="line">https://bbs.pediy.com/thread-269211.htm</span><br><span class="line">https://bbs.pediy.com/thread-269255.htm</span><br><span class="line">https://bbs.pediy.com/thread-269309.htm</span><br><span class="line">https://bbs.pediy.com/thread-269447.htm</span><br><span class="line">https://www.cnblogs.com/wjrblogs/p/13953761.html</span><br><span class="line">https://dl.google.com/android/repository/platform-tools_r33.0.3-windows.zip</span><br><span class="line">https://bbs.pediy.com/thread-262208.htm</span><br><span class="line">https://www.cnblogs.com/zhaoyixiang/p/11236458.html</span><br></pre></td></tr></table></figure></div>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>





        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/search/">搜索</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">一、前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Android-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">1.1.</span> <span class="toc-text">Android 四大组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">二、环境搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#drozer-%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.</span> <span class="toc-text">drozer 安装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E6%B5%8B%E8%AF%95"><span class="toc-number">3.</span> <span class="toc-text">三、四大组件测试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Activity"><span class="toc-number">3.1.</span> <span class="toc-text">Activity</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B6%8A%E6%9D%83%E7%BB%95%E8%BF%87"><span class="toc-number">3.1.1.</span> <span class="toc-text">越权绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%92%93%E9%B1%BC%E6%AC%BA%E8%AF%88-x2F-Activity%E5%8A%AB%E6%8C%81"><span class="toc-number">3.1.2.</span> <span class="toc-text">钓鱼欺诈&#x2F;Activity劫持</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB"><span class="toc-number">3.1.3.</span> <span class="toc-text">拒绝服务攻击</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Conten-Provid"><span class="toc-number">3.2.</span> <span class="toc-text">Conten Provid</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">3.2.1.</span> <span class="toc-text">信息泄露</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">3.2.2.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86"><span class="toc-number">3.2.3.</span> <span class="toc-text">目录遍历</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Broadcast-Receiver"><span class="toc-number">3.3.</span> <span class="toc-text">Broadcast Receiver</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.3.1.</span> <span class="toc-text">拒绝服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BC%AA%E9%80%A0%EF%BC%88%E5%8F%91%E9%80%81%E6%81%B6%E6%84%8F%E5%B9%BF%E6%92%AD%EF%BC%89"><span class="toc-number">3.3.2.</span> <span class="toc-text">消息伪造（发送恶意广播）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Service"><span class="toc-number">3.4.</span> <span class="toc-text">Service</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1-1"><span class="toc-number">3.4.1.</span> <span class="toc-text">拒绝服务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%89%A9%E5%B1%95%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text">四、扩展知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#adb%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">adb使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#APP%E6%A8%A1%E5%9D%97%E8%AF%B4%E6%98%8E"><span class="toc-number">4.2.</span> <span class="toc-text">APP模块说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">五、总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8F%82%E8%80%83"><span class="toc-number">6.</span> <span class="toc-text">六、参考</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&text=APP测试系列-四大组件安全测试"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&is_video=false&description=APP测试系列-四大组件安全测试"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=APP测试系列-四大组件安全测试&body=Check out this article: http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&title=APP测试系列-四大组件安全测试"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&name=APP测试系列-四大组件安全测试&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/&t=APP测试系列-四大组件安全测试"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        Copyright &copy;
        
        
        2022-2025
        Funsiooo
      </div>
      <div class="footer-right">
        <nav>
          <ul>
            <!--
          --><li><a href="/">首页</a></li><!--
        --><!--
          --><li><a href="/archives/">归档</a></li><!--
        --><!--
          --><li><a href="/search/">搜索</a></li><!--
        --><!--
          --><li><a href="/tags/">标签</a></li><!--
        --><!--
          --><li><a href="/about/">关于</a></li><!--
        -->
          </ul>
        </nav>        
      </div>

      <div class="footer-midle">
        <nav>
          <ul>
            
              <!-- 不蒜子统计 -->
              <span id="busuanzi_container_site_pv">
                  本站总访问量<span id="busuanzi_value_site_pv"></span>次
              </span>
              <span class="post-meta-divider">|</span>
              <span id="busuanzi_container_site_uv" style='display:none'>
                      本站访客数<span id="busuanzi_value_site_uv"></span>人
              </span>
              <span id="busuanzi_container_page_pv">
			  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	      </span>
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            
          </ul>
        </nav>
      </div>
</footer>
    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?47a5bc2b41144f91553c5eefd4999c0d";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'boom';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

<!-- FancyBox -->

<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>


</body>
</html>
