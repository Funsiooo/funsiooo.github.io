<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="一、前言为了保护应用及代码的安全性，开发者出厂前会针对安卓 APP 进行加固处理，防范潜在风险。一般通过混淆代码、反调试、阻止反编译、保护内存、加密数据和验证签名等手段，其中代码混淆和加固最为常见。 代码混淆代码混淆（Code Obfuscation）：通过对应用程序的代码进行混淆，即重命名类、方法、变量等标识符，并添加无效代码或控制流程的改变，来增加逆向工程的难度。常见的代码混淆工具包括 Pro">
<meta property="og:type" content="article">
<meta property="og:title" content="移动安全-Android APP 加固壳原理">
<meta property="og:url" content="http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/index.html">
<meta property="og:site_name" content="世间闲客·此闲行">
<meta property="og:description" content="一、前言为了保护应用及代码的安全性，开发者出厂前会针对安卓 APP 进行加固处理，防范潜在风险。一般通过混淆代码、反调试、阻止反编译、保护内存、加密数据和验证签名等手段，其中代码混淆和加固最为常见。 代码混淆代码混淆（Code Obfuscation）：通过对应用程序的代码进行混淆，即重命名类、方法、变量等标识符，并添加无效代码或控制流程的改变，来增加逆向工程的难度。常见的代码混淆工具包括 Pro">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/mobile/reinforce/image-20231207152604122.png">
<meta property="og:image" content="http://example.com/images/mobile/reinforce/image-20231207153148309.png">
<meta property="og:image" content="http://example.com/images/mobile/reinforce/image-20231207155612690.png">
<meta property="og:image" content="http://example.com/images/mobile/reinforce/image-20231208100319417.png">
<meta property="article:published_time" content="2024-02-16T08:07:37.000Z">
<meta property="article:modified_time" content="2024-02-16T15:21:22.000Z">
<meta property="article:author" content="Funsiooo">
<meta property="article:tag" content="加固史">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/mobile/reinforce/image-20231207152604122.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/logo-1.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/logo-1.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/logo-1.png">
        
      
    
    <!-- title -->
    <title>移动安全-Android APP 加固壳原理</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css" />

<meta name="generator" content="Hexo 5.4.2"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body class="max-width mx-auto px3 ">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="目录"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="顶部" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">首页</a></li><!--
     --><!--
       --><li><a href="/archives/">归档</a></li><!--
     --><!--
       --><li><a href="/search/">搜索</a></li><!--
     --><!--
       --><li><a href="/tags/">标签</a></li><!--
     --><!--
       --><li><a href="/about/">关于</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="上一篇" href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-FART%20%E8%84%B1%E5%A3%B3%E6%9C%BA%E5%88%B6%E4%BD%9C/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="下一篇" href="/2023/10/22/Linux%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="返回顶部" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="分享文章" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&text=移动安全-Android APP 加固壳原理"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&is_video=false&description=移动安全-Android APP 加固壳原理"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=移动安全-Android APP 加固壳原理&body=Check out this article: http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&name=移动安全-Android APP 加固壳原理&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&t=移动安全-Android APP 加固壳原理"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">一、前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86"><span class="toc-number">1.1.</span> <span class="toc-text">代码混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%A3%B3"><span class="toc-number">1.2.</span> <span class="toc-text">加壳</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8F%B2"><span class="toc-number">2.</span> <span class="toc-text">二、加固壳史</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.1.</span> <span class="toc-text">第一代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DEX%E5%8A%A0%E5%AF%86-%E8%90%BD%E5%9C%B0%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.1.1.</span> <span class="toc-text">DEX加密(落地加载)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.2.</span> <span class="toc-text">脱壳工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.2.</span> <span class="toc-text">第二代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dex%E6%8A%BD%E5%8F%96%E4%B8%8E%E5%8A%A0%E5%9B%BA"><span class="toc-number">2.2.1.</span> <span class="toc-text">dex抽取与加固</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E5%B7%A5%E5%85%B7-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">脱壳工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.3.</span> <span class="toc-text">第三代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dex-%E5%8A%A8%E6%80%81%E8%A7%A3%E5%AF%86%E4%B8%8E-so-%E6%B7%B7%E6%B7%86"><span class="toc-number">2.3.1.</span> <span class="toc-text">Dex 动态解密与 so 混淆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E5%B7%A5%E5%85%B7-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">脱壳工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.4.</span> <span class="toc-text">第四代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#VMP-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BF%9D%E6%8A%A4"><span class="toc-number">2.4.1.</span> <span class="toc-text">VMP(虚拟机保护)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95"><span class="toc-number">2.4.2.</span> <span class="toc-text">脱壳方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.5.</span> <span class="toc-text">第五代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%BA%90%E7%A0%81%E4%BF%9D%E6%8A%A4%EF%BC%88LLVM%EF%BC%89"><span class="toc-number">2.5.1.</span> <span class="toc-text">虚拟机源码保护（LLVM）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95-1"><span class="toc-number">2.5.2.</span> <span class="toc-text">脱壳方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%A3%B3%E8%AF%86%E5%88%AB"><span class="toc-number">3.</span> <span class="toc-text">三、壳识别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%9C%BA%E5%BA%94%E7%94%A8%E4%B8%80%E9%94%AE%E8%AF%86%E5%88%AB"><span class="toc-number">3.0.1.</span> <span class="toc-text">手机应用一键识别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">3.0.2.</span> <span class="toc-text">Windows 客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%9B%BA%E5%A3%B3%E7%89%B9%E5%BE%81"><span class="toc-number">3.0.3.</span> <span class="toc-text">加固壳特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E6%89%BE%E5%AF%BB%E6%A1%88%E4%BE%8B"><span class="toc-number">3.0.4.</span> <span class="toc-text">特征找寻案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95%E5%8F%8A%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB"><span class="toc-number">4.</span> <span class="toc-text">四、脱壳方法及工具汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98dump"><span class="toc-number">4.1.</span> <span class="toc-text">内存dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%91%E8%A7%86"><span class="toc-number">4.2.</span> <span class="toc-text">文件监视</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="toc-number">4.3.</span> <span class="toc-text">动态调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%87%8D%E7%BB%84"><span class="toc-number">4.4.</span> <span class="toc-text">内存重组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dex2oat"><span class="toc-number">4.5.</span> <span class="toc-text">dex2oat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E5%88%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">4.6.</span> <span class="toc-text">定制系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hook"><span class="toc-number">4.7.</span> <span class="toc-text">Hook</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">六、参考</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        移动安全-Android APP 加固壳原理
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Funsiooo</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2024-02-16T08:07:37.000Z" itemprop="datePublished">2024-02-16</time>
        
        (Updated: <time datetime="2024-02-16T15:21:22.000Z" itemprop="dateModified">2024-02-16</time>)
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97/">APP测试系列</a> › <a class="category-link" href="/categories/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/">移动安全</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/%E5%8A%A0%E5%9B%BA%E5%8F%B2/" rel="tag">加固史</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h2><p>为了保护应用及代码的安全性，开发者出厂前会针对安卓 APP 进行加固处理，防范潜在风险。一般通过混淆代码、反调试、阻止反编译、保护内存、加密数据和验证签名等手段，其中代码混淆和加固最为常见。</p>
<h3 id="代码混淆"><a href="#代码混淆" class="headerlink" title="代码混淆"></a>代码混淆</h3><p>代码混淆（Code Obfuscation）：通过对应用程序的代码进行混淆，即重命名类、方法、变量等标识符，并添加无效代码或控制流程的改变，来增加逆向工程的难度。常见的代码混淆工具包括 ProGuard 和 DexGuard。</p>
<h3 id="加壳"><a href="#加壳" class="headerlink" title="加壳"></a>加壳</h3><p>加壳：通过在 APK 文件的外层添加一层壳或保护层，来保护应用程序的代码和数据。这层壳可以包含各种安全措施和技术，如加密、反调试、防篡改、运行时解密等。它的作用是增加应用程序的安全性，防止逆向工程和破解行为。即使应用程序被反编译，只能看到外层壳的代码，而无法直接访问内部的关键代码和数据，从而提高了应用程序的安全性。</p>
<hr>
<h2 id="二、加固壳史"><a href="#二、加固壳史" class="headerlink" title="二、加固壳史"></a>二、加固壳史</h2><h3 id="第一代加固壳"><a href="#第一代加固壳" class="headerlink" title="第一代加固壳"></a>第一代加固壳</h3><h4 id="DEX加密-落地加载"><a href="#DEX加密-落地加载" class="headerlink" title="DEX加密(落地加载)"></a>DEX加密(落地加载)</h4><p>DEX 是 Dalvik Executable 的缩写，是 Android 操作系统中的一种可执行文件格式。它包含了应用的字节码指令，用于在 Dalvik 虚拟机中运行应用，Dalvik虚拟机将每个应用程序的字节码（编译后的.dex文件）转换为Dalvik可执行文件（.dex文件）。DEX 文件可以通过反编译工具被转换为 Java 代码，因此加密和保护 DEX 文件可以有效防止应用被反编译。常见加固手段如下：</p>
<ul>
<li><p><strong>Dex 字符串加密</strong></p>
<p>采用加密算法对 dex 的字符串进行加密处理，反编译后无法直接查看其代码。例：加密前代码为：String a &#x3D; “This is a string!”; 加密后代码：String a &#x3D; StringFog.decrypt(“ABCDEFGHIJKLMN”); 运行时代码：：decrypt: “ABCDEFGHIJKLMN” &#x3D;&gt; “This is a string!”。</p>
</li>
<li><p><strong>静态 DEX 文件整体加解密</strong></p>
<p>dex 文件整体加壳的基本原理是对 classes.dex 这个文件进行整体加密，将加密后得到的文件 存放在 apk 文件的资源文件中，并在App 运行时将加密后的 classes.dex 文件在内存中进行解密，再让 Dalvik 虚拟机动态加载解密后的原始 clases.dex 文件并执行。</p>
</li>
<li><p><strong>资源加密</strong></p>
<p>对 apk 解压后的资源文件进行加密处理，安卓资源文件一般指 res 和 assets 目录下的文件。例：资源加密后程序在读文件或者解压两个过程进行 hook，并对文件内容进行解密，就能达到资源保护的效果。例：将原资源文件 res&#x2F;layout&#x2F;activity_main.xml 命名为res&#x2F;a&#x2F;a.xml。</p>
</li>
<li><p><strong>反反编译</strong></p>
<p>通过添加反调试、反虚拟机等功能来对抗反编译工具。例如：Ptrace 反调试，使用 Ptrace 系统调用来监控调试器的行为，如果检测到调试器存在，则会终止应用的运行、TracePid 值校验反调试，通过校验 TracePid 值来判断是否被调试，如果不匹配则认为被调试。</p>
</li>
<li><p><strong>自定义 DexClassLoader</strong></p>
<p>使用自定义 DexClassLoader 对加密的 DEX 文件进行加载。这样可以在应用运行时动态加载和解密加密后的 DEX 文件。</p>
</li>
<li><p><strong>落地加载</strong></p>
</li>
</ul>
<p>​		将应用的代码和资源打包成一个单独的文件，对 apk 解压后，文件夹内可看见相关 dex 文件。</p>
<h4 id="脱壳工具"><a href="#脱壳工具" class="headerlink" title="脱壳工具"></a>脱壳工具</h4><ul>
<li><p>内存 Dump 法</p>
<div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于是dex整体保护，在内存中映射是整体连续的，通过定位起始地址将 app 完整脱下来。对于完整的 dex，采用暴力搜索 dex035 采用工具：FRIDA-DEXdump  项目地址：https://github.com/hluwa/FRIDA-DEXDump</span><br></pre></td></tr></table></figure></div></li>
</ul>
<h3 id="第二代加固壳"><a href="#第二代加固壳" class="headerlink" title="第二代加固壳"></a>第二代加固壳</h3><h4 id="dex抽取与加固"><a href="#dex抽取与加固" class="headerlink" title="dex抽取与加固"></a>dex抽取与加固</h4><p>第二代加壳技术 对 DEX 文件整体进行了保护 , 将其中的 关键代码抽取到外部 , DEX 加载到内存中后 , 不是完整的 DEX 文件 , 即使将整个 DEX 文件 DUMP 下来之后 , 其中的一些被抽取出来的关键代码无法看到 , 也就是 DEX 文件中的关键类或方法是空的。第一代壳主要针对整个 APK 文件进行加密，第二代壳则对 Dex 文件进行整体加固。第二代壳通过将 Dex 代码加密到 native 层即 so 文件（so 文件是指动态链接库文件，它包含了一些可执行的函数和数据，可以被加载到内存中并被应用调用。so的路径在**&#x2F;data&#x2F;data&#x2F;packagename&#x2F;lib**, 或者&#x2F;data&#x2F;app&#x2F;packagename&#x2F;lib 相关目录下。），常见加固手段如下：</p>
<ul>
<li><p><strong>Dex动态加载</strong></p>
<p>DEX文件的加密和部分函数逻辑的抽取到SO文件中。加载器在运行时负责解密和加载DEX文件，并使应用程序能够动态执行其中的代码逻辑。</p>
</li>
<li><p><strong>So加密</strong></p>
<p>针对 so 文件进行加密，so 文件通常包含了敏感的本地代码或函数实现，加密后程序将在运行时对 so 进行解密获取解密数据。</p>
</li>
<li><p><strong>Dex method代码抽取到外部(通常企业版)</strong></p>
<p>将敏感的 Dex Method 代码从 DEX 文件中提取出来，并进行加密和混淆。</p>
</li>
<li><p><strong>不落地加载</strong> </p>
<p>apk 目录下不能看到原始 dex，把加密的 dex 文件加载到内存中，然后解密，从始至终不会以文件形式存在。</p>
</li>
<li><p><strong>反调试，防 HOOK</strong></p>
</li>
<li><p>检测调试器、反调试技术、内存完整性检测、代码混淆和加密、防HOOK技术、签名校验。</p>
</li>
</ul>
<h4 id="脱壳工具-1"><a href="#脱壳工具-1" class="headerlink" title="脱壳工具"></a>脱壳工具</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dexhunter： https://github.com/zyq8709/DexHunter</span><br><span class="line">elf-dump-fix：https://github.com/maiyao1988/elf-dump-fix</span><br></pre></td></tr></table></figure></div>



<h3 id="第三代加固壳"><a href="#第三代加固壳" class="headerlink" title="第三代加固壳"></a>第三代加固壳</h3><h4 id="Dex-动态解密与-so-混淆"><a href="#Dex-动态解密与-so-混淆" class="headerlink" title="Dex 动态解密与 so 混淆"></a>Dex 动态解密与 so 混淆</h4><p>第三代壳在第二代壳的基础上继续改进，对抗 dump 内存脱壳。加深对 Dex 的加密。使用DEX动态加解密的应用程序来说，解密的过程是在运行时进行的，这意味着只有在需要执行特定的代码或方法时，相应的DEX部分才会被解密并加载到内存中，所以导致内存是不连续的无法直接 dump 完整的内存。常见加固手段如下：</p>
<ul>
<li><p><strong>Dex method代码动态解密</strong></p>
<p>将敏感的 Dex Method 代码在运行时进行解密加载到内存中，若没有执行到的  Method 代码则不进行解密并不释放到内存中去。</p>
</li>
<li><p><strong>So 代码膨胀混淆</strong></p>
<p>通过增加无效的、冗余的代码和数据，使得应用程序的代码量变得庞大和复杂，从而增加了分析者阅读和理解代码的难度。</p>
</li>
</ul>
<h4 id="脱壳工具-2"><a href="#脱壳工具-2" class="headerlink" title="脱壳工具"></a>脱壳工具</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dex2oat：https://github.com/spriteviki/Dex2oatHunter</span><br></pre></td></tr></table></figure></div>



<h3 id="第四代加固壳"><a href="#第四代加固壳" class="headerlink" title="第四代加固壳"></a>第四代加固壳</h3><h4 id="VMP-虚拟机保护"><a href="#VMP-虚拟机保护" class="headerlink" title="VMP(虚拟机保护)"></a>VMP(虚拟机保护)</h4><p>虚拟机保护技术。它通过在应用程序中引入自定义的虚拟机，将原始代码转换为虚拟指令，从而隐藏和保护应用程序的逻辑和算法。</p>
<h4 id="脱壳方法"><a href="#脱壳方法" class="headerlink" title="脱壳方法"></a>脱壳方法</h4><p>暂未探索到自动化工具进行自动化脱壳。</p>
<h3 id="第五代加固壳"><a href="#第五代加固壳" class="headerlink" title="第五代加固壳"></a>第五代加固壳</h3><h4 id="虚拟机源码保护（LLVM）"><a href="#虚拟机源码保护（LLVM）" class="headerlink" title="虚拟机源码保护（LLVM）"></a>虚拟机源码保护（LLVM）</h4><p>基于第四代方案的第一种方案（Java&#x2F;Kotlin → C&#x2F;C++），采用LLVM编译工具链（同时支持C&#x2F;C++, Swift, Object-C），通过对IR进行指令转换，生成<strong>自定义指令集（IR → VM）</strong>，APP内部隔离出独立的执行环境，将该核心代码放置在此独立的执行环境中运行</p>
<h4 id="脱壳方法-1"><a href="#脱壳方法-1" class="headerlink" title="脱壳方法"></a>脱壳方法</h4><p>暂未探索到自动化工具进行自动化脱壳。</p>
<hr>
<h2 id="三、壳识别"><a href="#三、壳识别" class="headerlink" title="三、壳识别"></a>三、壳识别</h2><h4 id="手机应用一键识别"><a href="#手机应用一键识别" class="headerlink" title="手机应用一键识别"></a>手机应用一键识别</h4><p>MT管理器：<a target="_blank" rel="noopener" href="https://mt2.cn/">https://mt2.cn/</a></p>
<p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231207152604122.png" data-caption="image-20231207152604122"><img src="/../images/mobile/reinforce/image-20231207152604122.png" alt="image-20231207152604122"></a></p>
<h4 id="Windows-客户端"><a href="#Windows-客户端" class="headerlink" title="Windows 客户端"></a>Windows 客户端</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">appmsg4.6.3（左）：https://github.com/sulab999/AppMessenger</span><br><span class="line">ApkScan-PKID（右）：https://pan.baidu.com/s/1rDfsEvqQwhUmep1UBLUwSQ（注意：该工具为2018年版本）</span><br></pre></td></tr></table></figure></div>

<p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231207153148309.png" data-caption="image-20231207153148309"><img src="/../images/mobile/reinforce/image-20231207153148309.png" alt="image-20231207153148309"></a></p>
<h4 id="加固壳特征"><a href="#加固壳特征" class="headerlink" title="加固壳特征"></a>加固壳特征</h4><table>
<thead>
<tr>
<th>厂商</th>
<th>特征</th>
<th>Java代码特征</th>
</tr>
</thead>
<tbody><tr>
<td>360加固</td>
<td>assets&#x2F;.appkey<br/>assets&#x2F;libjiagu.so<br/>libjiagu_art.so<br/>libjiagu_x86.so<br/>libprotectClass.so<br/>libjgdtc.so<br/>libjgdtc_a64.so<br/>libjgdtc_art.so<br/>libjgdtc_x64.so<br/>libjgdtc_x86.so<br/>libjiagu_a64.so<br/>libjiagu_ls.so<br/>libjiagu_x64.so<br/>libSafeManageService.so<br/>libjiagu_vip_x64.so<br/>libjiagu_vip.so<br/>libX86Bridge.so</td>
<td>com.stub.StubApp</td>
</tr>
<tr>
<td>假360加固</td>
<td></td>
<td>com.qihoo.util.stub2678363137</td>
</tr>
<tr>
<td>APKProtect</td>
<td>libAPKProtect.so</td>
<td></td>
</tr>
<tr>
<td>UU安全加固</td>
<td>assets&#x2F;libuusafe.jar.so<br/>assets&#x2F;libuusafe.so<br/>lib&#x2F;armeabi&#x2F;libuusafeempty.so</td>
<td></td>
</tr>
<tr>
<td>apktoolplus加固</td>
<td>assets&#x2F;jiagu_data.bin<br/>assets&#x2F;sign.bin<br/>lib&#x2F;armeabi&#x2F;libapktoolplus_jiagu.so</td>
<td>com.linchaolong.apktoolplus.jiagu.ProxyApplication</td>
</tr>
<tr>
<td>中国移动加固</td>
<td>assets&#x2F;mogosec_classes<br/>assets&#x2F;mogosec_data<br/>assets&#x2F;mogosec_dexinfo<br/>assets&#x2F;mogosec_march<br/>ibmogosecurity.so<br/>lib&#x2F;armeabi&#x2F;libcmvmp.so<br/>lib&#x2F;armeabi&#x2F;libmogosec_dex.so<br/>lib&#x2F;armeabi&#x2F;libmogosec_sodecrypt.so<br/>lib&#x2F;armeabi&#x2F;libmogosecurity.so</td>
<td>com.mogosec.AppMgr</td>
</tr>
<tr>
<td>几维安全</td>
<td>assets&#x2F;dex.dat<br/>lib&#x2F;armeabi&#x2F;kdpdata.so<br/>lib&#x2F;armeabi&#x2F;libkdp.so<br/>lib&#x2F;armeabi&#x2F;libkwscmm.so<br/>libkwscr.so<br/>libkwslinker.so</td>
<td>com.Kiwisec.KiwiSecApplication、com.Kiwisec.ProxyApplication</td>
</tr>
<tr>
<td>启明星辰</td>
<td>libvenSec.so<br/>libvenustech.so</td>
<td></td>
</tr>
<tr>
<td>网秦加固</td>
<td>libnqshield.so</td>
<td></td>
</tr>
<tr>
<td>娜迦加固</td>
<td>libchaosvmp.so<br/>libddog.so<br/>libfdog.so<br/>libhdog.so</td>
<td></td>
</tr>
<tr>
<td>娜迦加固（新版2022）</td>
<td>assets&#x2F;maindata&#x2F;fake_classes.dex<br/>lib&#x2F;armeabi&#x2F;libxloader.so<br/>lib&#x2F;armeabi-v7a&#x2F;libxloader.so<br/>lib&#x2F;arm64-v8a&#x2F;libxloader.so<br/>libxloader.so</td>
<td></td>
</tr>
<tr>
<td>娜迦加固（开发者试用版-VMP）</td>
<td>libvdog-x86.so<br/>libvdog.so</td>
<td></td>
</tr>
<tr>
<td>娜迦加固（企业版）</td>
<td>libedog.so</td>
<td></td>
</tr>
<tr>
<td>梆梆安全（企业版）</td>
<td>libDexHelper-x86.so<br/>libDexHelper.so<br/>libDexHelper-x86_64.so</td>
<td></td>
</tr>
<tr>
<td>梆梆安全（定制版）</td>
<td>assets&#x2F;classes.jar<br/> lib&#x2F;armeabi&#x2F;DexHelper.so</td>
<td></td>
</tr>
<tr>
<td>梆梆安全（免费版）</td>
<td>assets&#x2F;secData0.jar<br/>lib&#x2F;armeabi&#x2F;libSecShell-x86.so<br/>lib&#x2F;armeabi&#x2F;libSecShell.so<br/>libSecShell_art.so<br/>libSecShel1.so<br/>libsecexe.so<br/>libsecmain.so<br/>libbangcle_crypto_tool.so<br/>libpnc-crypto.so</td>
<td>com.secneo.apkwrapper.ApplicationWrapper、com.SecShell.SecShell.ApplicationWrapper、com.secneo.apkwrapper.AW</td>
</tr>
<tr>
<td>假梆梆加固</td>
<td></td>
<td>com.secoen.apkwrapper.ApplicationWrapper</td>
</tr>
<tr>
<td>海云安加固</td>
<td>assets&#x2F;itse<br/>lib&#x2F;armeabi&#x2F;libitsec.so<br/>libitsec.so</td>
<td>c.b.c.b</td>
</tr>
<tr>
<td>爱加密</td>
<td>assets&#x2F;af.bin<br/>assets&#x2F;ijm_lib&#x2F;X86&#x2F;libexec.so<br/>assets&#x2F;ijm_lib&#x2F;armeabi&#x2F;libexec.so<br/>assets&#x2F;signed.bin<br/>ijiami.dat<br/>lib&#x2F;armeabi&#x2F;libexecmain.so<br/>libexecmain.so<br/>libexecmain_x86.so<br/>libexecoat.so<br/>libexecoat_x86.so<br/>libijm-emulator.so</td>
<td>s.h.e.l.l.S</td>
</tr>
<tr>
<td>爱加密企业版</td>
<td>assets&#x2F;ijiami.ajm</td>
<td></td>
</tr>
<tr>
<td>爱加密3代壳</td>
<td>assets&#x2F;ijiami3.ajm<br/>libexecv3.so</td>
<td></td>
</tr>
<tr>
<td>爱加密5代壳</td>
<td>assets&#x2F;IJMDal.Data<br/>assets&#x2F;libijmDataEncryption.so<br/>libijmDataEncryption_arm64.so<br/>libijmDataEncryption_x86.so<br/>libijmDataEncryption_x86_64.so</td>
<td></td>
</tr>
<tr>
<td>珊瑚灵御</td>
<td>assets&#x2F;libreincp.so<br/>assets&#x2F;libreincp_x86.so</td>
<td>com.coral.util.StubApplication</td>
</tr>
<tr>
<td>瑞星加固</td>
<td>librsprotect.so</td>
<td></td>
</tr>
<tr>
<td>百度加固</td>
<td>libbaiduprotect.so<br/>assets&#x2F;baiduprotect.jar<br/>assets&#x2F;baiduprotect1.jar<br/>lib&#x2F;armeabi&#x2F;libbaiduprotect.so<br/>libbaiduprotect_art.so<br/>libbaiduprotect_x86.so</td>
<td>com.baidu.protect.StubApplication</td>
</tr>
<tr>
<td>盛大加固</td>
<td>libapssec.so</td>
<td></td>
</tr>
<tr>
<td>网易易盾</td>
<td>libnesec.so</td>
<td></td>
</tr>
<tr>
<td>腾讯加固</td>
<td>libexec.so<br/>libshell.so</td>
<td>com.tencent.StubShell.TxAppEntry</td>
</tr>
<tr>
<td>腾讯乐固（旧版）</td>
<td>libtup.so<br/>lib&#x2F;armeabi&#x2F;mix.dex<br/>liblegudb.so<br/>libshella<br/>lib&#x2F;armeabi&#x2F;mixz.dex<br/>libshel1x<br/>lib&#x2F;armeabi&#x2F;libshella-xxxx.so<br/>lib&#x2F;armeabi&#x2F;libshellx-xxxx.so<br/>tencent_stub<br/>libshella-2.10.2.3.so<br/>libshell.so<br/>libshella-2.9.0.2<br/>libshella-4.1.0.15.so<br/>libshella-4.1.0.19.so<br/>libshellx.so</td>
<td>com.tencent.StubShell.TxAppEntry</td>
</tr>
<tr>
<td>腾讯乐固（VMP）</td>
<td>lib&#x2F;arm64-v8a&#x2F;libxgVipSecurity.so<br/>lib&#x2F;armeabi-v7a&#x2F;libxgVipSecurity.so<br/>libxgVipSecurity.so</td>
<td></td>
</tr>
<tr>
<td>腾讯云加固</td>
<td>assets&#x2F;libshellx-super.2021.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2019.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2020.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2021.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2022.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2023.so<br/>tencent_sub</td>
<td></td>
</tr>
<tr>
<td>腾讯云移动应用安全</td>
<td>0000000lllll.dex<br/>00000olllll.dex<br/>000O00ll111l.dex<br/>00O000ll111l.dex<br/>0OO00l111l1l<br/>o0oooOO0ooOo.dat</td>
<td></td>
</tr>
<tr>
<td>腾讯云移动应用安全（腾讯御安全）</td>
<td>libBugly-yaq.so<br/>libshell-super.2019.so<br/>libshellx-super.2019.so<br/>libzBugly-yaq.so<br/>t86<br/>tosprotection<br/>tosversion<br/>000000011111.dex<br/>000000111111.dex<br/>000001111111<br/>00000o11111.dex<br/>o0ooo000oo0o.dat</td>
<td></td>
</tr>
<tr>
<td>腾讯御安全</td>
<td>libtosprotection.armeabi-v7a.so<br/>libtosprotection.armeabi.so<br/>libtosprotection.x86.so<br/>assets&#x2F;libtosprotection.armeabi-v7a.so<br/>assets&#x2F;libtosprotection.armeabi.so<br/>assets&#x2F;libtosprotection.x86.so<br/>assets&#x2F;tosversion<br/>lib&#x2F;armeabi&#x2F;libTmsdk-xxx-mfr.so<br/>lib&#x2F;armeabi&#x2F;libtest.so</td>
<td>MyWrapperProxyApplication</td>
</tr>
<tr>
<td>腾讯Bugly</td>
<td>lib&#x2F;arm64-v8a&#x2F;libBugly.so<br/>libBugly.so</td>
<td></td>
</tr>
<tr>
<td>蛮犀加固</td>
<td>assets&#x2F;mxsafe.config<br/>assets&#x2F;mxsafe.data<br/>assets&#x2F;mxsafe.jar<br/>assets&#x2F;mxsafe&#x2F;arm64-v8a&#x2F;libdSafeShell.so<br/>assets&#x2F;mxsafe&#x2F;x86_64&#x2F;libdSafeShell.so<br/>libdSafeShell.so</td>
<td></td>
</tr>
<tr>
<td>通付盾</td>
<td>libNSaferOnly.so<br/>libegis.so<br/>libgeiri.so<br/>libgeiri-x86.so</td>
<td></td>
</tr>
<tr>
<td>阿里加固</td>
<td>assets&#x2F;armeabi&#x2F;libzuma.so<br/>aliprotect.dat<br/>assets&#x2F;armeabi&#x2F;libfakejni.so<br/>assets&#x2F;libzuma.so<br/>assets&#x2F;libzumadata.so<br/>assets&#x2F;libpreverify1.so<br/>libsgmain.so<br/>libsgsecuritybody.so<br/>libmobisec.so</td>
<td></td>
</tr>
<tr>
<td>阿里云加固</td>
<td>libdemolish.so<br/>libdemolishdata.so</td>
<td></td>
</tr>
<tr>
<td>阿里聚安全</td>
<td>assets&#x2F;armeabi&#x2F;libfakejni.so<br/>assets&#x2F;libzumadata.so<br/>assets&#x2F;libpreverify1.so<br/>aliprotect.dat<br/>libdemolish.so<br/>libfakejni.so<br/>libmobisec.so<br/>libsgmain.so<br/>assets&#x2F;libzuma.so<br/>libzumadata.so<br/>libdemolishdata.so<br/>libpreverify1.so<br/>libsgsecuritybody.so</td>
<td></td>
</tr>
<tr>
<td>顶像科技</td>
<td>libx3g.so<br/>libjni.so<br/>lib&#x2F;armeabi&#x2F;libx3g.so</td>
<td>cn.securitystack.stee.AppStub</td>
</tr>
<tr>
<td>DexProtect加固</td>
<td>assets&#x2F;classes.dex.dat<br/>dp.arm-v7.so.dat<br/>dp.arm.so.dat</td>
<td></td>
</tr>
<tr>
<td>CFCA加固</td>
<td>libsecenh_a64.so<br/>libsecenh_x86.so<br/>my_classes.jar<br/>libsecenh.so<br/>libbasec.so<br/>libbasec_x86.so</td>
<td></td>
</tr>
<tr>
<td>OPPO加固-oppo手机加固</td>
<td>OPPOProtect.so<br/>OPPOProtect2019.so<br/>OPPOProtect2020.so<br/>OPPOProtect2021.so<br/>OPPOProtect2022.so<br/>OPPOProtect2023.so</td>
<td></td>
</tr>
<tr>
<td>OPPO加固-安全检测SDK</td>
<td>libomesStdSco.so<br/>jni&#x2F;arm64-v8a&#x2F;libomesStdSco.so<br/>jni&#x2F;armeabi-v7a&#x2F;libomesStdSco.so<br/>jni&#x2F;x86&#x2F;libomesStdSco.so<br/>jni&#x2F;x86_64&#x2F;libomesStdSco.so</td>
<td></td>
</tr>
<tr>
<td>深盾安全加固（Virbox Protector）</td>
<td>ibvirbox32.so<br/>libvirbox64.so</td>
<td></td>
</tr>
</tbody></table>
<h4 id="特征找寻案例"><a href="#特征找寻案例" class="headerlink" title="特征找寻案例"></a>特征找寻案例</h4><p>APP 爱加密5代壳，将 .apk 修改为 .zip 然后进行解压，解压后 assets 发现爱加密5代壳特征，IJMDal.Data</p>
<p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231207155612690.png" data-caption="image-20231207155612690"><img src="/../images/mobile/reinforce/image-20231207155612690.png" alt="image-20231207155612690"></a></p>
<p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231208100319417.png" data-caption="image-20231208100319417"><img src="/../images/mobile/reinforce/image-20231208100319417.png" alt="image-20231208100319417"></a></p>
<p>通过查壳工具，亦能查询</p>
<p>![image-20231207153148309](E:\Security file\learning notes\images\image-20231207153148309-17080968561231.png)</p>
<hr>
<h2 id="四、脱壳方法及工具汇总"><a href="#四、脱壳方法及工具汇总" class="headerlink" title="四、脱壳方法及工具汇总"></a>四、脱壳方法及工具汇总</h2><h3 id="内存dump"><a href="#内存dump" class="headerlink" title="内存dump"></a>内存dump</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FRIDA-DEXdump：https://github.com/hluwa/FRIDA-DEXDump</span><br></pre></td></tr></table></figure></div>



<h3 id="文件监视"><a href="#文件监视" class="headerlink" title="文件监视"></a>文件监视</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inotifywait-for-Android ：https://github.com/dstmath/inotifywait-for-Android</span><br></pre></td></tr></table></figure></div>



<h3 id="动态调试"><a href="#动态调试" class="headerlink" title="动态调试"></a>动态调试</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IDA 资源地址：https://www.52pojie.cn/thread-1861590-1-1.html</span><br></pre></td></tr></table></figure></div>



<h3 id="内存重组"><a href="#内存重组" class="headerlink" title="内存重组"></a>内存重组</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ZjDroid ：https://github.com/halfkiss/ZjDroiddumpDex</span><br><span class="line">dumpDex ：https://github.com/WrBug/dumpDex</span><br><span class="line">elfrebuild ：https://github.com/ylcangel/ElfRebuild</span><br></pre></td></tr></table></figure></div>



<h3 id="dex2oat"><a href="#dex2oat" class="headerlink" title="dex2oat"></a>dex2oat</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dex2oatHunter ：https://github.com/spriteviki/Dex2oatHunte</span><br></pre></td></tr></table></figure></div>



<h3 id="定制系统"><a href="#定制系统" class="headerlink" title="定制系统"></a>定制系统</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FART ：https://github.com/hanbinglengyue/FART</span><br><span class="line">BlackDex ：https://github.com/CodingGay/BlackDex</span><br></pre></td></tr></table></figure></div>



<p>攻击者可以通过自定义Android虚拟机，在解释器的代码上做记录一个函数的内容（CodeItem）。接下来遍历触发所有函数，从而获取到全部的函数内容。最终重新组装成一个完整的DEX文件</p>
<h3 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Xposed：https://github.com/ElderDrivers/EdXposed（非原 Xposed，原Xposed已停止更新）</span><br><span class="line">FRIDA：https://github.com/frida/frida</span><br></pre></td></tr></table></figure></div>



<h2 id="六、参考"><a href="#六、参考" class="headerlink" title="六、参考"></a>六、参考</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">https://www.isisy.com/1420.html</span><br><span class="line">https://zhuanlan.zhihu.com/p/550084508</span><br><span class="line">https://github.com/moyuwa/ApkCheckPack/tree/main</span><br><span class="line">https://blog.csdn.net/g5703129/article/details/85054405</span><br><span class="line">http://www.wiki.yelbee.top/2020/04/30/%E5%8D%93%E6%8A%A4%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/%E5%BA%94%E7%94%A8%E5%8A%A0%E5%9B%BA/4.1%E5%BA%94%E7%94%A8%E5%8A%A0%E5%9B%BA%E6%A6%82%E8%BF%B0/</span><br><span class="line">https://bbs.kanxue.com/thread-274793.htm</span><br><span class="line">https://cloud.tencent.com/developer/article/2284277</span><br><span class="line">https://onejane.github.io/2021/02/21/%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%E4%B9%8B%E5%88%86%E7%B1%BB%E6%8A%80%E6%9C%AF/#%E7%AC%AC%E4%BA%8C%E4%BB%A3%E5%A3%B3-dex%E6%8A%BD%E5%8F%96%E4%B8%8E%E5%8A%A0%E5%9B%BA</span><br><span class="line">https://dun.163.com/news/p/760c8c1ad4ee4349951646d85814264d</span><br><span class="line">https://www.dingxiang-inc.com/blog/post/2</span><br></pre></td></tr></table></figure></div>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>





        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a href="/search/">搜索</a></li>
         
          <li><a href="/tags/">标签</a></li>
         
          <li><a href="/about/">关于</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">一、前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86"><span class="toc-number">1.1.</span> <span class="toc-text">代码混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%A3%B3"><span class="toc-number">1.2.</span> <span class="toc-text">加壳</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8F%B2"><span class="toc-number">2.</span> <span class="toc-text">二、加固壳史</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.1.</span> <span class="toc-text">第一代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#DEX%E5%8A%A0%E5%AF%86-%E8%90%BD%E5%9C%B0%E5%8A%A0%E8%BD%BD"><span class="toc-number">2.1.1.</span> <span class="toc-text">DEX加密(落地加载)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.2.</span> <span class="toc-text">脱壳工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.2.</span> <span class="toc-text">第二代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#dex%E6%8A%BD%E5%8F%96%E4%B8%8E%E5%8A%A0%E5%9B%BA"><span class="toc-number">2.2.1.</span> <span class="toc-text">dex抽取与加固</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E5%B7%A5%E5%85%B7-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">脱壳工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.3.</span> <span class="toc-text">第三代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Dex-%E5%8A%A8%E6%80%81%E8%A7%A3%E5%AF%86%E4%B8%8E-so-%E6%B7%B7%E6%B7%86"><span class="toc-number">2.3.1.</span> <span class="toc-text">Dex 动态解密与 so 混淆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E5%B7%A5%E5%85%B7-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">脱壳工具</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.4.</span> <span class="toc-text">第四代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#VMP-%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BF%9D%E6%8A%A4"><span class="toc-number">2.4.1.</span> <span class="toc-text">VMP(虚拟机保护)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95"><span class="toc-number">2.4.2.</span> <span class="toc-text">脱壳方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%94%E4%BB%A3%E5%8A%A0%E5%9B%BA%E5%A3%B3"><span class="toc-number">2.5.</span> <span class="toc-text">第五代加固壳</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%BA%90%E7%A0%81%E4%BF%9D%E6%8A%A4%EF%BC%88LLVM%EF%BC%89"><span class="toc-number">2.5.1.</span> <span class="toc-text">虚拟机源码保护（LLVM）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95-1"><span class="toc-number">2.5.2.</span> <span class="toc-text">脱壳方法</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%A3%B3%E8%AF%86%E5%88%AB"><span class="toc-number">3.</span> <span class="toc-text">三、壳识别</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%8B%E6%9C%BA%E5%BA%94%E7%94%A8%E4%B8%80%E9%94%AE%E8%AF%86%E5%88%AB"><span class="toc-number">3.0.1.</span> <span class="toc-text">手机应用一键识别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows-%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-number">3.0.2.</span> <span class="toc-text">Windows 客户端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%9B%BA%E5%A3%B3%E7%89%B9%E5%BE%81"><span class="toc-number">3.0.3.</span> <span class="toc-text">加固壳特征</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E5%BE%81%E6%89%BE%E5%AF%BB%E6%A1%88%E4%BE%8B"><span class="toc-number">3.0.4.</span> <span class="toc-text">特征找寻案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95%E5%8F%8A%E5%B7%A5%E5%85%B7%E6%B1%87%E6%80%BB"><span class="toc-number">4.</span> <span class="toc-text">四、脱壳方法及工具汇总</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98dump"><span class="toc-number">4.1.</span> <span class="toc-text">内存dump</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%91%E8%A7%86"><span class="toc-number">4.2.</span> <span class="toc-text">文件监视</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95"><span class="toc-number">4.3.</span> <span class="toc-text">动态调试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E9%87%8D%E7%BB%84"><span class="toc-number">4.4.</span> <span class="toc-text">内存重组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dex2oat"><span class="toc-number">4.5.</span> <span class="toc-text">dex2oat</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E5%88%B6%E7%B3%BB%E7%BB%9F"><span class="toc-number">4.6.</span> <span class="toc-text">定制系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hook"><span class="toc-number">4.7.</span> <span class="toc-text">Hook</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8F%82%E8%80%83"><span class="toc-number">5.</span> <span class="toc-text">六、参考</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&text=移动安全-Android APP 加固壳原理"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&is_video=false&description=移动安全-Android APP 加固壳原理"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=移动安全-Android APP 加固壳原理&body=Check out this article: http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&title=移动安全-Android APP 加固壳原理"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&name=移动安全-Android APP 加固壳原理&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/&t=移动安全-Android APP 加固壳原理"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
      <div class="footer-left">
        Copyright &copy;
        
        
        2022-2025
        Funsiooo
      </div>
      <div class="footer-right">
        <nav>
          <ul>
            <!--
          --><li><a href="/">首页</a></li><!--
        --><!--
          --><li><a href="/archives/">归档</a></li><!--
        --><!--
          --><li><a href="/search/">搜索</a></li><!--
        --><!--
          --><li><a href="/tags/">标签</a></li><!--
        --><!--
          --><li><a href="/about/">关于</a></li><!--
        -->
          </ul>
        </nav>        
      </div>

      <div class="footer-midle">
        <nav>
          <ul>
            
              <!-- 不蒜子统计 -->
              <span id="busuanzi_container_site_pv">
                  本站总访问量<span id="busuanzi_value_site_pv"></span>次
              </span>
              <span class="post-meta-divider">|</span>
              <span id="busuanzi_container_site_uv" style='display:none'>
                      本站访客数<span id="busuanzi_value_site_uv"></span>人
              </span>
              <span id="busuanzi_container_page_pv">
			  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	      </span>
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            
          </ul>
        </nav>
      </div>
</footer>
    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板！\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功！");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?47a5bc2b41144f91553c5eefd4999c0d";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'boom';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

<!-- FancyBox -->

<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js"></script>


</body>
</html>
